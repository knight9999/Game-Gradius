<!DOCTYPE html><html><head><meta charset="utf-8"><title>HTML 5 G no pakuri</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="apple-mobile-web-app-title" content="G pakuri"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="apple-touch-icon" href="./images/homeicon.jpg"><style>html,body{background:rgba(0,0,0,1) url(./images/gradius_background.jpg);background-size:cover;font-family:HiraKakuProN-W3,"ヒラギノ角ゴ ProN W3",Helvetica,sans-serif;height:100%;margin:0;padding:0;position:relative;overflow:hidden;width:100%;z-index:0;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}body::before{background-color:rgba(0,0,0,0.7);left:0;content:'';height:100%;min-width:1000px;position:absolute;top:0;width:100%;z-index:0}article,aside,dialog,figure,footer,header,hgroup,menu,nav,section{display:block}p{margin:0;padding:0}body *{box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-touch-callout:none;-webkit-user-select:none}@keyframes _fadein{0%{opacity:0}100%{opacity:1}}@keyframes _flashing{0%{opacity:0}100%{opacity:1}}#game_wrapper{align-items:center;display:none;height:100%;justify-content:center;left:0;opacity:0;position:absolute;top:0;width:100%;z-index:1}#game_wrapper.on{animation:_fadein 1.0s;display:flex;opacity:1}#game{background-color:#000;border-bottom:2px solid rgba(200,200,200,1.0);border-top:2px solid rgba(200,200,200,1.0);box-shadow:0 0 10px 10px rgba(0,0,0,0.4);display:block;width:100%}body #sp_controller{display:none}body:not(.sp) #sp_landscapemode{display:none}#game_start_loading{display:none}#game_start_loading.on{color:rgba(255,255,255,1);display:block;height:100%;position:relative;width:100%;z-index:2}#game_start_loading.on .text{font-size:30px;left:50%;position:absolute;top:50%;transform:translate(-50%,-50%);text-align:center}#game_start_loading.on .text{opacity:1;animation:_flashing .1s infinite linear}@media screen and (max-width:999px){}@media screen and (orientation:portrait){body.sp section:not(#sp_landscapemode){display:none !important}body.sp section#sp_landscapemode{background-color:rgba(0,0,0,0.5);color:rgba(255,255,255,1);display:block;height:100%;position:relative;width:100%;z-index:1}body.sp section#sp_landscapemode ._inner{left:50%;position:absolute;text-align:center;top:45%;transform:translate(-50%,-50%)}body.sp section#sp_landscapemode #device{animation:3s anim infinite;background-color:rgba(255,255,255,0.2);border-radius:5px;border:2px solid rgba(255,255,255,1);height:60px;position:absolute;transform-origin:bottom right;transform:rotate(0);top:6em;left:calc(50% - 50px);transform:translate(-50%,-50%);width:36px}body.sp section#sp_landscapemode #device:after{background-color:rgba(0,0,0,1);border:1px solid rgba(255,255,255,1);content:'';left:calc(50% - 14px);top:calc(50% - 21px);position:absolute;height:40px;width:26px}@keyframes anim{0%{transform:translate(-50%,-50%)}30%{transform:translate(-50%,-50%) rotate(0)}70%{transform:translate(-50%,-50%) rotate(90deg)}100%{transform:translate(-50%,-50%) rotate(90deg)}}}@media screen and (orientation:landscape){body.sp section#sp_landscapemode{display:none !important}}body.sp section#game_wrapper.on{display:block}body.sp section#game_wrapper #game{border:2px solid rgba(190,190,190,1.0);height:100%;margin:auto;width:auto}body.sp section#sp_controller.on{bottom:0;display:block;height:100px;left:0;position:absolute;width:100%;z-index:5}body.sp section#sp_controller #sp_controller_inner{height:100%;margin:0 auto;position:relative;width:90%}body.sp section#sp_controller #sp_controller_inner .sp_controller_main{background-color:rgba(100,100,100,1.0);border:1px solid rgba(255,255,255,1.0);border-radius:50%;bottom:0;height:100px;opacity:.8;overflow:hidden;position:absolute;width:100px}body.sp section#sp_controller #sp_controller_inner .sp_controller_main .sp_controller_main_center{background-color:rgba(255,255,255,0.3);border-radius:50%;left:calc(50% - 45px);height:90px;position:absolute;top:calc(50% - 45px);width:90px}body.sp section#sp_controller #sp_controller_inner>div[class*="bt"]{background-color:rgba(100,100,100,1.0);border:1px solid rgba(255,255,255,1.0);border-radius:50%;color:rgba(255,255,255,1);height:70px;opacity:.8;position:absolute;width:70px}body.sp section#sp_controller #sp_controller_inner>div[class*="bt"].on{background-color:rgba(180,180,180,1.0) !important}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt::before{bottom:0;left:0;right:0;top:0;content:"";height:30px;margin:auto;position:absolute;width:30px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.r::before{background:url(./images/gradius_font.png) no-repeat;background-size:cover;background-position:-810px 0}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.p::before{background:url(./images/gradius_font.png) no-repeat;background-size:cover;background-position:-750px 0}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.s::before{background:url(./images/gradius_font.png) no-repeat;background-size:cover;background-position:-840px 0}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.b::before{background:url(./images/gradius_font.png) no-repeat;background-size:cover;background-position:-330px 0}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.a::before{background:url(./images/gradius_font.png) no-repeat;background-size:cover;background-position:-300px 0}@media screen and (min-width:1024px) and (orientation:landscape){body.sp section#game_wrapper{height:calc(100% - 200px);margin:0 auto;position:relative;width:100%}body.sp section#game_wrapper #game{height:auto;width:100%}@media screen and (max-height:704px) and (orientation:landscape){body.sp section#game_wrapper{width:inherit}body.sp section#game_wrapper #game{height:100%;width:auto}}body.sp section#sp_controller.on{height:200px}body.sp section#sp_controller #sp_controller_inner .sp_controller_main{height:200px;top:0;width:200px}body.sp section#sp_controller #sp_controller_inner .sp_controller_main .sp_controller_main_center{left:calc(50% - 80px);height:160px;top:calc(50% - 80px);width:160px}body.sp section#sp_controller #sp_controller_inner>div[class*="bt"]{font-size:280%;height:100px;width:100px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.hide{right:435px;top:115px;height:60px !important;width:60px !important}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.r{right:400px;top:00px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.p{right:200px;top:00px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.s{right:300px;top:70px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.b{right:100px;top:70px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.a{right:0;top:0}}@media screen and (min-width:737px) and (max-width:1023px) and (orientation:landscape){body.sp section#game_wrapper{height:100%;transform:scale(0.60);transform-origin:top}body.sp section#sp_controller #sp_controller_inner{width:80%}body.sp section#sp_controller #sp_controller_inner .sp_controller_main{height:100px;width:100px}body.sp section#sp_controller #sp_controller_inner .sp_controller_main .sp_controller_main_center{left:calc(50% - 45px);height:90px;top:calc(50% - 45px);width:90px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.hide{right:350px;bottom:0;height:30px !important;width:30px !important}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.r{right:280px;bottom:20px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.s{right:210px;bottom:0}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.p{right:140px;bottom:20px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.b{right:70px;bottom:0}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.a{right:0;bottom:20px}}@media screen and (min-width:569px) and (max-width:736px) and (orientation:landscape){body.sp section#game_wrapper{height:calc(100% - 100px)}body.sp section#sp_controller #sp_controller_inner .sp_controller_main{height:100px;width:100px}body.sp section#sp_controller #sp_controller_inner .sp_controller_main .sp_controller_main_center{left:calc(50% - 45px);height:90px;top:calc(50% - 45px);width:90px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.hide{right:350px;bottom:0;height:30px !important;width:30px !important}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.r{right:280px;bottom:20px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.s{right:210px;bottom:0}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.p{right:140px;bottom:20px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.b{right:70px;bottom:0}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.a{right:0;bottom:20px}}@media screen and (max-width:568px) and (orientation:landscape){body.sp section#game_wrapper{height:calc(100% - 100px)}body.sp section#game_wrapper #game{height:100%;width:auto}body.sp section#sp_controller #sp_controller_inner{width:95%}body.sp section#sp_controller #sp_controller_inner .sp_controller_main{height:100px;width:100px}body.sp section#sp_controller #sp_controller_inner .sp_controller_main .sp_controller_main_center{left:calc(50% - 45px);height:90px;top:calc(50% - 45px);width:90px}body.sp section#sp_controller #sp_controller_inner>div[class*="bt"]{height:60px;width:60px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.hide{right:350px;bottom:10px;height:30px !important;width:30px !important}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.r{right:280px;bottom:10px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.s{right:210px;bottom:10px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.p{right:140px;bottom:10px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.b{right:70px;bottom:10px}body.sp section#sp_controller #sp_controller_inner .sp_controller_bt.a{right:0;bottom:10px}}</style></head><body><section id="game_wrapper"><canvas id="game" height="500" width="1000"></canvas></section><section id="game_start_loading" class="on"><div class="text">Now Loading...<p class="rate"></p></div><div class="range"></div></section><section id="sp_controller"><div id="sp_controller_inner"><div class="sp_controller_main"><div class="sp_controller_main_center"></div></div><!-- /.sp_controller_main --><div class="sp_controller_bt hide"></div><div class="sp_controller_bt r"></div><div class="sp_controller_bt p"></div><div class="sp_controller_bt s"></div><div class="sp_controller_bt b"></div><div class="sp_controller_bt a"></div></div></section><!-- /#sp_controller --><section id="sp_landscapemode"><div class="_inner">    &#x753B;&#x9762;&#x3092;&#x6A2A;&#x306B;&#x3057;&#x3066;<br>&#x30B2;&#x30FC;&#x30E0;&#x3092;&#x3057;&#x3066;&#x304F;&#x3060;&#x3055;&#x3044;    <div id="device"></div></div></section><!-- /#sp_landscapemode --><script>"use strict";const t={_init_canvas_imgs(t){if(void 0!==t)for(let s in t)e[s]={},e[s].src=t[s].src,e[s].rate=t[s].rate,e[s].obj=new Image},_init_canvas_imgs_init(t){if(void 0!==t)for(let e in t)s[e]={},s[e].src=t[e].src,s[e].rate=t[e].rate,s[e].obj=new Image},_init_canvas_audios(t){if(void 0!==t)for(let e in t)i[e]={},i[e].src=t[e].src,i[e].valume=t[e].volume,i[e].loopOffset=t[e].loopOffset,i[e].buf=new Object}},e={},s={},i={};window.AudioContext=window.AudioContext||window.webkitAudioContext;let _=!1,o=0,n=0,a=null;const h=null===window.ontouchstart,r=60,l=document.getElementById("game")||{width:1e3,height:500};let d,c="",m="",p="",g=new Array;const y=0,u=1,x=2,w={_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7};let v=[],f=0;const b=()=>parseInt(v[f]._MOAI_RING_INT),P=()=>parseFloat(v[f]._shot_rate),M=()=>parseInt(v[f]._shot_speed),I=()=>parseInt(v[f]._enemy_speed),C=()=>parseInt(v[f]._hache_rate),j=()=>parseFloat(v[f]._volcano_rate),E=function(t){return new Promise((e,s)=>{let i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&(200===i.status?(console.log(t.url+":OK"),e(i.response)):(console.log("NG"),s(new Error(i.statusText))))},i.open("GET",t.url+"?date="+(new Date).getTime()),i.responseType=t.type||"json",i.onerror=(()=>{s(new Error(i.statusText))}),i.send(null)})},S={_img_loaded_count:0,_init_imgs(t,e){return new Promise((s,i)=>{let _=this,o=!1;for(let n in t){let a=t[n];a.obj.src=t[n].src,a.obj.onload=function(){if(a.obj.width*=a.rate,a.obj.height*=a.rate,_._img_loaded_count++,_._img_loaded_count>=Object.keys(t).length)s();else if(void 0!==e){let s=parseInt(_._img_loaded_count/Object.keys(t).length*100);e(s)}},a.obj.onabort=(()=>{o||(o=!0,i(a.obj.src))}),a.obj.onerror=(()=>{o||(o=!0,i(a.obj.src))})}})}},D={_audio_context:null,_audio_buffer_loader:null,_audio_now_obj_bg:null,_audio_context_source_bg:null,_audio_settimeout:null,_audio_loaded_count:0,_is_audio_context_source_bg:!1,_init(){this._audio_context=new window.AudioContext},_init_audios(t,e){return new Promise((s,i)=>{let _=this,o=!1;for(let n in t){let a=new XMLHttpRequest;a.open("GET",t[n].src,!0),a.responseType="arraybuffer",a.onload=(()=>{_._audio_context.decodeAudioData(a.response,i=>{t[n].buf=i,_._audio_loaded_count++,_._audio_loaded_count>=Object.keys(t).length?s():void 0!==e&&e(_._audio_loaded_count/Object.keys(t).length*100)},e=>{console.log("一部音声読み込みに失敗しました。再度立ち上げなおしてください:"+t[n].src),i(t[n].src)})}),a.onabort=(()=>{o||(o=!0,i(t[n].src))}),a.onerror=(()=>{o||(o=!0,i(t[n].src))}),a.send()}})},_reset(){this._audio_context=null,this._audio_buffer_loader=null,this._audio_now_obj_bg=null,this._audio_context_source_bg=null,this._is_audio_context_source_bg=!1,this._audio_settimeout=null,this._audio_loaded_count=0},_setPlay(t){if(null===t||void 0===t)return;var e=this._audio_context.createBufferSource();e.buffer=t.buf,e.loop=!1,e.connect(this._audio_context.destination),e.start(0)},_setOnBG(t){void 0!==t&&(this._audio_now_obj_bg=t)},_setPlayOnBG(t,e){let s=this;if(null===(t=void 0===t?s._audio_now_obj_bg:t))return;let i=t.loopOffset||0;e=!(!e&&void 0!==e),!0===s._is_audio_context_source_bg&&(s._audio_context_source_bg.stop(),s._is_audio_context_source_bg=!1);let _=s._audio_context.createBufferSource();_.buffer=t.buf,s._audio_now_obj_bg=t,_.connect(s._audio_context.destination),_.loop=e,_.loopStart=i||0,_.loopEnd=t.buf.duration,_.start(),s._audio_context_source_bg=_,s._is_audio_context_source_bg=!0},_setStopOnBG(){this._is_audio_context_source_bg&&(this._audio_context_source_bg.stop(),this._is_audio_context_source_bg=!1,clearTimeout(this._audio_settimeout))}},k={_url_params:new Array,_txt:{0:"0",1:"60",2:"120",3:"180",4:"240",5:"300",6:"360",7:"420",8:"480",9:"540",a:"600",b:"660",c:"720",d:"780",e:"840",f:"900",g:"960",h:"1020",i:"1080",j:"1140",k:"1200",l:"1260",m:"1320",n:"1380",o:"1440",p:"1500",q:"1560",r:"1620",s:"1680",t:"1740",u:"1800",v:"1860",w:"1920",x:"1980",y:"2040",z:"2100",":":"2160",_:"2280","-":"2340"},_ac:{_get:function(t,e,s){return t>=e.length*s-1?0:t+1}},getRad(t,e){if(void 0!==t&&void 0!==e)return Math.atan2(t.y-e.y,t.x-e.x)},getDeg(t,e){if(void 0===t||void 0===e)return;return Math.atan2(t.y-e.y,t.x-e.x)/Math.PI*180},getRadToDeg:t=>void 0===t||""===t?null:t/Math.PI*180,getBit:(t,e)=>("0".repeat(e)+t).slice(-1*e),getOrBit(t,e,s){let i=(parseInt(t,2)|parseInt(e,2)).toString(2);return this.getBit(i,s)},setUrlParams(){for(var t=location.search.slice(1).split(/(&|&amp;)/),e=0;e<t.length;e++){var s=t[e].replace("amp;","").split("=");""!==s[0]&&void 0!==s[0]&&("&"!==s[0]&&(this._url_params[s[0]]=s[1]))}},isObjsLessDistance(t){if(void 0===t)return!1;if(void 0===t.p||void 0===t.e)return!1;let e=t.p.getPlayerCenterPosition(),s=t.e.getEnemyCenterPosition(),i=t.d||100,_=Math.abs(e._x-s._x),o=Math.abs(e._y-s._y);return Math.sqrt(Math.pow(_,2)+Math.pow(o,2))<i},isShotCanvasOut:t=>t.x<-p.t||t.x>l.width+p.t||t.y<-p.t||t.y>l.height+p.t,isEnemyCanvasOut(t,e,s){let i=t.getEnemyCenterPosition(),_=e||{up:!0,down:!0,left:!0,right:!0},o=t.width,n=t.height,a=s||{up:0,down:0,left:0,right:0},h=a.up||0,r=a.right||0,d=a.down||0,c=a.left||0;return i._x<0-o-c&&!0===_.left||i._x>l.width+o+r&&!0===_.right||i._y<0-n-h&&!0===_.up||i._y>l.height+n+d&&!0===_.down},isSqCollision(t,e,s,i,_){return this.isSqCollision_laser(t,e,s,i,_).ret},isSqCollision_laser(t,e,s,i,_){let o=parseInt(void 0===e?0:e.split(",")[0]),n=parseInt(void 0===e?0:e.split(",")[1]),a=parseInt(void 0===i?0:i.split(",")[0]),h=parseInt(void 0===i?0:i.split(",")[1]),r=t.split(","),d=parseInt(r[2])-parseInt(r[0]),c=parseInt(r[3])-parseInt(r[1]),m=d/2+o+parseInt(r[0]),p=c/2+n+parseInt(r[1]);_&&console.log(m+":"+p);for(let t=0;t<s.length;t++){let e=s[t].split(","),i=parseInt(e[2])-parseInt(e[0]),_=parseInt(e[3])-parseInt(e[1]),o=void 0===e[4],n=i/2+a+parseInt(e[0]),r=_/2+h+parseInt(e[1]),l=Math.abs(n-m),g=Math.abs(r-p),x=a+parseInt(e[0]);if(d/2+i/2>l&&c/2+_/2>g)return o?{ret:y,val:x}:{ret:u,val:x}}return{ret:x,val:l.width}},_setDrawToText(t){if(void 0===t)return;let e=this;const i=s.font.obj,_=i.height;t.r=t.r||1,t.alpha=void 0===t.alpha||null===t.alpha?1:t.alpha;let o=(()=>"left"===t.x?0:"center"===t.x?parseInt(l.width/2)-parseInt(t.s.length*(_*t.r)/2):"right"===t.x?l.width-parseInt(t.s.length*_*t.r):t.x)(),n=(()=>"top"===t.y?0:"center"===t.y?parseInt(l.height/2)-parseInt(_*t.r/2):"bottom"===t.y?l.height-parseInt(_*t.r):t.y)();for(let s=0;s<t.s.length;s++)" "!==t.s[s]&&k._setDrawImage({img:i,x:o+_*t.r*s,y:n,imgPosx:parseInt(e._txt[t.s[s]]),width:_,height:_,scale:t.r,basePoint:1,alpha:t.alpha})},_setTextToFont(t,e,s){if(void 0===t||null===t)return;let i=this;s=s||30;let _="";for(let t=0;t<e.length;t++){if(" "===e[t]){_+='<img src="./images/gradius_spacer.png" width="'+s+'">';continue}_+='<div style="background:url(./images/gradius_font.png) no-repeat;width:'+s+"px;height:"+s+"px;background-position:"+parseInt(i._txt[e[t]])*(s/60)*-1+'px 0px;background-size:cover;display:inline-block;"></div>'}t.innerHTML=_},_setDrawImage(t){if(void 0===t||void 0===t.img||0===t.scale)return;let e=t.width||t.img.width,s=t.height||t.img.height,i=t.t_width||e,o=t.t_height||s,n=t.deg||0,a=t.imgPosx||0,h=t.imgPosy||0,r=t.scale||1,l=t.x||0,c=t.y||0,m=t.basePoint||5,p=void 0===t.alpha?1:t.alpha;void 0===t.direct?w._D:t.direct;if(1===t.basePoint&&void 0===t.t_width&&void 0===t.t_height&&void 0===t.imgPosx&&void 0===t.alpha&&void 0===t.scale&&void 0===t.deg)return d.drawImage(t.img,l,c,e,s),void(_&&(d.strokeStyle="rgba(200,200,255,0.5)",d.beginPath(),d.rect(l,c,e,s),d.stroke()));const g=[{x:0,y:0},{x:0,y:0},{x:-e/2,y:0},{x:-e,y:0},{x:0,y:-s/2},{x:-e/2,y:-s/2},{x:-e,y:-s/2},{x:0,y:-s},{x:-e/2,y:-s},{x:-e,y:-s}];d.save(),d.translate(l,c),(t=>{void 0!==t&&(t===w._U&&d.setTransform(1,0,0,-1,l,c+s),t===w._LU&&d.setTransform(-1,0,0,-1,l+e,c+s),t===w._LD&&d.setTransform(-1,0,0,1,l+e,c))})(t.direct),void 0!==t.alpha&&(d.globalAlpha=p),void 0!==t.deg&&d.rotate(n*Math.PI/180),void 0!==t.scale&&d.scale(r,r),d.drawImage(t.img,a,h,i,o,g[m].x,g[m].y,e,s),_&&(d.strokeStyle="rgba(200,200,255,0.5)",d.beginPath(),d.rect(g[m].x,g[m].y,e,s),d.stroke()),d.restore()},_multilineText(t,e,s){let i=e.length,_=[],o="";if(i<1)return _;for(let n=0;n<i;n++){let i=e.charAt(n);"\n"!==i?t.measureText(o+i).width<=s?o+=i:(_.push(o),o=i):(_.push(o),o="")}return o.length>0&&_.push(o),_}},L={_obj:new Array,_init(){this._obj=new Array},_reset(){this._obj=new Array},_get_enemies(){return this._obj},_add_enemies(t){void 0!==t&&this._obj.push(t)},_move_enemies(){this._obj.map(t=>{t.move()})},_draw_enemies(){this._obj.map(t=>{t.setDrawImage()})}};class A{constructor(t){this.id=L._get_enemies().length,this.img=t.img,this.imgPos=t.imgPos||[0],this.aniItv=t.aniItv||10,this.width=t.width||this.img.width,this.height=t.height||this.img.height,this.x=t.x||0,this.y=t.y||0,this.mapx=p.getMapX(this.x),this.mapy=p.getMapY(this.y),this.direct=void 0===t.direct?w._D:t.direct,this._s=t.s||"0",this.audio_collision=i.enemy_collision1,this.audio_alive=i.enemy_collision3,this._DEF_SHOTSTATUS={_SHOTTYPE_NORMAL:1,_SHOTTYPE_MISSILE:2,_SHOTTYPE_DOUBLE:1,_SHOTTYPE_RIPPLE_LASER:1.5,_SHOTTYPE_LASER:1},this.alpha=1,this._c=0,this.speed=0,this.getscore=200,this._standby=!0,this._isshow=!0,this._status=1,this.haspc=!1,this._collision_type="t0",this.is_ignore=t.is_ignore||!1,this.is_able_collision=!0,this.is_ignore_collision=!1,this.is_collision_player_init=!1,this.shotColMap=["0,0,"+this.width+","+this.height],this.col_date=null,this.col_canint=150}init(){this._status=0,this._isshow=!1}collision(t,e){return!!this.isCollision()&&(!this.is_able_collision||(this.setStatus(t,e),!0))}isAbleCollision(){return this.is_able_collision}isIgnore(){return this.is_ignore}isIgnoreCollision(){return this.is_ignore_collision}isCollision(){let t=this;return null===t.col_date?(t.col_date=new Date,!0):new Date-t.col_date>t.col_canint&&(t.col_date=new Date,!0)}setAlive(){let t=this;t.isalive()?D._setPlay(t.audio_alive):(Mt._set_score(t.getscore),t.showCollapes(),D._setPlay(t.audio_collision))}setStatus(t){this._status-=this._DEF_SHOTSTATUS[t]||1,this.setAlive()}getEnemyCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}isalive(){return this._status>0}isshow(){return this._isshow}isshot(){return!k.isObjsLessDistance({e:this,p:Dt._players_obj})&&Math.random()<P()}shot(){k.isEnemyCanvasOut(this)||this.isshot()&&mt._add_shot(new pt({x:this.getEnemyCenterPosition()._x,y:this.getEnemyCenterPosition()._y}))}set_imgPos(){this._c=this._c>=this.imgPos.length*this.aniItv-1?0:this._c+1}get_imgPos(){return this.imgPos[parseInt(this._c/this.aniItv)]||0}setDrawImage(){this.isMove()&&k._setDrawImage({img:this.img,x:this.x,y:this.y,imgPosx:this.get_imgPos(),width:this.width,height:this.height,direct:this.direct,alpha:this.alpha,basePoint:1})}isStandBy(){return this._standby}isCanvasOut(){return k.isEnemyCanvasOut(this,{up:!1,down:!1,left:!0,right:!1})}showCollapes(t,e){let s=this;s._isshow=!1,s.haspc?Mt._add_powercapsell({x:p.getX(s.x),y:p.getY(s.y)}):Wt._add_collisions({x:t||s.x+s.width/2,y:e||s.y+s.height/2,ct:s._collision_type})}isMove(){let t=this;return t.isStandBy()?(t.move_standby(),!1):t.isCanvasOut()?(t._status=0,t._isshow=!1,!1):!!t.isshow()&&!!t.isalive()}moveDraw(){}moveSet(){}move_standby(){let t=this;t.speed=I(),t.x<l.width-20&&(t._standby=!1)}move(){this.x=p.getX(this.x),this.y=p.getY(this.y),this.speed=I(),this.isMove()&&(this.moveSet(),this.shot())}}class O extends A{constructor(t){super({img:e.enemy_fan.obj,x:t.x,y:t.y,imgPos:[0,25,50,75,100,125,150,175],aniItv:5,width:25,height:25});this._status=1,this.speed=2,this.pos_y=t.y>250,this.change_x=!1,this.change_y=!1}isCanvasOut(){return k.isEnemyCanvasOut(this,{up:!1,down:!1,left:!0,right:this.change_x})}moveSet(){let t=this;if(t.x=p.getX(t.x),t.y=p.getY(t.y),!t.isMove())return;const e=t.pos_y?275:200;t.change_x=t.change_x||t.x<500,t.x+=t.change_x?t.speed+p.getBackGroundSpeed():-1*t.speed,t.change_y=t.change_y||t.pos_y&&t.y<e||!t.pos_y&&t.y>e,t.y+=(()=>t.change_x?t.change_y?0:t.pos_y?-1*t.speed:t.speed:0)(),t.set_imgPos(),t.shot()}move(){}}class T extends A{constructor(t){super({img:t.img||e.enemy_a.obj,x:t.x,y:t.y,imgPosx:[0],width:25,direct:t.direct});this._status=1}setDrawImageDirect(){let t=this,e=t.getEnemyCenterPosition()._x,s=Dt._players_obj.getPlayerCenterPosition()._x;t.direct!==w._U&&t.direct!==w._LU||(t.direct=s<e?w._U:w._LU),t.direct!==w._D&&t.direct!==w._LD||(t.direct=s<e?w._D:w._LD)}moveSet(){this.setDrawImageDirect(),this.imgPos=(t=>t>150?[0]:t<=150&&t>100?[25]:[50])(Math.abs(Dt._players_obj.y-this.y))}}class Y extends A{constructor(t){super({img:t.img||e.enemy_d.obj,x:t.x,y:t.y,width:25,imgPos:[0,25,50,75,100,125]})}moveSet(){this.x+=-1*this.speed;let t=this.x,e=Math.cos(t*Math.PI/180);this.y+=e,this.set_imgPos()}}class R extends A{constructor(t){super({img:t.img||e.enemy_f.obj,x:t.x,y:t.y,width:30,imgPos:[0,30,60,90],direct:t.direct});this._v=0,this.speed=t.direct===w._U?-.05:.05}getDir(){return this.x>l.width/2?-1:1}isCanvasOut(){return k.isEnemyCanvasOut(this,{up:!0,down:!0,left:!1,right:!1})}isshot(){return Math.random()<100*P()}shot(){if(!(this._v>0&&this._v<.05))return;if(!this.isshot())return;let t=this.getEnemyCenterPosition();for(let e=30;e<=360;e+=30)mt._add_shot(new pt({x:t._x,y:t._y,deg:e}))}move_standby(){let t=this;t.x+t.width<0&&(t._standby=!1)}moveSet(){let t=this;t.speed=t.direct===w._U?-.05:.05,t.x+=2*t.getDir(),t.y+=t._v,t._v+=t.speed;let e=t.getEnemyCenterPosition(),s=p.getMapX(e._x),i=p.getMapY(e._y);p.isMapCollision(s,i)&&(t._v+=t.speed,t._v*=-1),t.set_imgPos()}}class X extends A{constructor(t){super({img:e.enemy_m_group.obj,x:t.x,y:t.y,imgPos:[0,25,50,75,100,125,150],aniItv:5,width:25,height:25,direct:t.direct});this.getscore=100,this._change=!1,this._moveX=0,this._moveY=0}isCanvasOut(){return k.isEnemyCanvasOut(this)}moveSet(){let t=this,e=Dt._players_obj.getPlayerCenterPosition();t._change=!!t._change||(t.direct===w._U&&e._y<t.y?(t._moveX=e._x<t.x?-1*t.speed:t.speed,!0):t.direct===w._D&&e._y>t.y&&(t._moveX=e._x<t.x?-1*t.speed:t.speed,!0)),t._moveY=t._change?0:t.direct===w._U?t.speed:t.direct===w._D?-1*t.speed:void 0,t.x+=t._moveX,t.y+=t._moveY,t.set_imgPos()}}class U extends A{constructor(t){super({img:e.enemy_o.obj,x:t.x,y:t.y,width:25,direct:t.direct,is_ignore:!0})}isCanvasOut(){return this.x<400}isalive(){return!0}isshot(){return Math.random()<j()}shot(){}setDrawImage(){}moveSet(){if(!this.isshot())return;let t=new q({x:this.x,y:this.y});L._add_enemies(t)}}class B extends A{constructor(t){super({img:e.enemy_o.obj,x:t.x,y:t.y,imgPos:Math.random()>.5?[0]:[25],width:25,height:25,direct:t.direct});this._status=1,this.getscore=100,this.speedX=4*Math.random()+1,this.flagX=Math.random()>.5?1:-1,this.speedY=parseInt(5*Math.random())/10,this._v=-1*parseInt(5*Math.random()+5),this._collision_type="t2"}map_collition(){let t=this,e=t.getEnemyCenterPosition(),s=p.getMapX(e._x),i=p.getMapY(e._y);p.isMapCollision(s,i)&&(t.showCollapes(),t.init())}shot(){}moveSet(){this.map_collition(),this.x+=this.speedX*this.flagX,this.y+=this._v,this._v+=this.speedY}}class q extends B{constructor(t){super({x:t.x,y:t.y,direct:t.direct});this.speedY=parseInt(5*Math.random())/10*-1,this._v=parseInt(5*Math.random()+5)}}class F extends A{constructor(t){super({img:t.img||e.enemy_p_1.obj,x:t.x,y:t.y});this._status=4,this.getscore=100,this.rad=Math.PI+Math.random(),this.speedx=p.getBackGroundSpeed(),this.speedy=0,this.speeds=1,this.speedv=this.speeds,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,this.audio_collision=i.enemy_collision4,this.shotColMap=["10,10,"+(this.width-20)+","+(this.height-20)],this._s="0000,0000,0000,0000"}setAlive(){this.isalive()||(Mt._set_score(this.getscore),this.showCollapes())}map_collition(){let t=this,e=t.getEnemyCenterPosition(),s=p.getMapX(e._x),i=p.getMapY(e._y);return p.isMapCollision(p.getMapX(t.x),i)?(t.x+=2,void t.setBoundFlatX()):p.isMapCollision(p.getMapX(t.x+t.width),i)?(t.x-=2,void t.setBoundFlatX()):p.isMapCollision(s,p.getMapY(t.y))?(t.y+=2,void t.setBoundFlatY()):p.isMapCollision(s,p.getMapY(t.y+t.height))?(t.y-=2,void t.setBoundFlatY()):void 0}setBoundFlatX(){let t=2*(1*this.speedx+0*this.speedy)*-1;this.speedx=t+this.speedx,this.speedy=0+this.speedy}setBoundFlatY(){let t=2*(0*this.speedx+1*this.speedy)*-1;this.speedx=0+this.speedx,this.speedy=t+this.speedy}setSpeedForCanvasBounds(){let t=this;if(!(t.x<0||t.x>l.width))return t.y<p.t&&t.speedy<0?(t.y+=2,void(t.speedy=.5)):t.y+t.height+p.t>l.height&&t.speedy>0?(t.y-=2,void(t.speedy=-.5)):void((t.y<p.t||t.y+t.height+p.t>l.height)&&t.setBoundFlatY());t.setBoundFlatX()}setSpeedForBounds(t,e){if(void 0===t||void 0===e)return;let s=t.getEnemyCenterPosition()._x,i=t.getEnemyCenterPosition()._y,_=e.getEnemyCenterPosition()._x,o=e.getEnemyCenterPosition()._y,n=Math.sqrt(Math.pow(_-s,2)+Math.pow(o-i,2)),a=Math.abs(s-_)/n,h=Math.abs(i-o)/n,r=s<_?-1*a:a,l=i<o?-1*h:h;r*=2,l*=2,t.speedx=r,t.speedy=l,r*=-1,l*=-1,e.speedx=e.speedx,e.speedy=e.speedy}move_bounds(){let t=this,e=L._get_enemies();if(t.isalive()){t.setSpeedForCanvasBounds();for(let s=0;s<e.length;s++){if(!F.prototype.isPrototypeOf(e[s]))continue;if(!e[s].isalive())continue;if(e[s].isStandBy())continue;if(e[s].x>l.width)continue;if(t.id===e[s].id)continue;k.isSqCollision(t.shotColMap[0],t.x+","+t.y,e[s].shotColMap,e[s].x+","+e[s].y)!==x&&(t.speedv=t.speeds,e[s].speedv=e[s].speeds,t.setSpeedForBounds(t,e[s]))}}}showCollapes(){this._isshow=!1;let t=this.getEnemyCenterPosition();[e.enemy_p_2.obj,e.enemy_p_3.obj,e.enemy_p_4.obj,e.enemy_p_5.obj,e.enemy_p_6.obj,e.enemy_p_3.obj].map(e=>{L._add_enemies(new N({img:e,x:t._x+(30*Math.random()*2-30),y:t._y+(30*Math.random()*2-30)}))}),D._setPlay(this.audio_collision)}shot(){}move_standby(){let t=this;t.x<l.width&&(t._standby=!1,t.speedx=Math.cos(t.rad)*t.speedv,t.speedy=Math.sin(t.rad)*t.speedv)}moveSet(){this.map_collition(),this.move_bounds(),this.speedv=this.speedv>=.8?this.speedv-.01:.8,this.x+=this.speedx*this.speedv,this.x+=-.3*this.speed,this.y+=this.speedy*this.speedv}}class N extends F{constructor(t){super({img:t.img,x:t.x,y:t.y,direct:t.direct});this.audio_collision=i.enemy_collision5,this._status=5,this.getscore=500,this.rad=Math.random()*Math.PI*2-Math.PI,this.speedx=Math.cos(this.rad),this.speedy=Math.sin(this.rad),this.col_date=new Date,this._collision_type="t1",this._DEF_SHOTSTATUS._SHOTTYPE_LASER=1,this.shotColMap=["3,3,"+(this.width-6)+","+(this.height-6)]}setAlive(){this.isalive()||(Mt._set_score(this.getscore),this.showCollapes(),D._setPlay(this.audio_collision))}showCollapes(t,e){this._isshow=!1,Wt._add_collisions({x:t||this.x+this.width/2,y:e||this.y+this.height/2,ct:this._collision_type})}}class H extends A{constructor(t){super({img:e.enemy_moai.obj,imgPos:t.imgPos||[0],x:t.x,y:t.y,width:100,height:100,direct:t.direct});let s=this;s._status=2,s.getscore=500,s._isSetMapDefCol=!1,s._isopen=!1,s._open_count=0,s.audio_collision=i.enemy_collision5,s.audio_alive=i.enemy_collision8,s._collision_type="t8",s._collision_posy=s.direct===w._D?25:0,s._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,s.shotColMap=[s.direct===w._D?"0,50,35,85":s.direct===w._U?"0,25,35,50":s.direct===w._LD?"75,55,100,70":s.direct===w._LU?"75,35,100,50":void 0],s._s=(()=>s.direct===w._D?"0000,0011,0110,1111":s.direct===w._U?"1111,0110,0011,0000":s.direct===w._LD?"0000,1100,1110,1111":s.direct===w._LU?"1111,1110,1100,0000":void 0)(),s.defimgPos=[0,100,400]}collision(t,e){this._isopen&&this.isCollision()&&this.setStatus(t,e)}isRingShot(){let t=this;return!(t._status<=0)&&(!k.isEnemyCanvasOut(t)&&(!(Math.abs(Dt._players_obj.y-t.y)>100)&&(t.direct!==w._LU&&t.direct!==w._LD||!(Dt._players_obj.x<t.x))))}isMove(){let t=this;return t.isStandBy()?(t.move_standby(),!1):t.isCanvasOut()?(t._status=0,t._isshow=!1,!1):!!t.isshow()&&(t.isalive(),!0)}shot(){let t=this;if(!t.isalive())return;if(!t._open_count>0&&!t.isRingShot()||t._open_count++,t._open_count>0&&(t.imgPos=[t.defimgPos[1]],t._isopen=!0),t._open_count>200&&(t.imgPos=[t.defimgPos[0]],t._isopen=!1,t._open_count=-100),t._open_count<=0)return;let e=b();t._open_count%e==0&&L._add_enemies(new G({x:t.x+parseInt(t.shotColMap[0].split(",")[0]),y:t.y+parseInt(t.shotColMap[0].split(",")[1]),direct:t.direct}))}showCollapes(){let t=this;t.imgPos=[t.defimgPos[2]],t._isSetMapDefCol||(p.set_mapdef_col(t.mapx,t.mapy,t.direct===w._D?"0000,0000,0000,1111":t.direct===w._U?"1111,0000,0000,0000":t.direct===w._LD?"0000,0000,0000,1111":t.direct===w._LU?"1111,0000,0000,0000":void 0),Wt._add_collisions({x:t.x+t.width/2,y:t.y+t.height/2+t._collision_posy,ct:t._collision_type}),t._isSetMapDefCol=!0)}}class z extends H{constructor(t){super({imgPos:[200],x:t.x,y:t.y,direct:t.direct});let e=this;e._status=2,e._collision_posy=e.direct===w._D?-10:0,e.shotColMap=[e.direct===w._D?"20,40,50,85":e.direct===w._U?"20,25,50,70":void 0],e._s=(()=>e.direct===w._D?"0000,0000,0010,1111":e.direct===w._U?"1111,0010,0000,0000":void 0)(),e.defimgPos=[200,300,400]}}class G extends A{constructor(t){super({img:t.img||e.enemy_moai_ring.obj,x:t.x,y:t.y,imgPos:t.imgPos||[0,25],aniItv:t.aniItv||5,width:t.width||25,height:t.height||25});this.audio_collision=i.enemy_collision2,this.rad=k.getRad(Dt._players_obj,{x:t.x,y:t.y}),this.sx=Math.cos(this.rad),this.sy=Math.sin(this.rad),this._collision_type="t2",this.direct,w._D}isCanvasOut(){return k.isEnemyCanvasOut(this,{up:!1,down:!1,left:!0,right:!0})}map_collition(){let t=this,e=t.getEnemyCenterPosition(),s=p.getMapX(e._x),i=p.getMapY(e._y);p.isMapCollision(s,i)&&(Wt._add_collisions({x:e._x,y:e._y,ct:t._collision_type}),t.init())}shot(){}moveSet(){this.map_collition(),this.speed-=.5,this.x+=parseInt(5*this.sx)/5*this.speed,this.y+=parseInt(5*this.sy)/5*this.speed,this.set_imgPos()}}class V extends A{constructor(t){super({img:t.img||e.enemy_frame_large.obj,x:t.x,y:t.y,width:t.width||53,imgPos:t.imgPos||[0,53],direct:t.direct});this.getscore=100,this.speed=-1*M(),this.rad=0,this.speedx=0,this.speedy=0,this._isbroken=!1,this._c=0,this.shotColMap=["5,5,"+(this.width-5)+","+(this.height-5)]}setAlive(){this.isalive()||(Mt._set_score(this.getscore),this.showCollapes())}map_collition(){let t=this,e=t.getEnemyCenterPosition(),s=p.getMapX(e._x),i=p.getMapY(e._y);p.isMapCollision(s,i)&&t.init()}is_nearby(){return k.isObjsLessDistance({e:this,p:Dt._players_obj,d:200})}showCollapes(){let t=this;if(t._status>0)return;if(t._isbroken)return;let e=t.getEnemyCenterPosition();if(t.is_nearby())return;let s=0,_=L._get_enemies();for(let t=0;t<_.length;t++)W.prototype.isPrototypeOf(_[t])&&s++;let o=s>20?1:2;for(let s=0;s<o;s++)L._add_enemies(new W({x:e._x,y:e._y,direct:t.direct,rad:t.rad}));t._isbroken=!0,D._setPlay(i.enemy_collision1),t.init()}shot(){}move_standby(){this.x>=l.width||(this.rad=Math.atan2(700*Math.random()-100-this.y,0-this.x),this.deg=this.rad/Math.PI*180,this._standby=!1)}moveSet(){this.speed=M()+1.5,this.speedx=Math.cos(this.rad),this.speedy=Math.sin(this.rad),this.map_collition(),this.set_imgPos(),this.x+=this.speedx*this.speed,this.y+=this.speedy*this.speed}}class W extends V{constructor(t){super({img:t.img||e.enemy_frame_small.obj,x:t.x,y:t.y,direct:t.direct,width:t.width||35,imgPos:t.imgPos||[0,35]});this.rad=(t.rad||0)+(Math.random()-.5),this.deg=this.rad/Math.PI*180,this._isbroken=!1,this.shotColMap=["10,10,"+(this.width-10)+","+(this.height-10)],this._standby=!1}shot(){}setDrawImage(){this.isMove()&&k._setDrawImage({img:this.img,x:this.x,y:this.y,deg:this.deg+180,width:this.width,imgPosx:this.get_imgPos(),basePoint:1})}showCollapes(){let t=this;if(t._status>0)return;if(t._isbroken)return;let e=t.getEnemyCenterPosition();if(t.is_nearby())return;let s=0,_=L._get_enemies();for(let t=0;t<_.length;t++)Z.prototype.isPrototypeOf(_[t])&&s++;let o=s>30?0:2;for(let s=0;s<o;s++)L._add_enemies(new Z({x:e._x,y:e._y,direct:t.direct,rad:t.rad}));t._isbroken=!0,D._setPlay(i.enemy_collision1),t.init()}}class Z extends W{constructor(t){super({img:e.enemy_frame_mini.obj,x:t.x,y:t.y,direct:t.direct,width:30,imgPos:[0,30]});this._isbroken=!1,this.rad=(t.rad||0)+(Math.random()-.5),this.deg=this.rad/Math.PI*180,this.shotColMap=["10,10,"+(this.width-10)+","+(this.height-10)],this.is_able_collision=!1,this.is_ignore_collision=Math.random()>.05,this._standby=!1}}class K extends A{constructor(t){super({img:t.img||e.enemy_cell_hand_1.obj,x:t.x,y:t.y});this._initx=t.x||0,this._inity=t.y||0,this.rad=t.rad,this.rad_min=t.rad_min||-1,this.rad_max=t.rad_max||-2,this.flag=t.flag||!1,this.is_able_collision=!1,this._collision_type="t2",this.is_ignore_collision=t.ignore_collision||!0,this.ani=[{scale:1},{scale:.95},{scale:.9},{scale:.85},{scale:.9},{scale:.95}],this._c=0}isCanvasOut(){return k.isEnemyCanvasOut(this,{up:!1,down:!1,left:!0,right:!1},{left:200})}showCollapes(){let t=this.getEnemyCenterPosition();Wt._add_collisions({x:t._x,y:t._y,ct:this._collision_type}),this.init()}shot(){}setDrawImage(){}moveDraw(){this._c=this._c>=20*this.ani.length-1?0:this._c+1;const t=this.getEnemyCenterPosition();k._setDrawImage({img:this.img,x:t._x,y:t._y,scale:this.ani[parseInt(this._c/20)].scale}),this.shot()}move(){this.x=p.getX(this.x),this.y=p.getY(this.y),this.isMove()}}class Q extends K{constructor(t){t.img=e.enemy_cell_hand_2.obj,super(t);this.is_able_collision=!0,this.audio_alive=i.enemy_collision7,this._status=10,this.is_ignore_collision=!1,this.shotColMap=["-10,-10,"+(this.img.width+10)+","+(this.img.height+10)]}setAlive(){let t=this;t.isalive()||(Mt._set_score(t.getscore),t.showCollapes(),D._setPlay(t.audio_collision))}shot(){}}class J extends K{constructor(t){t.img=e.enemy_cell_hand_3.obj,super(t)}shot(){if(k.isEnemyCanvasOut(this))return;if(!this.isshot())return;let t=this.getEnemyCenterPosition();mt._add_shot(new pt({x:t._x,y:t._y,img:e.enemy_bullet_cell.obj,imgPos:[0,15],width:15}))}moveDraw(){let t=Dt._players_obj.getPlayerCenterPosition(),e=this.getEnemyCenterPosition(),s=Math.atan2(e._y-t._y,e._x-t._x);k._setDrawImage({img:this.img,x:e._x,y:e._y,deg:s/Math.PI*180})}}class $ extends A{constructor(t){super({img:t.img,x:t.x,y:t.y,width:t.width||t.img.width,height:t.height||t.img.height,imgPos:t.imgPos,aniItv:t.aniItv});this.speed=0,this.getscore=1e4,this._c_self_collision=4e3,this.audio_collision=i.enemy_collision6,this.audio_background=i.bg_boss,this.is_able_collision=!1,this._collision_type="t9",this._count=0,this.is_all_set=!1}shot(){}setSelfCollision(){if(this._count<this._c_self_collision)return;let t=L._get_enemies();for(let e=0;e<t.length;e++)t[e]._status=0;this.showCollapes(),D._setPlay(this.audio_collision)}move_Allset(){}isAllset(){return!!this.is_all_set||(this.move_Allset(),!1)}isMove(){let t=this;return t.isStandBy()?(t.move_standby(),!1):!!t.isshow()&&!!t.isalive()}move(){this.x=p.getX(this.x),this.y=p.getY(this.y),this.setSelfCollision(),this.isMove()&&this.isAllset()&&(this.moveSet(),this.shot(),this._count++)}}class tt extends A{constructor(t){super({img:t.img,x:t.x,y:t.y,width:t.width,height:t.height});this._initx=t.x||0,this._inity=t.y||0,this._boss=t.boss,this.x=this._boss.x+this._initx,this.y=this._boss.y+this._inity,this._status=8,this._standby=!1,this.getscore=500,this.is_able_collision=!1,this.audio_collision=i.enemy_collision5,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5}set_able_collision(){this.is_able_collision=!0}move(){let t=void 0===this._boss?0:this._boss.x,e=void 0===this._boss?0:this._boss.y;this.x=t+parseInt(this._initx),this.y=e+parseInt(this._inity)}}class et extends A{constructor(t){super({img:e.enemy_bigcore2_hand.obj,x:t._initx,y:t._inity,imgPos:[0,250,500],aniItv:6});let s=this;s._initx=t._initx||0,s._inity=t._inity||0,s._boss=t._boss,s.x=s._initx+t._boss.x,s.y=s._inity+t._boss.y,s._standby=!1,s.is_able_collision=!1,s.width=250,s.isshot=void 0!==t._img,s.isHandsOpen=!1,s.isHandsClose=!1,s.isstop=!1,s.direct=t._dir||w._U,s.shotColMap=[s.direct===w._U?"90,30,250,70,false":s.direct===w._D?"90,40,250,100,false":void 0],s.shotColMapTmp=s.direct===w._U?[["25,70,250,110,false","90,30,250,70,false"],["180,30,250,90,false"],["50,10,225,20,false"]]:s.direct===w._D?[["25,0,250,40,false","90,40,250,100,false"],["180,20,250,60,false"],["50,90,225,100,false"]]:void 0,s.imgsPos=[{x:0,y:(s.direct,w._U,0)},{x:0,y:s.direct===w._U?-40:40},{x:-5,y:s.direct===w._U?-30:30}],s.imgs_x=0,s.imgs_y=0}init(){this._isshow=!1,this._status=0}shot(){}showCollapes(){}setStatus(){this._status=0}is_hand_stop(){return this.isstop}set_hand_stop(){this.isstop=!0}move_hands_open(){let t=this;if(!t.isHandsOpen)return;if(t.isstop)return;let e=t.imgsPos[parseInt(t._c/t.aniItv)];t.imgs_x=parseInt(e.x),t.imgs_y=parseInt(e.y),t.shotColMap=[];let s=t.shotColMapTmp[parseInt(t._c/t.aniItv)];for(let e=0;e<s.length;e++)t.shotColMap.push(s[e]);if(t._c>=6*t.imgPos.length-1)return t._c=6*t.imgPos.length-1,void(t.isHandsOpen=!1);t._c++}set_imgPos(){}move_hands_close(){let t=this;if(!t.isHandsClose)return;if(t.isstop)return;let e=t.imgsPos[parseInt(t._c/t.aniItv)];t.imgs_x=parseInt(e.x),t.imgs_y=parseInt(e.y),t.shotColMap=[];let s=t.shotColMapTmp[parseInt(t._c/t.aniItv)];for(let e=0;e<s.length;e++)t.shotColMap.push(s[e]);if(t._c<=0)return t._c=0,void(t.isHandsClose=!1);t._c--}move(){this.move_hands_open(),this.move_hands_close(),this.x=this._boss.x+parseInt(this._initx)+this.imgs_x,this.y=this._boss.y+parseInt(this._inity)+this.imgs_y}}class st extends A{constructor(t){super({img:t._img||e.enemy_cristalcore_hand1.obj,x:t._initx,y:t._inity});this._initx=t._initx||0,this._inity=t._inity||0,this._boss=t._boss,this._c_move_round=t._cmr||0,this._c_move_self_round=t._cmsr||0,this._initRad=t._initRad||0,this._data=t._data||"0,0,0,0",this._count_turn=0,this._change=t._change,this._standby=!1,this.is_able_collision=!1,this.is_ignore_collision=t._ignore_collision||!1,this.isshot=void 0!==t._img,this._shot_count=0,this._collision_type="t1",this._c=0;let s=this._data.split(","),i=parseInt(s[2])+(this._change?1:-1),_=this._initRad*Math.cos(i*(Math.PI/180)),o=this._initRad*Math.sin(i*(Math.PI/180)),n=parseInt(s[3])+(this._change?1:-1);this._data=_+","+o+","+i+","+n}collision(t,e){}setStatus(){this._status=0}shot(){if(!1===this.isshot)return;if(this._shot_count++,this._shot_count<20)return;this._shot_count=0;let t=this._data.split(",");mt._add_shot(new yt({x:this.x,y:this.y+(this._change?-10:10),deg:parseInt(t[3])}))}move_hands(){let t=this;if(t._count_turn>=4)return void(t._c>400&&(t._c=0,t._count_turn=0));t._c>200&&(t._c=0,t._count_turn++,t._change=!t._change);let e=t._data.split(","),s=t._c_move_round,i=t._c_move_self_round;if(t._c>i)return;if(t._c<=i&&t._c>s){let s=parseInt(e[3])+(t._change?1:-1);return void(t._data=e[0]+","+e[1]+","+e[2]+","+s)}let _=parseInt(e[2])+(t._change?1:-1),o=t._initRad*Math.cos(_*(Math.PI/180)),n=t._initRad*Math.sin(_*(Math.PI/180)),a=parseInt(e[3])+(t._change?1:-1);t._data=o+","+n+","+_+","+a}setDrawImage(){let t=this._data.split(",");this.x=this._boss.x+parseInt(t[0])+this._initx,this.y=this._boss.y+parseInt(t[1])+this._inity,k._setDrawImage({img:this.img,x:this.x,y:this.y,deg:parseInt(t[3]),width:this.width,height:this.height})}moveDraw(t){t.is_all_set&&(this.shot(),this.move_hands(),this._c++)}move(){}}class it extends A{constructor(t){super({img:e.enemy_cube.obj,x:t.x,y:t.y,imgPos:[0,70,140,210],aniItv:10,width:70,height:70});this._standby=!1,this._status=1,this.speed=5,this.change_speed_c=parseInt(150*Math.random())+10,this._stop=!1,this.is_able_collision=!1,this.audio_collision=i.enemy_cube,this._col_c=0,this._count=0,this.tx=0,this.ty=0,this.rad=0,this.deg=0,this.sx=0,this.sy=0,this.shotColMap=["15,15,"+parseInt(this.width-30)+","+parseInt(this.height-30)]}isCanvasOut(){return k.isEnemyCanvasOut(this,{up:!0,down:!0,left:!0,right:!0})}shot(){}isMove(){let t=this;return 0===t.alpha?(t.init(),!1):t.isStandBy()?(t.move_standby(),!1):t.isCanvasOut()?(t._status=0,t._isshow=!1,!1):!!t.isshow()}move_bounds(){let t=this,e=L._get_enemies();for(let s=0;s<e.length;s++){if(!it.prototype.isPrototypeOf(e[s]))continue;if(t.id===e[s].id)continue;if(!e[s]._stop)continue;if(k.isSqCollision("20,20,50,50",t.x+","+t.y,["20,20,50,50"],e[s].x+","+e[s].y)!==x)return!0}return!1}moveSet(){let t=this;if(!0!==t._stop){if(t.x<0||t.y<0||t.y+t.height>l.height||t.move_bounds()){t.getEnemyCenterPosition();return p.set_mapdef_col(p.getMapX(t.x+20),p.getMapY(t.y+20),"11,11"),t._status=0,t._stop=!0,void D._setPlay(t.audio_collision)}if(t._count<t.change_speed_c&&(t.x-=t.speed),t._count===t.change_speed_c){let e=Dt._players_obj;t.tx=e.x+e.width,t.ty=e.getPlayerCenterPosition()._y,t.rad=Math.atan2(t.ty-t.getEnemyCenterPosition()._y,t.tx-t.getEnemyCenterPosition()._x),t.sx=Math.cos(t.rad),t.sy=Math.sin(t.rad),t.speed=5*M()}t._count>t.change_speed_c&&(t.x+=t.sx*t.speed,t.y+=t.sy*t.speed),t._count++,t.set_imgPos()}}move(){let t=this;0!==t.alpha?t.isMove()&&t.moveSet():t.init()}}class _t extends A{constructor(t){super({img:e.enemy_frame_head1.obj,x:t.x,y:t.y,direct:t.d});this.img=this.direct===w._L?e.enemy_frame_head3.obj:e.enemy_frame_head1.obj,this._standby=!1,this._status=70,this.getscore=5e3,this._deg=0,this.shotColMap=["30,30,"+(this.img.width-60)+","+(this.img.height-60)],this._collision_type="t9",this.audio_collision=i.enemy_collision6,this.num_col=6}showCollapes(){let t=this,e=t.getEnemyCenterPosition();t._isshow=!1;for(let s=0;s<(t.num_col||1);s++)Wt._add_collisions({x:e._x+Math.random()*(Math.random()>.5?100:-100),y:e._y+Math.random()*(Math.random()>.5?100:-100),ct:t._collision_type});D._setPlay(t.audio_collision)}setDirect(t){this.direct=t}shot(){let t=this;t.img=t._c%200<150&&t._c%200>0?t.direct===w._L?e.enemy_frame_head3.obj:e.enemy_frame_head1.obj:t.direct===w._L?e.enemy_frame_head4.obj:e.enemy_frame_head2.obj,t._c%200==150&&mt._add_shot(new ut({x:t.x,y:t.y,deg:t._deg+90,img:e.enemy_frame_small.obj,imgPos:[0,35],width:35}))}setDrawImage(){this.isshow()&&this.isalive()&&k._setDrawImage({img:this.img,x:this.x+this.img.width/4,y:this.y+this.img.height/4,deg:this._deg})}moveDraw(t){let e=this;e.isshow()&&(e.isalive()?(e.shot(),e.x=t.x,e.y=t.y,e._deg=t.deg):e.showCollapes())}move(){this._c=this._c>200?0:this._c+1}}class ot extends A{constructor(t){super({img:e.enemy_frame_body1.obj,x:t.x,y:t.y});this._standby=!1,this.is_able_collision=!1,this.shotColMap=["5,5,"+(this.img.width-10)+","+(this.img.height-10)],this._deg=0,this.speed=Math.random>.4?-10:10,this.is_frame_heads_collision=!1,this.ani=[{scale:1},{scale:.95},{scale:.9},{scale:.85},{scale:.9},{scale:.95}],this._deg_col=0}showCollapes(){let t=this;if(k.isEnemyCanvasOut(t))return t._status=0,void(t._isshow=!1);t.x+=Math.cos(t._deg*Math.PI/180)*t.speed,t.y+=Math.sin(t._deg*Math.PI/180)*t.speed,t._deg_col+=10,k._setDrawImage({img:t.img,x:t.getEnemyCenterPosition()._x,y:t.getEnemyCenterPosition()._y,deg:t._deg_col})}setDrawImage(){this.isshow()&&(this.is_frame_heads_collision||k._setDrawImage({img:this.img,x:this.getEnemyCenterPosition()._x,y:this.getEnemyCenterPosition()._y,deg:this._deg,scale:this.ani[parseInt(this._c/20)].scale}))}moveDraw(t){let e=this;if(e.isshow()){if(e.is_frame_heads_collision)return e._standby=!0,void e.showCollapes();e.x=t.x,e.y=t.y,e._deg=t.deg,e._deg_col=t.deg}}move(){this._c=this._c>=20*this.ani.length-1?0:this._c+1}}class nt extends A{constructor(t){super({img:e.enemy_cell_boss.obj,x:t.x,y:t.y});this._status=1,this.alpha=1,this.speed=2,this._standby=!1,this.ani=t.dark?[480,640,800]:[0,160,320],this.ani_c=0,this.ani_c_intv=20,this.width=160,this.height=this.img.height,this.shotColMap=["50,0,"+this.width+","+this.height],this.is_able_collision=!1,this.is_ignore_collision=!1,this._collision_type="t9"}showCollapes(){let t=this.getEnemyCenterPosition();Wt._add_collisions({x:this.x+this.width/2,y:t._y,ct:this._collision_type}),this.init()}moveSet(t){this.x=t.x,this.y=t.y,this.ani_c=this.ani_c>=this.ani.length*this.ani_c_intv-1?0:this.ani_c+1}setDrawImage(){}moveDraw(){k._setDrawImage({img:this.img,x:this.x,y:this.y,imgPosx:this.ani[parseInt(this.ani_c/this.ani_c_intv)],width:this.width,basePoint:1,alpha:this.alpha})}move(){}}class at extends A{constructor(t){super({img:e.enemy_cell_boss_eye.obj,x:t.x,y:t.y});this._status=100,this._standby=!1,this.audio_alive=i.enemy_collision7,this.is_able_collision=!1,this.ani=[0,48,96,144],this.ani_c=0,this.ani_c_intv=20,this.setAliveHit=!1,this.width=48,this.height=this.img.height,this.shotColMap=["0,0,"+this.width+","+this.height],this._collision_type="t1"}showCollapes(){this.init()}shot(){let t=this,s=k.getDeg(Dt._players_obj,t);for(let i=-30;i<=30;i+=30)mt._add_shot(new pt({x:t.x+20,y:this.getEnemyCenterPosition()._y,img:e.enemy_bullet_cell.obj,imgPos:[0,15],width:15,aniItv:10,deg:s+i}))}move_eye_open(){let t=this;t.ani_c>=t.ani.length*t.ani_c_intv-1||(t.ani_c%10==0&&t.shot(),t.ani_c++)}move_eye_close(){let t=this;t.ani_c<0||(t.ani_c%10==0&&t.shot(),t.ani_c--)}setAlive(){k._setDrawImage({img:this.img,x:this.x+20,y:this.y,imgPosx:this.ani[parseInt(this.ani_c/this.ani_c_intv)],width:this.width,basePoint:1}),D._setPlay(this.audio_alive)}setDrawImage(){}moveDraw(t){let e=this;e.isMove()?(e.x=t.x,e.y=t.y,e.is_able_collision=e.ani_c>0,e.ani_c<=0||k._setDrawImage({img:e.img,x:e.x,y:e.y,imgPosx:e.ani[parseInt(e.ani_c/e.ani_c_intv)],width:e.width,basePoint:1})):e.init()}move(){}}class ht extends A{constructor(t){super({img:e.enemy_death_shot2.obj,x:t.x,y:t.y,width:140,height:70});this.bossx=t.x,this.is_collision_player_init=!0,this.is_able_collision=!1,this.is_ignore_collision=!1,this._standby=!1}isCanvasOut(){return k.isEnemyCanvasOut(this,{up:!1,down:!1,left:!1,right:!1})}setDrawImage(){k._setDrawImage({img:this.img,t_width:40,x:this.x,y:this.y,width:40,height:this.height,basePoint:1}),k._setDrawImage({img:this.img,imgPosx:40,t_width:10,x:this.x+40,y:this.y,width:this.bossx-this.x-25,height:this.height,basePoint:1}),k._setDrawImage({img:this.img,imgPosx:70,x:this.bossx,y:this.y,width:70,height:this.height,basePoint:1})}move(){let t=this;t.bossx<=0?t.init():(t.x=t.x<=-1e3?-1e3:t.x-30,t.bossx=t.x>=0?t.bossx:t.bossx-30,t.width=t.bossx-t.x+25,t.shotColMap=["0,0,"+t.width+","+t.height+",false"])}}class rt extends ${constructor(t){super({img:e.enemy_moai_boss.obj,x:t.x,y:t.y,width:135,height:150});this._status=15,this.speedx=2,this.speedy=2,this._standby=!1,this.is_all_set=!1,this.moai_mini=[],this.ani=[0,135,270,405,540,675,810],this.imgPosx=this.ani[6],this._isopen=!1,this._direct=w._L,this.shotColMapDir={3:["0,90,20,120","20,0,135,150,false"],2:["115,90,135,120","0,0,115,150,false"]},this.shotColMap=this.shotColMapDir[this._direct],this.audio_alive=i.enemy_collision8,this._collision_type="t9",this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5}collision(t,e){this._isopen&&this.isCollision()&&this.setStatus(t,e)}showCollapes(){let t=this.getEnemyCenterPosition();this._isshow=!1,Wt._add_collisions({x:t._x,y:t._y,ct:this._collision_type});let e=L._get_enemies();for(let t=0;t<e.length;t++){let s=e[t];rt.prototype.isPrototypeOf(s)||(s.init(),s.showCollapes())}}set_direct(t){let e=this;0!==e._count&&(e._count%200>=170&&e._count%200<180?e.imgPosx=e._direct===w._L?e.ani[4]:e.ani[2]:e._count%200>=180&&e._count%200<190?e.imgPosx=e.ani[3]:e._count%200>=190&&e._count%200<200?e.imgPosx=e._direct===w._L?e.ani[2]:e.ani[4]:(e._count%200==0&&(e._direct=e._direct===w._L?w._R:w._L),e.imgPosx=e._direct===w._L?e.ani[5]:e.ani[0]))}shot(){let t=this;if(t._count%200>=170&&t._count%200<200)return;let e=0,s=L._get_enemies();for(let t=0;t<s.length;t++){let i=s[t];if(lt.prototype.isPrototypeOf(i)&&++e>5*I())return}if(t._count%50>=30&&t._count%50<50?(t.imgPosx=t._direct===w._L?t.ani[5]:t.ani[0],t._isopen=!0):(t.imgPosx=t._direct===w._L?t.ani[6]:t.ani[1],t._isopen=!1),t._count%30==20){let e=t.getEnemyCenterPosition(),s=new lt({x:e._x,y:e._y});t.moai_mini.push(s),L._add_enemies(s)}}isAllset(){return!!this.is_all_set||(this.move_Allset(),!1)}move_Allset(){let t=this;t.x-=4,t.x<l.width-300&&(t.is_all_set=!0)}move_standby(){}setDrawImage(){k._setDrawImage({img:this.img,x:this.x,y:this.y,imgPosx:this.imgPosx,width:this.width,basePoint:1})}moveSet(){this.shotColMap=this.shotColMapDir[this._direct],this.x+=this.speedx,this.speedx=this.x<200||this.x+this.width>900?-1*this.speedx:this.speedx,this.y+=this.speedy,this.speedy=this.y<50||this.y+this.height>450?-1*this.speedy:this.speedy;let t=this.getEnemyCenterPosition();this.set_direct();let e=L._get_enemies();for(let s=0;s<e.length;s++){let i=e[s];rt.prototype.isPrototypeOf(i)||i.setPos({x:t._x,y:t._y})}}}class lt extends A{constructor(t){super({img:e.enemy_moai_mini_boss.obj,x:t.x,y:t.y,width:27,height:30});this._status=3,this._radian=0,this._radius=0,this._standby=!1,this.audio_alive=i.enemy_collision3,this._collision_type="t2",this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,this._count=0}shot(){0===this._count&&L._add_enemies(new dt({x:this.x,y:this.y}))}setPos(t){this._radian+=.075,this._radius=this._radius<150?this._radius+5:this._radius,this.x=this._radius*Math.cos(this._radian)+t.x,this.y=this._radius*Math.sin(this._radian)+t.y}setDrawImage(){k._setDrawImage({img:this.img,x:this.x,y:this.y,basePoint:5})}moveSet(){this._count=this._count>3*b()?0:this._count+1}}class dt extends G{constructor(t){super({img:e.enemy_moai_boss_ring.obj,x:t.x,y:t.y,imgPos:[0,10],aniItv:5,width:10,height:10});this.audio_collision=i.enemy_collision2,this._collision_type="t2",this._DEF_SHOTSTATUS._SHOTTYPE_LASER=1,this.getscore=100}setPos(){}moveSet(){this.map_collition(),this.speed=3*M(),this.x+=this.sx*this.speed,this.y+=this.sy*this.speed,this.set_imgPos()}}class ct extends A{constructor(t){super({img:e.enemy_boss_aian.obj,x:t.x,y:t.y,width:75,height:65,imgPos:[0,75],aniItv:5});this.is_all_set=!0,this._status=3,this._collision_type="t3",this.getscore=500,this._move_status=0,this._rad=0}shot(){}move_standby(){}isCanvasOut(){return k.isEnemyCanvasOut(this,{up:!0,down:!0,left:!0,right:!1})}moveSet(){let t=this;if(t.x=p.getX(t.x),t.y=p.getY(t.y),t.isMove()){if(t.speed=2*I(),0===t._move_status){if(t.x<200)return void(t._move_status=1);t.x-=t.speed,t.y+=4*Math.sin(t._rad),t._rad+=.1}if(1===t._move_status){if(t.y>350)return void(t._move_status=2);t.y+=t.speed}if(2===t._move_status){if(t.x>750)return void(t._move_status=3);t.x+=t.speed}if(3===t._move_status){let e=Dt._players_obj.getPlayerCenterPosition();if(t.y>e._y-100&&t.y<e._y+0)return void(t._move_status=4);t.y-=t.speed}4===t._move_status&&(t.x-=t.speed),t.set_imgPos()}}move(){}}const mt={_obj:new Array,_init(){this._obj=new Array},_reset(){this._obj=new Array},_get_shot(){return this._obj},_add_shot(t){void 0!==t&&this._obj.push(t)},_move_shot(){this._obj.map(t=>{t.move()})},_draw_shot(){this._obj.map(t=>{t.setDrawImage()})}};class pt{constructor(t){let s=this;s.x=t.x||500,s.y=t.y||300,s.tx=Dt._players_obj.getPlayerCenterPosition()._x,s.ty=Dt._players_obj.getPlayerCenterPosition()._y,s.img=t.img||e.enemy_bullet.obj,s.imgPos=t.imgPos||[0,18],s._c=0,s.aniItv=t.aniItv||5,s.basePoint=t.basePoint||1,s.width=t.width||18,s.height=t.height||s.img.height,s.speed=t.speed||M(),s.rad=void 0===t.deg?k.getRad({x:s.tx,y:s.ty},{x:s.x,y:s.y}):t.deg*Math.PI/180,s.deg=t.deg||k.getDeg({x:s.tx,y:s.ty},{x:s.x,y:s.y}),s.sx=Math.cos(s.rad),s.sy=Math.sin(s.rad),s.viewDeg=t.viewDeg||!1,s._isshow=!0,s.is_ignore_collision=!1,s.shotColMap=["1,1,"+(s.width-1)+","+(s.height-1)]}init(){this._isshow=!1}map_collition(){let t=this,e=p.getMapX(t.x),s=p.getMapY(t.y);p.isMapCollision(e,s)&&t.init()}getEnemyCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}isshow(){return this._isshow}set_imgPos(){this._c=this._c>=this.imgPos.length*this.aniItv-1?0:this._c+1}get_imgPos(){return this.imgPos[parseInt(this._c/this.aniItv)]}setDrawImage(){k._setDrawImage({img:this.img,x:this.x,y:this.y,deg:this.viewDeg?this.deg:0,width:this.width,basePoint:this.basePoint,imgPosx:this.get_imgPos()})}move(){let t=this;t.map_collition(),t.y=p.getY(t.y),k.isEnemyCanvasOut(t)?t.init():(t.x+=parseInt(5*t.sx)/5*t.speed,t.y+=parseInt(5*t.sy)/5*t.speed,t.set_imgPos())}}class gt extends pt{constructor(t){super({x:t.x,y:t.y,img:t.img||e.enemy_bullet_laser.obj,width:t.width||30}),this.speed=4*M()}move(){let t=this;k.isEnemyCanvasOut(t)?t.init():(t.map_collition(),t.x-=t.speed)}}class yt extends pt{constructor(t){super({x:t.x,y:t.y,deg:t.deg,viewDeg:!0,img:e.enemy_cristalcore_shot.obj});this.speed=10}move(){let t=this;k.isEnemyCanvasOut(t)?t.init():(t.map_collition(),t.x-=t.sx*t.speed,t.y-=t.sy*t.speed)}}class ut extends pt{constructor(t){super({x:t.x,y:t.y,deg:t.deg,viewDeg:!0,width:t.width,imgPos:t.imgPos,basePoint:t.basePoint||5,img:t.img});this.ani_c=0,this.shotColMap=["-10,-10,10,10"],this.speed=M()-1}shot(){let t=this;if(100===t.ani_c){let s=t.getEnemyCenterPosition();for(let t=30;t<=360;t+=30)mt._add_shot(new xt({x:s._x,y:s._y,deg:t,width:30,imgPos:[0,30],img:e.enemy_frame_mini.obj}));t.init()}}move(){let t=this;k.isEnemyCanvasOut(t)?t.init():(t.shot(),t.set_imgPos(),t.map_collition(),t.x-=t.sx*t.speed,t.y-=t.sy*t.speed,t.ani_c++)}}class xt extends ut{constructor(t){super({x:t.x,y:t.y,deg:t.deg,viewDeg:!0,img:t.img,imgPos:t.imgPos,basePoint:5,width:t.width});this.speed=2*M(),this.shotColMap=["-7,-7,7,7"]}shot(){}}class wt extends pt{constructor(t){super({x:t.x,y:t.y,width:25,height:10,deg:t.deg,viewDeg:!0});this.img=e.enemy_death_shot.obj,this.speed=1}move(){let t=this;if(k.isEnemyCanvasOut(t))return void t.init();t.map_collition(),t.speed+=.17;let e=Dt._players_obj.getPlayerCenterPosition();e._y<t.y&&t.deg++,e._y>t.y&&t.deg--,t.rad=t.deg*Math.PI/180,t.sx=Math.cos(t.rad),t.sy=Math.sin(t.rad),t.x-=parseInt(t.sx*t.speed),t.y-=parseInt(t.sy*t.speed),t._c++}}const vt={_obj:new Object,_init(){this._obj=new Object},_reset(){this._obj=new Object},_init_maps(t,e){void 0!==t&&void 0!==e&&(this._obj[t]=e)},_move_maps(){let t=this;for(let e of Object.keys(t._obj))t._obj[e].isshow()||t._obj[e].isalive()?t._obj[e].move():delete t._obj[e]},_draw_maps(){let t=this;Object.keys(t._obj).forEach(e=>t._obj[e].setDrawImage())}};class ft{constructor(t){void 0!==t&&(this.img=t.img,this.imgPos=t.imgPos||[0],this.aniItv=t.aniItv||1,this.width=t.width||this.img.width,this.height=t.height||this.img.height,this.dir=t.dir||1,this.x=t.x||0,this.y=t.y||0,this._s=t.s||"1",this._c=0,this._status=1,this._isshow=!0,this.is_able_collision=!1,this.is_ignore=!1,this._standby=!0,this.shotColMap=["0,0,"+this.width+","+this.height],this._DEF_SHOTSTATUS={_SHOTTYPE_NORMAL:1,_SHOTTYPE_MISSILE:2,_SHOTTYPE_DOUBLE:1,_SHOTTYPE_RIPPLE_LASER:1.5,_SHOTTYPE_LASER:1},this._c=0)}getImg(){return this.img.obj}set_imgPos(){this._c=this._c>=this.imgPos.length*this.aniItv-1?0:this._c+1}get_imgPos(){return this.imgPos[parseInt(this._c/this.aniItv)]}collision(){}showCollapes(){}shot(){}isIgnore(){return this.is_ignore}isStandBy(){return this._standby}isshow(){return this._isshow}isalive(){return this._status>0}isCanvasOut(){return this.width+this.x<0}isMove(){let t=this;return t.isStandBy()?(t.move_standby(),!1):t.isCanvasOut()?(t._status=0,t._isshow=!1,!1):!!t.isshow()&&(!!t.isalive()||(t.showCollapes(),!1))}moveSet(){}move_standby(){this.x>l.width||(this._standby=!1)}setDrawImage(){this.isMove()&&k._setDrawImage({img:this.img,imgPosx:this.get_imgPos(),x:this.x,y:this.y,width:this.width,height:this.height,basePoint:1})}moveDraw(){}move(){this.x=p.getX(this.x),this.y=p.getY(this.y),this.speed=I(),this.isMove()&&(this.set_imgPos(),this.moveSet(),this.moveDraw(),this.shot())}}class bt extends ft{constructor(t){super({img:t.img,imgPos:[0,300,600],aniItv:20,width:300,height:50,x:t.x,y:t.y});this._s=t._s}}class Pt extends ft{constructor(t){super({img:e.map_cell_wall.obj,imgPos:t.imgPos||[0],width:25,height:25,x:t.x,y:t.y});this._s="1",this.is_able_collision=!0,this._status=1,this._status_count=0,this.audio_collision=i.map_cell_wall,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.2}collision(t){this._status-=this._DEF_SHOTSTATUS[t]||1}setDrawImage(){this.x>l.width||this.isalive()&&k._setDrawImage({img:this.img,imgPosx:this.get_imgPos(),x:this.x,y:this.y,width:this.width,height:this.height,basePoint:1})}isMove(){let t=this;return t.isStandBy()?(t.move_standby(),!1):t.isCanvasOut()?(t._status=0,t._isshow=!1,!1):!!t.isshow()}moveDraw(){let t=this;t._status_count>=200&&(t._status_count=0,t._status=1,p.set_mapdef_col(p.getMapX(t.x)+1,p.getMapY(t.y),"1")),t._status<=0&&(t._status=0,0===t._status_count&&(D._setPlay(t.audio_collision),p.set_mapdef_col(p.getMapX(t.x)+1,p.getMapY(t.y),"0")),t._status_count++)}}const Mt={_pm:new Object,_stageselect:new Object,_score:new Object,_background:new Object,_background_star:new Object,_background_defimg:{volcano:t=>new class extends St{constructor(t){super({_initx:t._initx,_infinite:t._infinite}),this._alpha=1,this.img=e.background_volcano}}(t),moai:t=>new class extends St{constructor(t){super({_initx:t._initx,_infinite:t._infinite}),this._alpha=1,this.img=e.background_moai}}(t),cell:t=>new class extends St{constructor(t){super({_initx:t._initx,_infinite:t._infinite}),this._alpha=1,this.img=e.background_cell}}(t),frame:t=>new class extends St{constructor(t){super({_initx:t._initx,_infinite:t._infinite}),this._alpha=1,this.img=e.background_frame}}(t)},_powercapsell_ar:new Array,_reset(){this._pm=new Object,this._stageselect=new Object,this._background=new Object,this._background_star=new Object,this._powercapsell_ar=new Array},_init_score(){this._score=new class{constructor(){this.score1p=0,this.score2p=0,this.def_scorehi=57300,this.scorehi=this.def_scorehi}reset(){this.score1p=0,this.score2p=0}set(t){this.score1p+=t,this.scorehi>=this.score1p||(this.scorehi=this.score1p)}setDrawImage(){s.font.obj;let t="1p"+("        "+this.score1p).slice(-8);k._setDrawToText({s:t,x:180,y:10,r:.3}),t="hi"+("        "+this.scorehi).slice(-8),k._setDrawToText({s:t,x:400,y:10,r:.3}),t="2p"+("        "+this.score2p).slice(-8),k._setDrawToText({s:t,x:620,y:10,r:.3})}}},_draw_score(){this._score.setDrawImage()},_set_score(t){this._score.set(t)},_reset_score(){this._score.reset()},_init_background(){this._background_star=new class extends jt{constructor(){super({x:0,y:0}),this._background_ar=new Array;for(let t=0;t<70;t++)this._background_ar.push(new Et)}setDrawImage(){this._background_ar.forEach(t=>{t.setDrawImage()})}move(){this._background_ar.forEach(t=>{t.move()})}}({initx:p.map_background_initx}),"none"!==p.map_background_img&&(this._background=this._background_defimg[p.map_background_img]({_initx:p.map_background_initx,_infinite:p.map_infinite}))},_move_background(){this._background_star.move(),"none"!==p.map_background_img&&this._background.move()},_draw_background(){this._background_star.setDrawImage(),"none"!==p.map_background_img&&this._background.setDrawImage()},_add_powercapsell(t){if(void 0===t)return;this._powercapsell_ar.push(new class{constructor(t,s){this.x=t||0,this.y=s||0,this.getscore=200,this.gotpc=!1,this.type=Math.random()>.1?"red":"blue",this._c=0,this.ani=[0,25,50,75],this.img=e.gradius_pc.obj,this.width=25,this.height=23}getPCCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}getPowerCapcell(){this.gotpc=!0}setDrawImage(){k._setDrawImage({img:this.img,x:this.x,y:this.y,imgPosx:this.ani[parseInt(this._c/5)]+("blue"===this.type?100:0),width:this.width,height:this.height,basePoint:1})}move(){this.gotpc||(this.x=p.getX(this.x),this.y=p.getY(this.y),this._c=this._c>=5*this.ani.length-1?0:this._c+1)}}(t.x,t.y))},_move_powercapsell(){let t=this;for(let e=t._powercapsell_ar.length-1;e>=0;e--){let s=t._powercapsell_ar[e];(s.x+s.width<0||s.gotpc)&&t._powercapsell_ar.splice(e,1),s.move()}},_draw_powercapsell(){this._powercapsell_ar.map(t=>{t.setDrawImage()})},_set_powercapsell(){let t=this;for(let e=0;e<t._powercapsell_ar.length;e++){let s=t._powercapsell_ar[e];if(s.gotpc)continue;let _=Dt._players_obj.getPlayerCenterPosition(),o=s.getPCCenterPosition();Math.sqrt(Math.pow(o._x-_._x,2)+Math.pow(o._y-_._y,2))<Math.sqrt(Math.pow(Dt._players_obj.width,2)+Math.pow(Dt._players_obj.height,2))/2&&(s.getPowerCapcell(),"red"!==s.type?"blue"===s.type&&(L._get_enemies().forEach(t=>{k.isEnemyCanvasOut(t)||t.isStandBy()||t.isAbleCollision()&&(t._status-=1,t.isalive()||(Mt._set_score(t.getscore),t.showCollapes()))}),mt._get_shot().forEach(t=>{k.isEnemyCanvasOut(t)||t.init()}),D._setPlay(i.enemy_all_out)):(c.move(),D._setPlay(i.pc),Mt._set_score(s.getscore)))}}};class It{constructor(){let t=this;t.img=e.meter.obj,t.x=l.width/2-t.img.width/2,t.y=l.height-30,t.meterdef_status="111111",t.meterdef_current="000000",t.meterdef={n_32:{func:()=>{Dt._players_obj.accel>=10?t._set_meter_status():Dt._players_obj.accel+=2}},n_16:{func:()=>{Dt._shot_missle_isalive=!0,t._set_meter_status()}},n_8:{func:()=>{Dt._shot_type=Dt._shot_type_def.DOUBLE,t._set_meter_status()}},n_4:{func:()=>{Dt._shot_type=Dt._shot_type_def.LASER,t._set_meter_status()}},n_2:{func:()=>{Dt._option_obj[Dt._option_count].settruealive(),Dt._option_count++,Dt._option_count<Dt._option_max||t._set_meter_status()}},n_1:{func:()=>{Dt._players_force_obj.init(),t._set_meter_status()}}},t._c_pms=0,t.pms_img=s.gradius_powermeterselect.obj,t.pms_img_selected=s.gradius_powermeterselect_selected.obj,t.pms_selected=[19,91,163,235],t._c_pmss=0,t.pms_img_shield_selected=s.gradius_powermeterselect_shield_selected.obj,t.pmss_selected=[0,100]}_set_hide(){Dt._shot_type=Dt._shot_type_def.NORMAL,Dt._shot_missle_isalive=!0;for(let t=0;t<Dt._option_max;t++)Dt._option_obj[t].settruealive();Dt._option_count=4,Dt._players_force_obj.init(),g=[],this._set_current_reset(),this.meterdef_status="101100"}_set_current_reset(){this.meterdef_current="000000"}_set_meter_status(){let t=this.meterdef_status,e=(~parseInt(this.meterdef_current,2)>>>0).toString(2).slice(-6);this.meterdef_status=this._get_bit((parseInt(t,2)&parseInt(e,2)).toString(2));let s=parseInt(this.meterdef_current,2);8!==s&&4!==s||(this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(8===s?"000100":"001000",2)).toString(2)))}_set_meter_on(t){this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(t,2)).toString(2))}_get_bit(t){return("000000"+t).slice(-6)}_get_meter_current(t){return 0===parseInt(t,2)||1===parseInt(t,2)?"100000":("000000"+(parseInt(t,2)>>1).toString(2)).slice(-6)}move(){this.meterdef_current=this._get_meter_current(this.meterdef_current)}playerset(){if(ke())return;let t=parseInt(this.meterdef_current,2),e=parseInt(this.meterdef_status,2);0!==t&&0!=(t&e)&&(Dt._players_obj.set_equipped(),D._setPlay(i.playerset),this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(this.meterdef_current,2)).toString(2)),this.meterdef["n_"+t].func(),this._set_current_reset())}show(){let t=this;k._setDrawImage({img:t.img,x:t.x+36,y:t.y,t_width:t.img.width-71,width:t.img.width-71,height:t.img.height,basePoint:1});for(let e=0;e<this.meterdef_status.length;e++)"0"===this.meterdef_status[e]&&k._setDrawImage({img:t.img,x:t.x+36+72*e,y:t.y,imgPosx:t.img.width-72,width:72,height:t.img.height,basePoint:1});let s=parseInt(this.meterdef_current,2);if(0===s)return;let i=parseInt(this.meterdef_status,2),_=e.meter_c.obj,o=0!=(s&i)?72*t.meterdef_current.indexOf("1"):_.width-72;k._setDrawImage({img:_,x:t.x+36+72*t.meterdef_current.indexOf("1"),y:t.y,imgPosx:o,width:72,height:_.height,basePoint:1})}pms_disp(){d.clearRect(0,0,l.width,l.height),k._setDrawToText({s:"power meter select",x:"center",y:20,r:.6}),k._setDrawToText({s:"shield select",x:200,y:400,r:.3}),k._setDrawImage({img:this.pms_img,x:l.width/2-this.pms_img.width/2,y:70,width:this.pms_img.width,height:this.pms_img.height,basePoint:1}),k._setDrawImage({img:e.meter.obj,imgPosx:360,imgPosy:0,x:290,y:430,width:72,height:19,basePoint:1});let t=s.gradius_powermeterselect_shield.obj;k._setDrawImage({img:t,x:470,y:390,width:t.width,height:t.height,basePoint:1})}set_pms_status(t){if(void 0===t)return;let e=this._c_pms+t.num;e=(e=e<=0?0:e)>=this.pms_selected.length-1?this.pms_selected.length-1:e,this._c_pms=e}set_pmss_status(t){if(void 0===t)return;let e=this._c_pmss+t.num;e=(e=e<=0?0:e)>=this.pmss_selected.length-1?this.pmss_selected.length-1:e,this._c_pmss=e}pms_select(){this.pms_disp(),k._setDrawImage({img:this.pms_img_selected,imgPosx:0,imgPosy:this.pms_selected[this._c_pms],x:l.width/2-this.pms_img.width/2,y:this.pms_selected[this._c_pms]+70,width:420,height:74,basePoint:1}),k._setDrawImage({img:this.pms_img_shield_selected,imgPosx:this.pmss_selected[this._c_pmss],imgPosy:0,x:this.pmss_selected[this._c_pmss]+470,y:390,width:85,height:75,basePoint:1})}}class Ct{constructor(){this.mapdef_status=0,this.mapdef=_?Kt[k._url_params.mp||this.mapdef_status]:Kt[this.mapdef_status]}init(){this.disp_thumb_map()}set_map_status(t){if(void 0===t)return;let e=this.mapdef_status+t.num;e=(e=e<=0?0:e)>=Kt.length-1?Kt.length-1:e,this.mapdef=Kt[e],this.mapdef_status=e}disp_thumb_map(){d.clearRect(0,0,l.width,l.height),k._setDrawToText({s:"stage select",x:"center",y:20,r:.6});let t=500-(Kt.length/2*20+10);for(let e=0;e<Kt.length;e++)d.beginPath(),d.lineWidth=1,d.strokeStyle="rgba(255,255,255,1)",d.fillStyle="rgba(255,255,255,1)",e===this.mapdef_status?d.fillRect(t+20*e,85,10,10):d.strokeRect(t+20*e,85,10,10);p.mapdef=this.mapdef._map,p.map_theme=this.mapdef._theme,p.mapdef_col=[],p.set_gamestart_mapdef_col(),p.showMapForStageselect(this.mapdef),k._setDrawToText({s:"stage title",x:400,y:130,r:.3}),d.moveTo(400,160),d.lineTo(950,160),d.stroke(),d.font="20px sans-serif";let e=k._multilineText(d,this.mapdef._title,550);for(let t=0;t<(e.length>2?2:e.length);t++)d.fillText(e[t],400,190+26*t);k._setDrawToText({s:"difficult:"+this.mapdef._difficult,x:400,y:230,r:.3}),d.moveTo(400,260),d.lineTo(950,260),d.stroke(),k._setDrawToText({s:"detail",x:400,y:300,r:.3}),d.moveTo(400,330),d.lineTo(950,330),d.stroke(),e=k._multilineText(d,this.mapdef._body,520);for(let t=0;t<(e.length>4?4:e.length);t++)d.fillText(e[t],400,360+30*t)}}class jt{constructor(t){this.x=t.x||0,this.y=t.y||0,this._c=0}setDrawImage(){}move(){}}class Et extends jt{constructor(){super({x:l.width*Math.random(),y:l.height*Math.random()}),this.rgb=parseInt(255*Math.random())+","+parseInt(255*Math.random())+","+parseInt(255*Math.random()),this.speed=5*Math.random(),this._c=parseInt(200*Math.random()),this._ar_alpha=[0,.2,.4,.6,.8,1,.8,.6,.4,.2],this._r=Math.random()+1}setDrawImage(){d.beginPath(),d.arc(this.x,this.y,this._r,0,2*Math.PI,!0),d.fillStyle="rgba("+this.rgb+","+this._ar_alpha[parseInt(this._c/20)]+")",d.fill()}move(){this._c=this._c>=199?0:this._c+1,0!==p.getBackGroundSpeed()&&(this.x=this.x<0?l.width:this.x-this.speed)}}class St extends jt{constructor(t){super({x:0,y:0}),this._initx=t._initx||0,this._alpha=1,this._slowx=t._slowx||1.3,this._slowy=t._slowy||2,this.img=e["background_"+t._img],this._ar=(()=>t._infinite?[{x:this._initx,y:0},{x:this._initx+l.width,y:0},{x:this._initx,y:l.height},{x:this._initx+l.width,y:l.height}]:[{x:this._initx,y:0},{x:this._initx+l.width,y:0}])()}setDrawImage(){this._ar.forEach(t=>{d.save(),d.globalAlpha=this._alpha,d.fillStyle=d.createPattern(this.img.obj,"repeat"),d.translate(t.x,t.y),d.fillRect(0,0,l.width,l.height),d.restore()})}move(){0!==p.getBackGroundSpeed()&&this._ar.forEach((t,e)=>{t.x=p.getBackGroundX(t.x,this._slowx),t.y=p.getBackGroundY(t.y,this._slowy)})}}const Dt={_players_obj:"",_players_force_obj:"",_players_max:5,_players_main_isalive:!0,_is_finished_player_collision:!1,_option_obj:new Array,_option_count:0,_option_max:4,_option_ani_count:0,_option_ani_def:[{scale:.8},{scale:.7},{scale:.6},{scale:.5},{scale:.6},{scale:.7}],_shots:{shot:{_SHOTTYPE_NORMAL:new Array,_SHOTTYPE_DOUBLE:new Array,_SHOTTYPE_LASER:new Array},missile:new Array},_shot_type_def:{MISSILE:"_SHOTTYPE_MISSILE",NORMAL:"_SHOTTYPE_NORMAL",DOUBLE:"_SHOTTYPE_DOUBLE",LASER:"_SHOTTYPE_LASER",RIPPLE_LASER:"_SHOTTYPE_RIPPLE_LASER"},_shot_type:"",_shot_max:2,_shot_missle_isalive:!1,_move_drawX:new Array,_move_drawY:new Array,_move_drawY_moves:new Array,_move_draw_max:100,_reset(){this._players_obj="",this._players_force_obj="",this._is_finished_player_collision=!1,this._option_obj=new Array,this._option_count=0,this._shots={shot:{_SHOTTYPE_NORMAL:new Array,_SHOTTYPE_DOUBLE:new Array,_SHOTTYPE_LASER:new Array},missile:new Array},this._shot_type=this._shot_type_def.NORMAL,this._shot_missle_isalive=!1,this._move_drawX=new Array,this._move_drawY=new Array},_draw_players(){let t=this;t._players_force_obj.setDrawImage(),t._players_obj.isalive()&&t._players_obj.setDrawImage()},_set_move_players(t){this._players_obj.isalive()&&this._players_obj.set_move(t)},_set_stop_players(){this._players_obj.isalive()&&this._players_obj.set_stop()},_move_players(){let t=this;t._players_obj.isalive()&&t._players_force_obj.move(),t._players_obj.move()},_draw_option(){let t=this;t._set_option_count();for(let e=0;e<t._option_max;e++)t._players_obj.isalive()&&t._option_obj[e].move(10*(e+1)),t._option_obj[e].setDrawImage()},_get_option_scale(){return this._option_ani_def[this._get_option_count()].scale},_set_shot_type(t){this._shot_type=t},_is_shottype_laser(){let t=this._shots.shot._SHOTTYPE_LASER[0];return void 0!==t&&(this._shot_type===this._shot_type_def.LASER&&!(!Gt.prototype.isPrototypeOf(t)&&!Vt.prototype.isPrototypeOf(t)))},_move_shots(){let t=this;if(t._players_obj.isalive())for(let e=0;e<t._players_max;e++)t._shot_missle_isalive&&t._shots.missile[e].move(),t._shots.shot[t._shot_type][e].move()},_draw_shots(){let t=this;for(let e=0;e<t._players_max;e++)t._shot_missle_isalive&&t._shots.missile[e].setDrawImage(),t._shots.shot[t._shot_type][e].setDrawImage()},_start_shots(){let t=this;t._shots.shot[t._shot_type].forEach((e,s)=>{if(e.player._isalive)if(t._shot_type!==t._shot_type_def.DOUBLE){e._sq=e._sq===e.shots.length-1?0:e._sq+1;var i=e.shots[e._sq];i._shot_alive||(i._shot=!0,0===s&&D._setPlay(i._audio))}else{if(e.shots[0]._shot_alive||e.shots[1]._shot_alive)return;if(e.shots[0]._shot=!0,e.shots[1]._shot=!0,0!==s)return;D._setPlay(e.shots[0]._audio)}})},_stop_shots(){this._shots.shot[this._shot_type].forEach(t=>{t.shots.forEach(t=>{t._shot=!1})})},_start_missile_shots(){this._shot_missle_isalive&&this._shots.missile.forEach((t,e)=>{if(t.player._isalive)if(3!==o){t._sq=t._sq===t.shots.length-1?0:t._sq+1;var s=t.shots[t._sq];s._shot_alive||(s._shot=!0,0===e&&D._setPlay(s._audio))}else{if(t.shots[0]._shot_alive||t.shots[1]._shot_alive)return;if(t.shots[0]._shot=!0,t.shots[1]._shot=!0,0!==e)return;D._setPlay(t.shots[0]._audio)}})},_stop_missile_shots(){this._shots.missile.forEach(t=>{t.shots.forEach(t=>{t._shot=!1})})},_draw_player_collision(){let t=this,e=t._players_obj;1===e._col_ani_c&&D._setPlay(i.vicviper_bomb),e._col_ani_c>=10*e.col_ani.length-1?t._is_finished_player_collision=!0:e._draw_collapes()},_enemy_collision(t){let e=this;e._init_laser_col_max();for(let s=t.length-1;s>=0;s--){let i=t[s];i.isshow()||i.isalive()||t.splice(s,1),i.isIgnore()||(i.isStandBy()||i.isalive()&&(e._players_obj.enemy_collision(i),e._players_force_obj.enemy_collision(i),e._shots.shot[e._shot_type].forEach(t=>{if(t.player._isalive)if(e._is_shottype_laser()){let e=t.enemy_collision(i);t.set_laser_col_max(e)}else t.enemy_collision(i)}),e._shot_missle_isalive&&e._shots.missile.forEach(t=>{t.player.isalive()&&t.shots.forEach(e=>{t.enemy_collision(i,e)})})))}e._set_shot_laser_MaxX(),e._set_shot_collision_control()},_enemy_shot_collision(t){let e=this;if(void 0!==t)for(let s=t.length-1;s>=0;s--){let i=t[s];i.isshow()?(e._players_obj.enemy_shot_collision(i),e._players_force_obj.enemy_shot_collision(i)):t.splice(s,1)}},_init_laser_col_max(){this._is_shottype_laser()&&this._shots.shot[this._shot_type].forEach(t=>{if(!t.player._isalive)return;t.shots[0]._laser_col_max=null})},_set_shot_laser_MaxX(){this._is_shottype_laser()&&this._shots.shot[this._shot_type].forEach(t=>{if(!t.player._isalive)return;let e=t.shots[0];if(0!==e._laser_col_max&&null!==e._laser_col_max)if(e.x>=e._laser_col_max+4*t.speed){if(e._is_col_map)return;t.setLaserMaxX(e,l.width)}else t.setLaserMaxX(e,e._is_col_map&&t.getLaserMaxX(e)<e._laser_col_max+10?t.getLaserMaxX(e):e._laser_col_max+10);else{if(e._is_col_map)return;t.setLaserMaxX(e,l.width)}})},_set_shot_collision_control(){this._is_shottype_laser()||this._shots.shot[this._shot_type].forEach(t=>{t.player._isalive&&t.shots.forEach(t=>{t.isCollision&&t._init()})})},_get_move_drawX(t){return this._move_drawX[t]},_get_move_drawY(t){return this._move_drawY[t]},_set_move_draw(){let t=this;if(!t._players_obj._ismove)return;let e=t._players_obj.width,s=t._players_obj.height,i=t._players_obj.x+parseInt(e/4),_=t._players_obj.y+parseInt(s/4),o=t._move_drawY;if(t._move_drawX.length===t._move_draw_max&&t._move_drawX.pop(),t._move_drawY.length===t._move_draw_max&&t._move_drawY.pop(),t._move_drawX.unshift(i),p.map_infinite)if(t._move_drawY_moves.unshift(-1*t._players_obj._y),0!==-1*p.getBackGroundSpeedY())for(let e=1;e<t._move_draw_max;e++)o[e]=o[e-1]+t._move_drawY_moves[e];else o.unshift(_);else o.unshift(_)},_init_players_obj(t){this._players_obj=0===t||2===t?new Lt:new class extends Lt{constructor(){super("vicviper1",100,200,!0),this.col_img_pos=[100]}};const e=this._shot_type_def;var s;this._shots.shot[e.NORMAL].push(new qt(this._players_obj)),this._shots.shot[e.DOUBLE].push((s=this._players_obj,0===t||2===t?new Ft(s):new Nt(s))),this._shots.shot[e.LASER].push(function(e){return 0===t?new Gt(e):1===t?new Vt(e):2===t?new Ht(e):3===t?new zt(e):void 0}(this._players_obj)),this._shots.missile.push(function(e){return 0===t?new Rt(e):1===t?new Ut(e):2===t?new Xt(e):3===t?new Bt(e):void 0}(this._players_obj))},_init_players_force_obj(t){this._players_force_obj=0===t||2===t?1===n?new Ot:new Tt:1===n?new class extends Ot{constructor(){super(),this.ani=[210,315]}}:new class extends Tt{constructor(){super(),this.ani=[80,120]}}},_init_option_obj(t){let e=this;const s=e._shot_type_def;for(let _=0;_<e._option_max;_++)e._option_obj.push(new At("option",110,70*(_+1),!1)),e._shots.shot[s.NORMAL].push(new qt(e._option_obj[_])),e._shots.shot[s.DOUBLE].push((i=e._option_obj[_],0===t||2===t?new Ft(i):new Nt(i))),e._shots.shot[s.LASER].push(function(e){return 0===t?new Gt(e):1===t?new Vt(e):2===t?new Ht(e):3===t?new zt(e):void 0}(e._option_obj[_])),e._shots.missile.push(function(e){return 0===t?new Rt(e):1===t?new Ut(e):2===t?new Xt(e):3===t?new Bt(e):void 0}(e._option_obj[_]));var i},_get_option_count(){return parseInt(this._option_ani_count/3)},_set_option_count(){this._players_obj.isalive()&&(this._option_ani_count=this._option_ani_count>=3*this._option_ani_def.length-1?0:this._option_ani_count+1)}};class kt{constructor(t,s,i,_){this.img=e[t].obj,this.x=s||100,this.y=i||100,this._x=0,this._y=0,this._isalive=_||!1,this._scalechange=!0,this.width=0,this.height=0,this._c=0,this.accel=3}isalive(){return this._isalive}enemy_collision(){}getPlayerCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}setfalsealive(){this._isalive=!1}settruealive(){this._isalive=!0}}class Lt extends kt{constructor(){super("vicviper",100,200,!0);this._isequipped=!1,this._isequipped_count=0,this.img=e.vicviper.obj,this.imgsize=this.img.height,this.width=this.imgsize,this.height=this.imgsize,this.img_vb=e.vicviper_back.obj,this.imgsize_vb=this.img_vb.height,this.width_vb=this.imgsize_vb,this.height_vb=this.imgsize_vb,this.c_vv_ani=20,this.vv_ani=[120,60,0,180,240],this.vv_e_ani=[420,360,300,480,540],this._img_vv="",this.c_vb_ani=0,this.vb_ani=[0,14,28],this.vb_e_ani=[42,42,42],this._img_vb="",this._col_ani_c=0,this.col_img=e.vicviper_bomb.obj,this.col_img_pos=[0],this.col_img_width=100,this.col_ani=[{scale:.5},{scale:.7},{scale:.5},{scale:.4},{scale:.3}],this.map_col_date=null,this.map_col_canint=0,this._ismove=!1}_draw_collapes(){const t=this.getPlayerCenterPosition();k._setDrawImage({img:this.col_img,x:t._x,y:t._y,width:this.col_img_width,imgPosx:this.col_img_pos,scale:this.col_ani[parseInt(this._col_ani_c/10)].scale}),this._col_ani_c=this._col_ani_c>=10*this.col_ani.length-1?0:this._col_ani_c+1}enemy_collision(t){1===n&&Dt._players_force_obj.isalive()||k.isSqCollision("25,28,45,35",this.x+","+this.y,t.shotColMap,t.x+","+t.y)!==x&&(t.collision(),this.setfalsealive())}enemy_shot_collision(t){1===n&&Dt._players_force_obj.isalive()||k.isSqCollision("25,28,45,35",this.x+","+this.y,t.shotColMap,t.x+","+t.y)!==x&&(t.init(),this.setfalsealive())}set_equipped(){this._isequipped_count=20}map_collition(){let t=this;1===n&&Dt._players_force_obj.isalive()||(()=>!!p.isMapCollision(p.getMapX(t.x+t.width/2),p.getMapY(t.y+t.height/2))&&(t.map_col_date=null,!0))()&&t.setfalsealive()}set_vv_ani(t){"ArrowUp"!==t&&"Up"!==t||(this.c_vv_ani-=2),"ArrowDown"!==t&&"Down"!==t||(this.c_vv_ani+=2)}set_moveamount(){let t=this;t._ismove?(t.x=function(e){let s=t.x+t._x;return s<=50?(t._x=0,50):s>=l.width-100?(t._x=0,l.width-100):s}(),t.y=function(e){let s=t.y+t._y;t.getPlayerCenterPosition();if(p.map_infinite){let e=100;return s<e?(p.setBackGroundSpeedY(t._y),e):s>l.height-t.height-e?(p.setBackGroundSpeedY(t._y),l.height-t.height-e):(p.setBackGroundSpeedY(0),s)}let i=1*t.height/2;return s<i?i:s>l.height-t.height-i?l.height-t.height-i:s}()):p.setBackGroundSpeedY(0)}set_move(t){if(void 0===t)return;let e=this;e._x=t.x*e.accel||0,e._y=t.y*e.accel||0,e._y>0&&e.set_vv_ani("Down"),e._y<0&&e.set_vv_ani("Up"),e._ismove=!0}set_stop(){this._x=0,this._y=0,this._ismove=!1}setDrawImage(){let t=this;k._setDrawImage({img:t.img,x:t.x,y:t.y,imgPosx:t._img_vv,width:t.imgsize,height:t.imgsize,basePoint:1}),k._setDrawImage({img:t.img_vb,x:t.x,y:t.y+22,imgPosx:t._img_vb,width:t.imgsize_vb,height:t.imgsize_vb,basePoint:1}),_&&(d.save(),d.fillStyle="rgba(0,0,255,0.5)",d.fillRect(t.x+25,t.y+28,20,7),d.restore())}move(){let t=this;t.isalive()&&(t.map_collition(),t.set_moveamount(),t._ismove?t.c_vv_ani>46?t.c_vv_ani=46:t.c_vv_ani<4&&(t.c_vv_ani=4):t.c_vv_ani>25?t.c_vv_ani-=1:t.c_vv_ani<25?t.c_vv_ani+=1:t.c_vv_ani=25,t._img_vv=(()=>{let e=parseInt(t.c_vv_ani/10);return t._isequipped_count<=0?t.vv_ani[e]:(t._isequipped_count--,t._isequipped_count>0&&t._isequipped_count%2==0?t.vv_e_ani[e]:t.vv_ani[e])})(),t._img_vb=(()=>{let e=parseInt(t.c_vb_ani/3);return t._isequipped_count>0&&t._isequipped_count%2==0?t.vb_e_ani[e]:t.vb_ani[e]})(),t.c_vb_ani=k._ac._get(t.c_vb_ani,t.vb_ani,3))}}class At extends kt{constructor(t,e,s,i){super(t,e,s,i),this.imgsize=this.img.height,this.width=this.imgsize,this.height=this.imgsize}setDrawImage(){if(!this._isalive)return;if(null===this.x||null===this.y||void 0===this.x||void 0===this.y)return;let t=this.getPlayerCenterPosition();k._setDrawImage({img:this.img,x:t._x,y:t._y,scale:Dt._get_option_scale()})}move(t){this.x=Dt._get_move_drawX(t),this.y=Dt._get_move_drawY(t)-2}}class Ot{constructor(){this.img=e.forcefield.obj,this.x=0,this.y=0,this.width=0,this.height=0,this._c=0,this._scale=0,this.reduce_scale_rate=.09,this.reduce_scale_min=.55,this.ani=[0,105],this.col_date=null,this.col_canint=25}init(){this._scale=1,this.width=this.img.width/4,this.height=this.img.height}reset(){this._scale=0,c._set_meter_on("000001")}isalive(){return 0!==this._scale}enemy_collision(t){this.isalive()&&k.isSqCollision(parseInt(this._scale*this.width/8)+","+parseInt(this._scale*this.height/8)+","+parseInt(this._scale*this.width*6/8)+","+parseInt(this._scale*this.height*6/8),this.x+","+this.y,t.shotColMap,t.x+","+t.y)!==x&&(t.collision(),this.reduce())}enemy_shot_collision(t){let e=this;e.isalive()&&k.isSqCollision(parseInt(e._scale*e.width/8)+","+parseInt(e._scale*e.height/8)+","+parseInt(e._scale*e.width*6/8)+","+parseInt(e._scale*e.height*6/8),e.x+","+e.y,t.shotColMap,t.x+","+t.y)!==x&&(t.is_ignore_collision?e.reset():(t.init(),e.reduce()))}getPlayerCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}map_collition(){let t=this.getPlayerCenterPosition(),e=p.getMapX(t._x),s=p.getMapY(t._y);p.isMapCollision(e,s)&&this.reduce()}isCollision(){let t=this;return null===t.col_date?(t.col_date=new Date,!0):new Date-t.col_date>t.col_canint&&(t.col_date=new Date,!0)}reduce(){let t=this;t.isalive()&&t.isCollision()&&(t._scale-=t.reduce_scale_rate,t._scale<=t.reduce_scale_min&&t.reset(),D._setPlay(i.vicviper_shield_reduce))}setDrawImage(){let t=Dt._players_obj,e=t.getPlayerCenterPosition()._x,s=t.getPlayerCenterPosition()._y;k._setDrawImage({img:this.img,x:e-6,y:s-2,imgPosx:this.ani[parseInt(this._c/5)],width:this.width,height:this.height,scale:this._scale})}move(){let t=Dt._players_obj;this.isalive()&&(this.map_collition(),this.x=t.x,this.y=t.y,this._c=this._c>=5*this.ani.length-1?0:this._c+1)}}class Tt extends Ot{constructor(){super();this.ani=[0,40],this.reduce_scale_rate=.04,this.reduce_scale_min=.35}getPlayerCenterPosition(){return{_x:this.x+this.width/2*this._scale,_y:this.y+this.height*this._scale}}init(){this._scale=1,this.img=e.shield.obj,this.width=this.img.width/4,this.height=this.img.height}isalive(){return 0!==this._scale}enemy_collision(t){this.isalive()&&k.isSqCollision("0,"+parseInt(this._scale*this.height*-1)+","+parseInt(this._scale*this.width)+","+parseInt(this._scale*this.height*2),this.x+","+this.y,t.shotColMap,t.x+","+t.y)!==x&&(t.collision(),this.reduce())}enemy_shot_collision(t){let e=this;e.isalive()&&k.isSqCollision("0,"+parseInt(e._scale*e.height*-1)+","+parseInt(e._scale*e.width)+","+parseInt(e._scale*e.height*2),e.x+","+e.y,t.shotColMap,t.x+","+t.y)!==x&&(t.is_ignore_collision?e.reset():(t.init(),e.reduce()))}map_collition(t){let e=this,s=p.getMapX(e.x),i=p.getMapY(e.y);p.isMapCollision(s,i)?e.reduce():(i=p.getMapY(e.y-e.height*e._scale+15),p.isMapCollision(s,i)?e.reduce():(i=p.getMapY(e.y+e.height*e._scale-15),p.isMapCollision(s,i)&&e.reduce()))}setDrawImage(){k._setDrawImage({img:this.img,x:this.x,y:this.y,imgPosx:this.ani[parseInt(this._c/5)],width:this.width,height:this.height,scale:this._scale,basePoint:7}),k._setDrawImage({img:this.img,x:this.x,y:this.y,imgPosx:this.ani[parseInt(this._c/5)],width:this.width,height:this.height,scale:this._scale,basePoint:1})}move(){if(!this.isalive())return;let t=Dt._players_obj,e=t.getPlayerCenterPosition();this.map_collition(t),this.x=t.x+t.width,this.y=e._y,this._c=this._c>=5*this.ani.length-1?0:this._c+1}}class Yt{constructor(t){this.shots=new Array,this.player=t,this._sq=0}enemy_collision(t){}map_collition(t){}getshottype(){}setDrawImage(){}move(){}}class Rt extends Yt{constructor(t){super(t),this.shots=new Array,this.col_mis=[{fs:"rgba(255,246,72,1)",scale:8},{fs:"rgba(255,131,62,1)",scale:10},{fs:"rgba(255,131,72,1)",scale:12},{fs:"rgba(255,131,62,1)",scale:14},{fs:"rgba(133,0,4,1)",scale:14},{fs:"rgba(100,0,4,1)",scale:16}],this.st={_st1:0,_st2:24,_st3:48,_st4:72,_st5:96,_st6:0,_st7:96,_st8:72,_st9:0},this.imgsize=e.gradius_missile.obj.height;for(let t=0;t<Dt._shot_max;t++)this.shots.push({sid:Dt._shot_type_def.MISSILE,id:t,x:0,y:0,_t:0,_st:"_st1",_img:e.gradius_missile.obj,_audio:i.missile,_c_mc:0,_c:0,_c_area:25,_enemyid:null,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._t=0,this._c=0,this._c_mc=0,this._c_area=25,this._st="_st1",this._enemyid=null,this._shot=!1,this._shot_alive=!1}});let s=this;this.mis_status={_st1:function(t){let e=s.player.getPlayerCenterPosition();var i;t.x=(i=t.x,t._shot_alive?i+4:e._x),t.y=function(s){return t._shot_alive?s+8:e._y}(t.y)},_st2:function(t){t.x+=0,t.y+=8},_st3:function(t){t.x+=8,t.y+=0},_st4:function(t){t.x+=2,t.y+=3},_st5:function(t){t.x+=3,t.y+=2},_st6:function(t){t.x+=4,t.y+=4},_st7:function(t){t.x+=6,t.y+=4},_st8:function(t){t.x+=6,t.y+=3},_st9:function(t){t.x+=2,t.y+=3}}}enemy_collision(t,e){if(!this.player.isalive())return;if(!e._shot_alive)return;let s=k.isSqCollision(0-e._img.height/4+","+(0-e._img.height/4)+","+5*e._img.height/4+","+5*e._img.height/4,e.x+","+e.y,t.shotColMap,t.x+","+t.y);s!==x&&(e._c>0||(0===e._c&&(e._c=1),s!==u&&t.collision(Dt._shot_type_def.MISSILE)))}get_missile_status(t){return t._st}set_missile_status(t,e){t._c_mc=t._c_mc>=1?0:t._c_mc+1,t._st=1===t._c_mc?e:t._st}map_collition(t){let e=this,s=p.getMapX(t.x+e.imgsize),i=p.getMapY(t.y+e.imgsize);if("_st4"===e.get_missile_status(t)&&e.set_missile_status(t,"_st5"),"_st5"===e.get_missile_status(t)&&e.set_missile_status(t,"_st9"),"_st6"===e.get_missile_status(t)&&e.set_missile_status(t,"_st7"),"_st7"===e.get_missile_status(t)&&e.set_missile_status(t,"_st8"),"_st8"===e.get_missile_status(t)&&e.set_missile_status(t,"_st3"),"_st9"===e.get_missile_status(t))return p.isMapCollision(s,i+1)?void e.set_missile_status(t,"_st6"):(t.x+=3,t.y+=6,void e.set_missile_status(t,"_st2"));if("_st3"===e.get_missile_status(t)){if(t.y=p.isMapCollision(s,i)?t.y-1:t.y+1,s=p.getMapX(t.x+e.imgsize/2),i=p.getMapY(t.y+e.imgsize/2),!p.isMapCollision(s+1,i+1))return void e.set_missile_status(t,"_st4");if(p.isMapCollision(s,i))return void t._init()}if("_st2"===e.get_missile_status(t)&&(i=p.getMapY(t.y+e.imgsize+25),p.isMapCollision(s,i)))e.set_missile_status(t,"_st6");else if("_st1"===e.get_missile_status(t)){if(i=p.getMapY(t.y+e.imgsize+25),p.isMapCollision(p.getMapX(t.x),p.getMapY(t.y)))return void t._init();if(p.isMapCollision(s+1,i)||p.isMapCollision(s,i))return void e.set_missile_status(t,"_st6")}}collapse_missile(t){let e=this,s=p.getX(t.x+e.imgsize/2),i=p.getY(t.y+e.imgsize/2);if(t._c>=5*e.col_mis.length)return void t._init();let _=parseInt(t._c/5);t._c_area=e.col_mis[_].scale,d.fillStyle=e.col_mis[_].fs,d.beginPath(),d.arc(s,i,e.col_mis[_].scale,0,2*Math.PI,!1),d.fill(),void 0!==this.col_mis[_-1]&&(d.fillStyle=e.col_mis[_-1].fs,d.beginPath(),d.arc(s,i,e.col_mis[_-1].scale,0,2*Math.PI,!1),d.fill()),t._c++}setDrawImage(){let t=this;for(let e=0;e<t.shots.length;e++){let s=t.shots[e];s._shot_alive&&(s._c>0?t.collapse_missile(s):k._setDrawImage({img:s._img,x:s.x,y:s.y,imgPosx:t.st[t.get_missile_status(s)],width:t.imgsize,height:t.imgsize,basePoint:1}))}}move(){let t=this,e=t.player;if(e.isalive()&&void 0!==e.x)for(let e=0;e<t.shots.length;e++){let s=t.shots[e];(s._shot||s._shot_alive)&&(s.y=p.getShotY(s.y),s._c>0?s.x=p.getX(s.x):k.isShotCanvasOut(s)?s._init():(t.mis_status[s._st](s),s._shot_alive=!0))}}}class Xt extends Rt{constructor(t){super(t);let e=this;this.st._st1=48,e.mis_status._st1=function(t){let s=e.player.getPlayerCenterPosition();var i;t.x=(i=t.x,t._shot_alive?i+4:s._x),t.y=function(e){return t._shot_alive?e+8:s._y}(t.y)}}enemy_collision(t,e){if(!this.player.isalive())return;if(!e._shot_alive)return;let s=k.isSqCollision(this.imgsize/4+","+this.imgsize/4+","+3*this.imgsize/4+","+3*this.imgsize/4,e.x+","+e.y,t.shotColMap,t.x+","+t.y);s!==x&&(e._c>0||(s!==u?(t.collision(Dt._shot_type_def.MISSILE),t.isalive()&&0===e._c&&(e._c=1)):0===e._c&&(e._c=1)))}}class Ut extends Rt{constructor(t){super(t),this.col_mis=[{fs:"rgba(198,231,247,1)",scale:30},{fs:"rgba(71,127,228,1)",scale:40},{fs:"rgba(22,83,190,1)",scale:50},{fs:"rgba(4,9,161,1)",scale:60},{fs:"rgba(0,27,100,1)",scale:70}],this.st={_st1:72,_st2:96,_st3:0}}enemy_collision(t,e){let s=this;if(!s.player.isalive())return;if(!e._shot_alive)return;t.getEnemyCenterPosition();let i=function(){if(e._c>0){if(e._c%20!=0)return x;let s=2*e._c_area;Math.sqrt(2);return k.isSqCollision("0,0,"+s+","+s,parseInt(e.x-s/2)+","+parseInt(e.y-s/2),t.shotColMap,t.x+","+t.y)}return k.isSqCollision(s.imgsize/4+","+s.imgsize/4+","+3*s.imgsize/4+","+3*s.imgsize/4,e.x+","+e.y,t.shotColMap,t.x+","+t.y)}();i!==x&&(0===e._c&&(e._c=1),i!==u&&t.collision(Dt._shot_type_def.MISSILE))}map_collition(t){let e=p.getMapX(t.x),s=p.getMapY(t.y+this.imgsize);(p.isMapCollision(e,s)||p.isMapCollision(e+1,s))&&0===t._c&&(t._c=1)}move(){let t=this,e=t.player;if(!e.isalive())return;if(void 0===e.x)return;let s=e.getPlayerCenterPosition();for(let e=0;e<t.shots.length;e++){let _=t.shots[e];(_._shot||_._shot_alive)&&(_.y=p.getShotY(_.y),_._c>0?_.x=p.getX(_.x):(_._t++,_.x=(i=_.x,_._shot_alive?i+4:s._x),_.y=function(t){return _._shot_alive?t+_._t*_._t/200:s._y-8}(_.y),_._st=_._t>20&&_._t<30?"_st2":_._t>30?"_st3":"_st1",k.isShotCanvasOut(_)?_._init():_._shot_alive=!0))}var i}}class Bt extends Rt{constructor(t){super(t),this.st={_st1:72,_st2:96,_st3:0,_st4:120,_st5:144,_st6:168}}enemy_collision(t,e){if(!this.player.isalive())return;if(!e._shot_alive)return;let s=k.isSqCollision("-10,-10,"+(this.imgsize+10)+","+(this.imgsize+10),e.x+","+e.y,t.shotColMap,t.x+","+t.y);s!==x&&(e._c>0||(0===e._c&&(e._c=1),s!==u&&t.collision(Dt._shot_type_def.MISSILE)))}map_collition(t){let e=p.getMapX(t.x),s=p.getMapY(0===t.id?t.y:t.y+this.imgsize);p.isMapCollision(e,s)&&0===t._c&&(t._c=1)}move(){let t=this.player;if(!t.isalive())return;if(void 0===t.x)return;let e=t.getPlayerCenterPosition(),s=this.shots[0]._shot|this.shots[1]._shot,i=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(s||i){s&&!i&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let t=0;t<this.shots.length;t++){let s=this.shots[t];s._shot_alive&&(s.y=p.getShotY(s.y),s._c>0?s.x=p.getX(s.x):(s._t+=1,s.x=(_=s.x,i?_+1:e._x),s.y=function(_){return 0===t?i?_+s._t*s._t/50*-1:e._y-20:i?_+s._t*s._t/50:e._y}(s.y),k.isShotCanvasOut(s)?s._init():(s._st=0===t?s._t>10&&s._t<20?"_st5":s._t>20?"_st6":"_st4":s._t>10&&s._t<20?"_st2":s._t>20?"_st3":"_st1",s._shot_alive=!0)))}var _}}}class qt extends Yt{constructor(t){super(t),this.shots=new Array,this.speed=20,this._width=25,this._height=25;for(let t=0;t<Dt._shot_max;t++)this.shots.push({sid:Dt._shot_type_def.NORMAL,x:0,y:0,isCollision:!1,img:e.shots.obj,_audio:i.shot_normal,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this.isCollision=!1,this._shot=!1,this._shot_alive=!1}})}enemy_collision(t){let e=this;if(e.player.isalive())for(let s=0;s<e.shots.length;s++){let i=e.shots[s];if(!i._shot_alive)continue;if(t.x<e.player.x)continue;let _=k.isSqCollision("-10,-10,"+(e._width+10)+","+(e._height+10),i.x+","+i.y,t.shotColMap,t.x+","+t.y);_!==x&&(_!==u?t.isalive()&&(t.collision(Dt._shot_type_def.NORMAL),i.isCollision=!0):i.isCollision=!0)}}map_collition(t){let e=p.getMapX(t.x+this._width/2),s=p.getMapY(t.y+this._height/2);if(p.isMapCollision(e,s))return t._init(),void p.setPlayersShotAbleCollision(e,s)}setDrawImage(){for(let t=0;t<this.shots.length;t++){let s=this.shots[t];s._shot_alive&&k._setDrawImage({img:e.shots.obj,x:s.x,y:s.y,imgPosx:[0],width:this._width,height:this._height,basePoint:1})}}move(){let t=this.player;if(!t.isalive())return;if(void 0===t.x)return;let e=t.getPlayerCenterPosition();for(let t=0;t<this.shots.length;t++){let s=this.shots[t];(s._shot||s._shot_alive)&&(s.x=s._shot_alive?s.x+this.speed:e._x,s.y=s._shot_alive?s.y:e._y-s.img.height/2,s.y=p.getShotY(s.y),k.isShotCanvasOut(s)?s._init():s._shot_alive=!0)}}}class Ft extends Yt{constructor(t){super(t);let e=this;e.shots=new Array,e._width=25,e._height=25,e.set=t.set||{speedx:[30,30],speedy:[0,23],imgPosx:[[0],[50]],setX:[(t,e,s)=>t?s.x+s._set_speedX:e._x+this._width/2,(t,e,s)=>t?s.x+s._set_speedX:e._x+this._width/2],setY:[(t,e,s)=>t?s.y:e._y-this._height/2,(t,e,s)=>t?s.y-s._set_speedY:e._y-s._set_speedY-this._height/2],mapCol:[t=>{let e=this.getShotCenterPosition(t);for(let s=e.x-t._set_speedX;s<e.x;s+=5)p.isMapCollision(p.getMapX(s),p.getMapY(e.y))&&(t._init(),p.setPlayersShotAbleCollision(p.getMapX(s),p.getMapY(e.y)))},t=>{let e=this.getShotCenterPosition(t);for(let s=e.x-t._set_speedX;s<e.x;s+=5)for(let i=e.y+t._set_speedY;i>=e.y;i-=3)p.isMapCollision(p.getMapX(s),p.getMapY(i))&&(t._init(),p.setPlayersShotAbleCollision(p.getMapX(s),p.getMapY(i)))}]};for(let t=0;t<Dt._shot_max;t++)e.shots.push({sid:Dt._shot_type_def.DOUBLE,x:0,y:0,imgPosx:e.set.imgPosx[t],isCollision:!1,_setX:e.set.setX[t],_setY:e.set.setY[t],_set_speedX:e.set.speedx[t],_set_speedY:e.set.speedy[t],_mapCol:e.set.mapCol[t],_audio:i.shot_normal,_enemyid:null,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this.isCollision=!1,this._enemyid=null,this._shot=!1,this._shot_alive=!1}})}getShotCenterPosition(t){return{x:parseInt(t.x+this._width/2),y:parseInt(t.y+this._height/2)}}enemy_collision(t){let e=this;if(e.player.isalive())for(let s=0;s<e.shots.length;s++){let i=e.shots[s];if(!i._shot_alive)continue;let _=k.isSqCollision("-10,-10,"+(e._width+10)+","+(e._height+10),i.x+","+i.y,t.shotColMap,t.x+","+t.y);_!==x&&(_!==u?t.isalive()&&(t.collision(Dt._shot_type_def.DOUBLE),i.isCollision=!0):i.isCollision=!0)}}map_collition(t){t._mapCol(t)}setDrawImage(){for(let t=0;t<this.shots.length;t++){let s=this.shots[t];s._shot_alive&&k._setDrawImage({img:e.shots.obj,x:s.x,y:s.y,imgPosx:this.set.imgPosx[t],width:this._width,height:this._height,basePoint:1})}}move(){let t=this.player;if(!t.isalive())return;if(void 0===t.x)return;let e=t.getPlayerCenterPosition(),s=this.shots[0]._shot|this.shots[1]._shot,i=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(s||i){s&&!i&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let t=0;t<this.shots.length;t++){let s=this.shots[t];s._shot_alive&&(s.x=s._setX(i,e,s),s.y=s._setY(i,e,s),s.y=p.getShotY(s.y),k.isShotCanvasOut(s)?s._init():s._shot_alive=!0)}}}}class Nt extends Ft{constructor(t){t.set={speedx:[30,30],speedy:[0,0],imgPosx:[[0],[30]],setX:[(t,e,s)=>t?s.x+s._set_speedX:e._x,(t,e,s)=>t?s.x-s._set_speedX:e._x],setY:[(t,e,s)=>t?s.y:e._y-this._width/2,(t,e,s)=>t?s.y:e._y-this._height/2],mapCol:[t=>{let e=this.getShotCenterPosition(t);for(let s=e.x-t._set_speedX;s<e.x;s+=5)p.isMapCollision(p.getMapX(s),p.getMapY(e.y))&&(t._init(),p.setPlayersShotAbleCollision(p.getMapX(s),p.getMapY(e.y)))},t=>{let e=this.getShotCenterPosition(t);for(let s=e.x-t._set_speedX;s<e.x;s+=5)p.isMapCollision(p.getMapX(s),p.getMapY(e.y))&&(t._init(),p.setPlayersShotAbleCollision(p.getMapX(s),p.getMapY(e.y)))}]},super(t)}}class Ht extends Yt{constructor(t){super(t),this.shots=new Array,this.speed=30,this.lineWidth_1=3,this.strokeStyle_1="rgba(40,70,255,1)",this.lineWidth_2=4,this.strokeStyle_2="rgba(100,180,255,0.7)";for(let t=0;t<Dt._shot_max;t++)this.shots.push({sid:Dt._shot_type_def.LASER,x:0,y:0,isCollision:!1,_t:0,_shot:!1,_shot_alive:!1,_width:0,_height:0,_audio:i.shot_ripple,_init:function(){this.x=0,this.y=0,this.isCollision=!1,this._t=0,this._shot=!1,this._shot_alive=!1,this._width=0,this._height=0}})}enemy_collision(t){if(this.player.isalive())for(let e=0;e<this.shots.length;e++){let s=this.shots[e];if(!s._shot_alive)continue;if(t.isIgnoreCollision())continue;let i=k.isSqCollision("0,-20,"+s._width+","+(2*s._height+20),s.x+","+(s.y-s._height),t.shotColMap,t.x+","+t.y);i!==x&&(i===y&&(t.collision(Dt._shot_type_def.RIPPLE_LASER),function(){let t=L._get_enemies();for(let e=0;e<t.length;e++){let i=t[e];i.isStandBy()||(i.isIgnore()||i.isalive()&&i.isshow()&&(i.isIgnoreCollision()||k.isSqCollision("0,0,"+s._width+","+2*s._height,s.x+","+(s.y-s._height),i.shotColMap,i.x+","+i.y)===y&&i.collision(Dt._shot_type_def.RIPPLE_LASER)))}}()),s.isCollision=!0)}}map_collition(t){let e=p.getMapX(t.x),s=p.getMapY(t.y);if(p.isMapCollision(e,s)||p.isMapCollision(e+1,s)){let i=parseInt(t._height/p.t/2);for(let t=s-i;t<=s+i;t++)p.isMapCollision(e+1,t)&&p.setPlayersShotAbleCollision(e+1,t);t._init()}}setDrawImage(){let t=this;for(let e=0;e<t.shots.length;e++){let s=t.shots[e];s._shot_alive&&(d.beginPath(),d.lineWidth=t.lineWidth_2,d.strokeStyle=t.strokeStyle_2,d.ellipse(s.x+1,s.y+1,s._width,s._height,0,0,2*Math.PI),d.stroke(),d.beginPath(),d.lineWidth=t.lineWidth_1,d.strokeStyle=t.strokeStyle_1,d.ellipse(s.x,s.y,s._width,s._height,0,0,2*Math.PI),d.stroke())}}move(){let t=this,e=t.player;if(!e.isalive())return;if(void 0===e.x)return;let s=e.getPlayerCenterPosition();for(let e=0;e<t.shots.length;e++){let _=t.shots[e];if(!_._shot&&!_._shot_alive)continue;let o=t.speed;_.x=(i=_.x,_._shot_alive?i+o:s._x),_.y=function(t){return _._shot_alive?t:s._y}(_.y),_.y=p.getShotY(_.y),k.isShotCanvasOut(_)?_._init():(_._t=_._t<20?_._t+1:_._t,_._width=.4+_._t,_._height=8+_._t*_._t/6,_._shot_alive=!0)}var i}}class zt extends Ht{constructor(t){super(t),this.strokeStyle_1="rgba(255,80,50,1)",this.strokeStyle_2="rgba(255,180,100,0.7)"}}class Gt extends Yt{constructor(t){super(t);let s=this;s.shots=new Array,s.speed=40,s.lineWidth=2,s.strokeStyle="rgba(50,80,255,1)",s.strokeStyle_u="rgba(120,150,255,1)",s.img_col=e.shot_laser_col.obj,s.imgsize_col=s.img_col.height,s.width_col=s.imgsize_col,s.height_col=s.imgsize_col,s.img_col_ani=[0,25];for(let t=0;t<1;t++)s.shots.push({sid:Dt._shot_type_def.LASER,x:0,sx:0,y:0,_c_col:0,laser_time:600,_enemy:null,_laser_t:0,_laser_ts:0,_laser_MaxX:l.width,_laser_col_max:null,_l_x:0,_l_sx:0,_is_col_map:!1,_shot:!1,_shot_alive:!1,_audio:i.shot_laser,_init:function(){this.x=0,this.sx=0,this.y=0,this._c_col=0,this._laser_t=0,this._laser_ts=0,this._enemy=null,this._l_x=0,this._l_sx=0,this._laser_MaxX=l.width,this._laser_col_max=null,this._is_col_map=!1,this._shot=!1,this._shot_alive=!1}})}set_laser_col_max(t){void 0!==t&&null!==t&&this.shots.forEach(e=>{e._laser_col_max=e._laser_col_max>t||null===e._laser_col_max?t:e._laser_col_max})}is_laser_collision(t){return t._laser_MaxX<l.width}laser_collision(t,e){this.is_laser_collision(t)&&(t._c_col=t._c_col>=this.img_col_ani.length-1?0:t._c_col+1,k._setDrawImage({img:this.img_col,imgPosx:this.img_col_ani[t._c_col],x:t._laser_MaxX-this.width_col,y:t.y-this.img_col.height/2,width:this.imgsize_col,height:this.imgsize_col,basePoint:1}))}enemy_collision(t){let e=this,s=null;for(let i=0;i<this.shots.length;i++){if(t.x+t.width<this.player.x)continue;let _=this.shots[i];if(!_._shot_alive)continue;if((s=k.isSqCollision_laser("0,-10,"+parseInt(_.x-_.sx)+",10",_.sx+","+_.y,t.shotColMap,t.x+","+t.y)).ret===x)return null;let o=_.x-_.sx<this.speed?_.x-_.sx:this.speed;if(o<=0)return null;if(t.x<_.x-o)return t.is_collision_player_init&&_._init(),s.ret===u?s.val:(t.collision(Dt._shot_type_def.LASER),t.isalive()?s.val:_._laser_MaxX+e.speed);for(let i=_.x-o;i<=_.x;i+=5)if((s=k.isSqCollision_laser("0,-10,"+parseInt(i-_.sx)+",10",_.sx+","+_.y,t.shotColMap,t.x+","+t.y)).ret!==x)return t.is_collision_player_init&&_._init(),s.ret===u?s.val:(t.collision(Dt._shot_type_def.LASER),t.isalive()?s.val:_._laser_MaxX+e.speed)}return null}map_collition(t){let e=this;if(!t._shot_alive)return;let s=p.getMapX(t.x),i=p.getMapY(t.y);t._is_col_map=!1;for(let s=t.x-e.speed;s<=t.x;s+=5)if(p.isMapCollision(p.getMapX(s),i)){e.setLaserMaxX(t,s),t._is_col_map=!0;break}for(let e=p.getMapX(t.sx)+1;e<=s;e++)p.isMapCollision(e,i)&&p.setPlayersShotAbleCollision(e,i,Dt._shot_type_def.LASER)}getLaserMaxX(t){return t._laser_MaxX}setLaserLine(t,e,s){t.x=e,t.sx=s}setLaserMaxX(t,e){t._laser_MaxX=e>l.width?l.width:e}setDrawImage(){let t=this;if(t.player.isalive()){d.lineWidth=t.lineWidth,d.strokeStyle=t.strokeStyle,d.lineCap="round";for(let e=0;e<t.shots.length;e++){let s=t.shots[e];s._shot_alive&&(s.x<s.sx||Math.abs(s.x-s.sx)<20||(s.x=t.getLaserMaxX(s)>s.x?s.x:t.getLaserMaxX(s),t.setDrawLaser(s),t.laser_collision(s)))}}}setDrawLaser(t){d.beginPath(),d.strokeStyle=this.strokeStyle_u,d.moveTo(t.sx,t.y+1),d.lineTo(t.x,t.y+1),d.stroke(),d.beginPath(),d.strokeStyle=this.strokeStyle,d.moveTo(t.sx,t.y),d.lineTo(t.x,t.y),d.stroke()}move(){let t=this,e=t.player;if(!e.isalive())return;if(void 0===e.x)return;let s=e.getPlayerCenterPosition(),i=s._x;for(let e=0;e<t.shots.length;e++){let _=t.shots[e];(_._shot||_._shot_alive)&&(_._l_x=(e=>(e+=t.speed)>=_._laser_MaxX-s._x?(_._laser_t+=1e3/r,_._laser_MaxX-s._x):e)(_._l_x),_._l_sx=(e=>_._shot?_._laser_t<=_.laser_time-200?e:(_._laser_ts+=1e3/r,_._laser_ts>_.laser_time-200?(_._init(),0):e>=_._l_x?_._l_x:e+t.speed):e>=_._l_x?(_._init(),0):e+t.speed)(_._l_sx),_.y=s._y,t.setLaserLine(_,i+_._l_x,i+_._l_sx),_._l_x>0&&(_._shot_alive=!0))}}}class Vt extends Gt{constructor(t){super(t);this.lineWidth=4,this.strokeStyle="rgba(100,20,10,1)",this.strokeStyle_u="rgba(255,200,150,0)",this.img_col_ani=[50,75]}setDrawLaser(t){let e=this;d.beginPath(),d.strokeStyle=e.strokeStyle,d.moveTo(t.sx,t.y+1),d.lineTo(t.x,t.y+1),d.stroke();for(let s=t.sx;s<=t.x&&!(s+10>=t.x&&e.is_laser_collision(t))&&(d.fillStyle="rgba(240,79,0,1)",d.fillRect(s,t.y,5,3),d.fillRect(s+5,t.y-3,5,3),!(s+20>=t.x&&e.is_laser_collision(t)));s+=20)d.fillStyle="rgba(208,89,11,1)",d.fillRect(s+15,t.y-3,5,3),d.fillRect(s+10,t.y,5,3),d.fillStyle="rgba(250,180,82,1)",d.fillRect(s+10,t.y-3,5,3),d.fillRect(s+15,t.y,5,3)}}const Wt={_collisions_obj:new Array,_reset(){this._collisions_obj=new Array},_add_collisions(t){if(void 0===t)return;this._collisions_obj.push(new class{constructor(t,e,s){this._c_anime_collosion=0,this.x=t||0,this.y=e||0,this.type=s||"t0",this._status=!0,this.img=Zt[this.type].img(),this.imgPos=Zt[this.type].imgPos,this.aniItv=Zt[this.type].intv,this.width=this.imgPos[1],this.height=this.img.height,this._c=0}isalive(){return this._status}set_imgPos(){this._c=this._c>=this.imgPos.length*this.aniItv-1?0:this._c+1}get_imgPos(){return this.imgPos[parseInt(this._c/this.aniItv)]}setDrawImage(){k._setDrawImage({img:this.img,imgPosx:this.get_imgPos(),x:this.x,y:this.y,width:this.width,height:this.height})}move(){let t=this;t._c>=t.imgPos.length*t.aniItv-1?t._status=!1:(t.set_imgPos(),t.x=p.getX(t.x),t.y=p.getY(t.y))}}(t.x,t.y,t.ct))},_move_collisions(){let t=this;for(let e=t._collisions_obj.length-1;e>=0;e--){let s=t._collisions_obj[e];s.isalive()||t._collisions_obj.splice(e,1),s.move()}},_draw_collisions(){this._collisions_obj.map(t=>{t.setDrawImage()})}},Zt={t0:{intv:5,imgPos:[0,30,60,90,120],img:()=>e.enemy_collapes0.obj},t1:{intv:5,imgPos:[0,55,110,165,220],img:()=>e.enemy_collapes1.obj},t2:{intv:5,imgPos:[0,30,60,90,120,150,180],img:()=>e.enemy_collapes2.obj},t3:{intv:5,imgPos:[0,50,100,150,200],img:()=>e.enemy_collapes3.obj},t8:{intv:5,imgPos:[0,90,180,270,360,450,540],img:()=>e.enemy_collapes8.obj},t9:{intv:5,imgPos:[0,200,400,600,800],img:()=>e.enemy_collapes9.obj}};let Kt="",Qt=0,Jt=0;const $t={enemy_cristalcore:{_obj:function(t){return new class extends ${constructor(t){super({img:e.enemy_cristalcore.obj,x:t.x,y:t.y}),this._status=1,this.speed=3,this.wall=[],this.hands_up=[],this.hands_down=[],this.is_able_collision=!1,this._shot_count=0,this.shotColMap=["25,0,227,10,false","25,242,227,250,false","120,0,227,250,false"],this.wall=[],this.hands_up=[new st({_boss:this,_ignore_collision:!0,_initx:70,_inity:90,_cmr:60,_cmsr:70,_initRad:40,_data:"0,0,180,10",_change:!0}),new st({_boss:this,_ignore_collision:!0,_initx:70,_inity:90,_cmr:70,_cmsr:80,_initRad:70,_data:"0,0,185,5",_change:!0}),new st({_boss:this,_initx:70,_inity:90,_cmr:80,_cmsr:100,_initRad:100,_data:"0,0,180,-10",_change:!0}),new st({_boss:this,_initx:70,_inity:90,_cmr:89,_cmsr:125,_initRad:130,_data:"0,0,175,-25",_change:!0}),new st({_boss:this,_initx:70,_inity:90,_cmr:97,_cmsr:145,_initRad:160,_data:"0,0,170,-40",_change:!0}),new st({_boss:this,_initx:70,_inity:90,_cmr:106,_cmsr:160,_initRad:190,_data:"0,0,165,-55",_change:!0}),new st({_boss:this,_img:e.enemy_cristalcore_hand2.obj,_initx:70,_inity:90,_cmr:115,_cmsr:170,_initRad:215,_data:"0,0,160,-70",_change:!0})],this.hands_up.map(t=>{L._add_enemies(t)}),this.hands_down=[new st({_boss:this,_ignore_collision:!0,_initx:70,_inity:165,_cmr:60,_cmsr:70,_initRad:40,_data:"0,0,180,-10",_change:!1}),new st({_boss:this,_ignore_collision:!0,_initx:70,_inity:165,_cmr:70,_cmsr:80,_initRad:70,_data:"0,0,175,-5",_change:!1}),new st({_boss:this,_initx:70,_inity:165,_cmr:80,_cmsr:100,_initRad:100,_data:"0,0,180,10",_change:!1}),new st({_boss:this,_initx:70,_inity:165,_cmr:89,_cmsr:125,_initRad:130,_data:"0,0,185,25",_change:!1}),new st({_boss:this,_initx:70,_inity:165,_cmr:97,_cmsr:145,_initRad:160,_data:"0,0,190,40",_change:!1}),new st({_boss:this,_initx:70,_inity:165,_cmr:106,_cmsr:160,_initRad:190,_data:"0,0,195,55",_change:!1}),new st({_boss:this,_img:e.enemy_cristalcore_hand2.obj,_initx:70,_inity:165,_cmr:115,_cmsr:170,_initRad:215,_data:"0,0,200,70",_change:!1})],this.hands_down.map(t=>{L._add_enemies(t)})}show_walls(){this.wall.map((t,e,s)=>{(void 0===s[e-1]||s[e-1]._status<=0)&&(t.is_able_collision=!0)})}shot(){let t=this;if(t._shot_count++,t._count%1200>800){if(t._shot_count<10)return}else if(t._c%1200<=800&&t._shot_count<50)return;t._shot_count=0,mt._add_shot(new gt({x:t.x,y:t.y+111})),mt._add_shot(new gt({x:t.x,y:t.y+140})),D._setPlay(i.enemy_bullet_laser)}showCollapes(){this._isshow=!1,this.hands_up.forEach(t=>{t.showCollapes(t.x,t.y),t.init()}),this.hands_down.forEach(t=>{t.showCollapes(t.x,t.y),t.init()}),Wt._add_collisions({x:this.x+this.img.width/2,y:this.y+this.img.height/2,ct:this._collision_type})}move_Allset(){let t=this;t.y-=4,t.y<200&&(t.is_all_set=!0)}move_standby(){let t=this;0===t.wall.length&&(t.wall=[new tt({img:e.enemy_cristalcore_wall1.obj,boss:t,x:47,y:116}),new tt({img:e.enemy_cristalcore_wall2.obj,boss:t,x:62,y:116}),new tt({img:e.enemy_cristalcore_wall2.obj,boss:t,x:77,y:116}),new tt({img:e.enemy_cristalcore_wall2.obj,boss:t,x:92,y:116}),new tt({img:e.enemy_bigcore_core.obj,boss:t,x:102,y:115,width:30,height:30})],t.wall.map(t=>{L._add_enemies(t)})),t._standby=!1}moveSet(){let t=this;t.show_walls(),t.hands_up.forEach(e=>{e.moveDraw(t)}),t.hands_down.forEach(e=>{e.moveDraw(t)}),t.y+=t.speed,t._count%1200>800&&t._count%45==0&&(t.speed*=-1),(t.y+t.img.height>l.height||t.y<0)&&(t.speed*=-1),t.wall.every(t=>!t.isalive())&&(t.hands_up.forEach(t=>{t._status=0}),t.hands_down.forEach(t=>{t._status=0}),t._status=0,t.setAlive())}}({x:t.x,y:t.y})}},enemy_bigcore:{_obj:function(t){return new class extends ${constructor(t){super({img:e.enemy_bigcore.obj,x:t.x,y:t.y}),this._status=1,this.speed=3,this.is_able_collision=!1,this.wall=[],this._wall_statuses="",this._moveYStop=!1,this.shotColMap=["120,0,169,40,false","120,70,169,114,false"]}show_walls(){this.wall.map((t,e,s)=>{(void 0===s[e-1]||s[e-1]._status<=0)&&(t.is_able_collision=!0)})}shot(){let t=this;if(t._count%100==0&&(t._moveYStop=!1),t._count%100>80&&t._count%100<99&&(t._moveYStop=!0),t._count%100==80){for(let s=0;s<=105;s+=35)mt._add_shot(new gt({x:t.x,y:t.y+s,img:e.enemy_bullet_z.obj,width:45,imgPos:[0]}));D._setPlay(i.enemy_bullet_laser)}}move_Allset(){let t=this;t.x-=4,t.x<l.width-t.img.width-80&&(t.is_all_set=!0)}move_standby(){let t=this;0===t.wall.length&&(t.wall=[new tt({img:e.enemy_bigcore_1.obj,boss:t,x:15,y:51}),new tt({img:e.enemy_bigcore_1.obj,boss:t,x:25,y:51}),new tt({img:e.enemy_bigcore_1.obj,boss:t,x:35,y:51}),new tt({img:e.enemy_bigcore_2.obj,boss:t,x:45,y:53}),new tt({img:e.enemy_bigcore_core.obj,boss:t,x:70,y:43,width:30,height:30})],t.wall.map(t=>{L._add_enemies(t)})),t._standby=!1}moveSet(){let t=this;t.show_walls(),t.y+=t._moveYStop?0:t.speed,t.speed=t.y<50||t.y+t.img.height>450?-1*t.speed:t.speed,t.shot(),t.wall.every(t=>!t.isalive())&&(t._status=0,t.setAlive())}}({x:t.x,y:t.y})}},enemy_bigcore2:{_obj:function(t){return new class extends ${constructor(t){super({img:e.enemy_bigcore2.obj,x:t.x,y:t.y});let s=this;s.speed=0,s.speed_mount=2,s.is_able_collision=!1,s.wall_up=[],s.wall_down=[],s.hands_up=[],s.hands_down=[],s.back=[0,85,170,255,340,425],s.back_img_up={x:200,y:-50,st:0,flag:!0,s1:function(){this.st>=15&&(this.flag=!1),this.st<=6&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},s2:function(){this.st>=6&&(this.flag=!1),this.st<=0&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},f:function(){let t=e.enemy_bigcore2_back.obj,i=(t.height,t.height);k._setDrawImage({img:t,x:s.x+this.x,y:s.y+this.y,imgPosx:85*parseInt(this.st/3),width:85,height:i,basePoint:1})}},s.back_img_down={x:200,y:30,st:0,flag:!0,s1:function(){this.st>=15&&(this.flag=!1),this.st<=6&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},s2:function(){this.st>=6&&(this.flag=!1),this.st<=0&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},f:function(){let t=e.enemy_bigcore2_back.obj,i=(t.height,t.height);k._setDrawImage({img:t,x:s.x+this.x,y:s.y+this.y+t.height,imgPosx:85*parseInt(this.st/3),width:85,height:i,direct:w._U,basePoint:1})}},s.tid=null,s._moveYStop=!1,s.shotColMap=["130,0,240,156,false"],s._collision_type="t9",s._hands_open_flag=!1}shot(){let t=this,e=t.getEnemyCenterPosition(),s=Dt._players_obj.getPlayerCenterPosition();if(t._count%150==0&&(t._moveYStop=!1),t._count%150>50&&t._count%150<99&&(t._moveYStop=!0),t._count%150==51&&(t._hands_open_flag=Math.abs(s._y-e._y)<100,t._hands_open_flag&&(t.hands_up.reverse().map(t=>{t.isHandsOpen=!0}),t.hands_down.reverse().map(t=>{t.isHandsOpen=!0}))),t._count%150==70){let e=[];t._hands_open_flag?(t.wall_up.some(t=>t.isalive())&&(e=e.concat([{x:85,y:-75},{x:70,y:-45},{x:120,y:-20},{x:100,y:0},{x:80,y:25},{x:60,y:45},{x:0,y:55}])),t.wall_down.some(t=>t.isalive())&&(e=e.concat([{x:0,y:85},{x:60,y:95},{x:80,y:115},{x:100,y:135},{x:120,y:160},{x:70,y:170},{x:85,y:200}]))):(t.wall_up.some(t=>t.isalive())&&(e=e.concat([{x:60,y:20},{x:0,y:55}])),t.wall_down.some(t=>t.isalive())&&(e=e.concat([{x:0,y:95},{x:60,y:130}])));for(let s=0;s<e.length;s++)mt._add_shot(new gt({x:t.x+e[s].x,y:t.y+e[s].y}));D._setPlay(i.enemy_bullet_laser)}t._count%150==110&&(t.hands_up.reverse().map(t=>{t.isHandsClose=!0}),t.hands_down.reverse().map(t=>{t.isHandsClose=!0}))}move_Allset(){let t=this;t.x-=4,t.speed>0&&!t._moveYStop?t.back_img_up.s1():t.back_img_up.s2(),t.back_img_up.f(),t.speed<0&&!t._moveYStop?t.back_img_down.s1():t.back_img_down.s2(),t.back_img_down.f(),t.x<l.width-t.img.width-80&&(t.speed=2,t.is_all_set=!0)}move_standby(){let t=this;0===t.wall_up.length&&(t.wall_up=[new tt({img:e.enemy_bigcore2_wall.obj,boss:t,x:90,y:38}),new tt({img:e.enemy_bigcore2_wall.obj,boss:t,x:95,y:38}),new tt({img:e.enemy_bigcore2_wall.obj,boss:t,x:100,y:38}),new tt({img:e.enemy_bigcore2_wall.obj,boss:t,x:105,y:38}),new tt({img:e.enemy_bigcore2_core.obj,boss:t,x:110,y:36})],t.wall_up.map(t=>{L._add_enemies(t)})),0===t.wall_down.length&&(t.wall_down=[new tt({img:e.enemy_bigcore2_wall.obj,boss:t,x:90,y:95}),new tt({img:e.enemy_bigcore2_wall.obj,boss:t,x:95,y:95}),new tt({img:e.enemy_bigcore2_wall.obj,boss:t,x:100,y:95}),new tt({img:e.enemy_bigcore2_wall.obj,boss:t,x:105,y:95}),new tt({img:e.enemy_bigcore2_core.obj,boss:t,x:110,y:93})],t.wall_down.map(t=>{L._add_enemies(t)})),0===t.hands_up.length&&(t.hands_up=[new et({_initx:-52,_inity:-30,_dir:w._U,_boss:t})],L._add_enemies(t.hands_up[0])),0===t.hands_down.length&&(t.hands_down=[new et({_initx:-52,_inity:75,_dir:w._D,_boss:t})],L._add_enemies(t.hands_down[0])),t._standby=!1}show_walls(){this.wall_up.map((t,e,s)=>{(void 0===s[e-1]||s[e-1]._status<=0)&&(t.is_able_collision=!0)}),this.wall_down.map((t,e,s)=>{(void 0===s[e-1]||s[e-1]._status<=0)&&(t.is_able_collision=!0)})}moveSet(){let t=this;t.speed>0&&!t._moveYStop?t.back_img_up.s1():t.back_img_up.s2(),t.back_img_up.f(),t.speed<0&&!t._moveYStop?t.back_img_down.s1():t.back_img_down.s2(),t.back_img_down.f(),t.show_walls(),t.y+=t._moveYStop?0:t.speed,t.speed=(()=>{if(t.y<50)return t.speed_mount;if(t.y+t.img.height>450)return-1*t.speed_mount;if(t._count%150!=0)return t.speed;let e=t.getEnemyCenterPosition()._y,s=Dt._players_obj.getPlayerCenterPosition()._y;return e<s?t.speed_mount:e>=s?-1*t.speed_mount:void 0})(),t.hands_up.reverse().map(e=>{t.wall_up.every(t=>!t.isalive())&&!e.is_hand_stop()&&(D._setPlay(t.audio_collision),e.set_hand_stop())}),t.hands_down.reverse().map(e=>{t.wall_down.every(t=>!t.isalive())&&!e.is_hand_stop()&&(D._setPlay(t.audio_collision),e.set_hand_stop())}),t.wall_up.every(t=>!t.isalive())&&t.wall_down.every(t=>!t.isalive())&&(t.hands_up.reverse().map(t=>{t._status=0}),t.hands_down.reverse().map(t=>{t._status=0}),t._status=0,t.setAlive())}}({x:t.x,y:t.y})}},enemy_frame:{_obj:function(t){return new class extends ${constructor(t){super({img:e.enemy_frame_body1.obj,x:t.x,y:t.y});let s=this;s._status=1,s.speed=3,s.moves_interval=15,s.shotColMap=[parseInt(s.img.width/2)+","+parseInt(s.img.height/2)+","+parseInt(s.img.width/2+1)+","+parseInt(s.img.height/2+1)],s._radX=0,s._radY=0,s._rad=100,s._deg=16,s._f=!1,s._mpt=0,s._collision_type="t9",s._collision_set=!1,s.movePos={_pos:0,_pos_same_count:0,_getPos:function(){return this._pos},_setPos:function(){let t=s.getEnemyCenterPosition();t._x<200?t._y<150?this._pos=1:t._y>l.height-150?this._pos=7:this._pos=4:t._x>l.width-200?t._y<150?this._pos=3:t._y>l.height-150?this._pos=9:this._pos=6:t._y<150?this._pos=2:t._y>l.height-150?this._pos=8:this._pos=5},move:function(){let t=this._getPos();if(this._setPos(),t===this._pos){if(this._pos_same_count++,this._pos_same_count<70)return;let t=5===(e=this)._pos?Math.random()>.4?2:1:3===e._pos&&1===s._mpt&&s._deg<190&&s._deg>=180?0:3===e._pos&&2===s._mpt&&s._deg<90&&s._deg>=80?0:6===e._pos&&1===s._mpt&&s._deg<270&&s._deg>=260?0:6===e._pos&&2===s._mpt&&s._deg<100&&s._deg>=90?0:9===e._pos&&1===s._mpt&&s._deg<280&&s._deg>=270?0:9===e._pos&&2===s._mpt&&s._deg<190&&s._deg>=180?0:2===e._pos&&1===s._mpt&&s._deg<180&&s._deg>=170?0:2===e._pos&&2===s._mpt&&s._deg<10&&s._deg>=0?0:8===e._pos&&1===s._mpt&&s._deg<360&&s._deg>=350?0:8===e._pos&&2===s._mpt&&s._deg<190&&s._deg>=180?0:1===e._pos&&1===s._mpt&&s._deg<180&&s._deg>=170?0:1===e._pos&&2===s._mpt&&s._deg<280&&s._deg>=270?0:4===e._pos&&1===s._mpt&&s._deg<90&&s._deg>=80?0:4===e._pos&&2===s._mpt&&s._deg<280&&s._deg>=270?0:7===e._pos&&1===s._mpt&&s._deg<360&&s._deg>=350?0:7===e._pos&&2===s._mpt&&s._deg<90&&s._deg>=80?0:s._mpt;return s.x<-s._rad||s.x>l.width+s._rad||s.y<-s._rad||s.y>l.height+s._rad?(s.deg=s.setDegAdd(180),s.moves_pt[s._mpt].switch(0),void(s._mpt=0)):(t!==s._mpt&&(this._pos_same_count=0),s.moves_pt[s._mpt].switch(t),void(s._mpt=t))}var e;let i=function(e){return 5===e._pos?0:1===t&&2===e._pos?2:1===t&&4===e._pos?1:4===t&&1===e._pos?2:4===t&&7===e._pos?1:7===t&&4===e._pos?2:7===t&&8===e._pos?1:2===t&&1===e._pos?1:2===t&&3===e._pos?2:8===t&&7===e._pos?2:8===t&&9===e._pos?1:3===t&&2===e._pos?1:3===t&&6===e._pos?2:6===t&&3===e._pos?1:6===t&&9===e._pos?2:9===t&&6===e._pos?1:9===t&&8===e._pos?2:parseInt(2*Math.random()+1)}(this);s.moves_pt[s._mpt].switch(i),s._mpt=i}},s.parts=[new _t({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new ot({o:null,x:1500,y:250}),new _t({o:null,x:1500,y:250,d:w._L})],s.moves=[];for(let t=0;t<s.parts.length;t++)L._add_enemies(s.parts[t]);s.moves_pt=[{switch:function(t){1===t?s._deg=s.setDegAdd(90):2===t&&(s._deg=s.setDegAdd(-90)),0!==t&&(s._radX=s.x+Math.cos(s._deg*Math.PI/180)*s._rad*-1,s._radY=s.y+Math.sin(s._deg*Math.PI/180)*s._rad*-1),s._mpt=t},move:function(){s.x+=s.speed*Math.cos(s._deg*Math.PI/180),s.y+=s.speed*Math.sin(s._deg*Math.PI/180)},setDeg:0},{switch:function(t){0===t?s._deg=s.setDegAdd(-90):2===t&&(s._deg=s.setDegAdd(-180)),1!==t&&(s._radX=s.x+Math.cos(s._deg*Math.PI/180)*s._rad*-1,s._radY=s.y+Math.sin(s._deg*Math.PI/180)*s._rad*-1),s._mpt=t},move:function(){s._deg=s.setDegAdd(-1*s.speed/2),s.x=s._radX+Math.cos(s._deg*Math.PI/180)*s._rad,s.y=s._radY+Math.sin(s._deg*Math.PI/180)*s._rad},setDeg:-90},{switch:function(t){0===t?s._deg=s.setDegAdd(90):1===t&&(s._deg=s.setDegAdd(-180)),2!==t&&(s._radX=s.x+Math.cos(s._deg*Math.PI/180)*s._rad*-1,s._radY=s.y+Math.sin(s._deg*Math.PI/180)*s._rad*-1),s._mpt=t},move:function(){s._deg=s.setDegAdd(s.speed/2),s.x=s._radX+Math.cos(s._deg*Math.PI/180)*s._rad,s.y=s._radY+Math.sin(s._deg*Math.PI/180)*s._rad},setDeg:90}],s.is_able_collision=!1,s._standby=!0,s._heads_statuses="",s._bodies_statuses=""}setSelfCollision(){let t=this;if(t._c>t._c_self_collision&&(t._heads_statuses="00"),-1===t._heads_statuses.indexOf("1")){for(let e=0;e<t.parts.length;e++)_t.prototype.isPrototypeOf(t.parts[e])?t.parts[e]._status=0:(t._collision_set||(t.parts[e]._deg=15*e),t.parts[e].is_frame_heads_collision=!0);t._collision_set=!0,-1===t._bodies_statuses.indexOf("1")&&t.init()}}set_heads_bodies_status(){let t=this;t._heads_statuses="",t._bodies_statuses="";for(let e=0;e<t.parts.length;e++)_t.prototype.isPrototypeOf(t.parts[e])?t._heads_statuses+=t.parts[e].isalive()?1:0:t._bodies_statuses+=t.parts[e].isalive()?1:0}setDegAdd(t){let e=(this._deg+t)%360;return e<0?360+e:e}isAllPartsCanvasOut(){return this.parts.every(t=>k.isEnemyCanvasOut(t))}move_standby(){let t=this;t._deg=190,t.x+=t.speed*Math.cos(t._deg*Math.PI/180),t.y+=t.speed*Math.sin(t._deg*Math.PI/180),t.moves.unshift({x:t.x,y:t.y,deg:t._deg}),t.moves.length>t.parts.length*t.moves_interval&&t.moves.pop();for(let e=0;e<t.parts.length;e++){let s=t.moves[e*t.moves_interval];if(void 0===s)break;t.parts[e].moveDraw({x:s.x,y:s.y,deg:s.deg})}t.x<l.width-300&&(t.movePos._setPos(),t._standby=!1)}setDrawImage(){let t=this;for(let e=0;e<t.parts.length&&void 0!==t.moves[e*t.moves_interval];e++){let s=t.moves[e*t.moves_interval];t.parts[e].moveDraw({x:s.x,y:s.y,deg:s.deg})}}move(){let t=this;t.isMove()&&((()=>{if(t._c%100==0&&t.isAllPartsCanvasOut()){const e=[{x:l.width/2,y:-30,deg:90},{x:l.width/2,y:l.height-30,deg:270},{x:-30,y:l.height/2,deg:0},{x:l.width-30,y:l.height/2,deg:180}],s=parseInt(4*Math.random());t.x=e[s].x,t.y=e[s].y,t._deg=e[s].deg,t._mpt=0}})(),t.set_heads_bodies_status(),t.moves.unshift({x:t.x,y:t.y,deg:t.setDegAdd(t.moves_pt[t._mpt].setDeg)}),t.moves.length>t.parts.length*t.moves_interval&&t.moves.pop(),t._f||t.parts[0].isalive()||(t._f=!0,t.parts.reverse(),t.moves.reverse(),t.parts[0].setDirect(w._R),t.parts=t.parts.map(t=>(t._deg=(t._deg+180)%360,t)),t.moves=t.moves.map(t=>(t.deg=(t.deg+180)%360,t)),t.parts.pop(),t.x=t.moves[0].x,t.y=t.moves[0].y,t._deg=t.moves[0].deg,t._mpt=0),t.movePos.move(),t.moves_pt[t._mpt].move(),t.setSelfCollision(),t._c++)}}({x:t.x,y:t.y})}},enemy_cell:{_obj:function(t){return new class extends ${constructor(t){super({img:e.enemy_cell_boss.obj,x:t.x,y:t.y}),this.rad=Math.random()*Math.PI-Math.PI/2,this._standby=!1,this.is_all_set=!1,this.ani=[0,180,360],this.ani_c=0,this.ani_c_intv=20,this.moves=[],this.speed=1,this.moves_interval=50,this.parts=[new nt({x:this.x,y:this.y,dark:!1}),new nt({x:this.x,y:this.y,dark:!0}),new nt({x:this.x,y:this.y,dark:!0}),new nt({x:this.x,y:this.y,dark:!0}),new nt({x:this.x,y:this.y,dark:!0}),new nt({x:this.x,y:this.y,dark:!0}),new nt({x:this.x,y:this.y,dark:!0})],this.parts_eye=new at({x:this.x,y:this.y}),this.width=200,this.height=this.img.height,this.shotColMap=["50,0,"+this.width+","+this.height],this.is_able_collision=!1,this._collision_type="t9",this._col_c=0}is_parts_eye_status(){return this.parts_eye.isalive()}setSelfCollision(){this._c<this._c_self_collision||(this.parts_eye._status=0,this.setCollapes())}setCollapes(){let t=this;if(0===t.parts.length)return t._status=0,void Mt._set_score(t.getscore);for(let e=t.parts.length-1;e>=0;e--)t.parts[e].moveDraw();let e=t.parts[t.parts.length-1];0===t._col_c?(e.showCollapes(),t.parts.pop()):t._col_c%8==0&&(Wt._add_collisions({x:e.x+100*Math.random(),y:e.y+100*Math.random(),ct:t._collision_type}),D._setPlay(t.audio_collision)),t._col_c=t._col_c>40?0:t._col_c+1}isAllset(){return!!this.is_all_set||(this.move_Allset(),!1)}move_Allset(){let t=this;t.x-=2;for(let e=0;e<t.parts.length;e++)t.parts[e].moveSet({x:t.x,y:t.y});if(!(t.x>=l.width-300)){t.is_all_set=!0;for(let e=0;e<t.parts.length;e++)L._add_enemies(t.parts[e]);L._add_enemies(t.parts_eye)}}showCollapes(){}move_standby(){}setDrawImage(){let t=this;for(let e=t.parts.length-1;e>=0;e--)t.parts[e].moveDraw();let e=t.moves[0];void 0!==e&&t.parts_eye.moveDraw({x:e.x,y:e.y+t.height/2-t.parts_eye.height/2})}move(){let t=this;if(t.ani_c=t.ani_c>=t.ani.length*t.ani_c_intv-1?0:t.ani_c+1,t.isMove()&&t.isAllset())if(t.is_parts_eye_status()){(t.x<400||t.x>700||t.y<100||t.y>300)&&(t.rad+=Math.PI/2),t.x+=Math.cos(t.rad)*t.speed,t.y+=Math.sin(t.rad)*t.speed,t.moves.unshift({x:t.x,y:t.y}),t.moves.length>t.parts.length*t.moves_interval&&t.moves.pop();for(let e=0;e<t.parts.length;e++){let s=t.moves[e*t.moves_interval];if(void 0===s)break;t.parts[e].moveSet({x:s.x,y:s.y,standby:!1})}t._c%300>100&&t._c%300<200&&t.parts_eye.move_eye_open(),t._c%300>=200&&t._c%300<300&&t.parts_eye.move_eye_close(),t.setSelfCollision(),t._c++}else t.setCollapes()}}({x:t.x,y:t.y})}},enemy_moai:{_obj:function(t){return new rt({x:t.x,y:t.y})}},enemy_death:{_obj:function(t){return new class extends ${constructor(t){super({img:e.enemy_death.obj,x:t.x,y:t.y,width:202,height:140}),this._status=100,this.tid=null,this.shotColMap=["20,0,40,100","40,0,230,140,false"],this._collision_type="t9",this.defSpeed=3,this._front_imgPosx=0,this._is_laser_status=!1,this._shot_count=0,this._shot_count_unit=5}setShotCountUnit(){let t=this;(t._count-t._shot_count)%(50*t._shot_count_unit)==50*t._shot_count_unit-1&&(t._shot_count_unit=t._is_laser_status?parseInt(3*Math.random()+3):t._shot_count_unit,t._shot_count=t._count)}setAlive(){let t=this;t.isalive()?D._setPlay(t.audio_alive):(Mt._set_score(t.getscore),D._setPlay(t.audio_collision),t.showCollapes())}isShooting(){let t=this._count-this._shot_count;return t%(50*this._shot_count_unit)>=50*(this._shot_count_unit-1)&&t%(50*this._shot_count_unit)<50*this._shot_count_unit}isShot(){return(this._count-this._shot_count)%(50*this._shot_count_unit)==50*(this._shot_count_unit-1)+10}shot(){let t=this;if(0===t._count)return;if(t._is_laser_status)return t._front_imgPosx=126,void(t.isShot()&&(L._get_enemies().unshift(new ht({x:t.x+50,y:t.y+35})),D._setPlay(i.enemy_bullet_laser_long)));let e=t._count-t._shot_count,s=50*t._shot_count_unit;if(e%s>200&&e%s<210&&(t._front_imgPosx=42),e%s>210&&e%s<230&&(t._front_imgPosx=84),e%s>230&&e%s<240&&(t._front_imgPosx=42),e%s>240&&e%s<250&&(t._front_imgPosx=0),t.isShot())for(let e=0;e<5;e++)mt._add_shot(new wt({x:t.x+50,y:t.y+45+10*e,deg:[40,20,1,-20,-40][e]}))}move_Allset(){let t=this;t.x-=4,t.x<l.width-t.img.width-80&&(t.is_all_set=!0,t.is_able_collision=!0)}move_standby(){let t=this;t.x-=4,t.x<l.width&&(t._standby=!1)}setDrawImage(){k._setDrawImage({img:this.img,x:this.x,y:this.y,deg:this.deg+180,basePoint:1}),k._setDrawImage({img:e.enemy_death_front.obj,x:this.x,y:this.y+34,imgPosx:this._front_imgPosx,basePoint:1,width:42})}moveSet(){let t=this;!1===t._is_laser_status&&(t._count>=t._c_self_collision/2||t._status<=50)&&(t._is_laser_status=!0,Wt._add_collisions({x:t.x,y:t.y+65,ct:"t1"}),D._setPlay(t.audio_collision));let e=Dt._players_obj.getPlayerCenterPosition();t.speed=(()=>t.isShooting()?0:t._count%50>=40&&t._count%50<50?0:t._count%50==0?e._y<t.y+t.height?-1*t.defSpeed:t.defSpeed:t.y<0&&t.speed<0?t.defSpeed:t.y+t.height>l.height&&t.speed>0?-1*t.defSpeed:t.speed)(),t.y+=t.speed,t.setShotCountUnit()}}({x:t.x,y:t.y})}},enemy_cube:{_obj:function(t){return new class extends ${constructor(t){super({img:e.enemy_cube.obj,x:t.x,y:t.y}),this._standby=!1,this._standby_count=0,this._complete_cube_count=0,this._map_col_reset=!1,this._cube_shot_max=100,this._cube_count=0,this.parts=[],this.is_all_set=!0}setSelfCollision(){}moveSet(){let t=this;if(t._cube_count>=t._cube_shot_max&&t.parts.every(t=>t._stop)&&t._complete_cube_count++,t._standby_count%40==0&&t._cube_count<t._cube_shot_max){let e=new it({x:l.width-10,y:380*Math.random()+50});L._add_enemies(e),t.parts.push(e),t._cube_count++}if(t._standby_count++,0!==t._complete_cube_count)return t.parts.map(e=>{e.alpha=t.alpha}),50===t._complete_cube_count&&(t.alpha=.7),100===t._complete_cube_count&&(t.alpha=.3),150===t._complete_cube_count&&(p.set_mapdef_col_clear(),t.alpha=0),200===t._complete_cube_count?(t._status=0,!1):void 0}}({x:t.x,y:t.y})}},enemy_aian:{_obj:function(t){return new class extends ${constructor(t){super({img:e.enemy_boss_aian.obj,x:t.x,y:t.y,width:100,height:87,imgPos:[0,100],aniItv:5}),this._standby=!0,this._status=1,this.audio_collision=i.enemy_collision2,this._collision_type="t2",this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,this.getscore=100,this.is_ignore=!0,this.aians_max=50,this.aians_count=0,this.aians_clear_count=0,this.parts=[],this.is_all_set=!0}setSelfCollision(){}shot(){}move_standby(){let t=this;if(0===t.parts.length)for(let e=0;e<t.aians_max;e++){let e=new ct({x:l.width+10,y:100});t.parts.push(e),L._add_enemies(e)}t._standby=!1}moveSet(){let t=this;if(t.aians_count===t.aians_max&&t.parts.every(t=>!t.isalive()))return t.aians_clear_count++,void(t.aians_clear_count>200&&t.init());t.parts.map(t=>{t.moveSet()}),t._count%30==0&&(t.aians_count>=t.aians_max||(t.parts[t.aians_count]._standby=!1,t.aians_count++))}}({x:t.x,y:t.y})}}},te={MAP_CRISTAL:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.enemy_p_1.obj,width:100,height:100,x:t.x,y:t.y}),this._s="0111,1111,0111,0111"}}({x:t.x,y:t.y})}},MAP_CRISTAL_UP:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_cristal_up.obj,width:100,height:50,x:t.x,y:t.y}),this._s="1111,1111"}}({x:t.x,y:t.y})}},MAP_CRISTAL_DOWN:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_cristal_down.obj,width:100,height:50,x:t.x,y:t.y}),this._s="1111,1111"}}({x:t.x,y:t.y})}},MAP_VOLCANO_A:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_A.obj,width:225,height:75,x:t.x,y:t.y}),this._s="111111111,111111111,000000000"}}({x:t.x,y:t.y})}},MAP_VOLCANO_B:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_B.obj,width:225,height:75,x:t.x,y:t.y}),this._s="111111111,111111111,000000000"}}({x:t.x,y:t.y})}},MAP_VOLCANO_C:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_C.obj,width:225,height:75,x:t.x,y:t.y}),this._s="000000000,111111111,111111111"}}({x:t.x,y:t.y})}},MAP_VOLCANO_D:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_D.obj,width:225,height:75,x:t.x,y:t.y}),this._s="000000000,111111111,111111111"}}({x:t.x,y:t.y})}},MAP_VOLCANO_E:{_obj:function(t){return new MAP_VOLCANO_E({x:t.x,y:t.y})}},MAP_VOLCANO_F:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_F.obj,width:225,height:150,x:t.x,y:t.y}),this._s="000110000,000110000,001111000,011111100,011111110,111111111"}}({x:t.x,y:t.y})}},MAP_VOLCANO_G:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_G.obj,width:225,height:150,x:t.x,y:t.y}),this._s="111111110,011111110,011111100,001111000,000110000,000110000"}}({x:t.x,y:t.y})}},MAP_VOLCANO_H:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_H.obj,width:500,height:325,x:t.x,y:t.y}),this._s="00000000000000000000,00000111111111111110,00000111111110000000,00000000011110000000,00000000001100000000,00000000001100000000,00000000001100000000,11111111111111111100,01111111111111111100,00000000011000000000,00000000011000000000,00000000111000000000,00000001111110000000"}}({x:t.x,y:t.y})}},MAP_VOLCANO_I:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_I.obj,width:375,height:250,x:t.x,y:t.y}),this._s="000000010000000,000000010000000,000000111000000,000001111100000,000011111110000,000111111111000,001111111111100,001111111111100,011111111111110,111111111111111"}}({x:t.x,y:t.y})}},MAP_VOLCANO_J:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_J.obj,width:375,height:250,x:t.x,y:t.y}),this._s="111111111111111,011111111111110,001111111111100,001111111111100,000111111111000,000011111110000,000001111100000,000000111000000,000000010000000,000000010000000"}}({x:t.x,y:t.y})}},MAP_VOLCANO_K:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_K.obj,width:75,height:25,x:t.x,y:t.y}),this._s="010"}}({x:t.x,y:t.y})}},MAP_VOLCANO_L:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_L.obj,width:75,height:25,x:t.x,y:t.y}),this._s="010"}}({x:t.x,y:t.y})}},MAP_VOLCANO_M:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_M.obj,width:100,height:50,x:t.x,y:t.y}),this._s="0111,1111"}}({x:t.x,y:t.y})}},MAP_VOLCANO_N:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_N.obj,width:100,height:50,x:t.x,y:t.y}),this._s="1111,0111"}}({x:t.x,y:t.y})}},MAP_VOLCANO_O:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_O.obj,width:100,height:50,x:t.x,y:t.y}),this._s="1111,1110"}}({x:t.x,y:t.y})}},MAP_VOLCANO_P:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_volcano_P.obj,width:100,height:50,x:t.x,y:t.y}),this._s="1110,1111"}}({x:t.x,y:t.y})}},MAP_CUBE_A:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_cube_A.obj,width:25,height:25,x:t.x,y:t.y}),this._s="1"}}(void 0===t?{}:{x:t.x,y:t.y})}},MAP_CUBE_B:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_cube_B.obj,width:500,height:50,x:t.x,y:t.y}),this._s="11111111111111111111,11111111111111111111"}}(void 0===t?{}:{x:t.x,y:t.y})}},MAP_MOAI_A:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_moai_A.obj,width:250,height:100,x:t.x,y:t.y}),this._s="0000000000,0111111111,0111111111,0000000000"}}({x:t.x,y:t.y})}},MAP_MOAI_B:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_moai_B.obj,width:250,height:100,x:t.x,y:t.y}),this._s="0000000000,1111111110,1111111110,0000000000"}}({x:t.x,y:t.y})}},MAP_FRAME_A:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_frame_A.obj,imgPos:[0,200,400,600,800],aniItv:10,width:200,height:75,x:t.x,y:t.y}),this._s="000000000,11111111,11111111"}}({x:t.x,y:t.y})}},MAP_FRAME_B:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_frame_B.obj,imgPos:[0,200,400,600,800],aniItv:10,width:200,height:75,x:t.x,y:t.y}),this._s="11111111,11111111,00000000"}}({x:t.x,y:t.y})}},MAP_FRAME_C:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_frame_C.obj,imgPos:[0,50,100,150],aniItv:10,width:50,height:75,x:t.x,y:t.y}),this._s="00,01,11",this.direct=w._LD}}({x:t.x,y:t.y})}},MAP_FRAME_D:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_frame_D.obj,imgPos:[0,50,100,150],aniItv:10,width:50,height:75,x:t.x,y:t.y}),this._s="11,01,00",this.direct=w._LU}}({x:t.x,y:t.y})}},MAP_FRAME_E:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_frame_E.obj,imgPos:[0,50,100,150],aniItv:10,width:50,height:75,x:t.x,y:t.y}),this._s="00,10,11",this.direct=w._LU}}({x:t.x,y:t.y})}},MAP_FRAME_F:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_frame_F.obj,imgPos:[0,50,100,150],aniItv:10,width:50,height:75,x:t.x,y:t.y}),this._s="11,10,00",this.direct=w._LU}}({x:t.x,y:t.y})}},MAP_CELL_A:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_cell_A.obj,imgPos:[0,475,950],aniItv:20,width:475,height:100,x:t.x,y:t.y}),this._s="0000000000000000000,0001111111111111000,0011111111111111100,1111111111111111111"}}({x:t.x,y:t.y})}},MAP_CELL_B:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_cell_B.obj,imgPos:[0,475,950],aniItv:20,width:475,height:100,x:t.x,y:t.y}),this._s="1111111111111111111,0011111111111111100,0001111111111111000,0000000000000000000"}}({x:t.x,y:t.y})}},MAP_CELL_C:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_cell_C.obj,imgPos:[0,125,250],aniItv:20,width:125,height:100,x:t.x,y:t.y}),this._s="00100,01110,01110,11111"}}({x:t.x,y:t.y})}},MAP_CELL_D:{_obj:function(t){return new class extends ft{constructor(t){super({img:e.map_cell_D.obj,imgPos:[0,125,250],aniItv:20,width:125,height:100,x:t.x,y:t.y}),this._s="11111,01110,01110,00100"}}({x:t.x,y:t.y})}},MAP_CELL_G:{_obj:function(t){return new class extends Pt{constructor(t){super({imgPos:[0],x:t.x,y:t.y})}}({x:t.x,y:t.y})}},MAP_CELL_H:{_obj:function(t){return new class extends Pt{constructor(t){super({imgPos:[25],x:t.x,y:t.y})}}({x:t.x,y:t.y})}},MAP_CELL_I:{_obj:function(t){return new class extends Pt{constructor(t){super({imgPos:[50],x:t.x,y:t.y})}}({x:t.x,y:t.y})}},MAP_CELL_J:{_obj:function(t){return new class extends Pt{constructor(t){super({imgPos:[75],x:t.x,y:t.y})}}({x:t.x,y:t.y})}},MAP_CELL_K:{_obj:function(t){return new class extends Pt{constructor(t){super({imgPos:[100],x:t.x,y:t.y})}}({x:t.x,y:t.y})}},MAP_CELL_L:{_obj:function(t){return new class extends Pt{constructor(t){super({imgPos:[125],x:t.x,y:t.y})}}({x:t.x,y:t.y})}},MAP_CELL_M:{_obj:function(t){return new class extends Pt{constructor(t){super({imgPos:[150],x:t.x,y:t.y})}}({x:t.x,y:t.y})}},MAP_CELL_N:{_obj:function(t){return new class extends Pt{constructor(t){super({imgPos:[175],x:t.x,y:t.y})}}({x:t.x,y:t.y})}},MAP_CELL_O:{_obj:function(t){return new class extends Pt{constructor(t){super({imgPos:[200],x:t.x,y:t.y})}}({x:t.x,y:t.y})}},MAP_CELL_V:{_obj:function(t){return new class extends bt{constructor(t){super({img:e.map_cell_V.obj,x:t.x,y:t.y,_s:"001111111100,111111111111"})}}({x:t.x,y:t.y})}},MAP_CELL_W:{_obj:function(t){return new class extends bt{constructor(t){super({img:e.map_cell_W.obj,x:t.x,y:t.y,_s:"111111111111,001111111100"})}}({x:t.x,y:t.y})}},MAP_CELL_Y:{_obj:function(t){return new class extends bt{constructor(t){super({img:e.map_cell_Y.obj,x:t.x,y:t.y,_s:"111111111111,111111111111"})}}({x:t.x,y:t.y})}},MAP_CELL_Z:{_obj:function(t){return new class extends bt{constructor(t){super({img:e.map_cell_Z.obj,x:t.x,y:t.y,_s:"111111111111,111111111111"})}}({x:t.x,y:t.y})}}},ee={ENEMY_a:{_obj:function(t,e,s){return new T({x:t,y:e,direct:s})},_st:""},ENEMY_b:{_obj:function(t,s,i){return new class extends T{constructor(t){super({img:e.enemy_b.obj,x:t.x,y:t.y,direct:t.direct}),this.haspc=!0}}({x:t,y:s,direct:i})},_st:""},ENEMY_c:{_obj:function(t,s,i){let _=p.isMapCollision(p.getMapX(t),p.getMapY(s)-1)?w._U:w._D;return _=p.isMapCollision(p.getMapX(t),p.getMapY(s)+2)?w._D:w._U,new class extends A{constructor(t){super({img:e.enemy_c.obj,x:t.x,y:t.y,width:50,height:50,imgPos:[0,50,100,150,200,250,300],direct:t.direct});let s=this;s._st="_st1",s._shot=!1,s._status=1,s._docker_speed=0,s._collision_type="t3",s._count=0,s.shotColMap=s.direct===w._D?["10,10,43,42"]:["0,0,43,32"],s._ene_status={_st1:{_f:function(){!0!==s._shot&&(s.imgPos=[0,50,100,150],s.set_imgPos())},_setX:function(){return s.x+2*s._docker_speed}},_st2:{_f:function(){if(!(s.x>=l.width))return s._shot=!0,s.imgPos=[200,250,300],s.set_imgPos(),s._c>=s.imgPos.length*s.aniItv-1?(s.shot(),s._shot=!1,void(s._st="_st1")):void 0},_setX:function(){return s.x}}}}map_collition(){let t=this,e=t.getEnemyCenterPosition(),s=p.getMapX(e._x),i=p.getMapY(t.y);if(p.isMapBefore(s,i))return t._docker_speed=Math.abs(t._docker_speed),void(t.x+=2*t._docker_speed);if(p.isMapLastSide(p.getMapX(t.x),i))return t._docker_speed*=-1,void(t.x+=2*t._docker_speed);let _=3*Math.abs(t._docker_speed);t.y=(e=>e.direct===w._U||e.direct===w._LU?t.y<=0?e.y+_:(i=p.getMapY(e.y),p.isMapCollision(s-1,i)||p.isMapCollision(s+1,i)?e.y+_:(i=p.getMapY(e.y-3),p.isMapCollision(s,i)?e.y:e.y-_)):e.direct===w._D||e.direct===w._LD?t.y+t.height>=l.height?e.y-_:(i=p.getMapY(e.y+t.height),p.isMapCollision(s-1,i)||p.isMapCollision(s+1,i)?e.y-_:(i=p.getMapY(e.y+t.height+3),p.isMapCollision(s,i)?e.y:e.y+_)):void 0)(t)}setDrawImageDirect(){let t=this,e=t.getEnemyCenterPosition()._x,s=Dt._players_obj.getPlayerCenterPosition()._x;t.direct!==w._U&&t.direct!==w._LU||(t.direct=s<e?w._U:w._LU),t.direct!==w._D&&t.direct!==w._LD||(t.direct=s<e?w._D:w._LD)}set_speed(){let t=this,e=Dt._players_obj.getPlayerCenterPosition();if(t._count>3e3*Math.random()&&(t._count=0),0!==t._count)return;let s=t._docker_speed>0?-1*(t.speed-1):t.speed-1;t._docker_speed=s,t._docker_speed=e._x<t.x?-1*t._docker_speed:Math.abs(t._docker_speed)}isshot(){return Math.random()<4*P()}shot(){if("_st1"===this._st)return;if(k.isEnemyCanvasOut(this))return;if(!this.isshot())return;let t=Dt._players_obj.getPlayerCenterPosition(),e=this.getEnemyCenterPosition(),s=k.getDeg({x:t._x,y:t._y},{x:e._x,y:e._y});mt._add_shot(new pt({x:e._x,y:e._y,deg:s-10})),mt._add_shot(new pt({x:e._x,y:e._y,deg:s+10}))}moveSet(){this.setDrawImageDirect(),this.map_collition(),this.set_speed(),this._st=this.isshot()||this._shot?"_st2":"_st1",this._ene_status[this._st]._f(),this.x=this._ene_status[this._st]._setX(),this._count++}}({x:t,y:s,direct:i})},_st:""},ENEMY_d:{_obj:function(t,e,s){return new Y({x:t,y:e,direct:s})},_st:""},ENEMY_e:{_obj:function(t,s,i){return new class extends Y{constructor(t){super({img:e.enemy_e.obj,x:t.x,y:t.y,direct:t.direct}),this.haspc=!0}}({x:t,y:s,direct:i})},_st:""},ENEMY_f:{_obj:function(t,e,s){return s=e<l.height/2?w._U:w._D,new R({x:t,y:e,direct:s})},_st:""},ENEMY_g:{_obj:function(t,s,i){return new class extends R{constructor(t){super({img:e.enemy_g.obj,x:t.x,y:t.y,direct:t.direct}),this.haspc=!0}}({x:t,y:s,direct:s<l.height/2?w._U:w._D})},_st:""},ENEMY_m:{_obj:function(t,s,i){return new class extends A{constructor(t){super({img:e.enemy_m1.obj,x:t.x,y:t.y,imgPos:[0,50,100,150,100,50,0],width:50,height:25,aniItv:5,direct:t.direct}),this._status=4,this._collision_type="t3",this.getscore=200,this._count=0}shot(){}moveSet(){let t=this;if(!t.isalive())return void t.showCollapes(0,t.direct===w._U?0:-p.t);if(t._count=t._count>=300?0:t._count+1,t.x<300&&t._count<=100)return void(t._count=99);if(t.img=t._status<=1?e.enemy_m2.obj:e.enemy_m1.obj,t._count<100||t>=300)return t.imgPos[0],void(t._c=0);if(t._count%300>100&&t._count%300<120&&(t.imgPos[150],t.set_imgPos()),t._count%300>280&&t._count%300<300&&(t.imgPos[0],t.set_imgPos()),t._count%300<120||t._count%300>=300)return;if(t._count%C()!=0)return;let s=new X({x:t.x+12.5,y:t.y+(t.direct===w._U?15:-10),direct:t.direct});L._add_enemies(s)}}({x:t,y:s,direct:i})},_st:""},ENEMY_n:{_obj:function(t,e,s){return new U({x:t,y:e,direct:s})},_st:""},ENEMY_o:{_obj:function(t,s,i){return new class extends U{constructor(t){super({img:e.enemy_o.obj,x:t.x,y:t.y,direct:t.direct})}moveSet(){if(!this.isshot())return;let t=new B({x:this.x,y:this.y});L._add_enemies(t)}}({x:t,y:s,direct:i})},_st:""},ENEMY_p:{_obj:function(t,e,s){return new F({x:t,y:e,direct:w._D})},_st:""},ENEMY_FAN:{_obj:function(t,s,i){return new class extends A{constructor(t){super({img:e.enemy_fan.obj,x:t.x,y:t.y,imgPos:[0,25,50,75,100,125,150,175],aniItv:5,width:25,height:25,direct:t.direct}),this.haspc=!0,this.parts=[],this.is_ignore=!0}move_standby(){let t=this;if(!(t.x>l.width)){t._standby=!1,t.parts=[new O({x:t.x+0*t.width,y:t.y}),new O({x:t.x+.5*t.width,y:t.y}),new O({x:t.x+1*t.width,y:t.y}),new O({x:t.x+1.5*t.width,y:t.y}),new O({x:t.x+2*t.width,y:t.y}),new O({x:t.x+2.5*t.width,y:t.y})];for(let e=0;e<t.parts.length;e++)L._add_enemies(t.parts[e])}}setDrawImage(){}moveSet(){let t=this;for(let e=t.parts.length-1;e>=0;e--){let s=t.parts[e];s.moveSet(),s.isalive()||t.parts.splice(e,1)}if(0===t.parts.length)return t.x<l.width&&t.showCollapes(),void t.init();t.x=t.parts[t.parts.length-1].x,t.y=t.parts[t.parts.length-1].y}}({x:t,y:s,direct:i})},_st:""},ENEMY_MOAI_Q_U:{_obj:function(t,e,s){return new H({x:t,y:e,direct:w._U})},_st:"transform:scale(1,-1);"},ENEMY_MOAI_Q_D:{_obj:function(t,e,s){return new H({x:t,y:e,direct:w._D})},_st:""},ENEMY_MOAI_Q_LD:{_obj:function(t,e,s){return new H({x:t,y:e,direct:w._LD})},_st:"transform:scale(-1,1);"},ENEMY_MOAI_Q_LU:{_obj:function(t,e,s){return new H({x:t,y:e,direct:w._LU})},_st:"transform:scale(-1,-1);"},ENEMY_MOAI_R_U:{_obj:function(t,e,s){return new z({x:t,y:e,direct:w._U})},_st:"transform:scale(1,-1);"},ENEMY_MOAI_R_D:{_obj:function(t,e,s){return new z({x:t,y:e,direct:w._D})},_st:""},ENEMY_FRAME_1:{_obj:function(t,e,s){return new V({x:t,y:e,direct:s})},_st:""},ENEMY_CELL_CORE:{_obj:function(t,s,_){return new class extends A{constructor(t){super({img:e.enemy_cell_core.obj,x:t.x,y:t.y,aniItv:20}),this._status=10,this.getscore=500,this.audio_alive=i.enemy_collision7,this._collision_type="t9",this.rad=0,this.ani=[{scale:1},{scale:.95},{scale:.9},{scale:.85},{scale:.9},{scale:.95}],this.hands_up_rad=[],this.hands_up=[],this.hands_up_count={c:0,max:parseInt(300*Math.random())+100},this.hands_down_rad=[],this.hands_down=[],this.hands_down_count={c:0,max:parseInt(300*Math.random())+100},this.hands_distance=12}set_hands_target(t,e){let s=Dt._players_obj.getPlayerCenterPosition();return t%e>0&&t%e<parseInt(e/2)?s:{_x:this.x+200,_y:this.y+100}}set_hands_rad(t,e,s,i){let _=i,o=s.getEnemyCenterPosition(),n=parseInt(100*Math.random())-50,a=_._x+n-o._x,h=_._y+n-o._y,r=(t=>{let e=Math.random()/50;return(t=(t=s.flag?Math.cos(t)>0?s.rad+e:s.rad-e:Math.cos(t)>0?s.rad-e:s.rad+e)<0?2*Math.PI+t:t)>=s.rad_min&&t<=s.rad_max?t:s.rad})(Math.atan2(h,a));s.rad=r,t.unshift(r)}set_hands_pos(t,e,s,i,_){e.x=(i||0)+s.x+Math.cos(t)*this.hands_distance,e.y=(_||0)+s.y+Math.sin(t)*this.hands_distance}is_hands_up_status(){let t=this;for(let e=0;e<t.hands_up.length;e++)if(Q.prototype.isPrototypeOf(t.hands_up[e]))return t.hands_up[e].isalive()}is_hands_down_status(){let t=this;for(let e=0;e<t.hands_down.length;e++)if(Q.prototype.isPrototypeOf(t.hands_down[e]))return t.hands_down[e].isalive()}isCanvasOut(){return k.isEnemyCanvasOut(this,{up:!1,down:!1,left:!0,right:!1},{left:200})}showCollapes(){let t=this,e=t.getEnemyCenterPosition();t._isshow=!1;for(let e=0;e<t.hands_up.length;e++)t.hands_up[e].showCollapes();for(let e=0;e<t.hands_down.length;e++)t.hands_down[e].showCollapes();Wt._add_collisions({x:e._x,y:e._y,ct:t._collision_type}),D._setPlay(t.audio_collision)}move_standby(){let t=this;if(t.x<l.width-20){t._standby=!1,t.hands_up=[new K({x:t.x,y:t.y,rad:3*Math.PI/2,rad_min:Math.PI+1.5,rad_max:Math.PI+2,flag:!0,ignore_collision:!1}),new K({x:t.x,y:t.y,rad:3*Math.PI/2-.2,rad_min:Math.PI+1,rad_max:Math.PI+2.2,flag:!0,ignore_collision:!1}),new K({x:t.x,y:t.y,rad:3*Math.PI/2-.4,rad_min:Math.PI+.7,rad_max:Math.PI+2.4,flag:!0,ignore_collision:!1}),new K({x:t.x,y:t.y,rad:3*Math.PI/2-.4,rad_min:Math.PI+.7,rad_max:Math.PI+2.4,flag:!0,ignore_collision:!1}),new Q({x:t.x,y:t.y,rad:3*Math.PI/2-.6,rad_min:Math.PI+.5,rad_max:Math.PI+2.6,flag:!0}),new K({x:t.x,y:t.y,rad:3*Math.PI/2-.8,rad_min:Math.PI+.5,rad_max:Math.PI+2.8,flag:!0}),new K({x:t.x,y:t.y,rad:3*Math.PI/2-1,rad_min:Math.PI+.3,rad_max:Math.PI+2.8,flag:!0}),new K({x:t.x,y:t.y,rad:3*Math.PI/2-1.2,rad_min:Math.PI+.3,rad_max:Math.PI+2.8,flag:!0}),new J({x:t.x,y:t.y,rad:3*Math.PI/2-1.4,rad_min:Math.PI+.3,rad_max:Math.PI+2.6,flag:!0})];for(let e=0;e<t.hands_up.length;e++)L._add_enemies(t.hands_up[e]);t.hands_down=[new K({x:t.x,y:t.y,rad:Math.PI-1,rad_min:Math.PI-2,rad_max:Math.PI-1,flag:!1,ignore_collision:!1}),new K({x:t.x,y:t.y,rad:Math.PI-1,rad_min:Math.PI-2.1,rad_max:Math.PI-.9,flag:!1,ignore_collision:!1}),new K({x:t.x,y:t.y,rad:Math.PI-.9,rad_min:Math.PI-2.2,rad_max:Math.PI-.9,flag:!1,ignore_collision:!1}),new K({x:t.x,y:t.y,rad:Math.PI-.9,rad_min:Math.PI-2.3,rad_max:Math.PI-.6,flag:!1,ignore_collision:!1}),new Q({x:t.x,y:t.y,rad:Math.PI-.9,rad_min:Math.PI-2.7,rad_max:Math.PI-.6,flag:!1}),new K({x:t.x,y:t.y,rad:Math.PI-.8,rad_min:Math.PI-2.7,rad_max:Math.PI-.6,flag:!1}),new K({x:t.x,y:t.y,rad:Math.PI-.8,rad_min:Math.PI-2.8,rad_max:Math.PI-.1,flag:!1}),new K({x:t.x,y:t.y,rad:Math.PI-.7,rad_min:Math.PI-2.8,rad_max:Math.PI-.1,flag:!1}),new J({x:t.x,y:t.y,rad:Math.PI-.7,rad_min:Math.PI-2.8,rad_max:Math.PI-.1,flag:!1})];for(let e=0;e<t.hands_down.length;e++)L._add_enemies(t.hands_down[e])}}shot(){}set_aniPos(){this._c=this._c>=this.ani.length*this.aniItv-1?0:this._c+1}get_aniPos(){return this.ani[parseInt(this._c/this.aniItv)]}setDrawImage(){let t=this;for(let e=0;e<t.hands_up.length;e++)0!==e?(t.set_hands_pos(t.hands_up_rad[e],t.hands_up[e],t.hands_up[e-1]),t.hands_up[e].moveDraw()):(t.set_hands_pos(t.hands_up_rad[e],t.hands_up[e],t,t.img.width/2-t.hands_up[e].img.width/2,10),t.hands_up[e].moveDraw());for(let e=0;e<t.hands_down.length;e++)0!==e?(t.set_hands_pos(t.hands_down_rad[e],t.hands_down[e],t.hands_down[e-1]),t.hands_down[e].moveDraw()):(t.set_hands_pos(t.hands_down_rad[e],t.hands_down[e],t,t.img.width/2-t.hands_down[e].img.width/2,t.img.height-30),t.hands_down[e].moveDraw());const e=t.getEnemyCenterPosition();k._setDrawImage({img:t.img,x:e._x,y:e._y,scale:t.get_aniPos().scale*(t._status/10>.7?t._status/10:.7)})}moveSet(){let t=this;t.set_aniPos();const e=t.getEnemyCenterPosition(),s=Dt._players_obj.getPlayerCenterPosition();let i=k.getRad({x:s._x,y:s._y},{x:e._x,y:e._y});if(t.y+=Math.sin(i)*(t.speed-1),!t.is_hands_up_status()&&0!==t.hands_up.length){for(let e=0;e<t.hands_up.length;e++)t.hands_up[e].showCollapes();t.hands_up=[]}if(!t.is_hands_down_status()&&0!==t.hands_down.length){for(let e=0;e<t.hands_down.length;e++)t.hands_down[e].showCollapes();t.hands_down=[]}t.hands_up_rad=[],t.hands_up_count.c=t.hands_up_count.c>t.hands_up_count.max?0:t.hands_up_count.c+1;let _=t.set_hands_target(t.hands_up_count.c,t.hands_up_count.max);for(let e=t.hands_up.length-1;e>=0;e--){if(void 0===t.hands_up[e-1]){t.set_hands_rad(t.hands_up_rad,t,t.hands_up[e],_);break}t.set_hands_rad(t.hands_up_rad,t.hands_up[e-1],t.hands_up[e],_),J.prototype.isPrototypeOf(t.hands_up[e])&&t.hands_up[e].shot()}t.hands_down_rad=[],t.hands_down_count.c=t.hands_down_count.c>t.hands_down_count.max?0:t.hands_down_count.c+1;let o=t.set_hands_target(t.hands_down_count.c,t.hands_down_count.max);for(let e=t.hands_down.length-1;e>=0;e--){if(void 0===t.hands_down[e-1]){t.set_hands_rad(t.hands_down_rad,t,t.hands_down[e],o);break}t.set_hands_rad(t.hands_down_rad,t.hands_down[e-1],t.hands_down[e],o),J.prototype.isPrototypeOf(t.hands_down[e])&&t.hands_down[e].shot()}let n=t.get_aniPos(),a=t.img.width/2-t.img.width*n.scale/2+","+(t.img.height/2-t.img.height*n.scale/2)+","+t.img.width*n.scale+","+t.img.height*n.scale;t.shotColMap=[a]}}({x:t,y:s,direct:_})},_st:""},ENEMY_CELL_A:{_obj:function(t,s,i){return new class extends T{constructor(t){super({img:e.enemy_cell_a.obj,x:t.x,y:t.y,direct:t.direct})}}({x:t,y:s,direct:i})},_st:""},ENEMY_CELL_B:{_obj:function(t,s,i){return new class extends T{constructor(t){super({img:e.enemy_cell_b.obj,x:t.x,y:t.y,direct:t.direct}),this.haspc=!0}}({x:t,y:s,direct:i})},_st:""}},se={},ie={};const _e=null===window.ontouchstart?"touchstart":"keydown",oe=null===window.ontouchstart?"touchmove":"keydown",ne=null===window.ontouchstart?"touchend":"keyup";let ae=!1,he=!1;const re=function(){h?Pe._sp_bt_s.addEventListener(_e,be.keydown_start):document.addEventListener(_e,fe.keydown_start)},le=function(){h?Pe._sp_bt_s.removeEventListener(_e,be.keydown_start):document.removeEventListener(_e,fe.keydown_start)},de=function(){h?(Pe._sp_main_center.addEventListener(oe,be.keymove_select_stage),Pe._sp_main_center.addEventListener(ne,be.keyend_select_stage),Pe._sp_bt_a.addEventListener(_e,be.keydown_select_stage_a)):document.addEventListener(_e,fe.keydown_select_stage)},ce=function(){h?(Pe._sp_main_center.removeEventListener(oe,be.keymove_select_stage),Pe._sp_main_center.removeEventListener(ne,be.keyend_select_stage),Pe._sp_bt_a.removeEventListener(_e,be.keydown_select_stage_a),Pe._set_reset()):document.removeEventListener(_e,fe.keydown_select_stage)},me=function(){h?(Pe._sp_main_center.addEventListener(oe,be.keymove_select_powermeter),Pe._sp_main_center.addEventListener(ne,be.keyend_select_powermeter),Pe._sp_bt_a.addEventListener(_e,be.keydown_select_powermeter_a)):document.addEventListener(_e,fe.keydown_select_powermeter)},pe=function(){h?(Pe._sp_main_center.removeEventListener(oe,be.keymove_select_powermeter),Pe._sp_main_center.removeEventListener(ne,be.keyend_select_powermeter),Pe._sp_bt_a.removeEventListener(_e,be.keydown_select_powermeter_a),Pe._set_reset()):document.removeEventListener(_e,fe.keydown_select_powermeter)},ge=function(){h?(Pe._sp_bt_hide.addEventListener(_e,be.keydown_game_hide),Pe._sp_bt_r.addEventListener(_e,be.keydown_game_r),Pe._sp_bt_p.addEventListener(_e,be.keydown_game_p),Pe._sp_bt_s.addEventListener(_e,be.keydown_game_s),Pe._sp_bt_b.addEventListener(_e,be.keydown_game_b),Pe._sp_bt_a.addEventListener(_e,be.keydown_game_a),Pe._sp_main_center.addEventListener(_e,be.keymove_game_controller),Pe._sp_main_center.addEventListener(oe,be.keymove_game_controller)):document.addEventListener(_e,fe.keydown_game)},ye=function(){h?(Pe._sp_bt_a.addEventListener(ne,be.keyup_game_a),Pe._sp_main_center.addEventListener(ne,be.keyend_game_controller),Pe._set_reset()):document.addEventListener(ne,fe.keyup_game)},ue=function(){h?(Pe._sp_bt_hide.removeEventListener(_e,be.keydown_game_hide),Pe._sp_bt_r.removeEventListener(_e,be.keydown_game_r),Pe._sp_bt_p.removeEventListener(_e,be.keydown_game_p),Pe._sp_bt_s.removeEventListener(_e,be.keydown_game_s),Pe._sp_bt_b.removeEventListener(_e,be.keydown_game_b),Pe._sp_bt_a.removeEventListener(_e,be.keydown_game_a),Pe._sp_main_center.removeEventListener(_e,be.keymove_game_controller),Pe._sp_main_center.removeEventListener(oe,be.keymove_game_controller)):document.removeEventListener(_e,fe.keydown_game)},xe=function(){h?(Pe._sp_bt_a.removeEventListener(ne,be.keyup_game_a),Pe._sp_main_center.removeEventListener(ne,be.keyend_game_controller),Pe._set_reset()):document.removeEventListener(ne,fe.keyup_game)},we=function(){h?(Pe._sp_bt_r.addEventListener(_e,be.keydown_gameover_r),Pe._sp_bt_s.addEventListener(_e,be.keydown_gameover_s)):document.addEventListener(_e,fe.keydown_gameover)},ve=function(){h?(Pe._sp_bt_r.removeEventListener(_e,be.keydown_gameover_r),Pe._sp_bt_s.removeEventListener(_e,be.keydown_gameover_s)):document.removeEventListener(_e,fe.keydown_gameover)},fe={keydown_start:function(t){"S"!==t.key&&"s"!==t.key||is()},keydown_select_powermeter:function(t){if(cancelAnimationFrame(a),a=null,"Enter"===t.key||"enter"===t.key)return Ge(),D._setPlay(i.playerset),!1;"ArrowUp"!==t.key&&"Up"!==t.key||c.set_pms_status({num:-1}),"ArrowDown"!==t.key&&"Down"!==t.key||c.set_pms_status({num:1}),"ArrowLeft"!==t.key&&"Left"!==t.key||c.set_pmss_status({num:-1}),"ArrowRight"!==t.key&&"Right"!==t.key||c.set_pmss_status({num:1}),c.pms_select(),D._setPlay(i.pms_select)},keydown_select_stage:function(t){if("Enter"===t.key||"enter"===t.key)return p.set_stage_map_pattern(m.mapdef_status),ts(),D._setPlay(i.playerset),!1;"ArrowLeft"!==t.key&&"Left"!==t.key||m.set_map_status({num:-1}),"ArrowRight"!==t.key&&"Right"!==t.key||m.set_map_status({num:1}),m.disp_thumb_map(),D._setPlay(i.pms_select)},keydown_gameclear:function(t){return"R"===t.key||"r"===t.key?(He(),Je(),$e(),!1):"S"===t.key||"s"===t.key?(He(),Je(),es(),!1):"P"===t.key||"p"===t.key?(ke()?(g=[],Le()):ze(),!1):(" "!==t.key&&"Spacebar"!==t.key||Ne(),"ArrowLeft"!==t.key&&"Left"!==t.key||Dt._set_move_players({x:-1,y:0}),"ArrowRight"!==t.key&&"Right"!==t.key||Dt._set_move_players({x:1,y:0}),"ArrowUp"!==t.key&&"Up"!==t.key||Dt._set_move_players({x:0,y:-1}),"ArrowDown"!==t.key&&"Down"!==t.key||Dt._set_move_players({x:0,y:1}),void("B"!==t.key&&"b"!==t.key||c.playerset()))},keydown_gameover:function(t){return"R"===t.key||"r"===t.key?(He(),Je(),$e(),!1):"S"===t.key||"s"===t.key?(He(),Je(),es(),!1):void 0},keydown_game:function(t){return!!Dt._players_obj.isalive()&&("R"===t.key||"r"===t.key?(He(),Je(),$e(),!1):"S"===t.key||"s"===t.key?(He(),Je(),es(),!1):"P"===t.key||"p"===t.key?(ke()?(g=[],Le()):ze(),!1):ke()?(g.push(t.keyCode),"38,38,40,40,37,39,37,39,66,65"===g.toString()&&c._set_hide(),!1):(" "!==t.key&&"Spacebar"!==t.key||Ne(),"ArrowLeft"!==t.key&&"Left"!==t.key||Dt._set_move_players({x:-1,y:0}),"ArrowRight"!==t.key&&"Right"!==t.key||Dt._set_move_players({x:1,y:0}),"ArrowUp"!==t.key&&"Up"!==t.key||Dt._set_move_players({x:0,y:-1}),"ArrowDown"!==t.key&&"Down"!==t.key||Dt._set_move_players({x:0,y:1}),"B"!==t.key&&"b"!==t.key||c.playerset(),!!_&&("M"!==t.key&&"m"!==t.key||Ke(),"N"!==t.key&&"n"!==t.key||Qe(),void("V"!==t.key&&"v"!==t.key||c.move()))))},keyup_game:function(t){"ArrowLeft"!==t.key&&"Left"!==t.key||Dt._set_stop_players(),"ArrowRight"!==t.key&&"Right"!==t.key||Dt._set_stop_players(),"ArrowUp"!==t.key&&"Up"!==t.key||Dt._set_stop_players(),"ArrowDown"!==t.key&&"Down"!==t.key||Dt._set_stop_players()," "!==t.key&&"Spacebar"!==t.key||He()}},be={keydown_start:function(t){is()},keydown_select_powermeter_a:function(t){return Ge(),D._setPlay(i.playerset),!1},keymove_select_powermeter:function(t){cancelAnimationFrame(a),a=null,t.preventDefault();let e=Pe._get_st(t);if(!0===ae)return!1;ae=!0,e===Pe._DEF_DIR._L&&c.set_pmss_status({num:-1}),e===Pe._DEF_DIR._U&&c.set_pms_status({num:-1}),e===Pe._DEF_DIR._R&&c.set_pmss_status({num:1}),e===Pe._DEF_DIR._D&&c.set_pms_status({num:1}),c.pms_select(),D._setPlay(i.pms_select)},keyend_select_powermeter:function(t){Pe._set_reset(),ae=!1},keymove_select_stage:function(t){if(t.preventDefault(),he)return;he=!0;let e=Pe._get_st(t);return e?(e===Pe._DEF_DIR._L&&m.set_map_status({num:-1}),e===Pe._DEF_DIR._R&&m.set_map_status({num:1}),m.disp_thumb_map(),D._setPlay(i.pms_select),!1):void 0},keyend_select_stage:function(t){he=!1},keydown_select_stage_a:function(t){return p.set_stage_map_pattern(m.mapdef_status),ts(),D._setPlay(i.playerset),!1},keydown_gameclear_r:function(t){return He(),Je(),$e(),!1},keydown_gameclear_s:function(t){return He(),Je(),$e(),!1},keydown_gameclear_p:function(t){return ke()?(g=[],Le()):ze(),!1},keydown_gameover_r:function(t){return He(),Je(),$e(),!1},keydown_gameover_s:function(t){return He(),Je(),es(),!1},keymove_game_controller:function(t){t.preventDefault();let e=Pe._get_st(t);if(!1!==e)return e===Pe._DEF_DIR._L&&Dt._set_move_players({x:-1,y:0}),e===Pe._DEF_DIR._LU&&Dt._set_move_players({x:1/Math.sqrt(2)*-1,y:1/Math.sqrt(2)*-1}),e===Pe._DEF_DIR._U&&Dt._set_move_players({x:0,y:-1}),e===Pe._DEF_DIR._RU&&Dt._set_move_players({x:1/Math.sqrt(2)*1,y:1/Math.sqrt(2)*-1}),e===Pe._DEF_DIR._R&&Dt._set_move_players({x:1,y:0}),e===Pe._DEF_DIR._RD&&Dt._set_move_players({x:1/Math.sqrt(2)*1,y:1/Math.sqrt(2)*1}),e===Pe._DEF_DIR._D&&Dt._set_move_players({x:0,y:1}),e===Pe._DEF_DIR._LD&&Dt._set_move_players({x:1/Math.sqrt(2)*-1,y:1/Math.sqrt(2)*1}),!1},keyend_game_controller:function(t){Dt._set_stop_players()},keydown_game_hide:function(t){return c._set_hide(),!1},keydown_game_r:function(t){return Je(),$e(),!1},keydown_game_s:function(t){return Je(),es(),!1},keydown_game_p:function(t){return ke()?(g=[],Le()):ze(),!1},keydown_game_a:function(t){return Ne(),!1},keydown_game_b:function(t){return c.playerset(),!1},keyup_game_a:function(t){return He(),!1}},Pe={x:0,y:0,_main_dist_within:0,_sp_main_center:new Object,_sp_main:new Object,_sp_bt_hide:new Object,_sp_bt_r:new Object,_sp_bt_p:new Object,_sp_bt_s:new Object,_sp_bt_b:new Object,_sp_bt_a:new Object,_DEF_DIR:{_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},_SP_CONTROLLER_SETINTERVAL:!1,_set_main_dist_within(t){void 0!==t&&(this._main_dist_within=t.num)},_set_sp_main_movePoint(t){let e=Pe._sp_main.getBoundingClientRect();for(let s=0;s<t.touches.length;s++)Pe._sp_main_center===t.touches[s].target&&(this.x=t.touches[s].clientX-e.left,this.y=t.touches[s].clientY-e.top)},_draw_sp_main(t){this._SP_CONTROLLER_SETINTERVAL&&(t.obj.target.style.left=parseInt(t.x)+"px",t.obj.target.style.top=parseInt(t.y)+"px")},_keymove_sp_main(t){let e=Pe;e._SP_CONTROLLER_SETINTERVAL=!0,e._set_sp_main_movePoint(t);let s=e.x-parseInt(window.getComputedStyle(e._sp_main_center).width)/2,i=e.y-parseInt(window.getComputedStyle(e._sp_main_center).height)/2;e._draw_sp_main({obj:t,x:s,y:i}),t.stopPropagation(),t.preventDefault()},_keyup_sp_main(t){Pe._SP_CONTROLLER_SETINTERVAL=!1,t.target.style.top="",t.target.style.left="",t.stopPropagation(),t.preventDefault()},_keydown_sp_bts(t){t.currentTarget.classList.add("on"),t.stopPropagation(),t.preventDefault()},_keyup_sp_bts(t){t.currentTarget.classList.remove("on"),t.stopPropagation(),t.preventDefault()},_get_st:function(t){let e=this._sp_main;this._set_sp_main_movePoint(t);let s=parseInt(window.getComputedStyle(e).width),i=parseInt(window.getComputedStyle(e).height),_=s/2-this.x,o=i/2-this.y;if(Math.sqrt(Math.pow(_,2)+Math.pow(o,2))<this._main_dist_within)return!1;let n=parseInt(180*Math.atan2(o,_)/Math.PI);return n>-40&&n<=40?this._DEF_DIR._L:n>40&&n<=50?this._DEF_DIR._LU:n>50&&n<=130?this._DEF_DIR._U:n>130&&n<=140?this._DEF_DIR._RU:n>140&&n<=180||n<-140&&n>=-180?this._DEF_DIR._R:n<-130&&n>=-140?this._DEF_DIR._RD:n<-50&&n>=-130?this._DEF_DIR._D:n<-40&&n>=-50?this._DEF_DIR._LD:void 0},_set_reset(){},_set_obj(){this._sp_main_center=document.querySelector(".sp_controller_main_center"),this._sp_main=document.querySelector(".sp_controller_main"),this._sp_bt_hide=document.querySelector(".sp_controller_bt.hide"),this._sp_bt_r=document.querySelector(".sp_controller_bt.r"),this._sp_bt_p=document.querySelector(".sp_controller_bt.p"),this._sp_bt_s=document.querySelector(".sp_controller_bt.s"),this._sp_bt_b=document.querySelector(".sp_controller_bt.b"),this._sp_bt_a=document.querySelector(".sp_controller_bt.a"),this._sp_main_center.addEventListener(oe,this._keymove_sp_main),this._sp_main_center.addEventListener(ne,this._keyup_sp_main);const t=document.querySelectorAll(".sp_controller_bt");for(let e=0;e<t.length;e++)t[e].addEventListener(_e,this._keydown_sp_bts),t[e].addEventListener(ne,this._keyup_sp_bts)}};let Me=null,Ie=null,Ce=null,je=null,Ee=!1,Se=!1,De=!1;const ke=()=>null===Me,Le=()=>{ge(),ye(),D._setPlayOnBG();const t=()=>{Me=window.requestAnimationFrame(t),p.isChangeBackgroundMain()&&!De&&(D._setPlayOnBG(i["bg_"+p.map_bgmusic]),De=!0),d.clearRect(0,0,l.width,l.height),Dt._players_obj.isalive()&&(Mt._move_background(),vt._move_maps(),p.move(),f=Dt._option_count>2?1:0,f+=Dt._shot_type===Dt._shot_type_def.LASER?1:0,f+=Dt._players_force_obj.isalive()?1:0,f=(f+=parseInt(p.get_mapdefs_difficult()))>=v.length-1?v.length-1:f,Mt._move_powercapsell(),Dt._move_shots(),mt._move_shot(),L._move_enemies(),p.isPlayersShotCollision(),Dt._enemy_shot_collision(mt._get_shot()),Dt._enemy_collision(L._get_enemies()),Wt._move_collisions(),Mt._set_powercapsell(),Dt._move_players(),Dt._set_move_draw()),Mt._draw_background(),mt._draw_shot(),L._draw_enemies(),Mt._draw_powercapsell(),Wt._draw_collisions(),Dt._draw_shots(),Dt._draw_option(),Dt._draw_players(),vt._draw_maps(),c.show(),Mt._draw_score(),Dt._players_obj.isalive()?Be():qe()};Me=window.requestAnimationFrame(t)};let Ae=!1,Oe=0,Te=!1,Ye=0,Re=0,Xe=0,Ue=new Object;const Be=()=>{if(p.isboss)if(p.isMapGameClear())We();else if(Ye>=p.get_ememies_boss().length)We();else{if(!Ae){Ae=!0;let t=p.get_ememies_boss()[Ye];t._left||(L._reset(),mt._reset()),Ke(),Ue=t._obj(),L._add_enemies(Ue),t._bgmusic()}if(p.setBackGroundSpeedY(0),p.setInifinite(!1),Te){return 0===Xe&&Qe(),p.get_ememies_boss()[Ye-1]._movex<=Xe?(Xe=0,Te=!1,void(Ae=!1)):void Xe++}if(!Ue.isalive())return Te=!0,Ye++,void(Re=0);Re++}},qe=()=>{if(ue(),xe(),D._setStopOnBG(),He(),Ke(),Dt._is_finished_player_collision)return ze(),void Ze();Dt._draw_player_collision()};let Fe=0;const Ne=()=>{if(null===Me)return;if(null!==a)return;let t=new Date;Fe=0;const e=()=>{if(a=window.requestAnimationFrame(e),(Fe=Fe>10?Fe:Fe+1)>=10){if(new Date-t<50)return;t=new Date}else if(1!==Fe)return;Dt._start_shots(),Dt._start_missile_shots()};a=window.requestAnimationFrame(e)},He=()=>{window.cancelAnimationFrame(a),a=null,Dt._stop_shots(),Dt._stop_missile_shots()},ze=()=>{D._setStopOnBG(),window.cancelAnimationFrame(Me),Me=null},Ge=()=>{He(),pe();let t=0,e=null;const s=()=>{e=window.requestAnimationFrame(s),d.clearRect(0,0,l.width,l.height),c.pms_disp(),t%5==0&&c.pms_select(),t>40&&(o=c._c_pms,n=c._c_pmss,window.cancelAnimationFrame(e),$e()),t++};e=window.requestAnimationFrame(s)},Ve=()=>{if(ue(),xe(),D._setStopOnBG(),_)return void Le();let t=0;const e=()=>{if(Ce=window.requestAnimationFrame(e),t>140)return window.cancelAnimationFrame(Ce),Ce=null,void Le();d.clearRect(0,0,l.width,l.height),Mt._move_background(),Mt._draw_background(),c.show(),Mt._draw_score(),parseInt(t/50)%2!=0||k._setDrawToText({s:"start",x:"center",y:l.height/2-30-20}),t++};Ce=window.requestAnimationFrame(e)},We=()=>{Oe>100?(Qe(),k._setDrawToText({s:"gameclear",x:"center",y:l.height/2-30-40}),k._setDrawToText({s:"press r to restart",x:"center",y:l.height/2+30,r:.3}),k._setDrawToText({s:"press s to change to another stage",x:"center",y:l.height/2+60,r:.3}),Ee=!0):Oe++},Ze=()=>{ue(),xe(),we(),ze(),d.save(),d.fillStyle="rgba(0,0,0,0.6)",d.fillRect(0,0,l.width,l.height),d.restore(),k._setDrawToText({s:"gameover",x:"center",y:l.height/2-30-40}),k._setDrawToText({s:"press r to restart",x:"center",y:l.height/2+30,r:.3}),k._setDrawToText({s:"press s to change to another stage",x:"center",y:l.height/2+60,r:.3}),Se=!0,Ee=!1},Ke=()=>{p.set_scroll_off_x()},Qe=()=>{p.set_scroll_on_x()},Je=()=>{ue(),xe(),ve(),He(),ze(),d.clearRect(0,0,l.width,l.height),vt._init(),Dt._reset(),L._reset(),mt._reset(),c="",Wt._reset(),f=0,Mt._reset(),Qt=0,Jt=0,Ae=!1,Oe=0,Te=!1,Ye=0,Re=0,Xe=0,Ue=new Object,Ee&&p.set_mapdefs_difficult(),Ee||Mt._reset_score(),je=Ee?i.background_playing_start2:i.background_playing_start,Ee=!1,Se=!1,De=!1},$e=()=>{pe(),Dt._init_players_obj(o),Dt._init_players_force_obj(o),Dt._init_option_obj(o),c=new It,p.set_gamestart(),Mt._init_background(),je=null===je?i.background_playing_start:je,je=0===p.map_bgchange?null:je,D._setOnBG(je),Ve()},ts=()=>{He(),d.clearRect(0,0,l.width,l.height),ce(),me(),(c=new It).pms_disp(),c.pms_select()},es=()=>{He(),window.cancelAnimationFrame(Ie),Ie=null,d.clearRect(0,0,l.width,l.height),le(),ue(),xe(),ve(),(m=new Ct).init(),de(),D._setPlayOnBG(i.bg_powermeterselect)};let ss=0;const is=()=>{le(),S._init_imgs(e,t=>{ss=t}).then(()=>{es()}),D._setPlay(i.opening)};window.addEventListener("load",()=>{d=l.getContext("2d"),D._init(),k.setUrlParams(),_="true"===k._url_params.debug,h&&document.querySelector("body").classList.add("sp"),E({url:"./gradius_config.json"}).then(e=>{v=e.common.difficult,Pe._set_main_dist_within({num:parseInt(e.controller_event.sp_controller_main_dist_within)}),t._init_canvas_imgs(e.canvasimgs.imgs),t._init_canvas_imgs_init(e.canvasimgs.imgs_init),t._init_canvas_audios(e.canvasimgs.audios),(p=new class{constructor(t){this.pt=t||0,this.initx=0,this.inity=0,this.x=this.initx,this.y=this.inity,this.collision=new RegExp("[1A-Z]"),this.collision_enemies=new RegExp("[a-z]","g"),this.collision_map=new RegExp("[A-Z]"),this.collision_map_d=new RegExp("[BD]"),this.t=25,this.mapdef=new Array,this.mapdef_col=new Array,this.map_theme=0,this.map_pettern=0,this.map_difficult=0,this.map_background_speed=0,this.map_backgroundY_speed=0,this.map_background_img=!1,this.map_background_initx=0,this.map_infinite=!1,this.map_bgmusic="",this.map_boss="",this.map_enemies_boss=new Object,this.map_bgchange=0,this.isboss=!1}init(){return new Promise((t,e)=>{E({url:"./gradius_map.json"}).then(e=>{Kt=e,t()},()=>{e()})})}init_map_theme(t){if(void 0!==t)for(let e in t){ie[e]={},ie[e]._map={},ie[e]._enemies={};for(let s in t[e].map)ie[e]._map[s]={_gamestart(i,_,o){vt._init_maps(o,te[t[e].map[s]]._obj({x:i,y:_}))},_getObj:i=>(i=i||{x:0,y:0,md:0},te[t[e].map[s]]._obj({x:i.x,y:i.y}))};for(let s in t[e].enemies)ie[e]._enemies[s]={_gamestart(i,_,o){L._add_enemies(ee[t[e].enemies[s]]._obj(i,_,o))},_st:ee[t[e].enemies[s]]._st,_getObj:i=>(i=i||{x:0,y:0,md:0},ee[t[e].enemies[s]]._obj(i.x,i.y,i.md))}}}init_map_enemies_boss(t){if(void 0!==t)for(let e in t)se[e]=[],t[e].map(t=>{se[e].push({_point:{x:t.obj.x||l.width,y:t.obj.y||l.height/2},_obj:function(){return $t[t.obj.img]._obj(this._point)},_movex:t.movex||0,_left:t.left||!1,_bgmusic:null===t.bgmusic||void 0===t.bgmusic?function(){}:function(){D._setPlayOnBG(i[t.bgmusic||"bg_boss"])}})})}setInifinite(t){this.map_infinite=t}set_stage_map_pattern(t){this.map_pettern=t}get_stage_map_pattern(){return this.map_pettern}get_mapdefs_difficult(){return Kt[this.map_pettern]._difficult-1}set_mapdefs_difficult(){Kt[this.map_pettern]._difficult=parseInt(Kt[this.map_pettern]._difficult)+1}set_gamestart(){const t=Kt[this.map_pettern];this.map_backgroundY_speed=0,this.x=parseInt(t._initx),this.y=this.inity,this.initx=parseInt(t._initx),this.mapdef=t._map,this.map_difficult=k._url_params.ed||parseInt(t._difficult)-1,this.map_background_img="false"!==t._background_img&&t._background_img,this.map_background_initx=parseInt(t._background_initx),this.map_background_speed=parseInt(t._speed),this.map_theme=t._theme,this.map_infinite="true"===t._map_infinite,this.map_bgmusic=t._bgmusic,this.map_boss=t._boss,this.map_bgchange=parseInt(t._bgchange)||0,this.map_enemies_boss=se[this.map_boss],this.isboss=!1,this.set_gamestart_mapdef_col(),this.set_gamestart_map_theme_objs()}get_ememies_boss(){return this.map_enemies_boss}set_gamestart_map_theme_objs(){let t=this;for(let e=0;e<t.mapdef.length;e++){let s=t.mapdef[e];for(let i=0;i<s.length;i++)if(t.isEnemiesBit(s[i])){let _=ie[t.map_theme]._enemies[s[i]],o=p.get_enemy_dir(i,e,_);_._gamestart(t.x+i*t.t,e*t.t,o)}else t.isCollisionBit(s[i])&&ie[t.map_theme]._map[s[i]]._gamestart(t.x+i*t.t,e*t.t,i+","+e)}}set_gamestart_mapdef_col(){let t=this;Object.assign(t.mapdef_col,t.mapdef);for(let e=0;e<t.mapdef_col.length;e++)t.mapdef_col[e]=t.mapdef_col[e].replace(/[a-zA-Z]/gi,"0");for(let i=0;i<t.mapdef.length;i++){let _=t.mapdef[i];for(let o=0;o<_.length;o++){if(null===_[o].match(/[A-Za-z]/))continue;let n=t.isEnemiesBit(_[o])?ie[t.map_theme]._enemies[_[o]]._getObj():ie[t.map_theme]._map[_[o]]._getObj();if(void 0===n){console.log("テーマ:"+t.map_theme+"に対して "+_[o]+"の定義がありません。");continue}let a=n._s.split(",");for(let n=0;n<a.length;n++){let h=t.mapdef_col[i+n],r=t.mapdef[i+n];void 0!==h&&void 0!==r&&(t.mapdef_col[i+n]=h.substr(0,o)+(e=h.substr(o,a[n].length),s=a[n],t.setCollisionBit(s,e))+h.substr(o+a[n].length,_.length))}}t.mapdef_col[i]=t.mapdef_col[i].substr(0,t.mapdef[i].length)}var e,s}set_mapdef_col(t,e,s){let i=this;if(void 0===t||void 0===e||void 0===s)return;let _=s.split(",");for(let s=0;s<_.length;s++){let o=i.mapdef_col[e+s];void 0!==o&&(i.mapdef_col[e+s]=o.substr(0,t)+_[s]+o.substr(t+_[s].length))}}get_enemy_dir(t,e,s){let i=s._getObj().height/this.t||1;if(!this.isMapCollision(t,e-1)&&!this.isMapCollision(t,e+Math.ceil(i)))return w._D;let _=this.isMapCollision(t,e-1)?w._U:w._D;return _=this.isMapCollision(t,e+Math.ceil(i))?w._D:w._U}getX(t){return t+-1*this.map_background_speed}getY(t){let e=this;return e.map_infinite?t-e.map_backgroundY_speed<-250?250+t-e.map_backgroundY_speed+750:t-e.map_backgroundY_speed>750?-250-(750-t+e.map_backgroundY_speed):(t-e.map_backgroundY_speed)%1e3:t}getBackGroundX(t,e){let s=t-this.map_background_speed/(e||1.3);return(s=Math.floor(10*s)/10)<=-l.width?l.width-s%l.width:s}getBackGroundY(t,e){if(!this.map_infinite)return t;let s=t-this.map_backgroundY_speed/(e||1);return(s=Math.floor(10*s)/10)<=-l.height?l.height+s%l.height:s>=l.height?-l.height+s%l.height:s}getShotY(t){return t-this.map_backgroundY_speed}setCollisionBit(t,e){let s="";for(let i=0;i<t.length;i++)"0"!==t[i]?s+="1":s+=e[i];return s}setBackGroundSpeedY(t){this.map_backgroundY_speed=t}getBackGroundSpeed(){return this.map_background_speed}getBackGroundSpeedY(){return this.map_backgroundY_speed}get_stage_map_pattern(t){return this.map_pettern}getMapX(t){return Math.floor((t+Qt-this.initx)/this.t)}getMapY(t,e){return!0===e&&(console.log("_y:"+t),console.log("_MAP_SCROLL_POSITION_Y:"+Jt)),Math.floor((t+Jt)%1e3/this.t)}isCollisionBit(t){return null!==t.match(this.collision)}isEnemiesBit(t){return null!==t.match(this.collision_enemies)}isMapBefore(t,e){return t<0}isMapLastSide(t,e){return void 0!==this.mapdef[e]&&(void 0===this.mapdef[e][t]||t===this.mapdef[e].length-1)}isMapOver(t,e){return void 0!==this.mapdef[e]&&(void 0===this.mapdef[e][t]||t>this.mapdef[e].length-1)}isMapCollision(t,e){return void 0!==this.mapdef_col[e]&&void 0!==this.mapdef_col[e][t]&&!!this.isCollisionBit(this.mapdef_col[e][t])}isMapGameClear(){if(""===this.map_boss||void 0===this.map_boss||void 0===se[this.map_boss])return!0}isChangeBackgroundMain(){return Qt>this.map_bgchange}setPlayersShotAbleCollision(t,e,s){let i=vt._obj[t+","+e];void 0!==i&&i.is_able_collision&&i.collision(s)}isPlayersShotCollision(){for(let t=0;t<Dt._shots.shot[Dt._shot_type].length;t++){let e=Dt._shots.shot[Dt._shot_type][t];for(let t=0;t<e.shots.length;t++){let s=e.shots[t];s._shot_alive&&e.map_collition(s)}}for(let t=0;t<Dt._shots.missile.length;t++){let e=Dt._shots.missile[t];if(e.player.isalive())for(let t=0;t<e.shots.length;t++){let s=e.shots[t];s._shot_alive&&(s._c>0||e.map_collition(s))}}}show(){}showMapForStageselect(t){let e=this;if(null===t||void 0===t)return;let s=t._map.length;for(let i=0;i<(s>20?20:s);i++){let s=t._map[i].length;for(let _=0;_<(s>40?40:s);_++){let s=t._map[i][_+100];if(void 0!==s&&"0"!==s)if(null!==s.match(e.collision_enemies)){let e=ie[t._theme]._enemies[s],o=p.get_enemy_dir(_+100,i,e),n=e._getObj({x:0,y:0,md:o});k._setDrawImage({img:n.img,x:0+10*_,y:130+10*i,imgPosx:n.imgPos[0],width:n.width/2.5,height:n.height/2.5,t_width:n.width,t_height:n.height,direct:n.direct,basePoint:1})}else{let e=ie[t._theme]._map[s]._getObj();k._setDrawImage({img:e.img,x:0+10*_,y:130+10*i,imgPosx:e.imgPos[0],width:e.width/2.5,height:e.height/2.5,t_width:e.width,t_height:e.height,basePoint:1})}}}d.fillStyle="rgba(0,0,0,1)",d.fillRect(0,130,50,500),d.fillRect(350,130,500,500),d.fillRect(50,330,500,500),d.beginPath(),d.lineWidth=1,d.strokeStyle="rgba(255,255,255,1)",d.fillStyle="rgba(255,255,255,1)",d.strokeRect(50,130,300,200)}set_mapdef_col_clear(){let t=this;for(let e=0;e<t.mapdef_col.length;e++){let s=t.mapdef_col[e];t.mapdef_col[e]=s.replace(/1/gi,"0")}}set_scroll_on_x(){this.map_background_speed=parseInt(Kt[this.map_pettern]._speed)}set_scroll_off_x(){this.map_background_speed=0}move(){let t=this;Qt+l.width>t.mapdef[0].length*t.t+t.initx&&(t.isboss=!0),Qt-100>t.mapdef[0].length*t.t+t.initx&&(t.map_background_speed=0),t.x+=-1*t.map_background_speed,Qt+=t.map_background_speed,Jt=function(){let e=Jt+t.map_backgroundY_speed;return e<0?(1e3+e)%1e3:e%1e3}()}}).init(),p.init_map_theme(e.map.theme),p.init_map_enemies_boss(e.map.enemies_boss)}).then(()=>D._init_audios(i,t=>{document.querySelector("#game_start_loading .rate").innerHTML=parseInt(t)+"%"})).then(()=>S._init_imgs(s)).then(()=>{if(Dt._set_shot_type("_SHOTTYPE_NORMAL"),Mt._init_score(),document.querySelector("#game_start_loading").classList.remove("on"),document.querySelector("#game_wrapper").classList.add("on"),h&&(document.querySelector("#sp_controller").classList.add("on"),Pe._set_obj()),_)return m=new Ct,p.set_stage_map_pattern(k._url_params.mp||0),void S._init_imgs(e).then(()=>{ts()});re(),(()=>{let t=0;const e=()=>{Ie=window.requestAnimationFrame(e),d.clearRect(0,0,l.width,l.height),k._setDrawImage({img:s.gradius_background.obj,width:1e3,height:500,t_width:640,t_height:418,alpha:.5,basePoint:1}),k._setDrawImage({img:s.gradius_logo.obj,x:150,y:80,width:700,height:130,basePoint:1}),k._setDrawToText({s:"no pakuri",x:"center",y:l.height/2-20,r:.7}),k._setDrawToText({s:"press s to start",x:"center",y:l.height/2+60,r:.5,alpha:parseFloat(t/100)}),t=t>=100?0:t+1,0!==ss&&k._setDrawToText({s:"now loading "+ss,x:"center",y:l.height/2+130,r:.4,alpha:t%2==0?1:0})};Ie=window.requestAnimationFrame(e)})()}).catch(()=>{console.log("json:error"),alert("エラーが発生しました。もう一度このアプリ再起動をお願いします。\nブラウザでキャッシュクリアの必要性があります")})}),window.addEventListener("touchmove",function(t){t.preventDefault()},{passive:!1});</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-117905768-1', 'auto'); ga('send', 'pageview');</script></body></html>