"use strict";const _CANVAS_IMGS={vicviper1:{src:"images/gradius_vicviper1.png",rate:.26,obj:new Image},vicviper2:{src:"images/gradius_vicviper2.png",rate:.26,obj:new Image},vicviper3:{src:"images/gradius_vicviper3.png",rate:.26,obj:new Image},vicviper4:{src:"images/gradius_vicviper4.png",rate:.26,obj:new Image},vicviper5:{src:"images/gradius_vicviper5.png",rate:.26,obj:new Image},vicviper1_e:{src:"images/gradius_vicviper1_e.png",rate:.26,obj:new Image},vicviper2_e:{src:"images/gradius_vicviper2_e.png",rate:.26,obj:new Image},vicviper3_e:{src:"images/gradius_vicviper3_e.png",rate:.26,obj:new Image},vicviper4_e:{src:"images/gradius_vicviper4_e.png",rate:.26,obj:new Image},vicviper5_e:{src:"images/gradius_vicviper5_e.png",rate:.26,obj:new Image},vicviper_back1:{src:"images/gradius_vicviper_back1.png",rate:.26,obj:new Image},vicviper_back2:{src:"images/gradius_vicviper_back2.png",rate:.26,obj:new Image},vicviper_back3:{src:"images/gradius_vicviper_back3.png",rate:.26,obj:new Image},vicviper_back1_e:{src:"images/gradius_vicviper_back1_e.png",rate:.26,obj:new Image},vicviper_bomb:{src:"images/gradius_vicviper_bomb.png",rate:1,obj:new Image},vicviper_bomb_red:{src:"images/gradius_vicviper_bomb_red.png",rate:1,obj:new Image},option:{src:"images/option.png",rate:.3,obj:new Image},missile1:{src:"images/missile1.png",rate:.5,obj:new Image},missile2:{src:"images/missile2.png",rate:.5,obj:new Image},missile3:{src:"images/missile3.png",rate:.5,obj:new Image},missile4:{src:"images/missile4.png",rate:.5,obj:new Image},missile5:{src:"images/missile5.png",rate:.5,obj:new Image},missile6:{src:"images/missile6.png",rate:.5,obj:new Image},missile7:{src:"images/missile7.png",rate:.5,obj:new Image},missile8:{src:"images/missile8.png",rate:.5,obj:new Image},shot1:{src:"images/gradius_shot1.png",rate:.4,obj:new Image},shot2:{src:"images/gradius_shot2.png",rate:.4,obj:new Image},shot3:{src:"images/gradius_shot3.png",rate:.4,obj:new Image},shot_laser_col1:{src:"images/gradius_shot_laser_col1.png",rate:.4,obj:new Image},shot_laser_col2:{src:"images/gradius_shot_laser_col2.png",rate:.4,obj:new Image},shot_laser_col3:{src:"images/gradius_shot_laser_col3.png",rate:.4,obj:new Image},shot_laser_col4:{src:"images/gradius_shot_laser_col4.png",rate:.4,obj:new Image},meter:{src:"images/gradius_meter.png",rate:.5,obj:new Image},meter_c_speedup:{src:"images/gradius_meter_c_speedup.png",rate:.5,obj:new Image},meter_c_missile:{src:"images/gradius_meter_c_missile.png",rate:.5,obj:new Image},meter_c_double:{src:"images/gradius_meter_c_double.png",rate:.5,obj:new Image},meter_c_laser:{src:"images/gradius_meter_c_laser.png",rate:.5,obj:new Image},meter_c_option:{src:"images/gradius_meter_c_option.png",rate:.5,obj:new Image},meter_c_shield:{src:"images/gradius_meter_c_shield.png",rate:.5,obj:new Image},meter_blank:{src:"images/gradius_meter_blank.png",rate:.5,obj:new Image},meter_c_blank:{src:"images/gradius_meter_c_blank.png",rate:.5,obj:new Image},forcefield1:{src:"images/gradius_forcefield1.png",rate:1,obj:new Image},forcefield2:{src:"images/gradius_forcefield2.png",rate:1,obj:new Image},forcefield_red1:{src:"images/gradius_forcefield_red1.png",rate:1,obj:new Image},forcefield_red2:{src:"images/gradius_forcefield_red2.png",rate:1,obj:new Image},shield1:{src:"images/gradius_shield1.png",rate:.4,obj:new Image},shield2:{src:"images/gradius_shield2.png",rate:.4,obj:new Image},shield_red1:{src:"images/gradius_shield_red1.png",rate:.4,obj:new Image},shield_red2:{src:"images/gradius_shield_red2.png",rate:.4,obj:new Image},enemy_a_1:{src:"images/gradius_enemy_a_1.png",rate:.55,obj:new Image},enemy_a_2:{src:"images/gradius_enemy_a_2.png",rate:.55,obj:new Image},enemy_b_1:{src:"images/gradius_enemy_b_1.png",rate:.55,obj:new Image},enemy_b_2:{src:"images/gradius_enemy_b_2.png",rate:.55,obj:new Image},enemy_c_1:{src:"images/gradius_enemy_c_1.png",rate:.4,obj:new Image},enemy_c_2:{src:"images/gradius_enemy_c_2.png",rate:.4,obj:new Image},enemy_c_3:{src:"images/gradius_enemy_c_3.png",rate:.4,obj:new Image},enemy_c_4:{src:"images/gradius_enemy_c_4.png",rate:.4,obj:new Image},enemy_d_1:{src:"images/gradius_enemy_d_1.png",rate:.2,obj:new Image},enemy_d_2:{src:"images/gradius_enemy_d_2.png",rate:.2,obj:new Image},enemy_d_3:{src:"images/gradius_enemy_d_3.png",rate:.2,obj:new Image},enemy_d_4:{src:"images/gradius_enemy_d_4.png",rate:.2,obj:new Image},enemy_e_1:{src:"images/gradius_enemy_e_1.png",rate:.2,obj:new Image},enemy_e_2:{src:"images/gradius_enemy_e_2.png",rate:.2,obj:new Image},enemy_e_3:{src:"images/gradius_enemy_e_3.png",rate:.2,obj:new Image},enemy_e_4:{src:"images/gradius_enemy_e_4.png",rate:.2,obj:new Image},enemy_f_1:{src:"images/gradius_enemy_f_1.png",rate:.4,obj:new Image},enemy_f_2:{src:"images/gradius_enemy_f_2.png",rate:.4,obj:new Image},enemy_f_3:{src:"images/gradius_enemy_f_3.png",rate:.4,obj:new Image},enemy_f_4:{src:"images/gradius_enemy_f_4.png",rate:.4,obj:new Image},enemy_g_1:{src:"images/gradius_enemy_g_1.png",rate:.4,obj:new Image},enemy_g_2:{src:"images/gradius_enemy_g_2.png",rate:.4,obj:new Image},enemy_g_3:{src:"images/gradius_enemy_g_3.png",rate:.4,obj:new Image},enemy_g_4:{src:"images/gradius_enemy_g_4.png",rate:.4,obj:new Image},enemy_m_1:{src:"images/gradius_enemy_m_1.png",rate:.24,obj:new Image},enemy_m_2:{src:"images/gradius_enemy_m_2.png",rate:.24,obj:new Image},enemy_m_3:{src:"images/gradius_enemy_m_3.png",rate:.24,obj:new Image},enemy_m_4:{src:"images/gradius_enemy_m_4.png",rate:.24,obj:new Image},enemy_m_5:{src:"images/gradius_enemy_m_5.png",rate:.24,obj:new Image},enemy_m_6:{src:"images/gradius_enemy_m_6.png",rate:.24,obj:new Image},enemy_m_7:{src:"images/gradius_enemy_m_7.png",rate:.24,obj:new Image},enemy_m_8:{src:"images/gradius_enemy_m_8.png",rate:.24,obj:new Image},enemy_m_11:{src:"images/gradius_enemy_m_11.png",rate:.22,obj:new Image},enemy_m_12:{src:"images/gradius_enemy_m_12.png",rate:.22,obj:new Image},enemy_m_13:{src:"images/gradius_enemy_m_13.png",rate:.22,obj:new Image},enemy_m_14:{src:"images/gradius_enemy_m_14.png",rate:.22,obj:new Image},enemy_m_15:{src:"images/gradius_enemy_m_15.png",rate:.22,obj:new Image},enemy_m_16:{src:"images/gradius_enemy_m_16.png",rate:.22,obj:new Image},enemy_m_17:{src:"images/gradius_enemy_m_17.png",rate:.22,obj:new Image},enemy_o_1:{src:"images/gradius_enemy_o_1.png",rate:.3,obj:new Image},enemy_o_2:{src:"images/gradius_enemy_o_2.png",rate:.3,obj:new Image},enemy_p_1:{src:"images/gradius_enemy_p_1.png",rate:.23,obj:new Image},enemy_p_2:{src:"images/gradius_enemy_p_2.png",rate:.3,obj:new Image},enemy_p_3:{src:"images/gradius_enemy_p_3.png",rate:.3,obj:new Image},enemy_p_4:{src:"images/gradius_enemy_p_4.png",rate:.3,obj:new Image},enemy_p_5:{src:"images/gradius_enemy_p_5.png",rate:.3,obj:new Image},enemy_m_a_1:{src:"images/gradius_enemy_m_a_1.png",rate:.25,obj:new Image},enemy_m_a_2:{src:"images/gradius_enemy_m_a_2.png",rate:.25,obj:new Image},enemy_m_b_1:{src:"images/gradius_enemy_m_b_1.png",rate:.25,obj:new Image},enemy_m_b_2:{src:"images/gradius_enemy_m_b_2.png",rate:.25,obj:new Image},enemy_m_z:{src:"images/gradius_enemy_m_z.png",rate:.25,obj:new Image},enemy_m_y_1:{src:"images/gradius_enemy_m_y_1.png",rate:.5,obj:new Image},enemy_m_y_2:{src:"images/gradius_enemy_m_y_2.png",rate:.5,obj:new Image},enemy_frame_1:{src:"images/gradius_enemy_frame_1.png",rate:.3,obj:new Image},enemy_frame_2:{src:"images/gradius_enemy_frame_2.png",rate:.3,obj:new Image},enemy_frame_3:{src:"images/gradius_enemy_frame_3.png",rate:.3,obj:new Image},enemy_frame_4:{src:"images/gradius_enemy_frame_4.png",rate:.3,obj:new Image},enemy_frame_5:{src:"images/gradius_enemy_frame_5.png",rate:.3,obj:new Image},enemy_frame_6:{src:"images/gradius_enemy_frame_6.png",rate:.3,obj:new Image},enemy_frame_head1:{src:"images/gradius_enemy_frame_head_1.png",rate:1,obj:new Image},enemy_frame_head2:{src:"images/gradius_enemy_frame_head_2.png",rate:1,obj:new Image},enemy_frame_head3:{src:"images/gradius_enemy_frame_head_3.png",rate:1,obj:new Image},enemy_frame_head4:{src:"images/gradius_enemy_frame_head_4.png",rate:1,obj:new Image},enemy_frame_body1:{src:"images/gradius_enemy_frame_body_1.png",rate:1,obj:new Image},enemy_bigcore:{src:"images/gradius_enemy_bigcore.png",rate:.6,obj:new Image},enemy_bigcore_1:{src:"images/gradius_enemy_bigcore_1.png",rate:.6,obj:new Image},enemy_bigcore_2:{src:"images/gradius_enemy_bigcore_2.png",rate:.6,obj:new Image},enemy_bigcore_3:{src:"images/gradius_enemy_bigcore_3.png",rate:.6,obj:new Image},enemy_bigcore_4_1:{src:"images/gradius_enemy_bigcore_4_1.png",rate:.6,obj:new Image},enemy_bigcore_4_2:{src:"images/gradius_enemy_bigcore_4_2.png",rate:.6,obj:new Image},enemy_bigcore_4_3:{src:"images/gradius_enemy_bigcore_4_3.png",rate:.6,obj:new Image},enemy_bigcore_4_4:{src:"images/gradius_enemy_bigcore_4_4.png",rate:.6,obj:new Image},enemy_bigcore_4_5:{src:"images/gradius_enemy_bigcore_4_5.png",rate:.6,obj:new Image},enemy_cristalcore:{src:"images/gradius_enemy_cristalcore.png",rate:1,obj:new Image},enemy_cristalcore_hand1:{src:"images/gradius_enemy_cristalcore_hand1.png",rate:.3,obj:new Image},enemy_cristalcore_hand2:{src:"images/gradius_enemy_cristalcore_hand2.png",rate:.4,obj:new Image},enemy_cristalcore_wall1:{src:"images/gradius_enemy_cristalcore_wall1.png",rate:1,obj:new Image},enemy_cristalcore_wall2:{src:"images/gradius_enemy_cristalcore_wall2.png",rate:1,obj:new Image},enemy_cristalcore_shot:{src:"images/gradius_enemy_cristalcore_shot.png",rate:.2,obj:new Image},enemy_cube1:{src:"images/gradius_enemy_cube1.png",rate:.25,obj:new Image},enemy_cube2:{src:"images/gradius_enemy_cube2.png",rate:.25,obj:new Image},enemy_cube3:{src:"images/gradius_enemy_cube3.png",rate:.25,obj:new Image},enemy_cube4:{src:"images/gradius_enemy_cube4.png",rate:.25,obj:new Image},enemy_bigcore2:{src:"images/gradius_enemy_bigcore2.png",rate:1,obj:new Image},enemy_bigcore2_hand1:{src:"images/gradius_enemy_bigcore2_hand1.png",rate:1,obj:new Image},enemy_bigcore2_hand2:{src:"images/gradius_enemy_bigcore2_hand2.png",rate:1,obj:new Image},enemy_bigcore2_hand3:{src:"images/gradius_enemy_bigcore2_hand3.png",rate:1,obj:new Image},enemy_bigcore2_wall:{src:"images/gradius_enemy_bigcore2_wall.png",rate:1,obj:new Image},enemy_bigcore2_core:{src:"images/gradius_enemy_bigcore2_core.png",rate:1,obj:new Image},enemy_bigcore2_back1:{src:"images/gradius_enemy_bigcore2_back1.png",rate:1,obj:new Image},enemy_bigcore2_back2:{src:"images/gradius_enemy_bigcore2_back2.png",rate:1,obj:new Image},enemy_bigcore2_back3:{src:"images/gradius_enemy_bigcore2_back3.png",rate:1,obj:new Image},enemy_bigcore2_back4:{src:"images/gradius_enemy_bigcore2_back4.png",rate:1,obj:new Image},enemy_bigcore2_back5:{src:"images/gradius_enemy_bigcore2_back5.png",rate:1,obj:new Image},enemy_bigcore2_back6:{src:"images/gradius_enemy_bigcore2_back6.png",rate:1,obj:new Image},enemy_collapes1:{src:"images/gradius_enemy_collapes1.png",rate:1,obj:new Image},enemy_collapes2:{src:"images/gradius_enemy_collapes2.png",rate:1,obj:new Image},enemy_collapes11:{src:"images/gradius_enemy_collapes11.png",rate:.2,obj:new Image},enemy_collapes12:{src:"images/gradius_enemy_collapes12.png",rate:.2,obj:new Image},enemy_collapes13:{src:"images/gradius_enemy_collapes13.png",rate:.2,obj:new Image},enemy_collapes21:{src:"images/gradius_enemy_collapes21.png",rate:.22,obj:new Image},enemy_collapes22:{src:"images/gradius_enemy_collapes22.png",rate:.22,obj:new Image},enemy_collapes23:{src:"images/gradius_enemy_collapes23.png",rate:.22,obj:new Image},enemy_collapes24:{src:"images/gradius_enemy_collapes24.png",rate:.22,obj:new Image},enemy_collapes81:{src:"images/gradius_enemy_collapes81.png",rate:.2,obj:new Image},enemy_collapes82:{src:"images/gradius_enemy_collapes82.png",rate:.2,obj:new Image},enemy_collapes83:{src:"images/gradius_enemy_collapes83.png",rate:.2,obj:new Image},enemy_collapes84:{src:"images/gradius_enemy_collapes84.png",rate:.2,obj:new Image},enemy_collapes91:{src:"images/gradius_enemy_collapes91.png",rate:.2,obj:new Image},enemy_collapes92:{src:"images/gradius_enemy_collapes92.png",rate:.2,obj:new Image},enemy_collapes93:{src:"images/gradius_enemy_collapes93.png",rate:.2,obj:new Image},enemy_collapes94:{src:"images/gradius_enemy_collapes94.png",rate:.2,obj:new Image},enemy_collapes95:{src:"images/gradius_enemy_collapes95.png",rate:.2,obj:new Image},enemy_collapes96:{src:"images/gradius_enemy_collapes96.png",rate:.2,obj:new Image},enemy_bullet1:{src:"images/gradius_enemy_bullet1.png",rate:.8,obj:new Image},enemy_bullet2:{src:"images/gradius_enemy_bullet2.png",rate:.8,obj:new Image},enemy_bullet_z:{src:"images/gradius_enemy_bullet_z.png",rate:.2,obj:new Image},enemy_bullet_laser:{src:"images/gradius_enemy_bullet_laser.png",rate:.25,obj:new Image},pc1:{src:"images/gradius_pc1.png",rate:.5,obj:new Image},pc2:{src:"images/gradius_pc2.png",rate:.5,obj:new Image},pc3:{src:"images/gradius_pc3.png",rate:.5,obj:new Image},pc4:{src:"images/gradius_pc4.png",rate:.5,obj:new Image},pc5:{src:"images/gradius_pc5.png",rate:.5,obj:new Image},pc11:{src:"images/gradius_pc11.png",rate:.5,obj:new Image},pc12:{src:"images/gradius_pc12.png",rate:.5,obj:new Image},pc13:{src:"images/gradius_pc13.png",rate:.5,obj:new Image},pc14:{src:"images/gradius_pc14.png",rate:.5,obj:new Image},map_cube_A:{src:"images/gradius_map_cube_A.png",rate:1,obj:new Image},map_moai_A:{src:"images/gradius_map_moai_A.png",rate:.5,obj:new Image},map_moai_B:{src:"images/gradius_map_moai_B.png",rate:.5,obj:new Image},map_volcano_A:{src:"images/gradius_map_volcano_A.png",rate:1,obj:new Image},map_volcano_B:{src:"images/gradius_map_volcano_B.png",rate:1,obj:new Image},map_volcano_C:{src:"images/gradius_map_volcano_C.png",rate:1,obj:new Image},map_volcano_D:{src:"images/gradius_map_volcano_D.png",rate:1,obj:new Image},map_volcano_E:{src:"images/gradius_map_volcano_E.png",rate:1,obj:new Image},map_volcano_F:{src:"images/gradius_map_volcano_F.png",rate:1,obj:new Image},map_volcano_G:{src:"images/gradius_map_volcano_G.png",rate:1,obj:new Image},map_volcano_H:{src:"images/gradius_map_volcano_H.png",rate:1,obj:new Image},map_volcano_I:{src:"images/gradius_map_volcano_I.png",rate:1,obj:new Image},map_volcano_J:{src:"images/gradius_map_volcano_J.png",rate:1,obj:new Image},map_volcano_K:{src:"images/gradius_map_volcano_K.png",rate:1,obj:new Image},map_volcano_L:{src:"images/gradius_map_volcano_L.png",rate:1,obj:new Image},map_volcano_M:{src:"images/gradius_map_volcano_M.png",rate:1,obj:new Image},map_volcano_N:{src:"images/gradius_map_volcano_N.png",rate:1,obj:new Image},map_volcano_O:{src:"images/gradius_map_volcano_O.png",rate:1,obj:new Image},map_volcano_P:{src:"images/gradius_map_volcano_P.png",rate:1,obj:new Image},map_frame_A_1:{src:"images/gradius_map_frame_A_1.png",rate:1,obj:new Image},map_frame_A_2:{src:"images/gradius_map_frame_A_2.png",rate:1,obj:new Image},map_frame_A_3:{src:"images/gradius_map_frame_A_3.png",rate:1,obj:new Image},map_frame_A_4:{src:"images/gradius_map_frame_A_4.png",rate:1,obj:new Image},map_frame_A_5:{src:"images/gradius_map_frame_A_5.png",rate:1,obj:new Image},map_frame_B_1:{src:"images/gradius_map_frame_B_1.png",rate:1,obj:new Image},map_frame_B_2:{src:"images/gradius_map_frame_B_2.png",rate:1,obj:new Image},map_frame_B_3:{src:"images/gradius_map_frame_B_3.png",rate:1,obj:new Image},map_frame_B_4:{src:"images/gradius_map_frame_B_4.png",rate:1,obj:new Image},map_frame_B_5:{src:"images/gradius_map_frame_B_5.png",rate:1,obj:new Image},map_frame_C_1:{src:"images/gradius_map_frame_C_1.png",rate:1,obj:new Image},map_frame_C_2:{src:"images/gradius_map_frame_C_2.png",rate:1,obj:new Image},map_frame_C_3:{src:"images/gradius_map_frame_C_3.png",rate:1,obj:new Image},map_frame_C_4:{src:"images/gradius_map_frame_C_4.png",rate:1,obj:new Image},map_frame_C_5:{src:"images/gradius_map_frame_C_5.png",rate:1,obj:new Image},map_frame_D_1:{src:"images/gradius_map_frame_D_1.png",rate:1,obj:new Image},map_frame_D_2:{src:"images/gradius_map_frame_D_2.png",rate:1,obj:new Image},map_frame_D_3:{src:"images/gradius_map_frame_D_3.png",rate:1,obj:new Image},map_frame_D_4:{src:"images/gradius_map_frame_D_4.png",rate:1,obj:new Image},map_frame_D_5:{src:"images/gradius_map_frame_D_5.png",rate:1,obj:new Image},map_frame_E_1:{src:"images/gradius_map_frame_E_1.png",rate:1,obj:new Image},map_frame_E_2:{src:"images/gradius_map_frame_E_2.png",rate:1,obj:new Image},map_frame_E_3:{src:"images/gradius_map_frame_E_3.png",rate:1,obj:new Image},map_frame_E_4:{src:"images/gradius_map_frame_E_4.png",rate:1,obj:new Image},map_frame_E_5:{src:"images/gradius_map_frame_E_5.png",rate:1,obj:new Image},map_frame_F_1:{src:"images/gradius_map_frame_F_1.png",rate:1,obj:new Image},map_frame_F_2:{src:"images/gradius_map_frame_F_2.png",rate:1,obj:new Image},map_frame_F_3:{src:"images/gradius_map_frame_F_3.png",rate:1,obj:new Image},map_frame_F_4:{src:"images/gradius_map_frame_F_4.png",rate:1,obj:new Image},map_frame_F_5:{src:"images/gradius_map_frame_F_5.png",rate:1,obj:new Image}},_CANVAS_IMGS_INIT={font_0:{src:"images/gradius_font_0.png",rate:1,obj:new Image},font_1:{src:"images/gradius_font_1.png",rate:1,obj:new Image},font_2:{src:"images/gradius_font_2.png",rate:1,obj:new Image},font_3:{src:"images/gradius_font_3.png",rate:1,obj:new Image},font_4:{src:"images/gradius_font_4.png",rate:1,obj:new Image},font_5:{src:"images/gradius_font_5.png",rate:1,obj:new Image},font_6:{src:"images/gradius_font_6.png",rate:1,obj:new Image},font_7:{src:"images/gradius_font_7.png",rate:1,obj:new Image},font_8:{src:"images/gradius_font_8.png",rate:1,obj:new Image},font_9:{src:"images/gradius_font_9.png",rate:1,obj:new Image},font_a:{src:"images/gradius_font_a.png",rate:1,obj:new Image},font_b:{src:"images/gradius_font_b.png",rate:1,obj:new Image},font_c:{src:"images/gradius_font_c.png",rate:1,obj:new Image},font_d:{src:"images/gradius_font_d.png",rate:1,obj:new Image},font_e:{src:"images/gradius_font_e.png",rate:1,obj:new Image},font_f:{src:"images/gradius_font_f.png",rate:1,obj:new Image},font_g:{src:"images/gradius_font_g.png",rate:1,obj:new Image},font_h:{src:"images/gradius_font_h.png",rate:1,obj:new Image},font_i:{src:"images/gradius_font_i.png",rate:1,obj:new Image},font_j:{src:"images/gradius_font_j.png",rate:1,obj:new Image},font_k:{src:"images/gradius_font_k.png",rate:1,obj:new Image},font_l:{src:"images/gradius_font_l.png",rate:1,obj:new Image},font_m:{src:"images/gradius_font_m.png",rate:1,obj:new Image},font_n:{src:"images/gradius_font_n.png",rate:1,obj:new Image},font_o:{src:"images/gradius_font_o.png",rate:1,obj:new Image},font_p:{src:"images/gradius_font_p.png",rate:1,obj:new Image},font_q:{src:"images/gradius_font_q.png",rate:1,obj:new Image},font_r:{src:"images/gradius_font_r.png",rate:1,obj:new Image},font_s:{src:"images/gradius_font_s.png",rate:1,obj:new Image},font_t:{src:"images/gradius_font_t.png",rate:1,obj:new Image},font_u:{src:"images/gradius_font_u.png",rate:1,obj:new Image},font_v:{src:"images/gradius_font_v.png",rate:1,obj:new Image},font_w:{src:"images/gradius_font_w.png",rate:1,obj:new Image},font_x:{src:"images/gradius_font_x.png",rate:1,obj:new Image},font_y:{src:"images/gradius_font_y.png",rate:1,obj:new Image},font_z:{src:"images/gradius_font_z.png",rate:1,obj:new Image},"font_:":{src:"images/gradius_font_27.png",rate:1,obj:new Image},gradius_powermeterselect:{src:"images/gradius_powermeterselect.png",rate:.28,obj:new Image},gradius_powermeterselect_shield:{src:"images/gradius_powermeterselect_shield.png",rate:.28,obj:new Image},gradius_powermeterselect_shield_:{src:"images/gradius_powermeterselect_shield_.png",rate:.28,obj:new Image},gradius_powermeterselect_0:{src:"images/gradius_powermeterselect_0.png",rate:.28,obj:new Image},gradius_powermeterselect_1:{src:"images/gradius_powermeterselect_1.png",rate:.28,obj:new Image},gradius_powermeterselect_2:{src:"images/gradius_powermeterselect_2.png",rate:.28,obj:new Image},gradius_powermeterselect_3:{src:"images/gradius_powermeterselect_3.png",rate:.28,obj:new Image},gradius_powermeterselect_shield_0:{src:"images/gradius_powermeterselect_shield_0.png",rate:.28,obj:new Image},gradius_powermeterselect_shield_1:{src:"images/gradius_powermeterselect_shield_1.png",rate:.28,obj:new Image}},_CANVAS_AUDIOS={shot_laser:{src:"audios/shot_laser.mp3",volume:1,obj:null,buf:new Object},missile:{src:"audios/missile.mp3",volume:1,obj:null,buf:new Object},shot_normal:{src:"audios/shot_normal.mp3",volume:1,obj:null,buf:new Object},shot_ripple:{src:"audios/shot_ripple.mp3",volume:1,obj:null,buf:new Object},vicviper_bomb:{src:"audios/vicviper_bomb.mp3",volume:1,obj:null,buf:new Object},vicviper_shield_reduce:{src:"audios/vicviper_shield_reduce.mp3",volume:1,obj:null,buf:new Object},pc:{src:"audios/pc.mp3",volume:1,obj:null,buf:new Object},playerset:{src:"audios/playerset.mp3",volume:1,obj:null,buf:new Object},pms_select:{src:"audios/pms_select.mp3",volume:1,obj:null,buf:new Object},enemy_bullet_laser:{src:"audios/enemy_bullet_laser.mp3",volume:1,obj:null,buf:new Object},enemy_collision1:{src:"audios/enemy_collision1.mp3",volume:1,obj:null,buf:new Object},enemy_collision2:{src:"audios/enemy_collision2.mp3",volume:1,obj:null,buf:new Object},enemy_collision3:{src:"audios/enemy_collision3.mp3",volume:1,obj:null,buf:new Object},enemy_collision4:{src:"audios/enemy_collision4.mp3",volume:1,obj:null,buf:new Object},enemy_collision5:{src:"audios/enemy_collision5.mp3",volume:1,obj:null,buf:new Object},enemy_collision6:{src:"audios/enemy_collision6.mp3",volume:1,obj:null,buf:new Object},enemy_all_out:{src:"audios/enemy_all_out.mp3",volume:1,obj:null,buf:new Object},enemy_cube:{src:"audios/enemy_cube.mp3",volume:1,obj:null,buf:new Object},bg_powermeterselect:{src:"audios/bg_powermeterselect.mp3",volume:1,obj:null,buf:new Object},bg_boss:{src:"audios/bg_boss.mp3",volume:1,obj:null,buf:new Object},bg_type1:{src:"audios/bg_moai.mp3",volume:1,obj:null,buf:new Object},bg_type2:{src:"audios/bg_volcano.mp3",volume:1,obj:null,buf:new Object},bg_type3:{src:"audios/bg_crystal.mp3",volume:1,obj:null,buf:new Object},bg_type4:{src:"audios/bg_frame.mp3",volume:1,obj:null,buf:new Object},bg_type5:{src:"audios/bg_thunderbolt.mp3",volume:1,obj:null,buf:new Object}};class GameObject_ENEMY{constructor(_o,_x,_y){this.id=_ENEMIES.length,this.gid=0,this.img=_o,this.audio_collision=_CANVAS_AUDIOS.enemy_collision1,this.audio_alive=_CANVAS_AUDIOS.enemy_collision3,this.x=_x||0,this.y=_y||0,this.isshot=!1,this._DEF_DIR={_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},this._DEF_SHOTSTATUS={_SHOTTYPE_NORMAL:1,_SHOTTYPE_MISSILE:2,_SHOTTYPE_DOUBLE:1,_SHOTTYPE_RIPPLE_LASER:1.5,_SHOTTYPE_LASER:1},this.alpha=1,this._c=0,this.speed=1,this.getscore=200,this.direct=this._DEF_DIR._U,this._standby=!0,this._isshow=!0,this._status=1,this.haspc=!1,this._collision_type="t0",this.is_able_collision=!0,this.is_ignore_collision=!1,this.shotColMap=["0,0,"+this.img.width+","+this.img.height],this.col_date=null,this.col_canint=150}init(){this._status=0,this._isshow=!1}collision(_s_type,_num){return!!this.isCollision()&&(!this.is_able_collision||(this.setStatus(_s_type,_num),!0))}isAbleCollision(){return this.is_able_collision}isIgnoreCollision(){return this.is_ignore_collision}isCollision(){let _this=this;return null===_this.col_date?(_this.col_date=new Date,!0):new Date-_this.col_date>_this.col_canint&&(_this.col_date=new Date,!0)}setAlive(){let _this=this;_this.isalive()?_GAME._setPlay(_this.audio_alive):(_SCORE.set(_this.getscore),_GAME._setPlay(_this.audio_collision))}setStatus(_s_type,_num){this._status-=this._DEF_SHOTSTATUS[_s_type]||1,this.setAlive()}getEnemyCenterPosition(){return{_x:this.x+this.img.width/2,_y:this.y+this.img.height/2}}isalive(){return this._status>0}isshow(){return this._isshow}shot(){_GAME.isEnemyCanvasOut(this)||Math.random()>=_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SHOT_RATE||_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(this.getEnemyCenterPosition()._x,this.getEnemyCenterPosition()._y))}get_move_bound_val(){return parseInt(2*Math.random()+1)*(Math.random()>.5?1:-1)}setDrawImageRotate(_deg){_CONTEXT.save(),_CONTEXT.translate(this.x+this.img.width/2,this.y+this.img.height/2),_CONTEXT.rotate(_deg*Math.PI/180),_CONTEXT.drawImage(this.img,-this.img.width/2,-this.img.height/2,this.img.width,this.img.height),_CONTEXT.restore()}setDrawImageAlpha(_alpha){_CONTEXT.save(),_CONTEXT.globalAlpha=_alpha,_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height),_CONTEXT.restore(),this.alpha=_alpha}setDrawImage(){_CONTEXT.save(),this.setDrawImageDirect(),_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height),_CONTEXT.restore()}setDrawImageDirect(){let _this=this;_this.direct===_this._DEF_DIR._U&&_CONTEXT.setTransform(1,0,0,-1,0,2*_this.y+_this.img.height),_this.direct===_this._DEF_DIR._LU&&_CONTEXT.setTransform(-1,0,0,-1,2*_this.x+_this.img.width,2*_this.y+_this.img.height),_this.direct===_this._DEF_DIR._LD&&_CONTEXT.setTransform(-1,0,0,1,2*_this.x+_this.img.width,0)}isStandBy(){return this._standby}isCanvasOut(){return _GAME.isEnemyCanvasOut(this,{up:!1,down:!1,left:!0,right:!1})}showCollapes(_x,_y){let _this=this;_this._isshow=!1,_this.haspc?_POWERCAPSELLS.push(new GameObject_POWERCAPSELL(_this.x,_this.y)):_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(_x||_this.x+_this.img.width/2,_y||_this.y+_this.img.height/2,_this._collision_type))}isMove(){let _this=this;return _this.isStandBy()?(_this.move_standby(),!1):_this.isCanvasOut()?(_this._status=0,_this._isshow=!1,!1):!!_this.isshow()&&(!!_this.isalive()||(_this.showCollapes(),!1))}moveDraw(){this.setDrawImage(),this.shot()}move_standby(){let _this=this;_this.x<_CANVAS.width-20&&(_this._standby=!1)}move(){this.x=_MAP.getX(this.x),this.y=_MAP.getY(this.y),this.isMove()&&this.moveDraw()}}class ENEMY_a extends GameObject_ENEMY{constructor(_x,_y,_d){super(_CANVAS_IMGS.enemy_a_1.obj,_x,_y);this._status=1,this.direct=_d||this._DEF_DIR._U,this.defimg=[_CANVAS_IMGS.enemy_a_1.obj,_CANVAS_IMGS.enemy_a_2.obj]}setDrawImageDirect(){let _this=this;_this.direct===_this._DEF_DIR._U&&(_PLAYERS_MAIN.x<_this.x?_CONTEXT.setTransform(1,0,0,-1,0,2*_this.y+_this.img.height):_CONTEXT.setTransform(-1,0,0,-1,2*_this.x+_this.img.width,2*_this.y+_this.img.height)),_this.direct===_this._DEF_DIR._D&&(_PLAYERS_MAIN.x<_this.x?_CONTEXT.setTransform(1,0,0,1,0,0):_CONTEXT.setTransform(-1,0,0,1,2*_this.x+_this.img.width,0))}moveDraw(){this.img=Math.abs(_PLAYERS_MAIN.y-this.y)>100?this.defimg[0]:this.defimg[1],this.setDrawImage(),this.shot()}}class ENEMY_b extends ENEMY_a{constructor(_x,_y,_d){super(_x,_y,_d);this.direct=_d||this._DEF_DIR._U,this.haspc=!0,this.defimg=[_CANVAS_IMGS.enemy_b_1.obj,_CANVAS_IMGS.enemy_b_2.obj]}}class ENEMY_c extends GameObject_ENEMY{constructor(_x,_y,_d){super(_CANVAS_IMGS.enemy_c_1.obj,_x,_y);let _this=this;_this.x=_x,_this.y=_d===_this._DEF_DIR._D?_y-(_CANVAS_IMGS.enemy_c_1.obj.height-_MAP.t):_y,_this._st="_st1",_this._shot=!1,_this._status=1,_this.direct=_d||_this._DEF_DIR._U,_this._collision_type="t1",_this.speed=_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SPEED,_this._c_shotstep=0,_this.shotstep=[{img:_CANVAS_IMGS.enemy_c_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_4.obj,scale:1}],_this._c_walkstep=0,_this.walkstep=[{img:_CANVAS_IMGS.enemy_c_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_2.obj,scale:1}],_this._c_walk=0;_this.shotColMap=_d===_this._DEF_DIR._D?["10,10,43,42"]:["0,0,43,32"],_this._ene_status={_st1:{_f:function(){!0!==_this._shot&&(_this._c_walkstep=19===_this._c_walkstep?0:_this._c_walkstep+1,_this.img=_this.walkstep[parseInt(_this._c_walkstep/10)].img,_this._c_walk++)},_setX:function(){return _this.x+2*_this.speed}},_st2:{_f:function(){if(!(_this.x>=_CANVAS.width)){if(_this._shot=!0,_this._c_shotstep>=19)return _this.shot(),_this._c_shotstep=0,_this._shot=!1,void(_this._st="_st1");_this._c_shotstep+=1,_this.img=_this.img=_this.shotstep[parseInt(_this._c_shotstep/10)].img}},_setX:function(){return _this.x}}}}map_collition(){let _this=this,_e=_this.getEnemyCenterPosition(),_map_x=_MAP.getMapX(_e._x),_map_y=_MAP.getMapY(_e._y);_MAP.isMapBefore(_map_x,_map_y)&&(_this.speed=Math.abs(_this.speed)),_MAP.isMapLastSide(_map_x,_map_y)&&(_this.speed=-1*_this.speed);let _s=_MAP.t;_s=2*Math.abs(_this.speed);let _f=_MAP.isMapCollision(_map_x+1,_map_y)||_MAP.isMapCollision(_map_x-1,_map_y);var _t;_this.y=(_t=_this).direct===_this._DEF_DIR._U?_f?_t.y+_s:_t.y:_t.direct===_this._DEF_DIR._D?_f?_t.y-_s:_t.y:void 0,_this.y=function(_t){return _t.direct===_this._DEF_DIR._U?_MAP.isMapCollision(_map_x,_map_y-1)?_t.y:_t.y-_s:_t.direct===_this._DEF_DIR._D?_MAP.isMapCollision(_map_x,_map_y+1)?_t.y:_t.y+_s:void 0}(_this)}setDrawImageDirect(){let _this=this;_this.direct===_this._DEF_DIR._U&&(_PLAYERS_MAIN.x<_this.x?_CONTEXT.setTransform(1,0,0,-1,0,2*_this.y+_this.img.height):_CONTEXT.setTransform(-1,0,0,-1,2*_this.x+_this.img.width,2*_this.y+_this.img.height)),_this.direct===_this._DEF_DIR._D&&(_PLAYERS_MAIN.x<_this.x?_CONTEXT.setTransform(1,0,0,1,0,0):_CONTEXT.setTransform(-1,0,0,1,2*_this.x+_this.img.width,0))}set_speed(){let _p=_PLAYERS_MAIN.getPlayerCenterPosition();this._c_walk>5e3*Math.random()&&(this._c_walk=0,this.speed=_p._x<this.x?-1*this.speed:Math.abs(this.speed))}shot(){if(_GAME.isEnemyCanvasOut(this))return;let _p=_PLAYERS_MAIN.getPlayerCenterPosition(),_e=this.getEnemyCenterPosition(),_x=_p._x>_e._x?1:-1,_y=this.direct===this._DEF_DIR._U?1:-1;_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT2(_e._x,_e._y,_x,_y)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT2(_e._x,_e._y,_x,_y/2))}moveDraw(){this.map_collition(),this.set_speed(),this._st=Math.random()<_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SHOT_RATE||this._shot?"_st2":"_st1",this._ene_status[this._st]._f(),this.x=this._ene_status[this._st]._setX(),this.setDrawImage()}}class ENEMY_d extends GameObject_ENEMY{constructor(_x,_y,_d){super(_CANVAS_IMGS.enemy_d_1.obj,_x,_y);this._status=1,this.speed=2,this._col_c=0,this.col=[{img:_CANVAS_IMGS.enemy_d_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_4.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_2.obj,scale:1}]}moveDraw(){this.x+=-1*this.speed;let _d=this.x,_v=Math.cos(_d*Math.PI/180);var _t;this.y+=_v,this.img=((_t=this)._col_c=_t._col_c>=5*_t.col.length-1?0:_t._col_c+1,_t.col[parseInt(_t._col_c/5)].img),this.setDrawImage(),this.shot()}}class ENEMY_e extends ENEMY_d{constructor(_x,_y,_d){super(_x,_y,_d);this.haspc=!0,this._col_c=0,this.col=[{img:_CANVAS_IMGS.enemy_e_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_4.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_2.obj,scale:1}],this.defimg=this.col}}class ENEMY_f extends GameObject_ENEMY{constructor(_x,_y,_d){super(_CANVAS_IMGS.enemy_f_1.obj,_x,_y);this._status=1,this.haspc=!1,this._v=0,this.direct=_d||this._DEF_DIR._U,this.speed=_d===this._DEF_DIR._U?-.05:.05,this._col_c=0,this.col=[{img:_CANVAS_IMGS.enemy_f_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_4.obj,scale:1}]}getDir(){return this.x>_CANVAS.width/2?-1:.5}isCanvasOut(){return _GAME.isEnemyCanvasOut(this,{up:!0,down:!0,left:!1,right:!1})}shot(){let _e=this.getEnemyCenterPosition();_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_e._x,_e._y,1,_e._y)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_e._x,_e._y,_e._x-_CANVAS.width/4,1)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_e._x,_e._y,_e._x,1)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_e._x,_e._y,_e._x+_CANVAS.width/4,1)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_e._x,_e._y,_CANVAS.width,_e._y)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_e._x,_e._y,_e._x+_CANVAS.width/4,_CANVAS.height)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_e._x,_e._y,_e._x,_CANVAS.height)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_e._x,_e._y,_e._x-_CANVAS.width/4,_CANVAS.height))}move_standby(){let _this=this;_this.x+_this.img.width<0&&(_this._standby=!1)}moveDraw(){let _this=this;_this.x+=4*_this.getDir(),_this.y+=_this._v,_this._v+=_this.speed;let _e=_this.getEnemyCenterPosition(),_mx=_MAP.getMapX(_e._x),_my=_MAP.getMapY(_e._y);var _t;_MAP.isMapCollision(_mx,_my)&&(_this._v+=_this.speed,_this._v*=-1),_this.img=((_t=_this)._col_c=_t._col_c>=5*_t.col.length-1?0:_t._col_c+1,_t.col[parseInt(_t._col_c/5)].img),_this.setDrawImage(),_this._v>0&&_this._v<.05&&_this.shot()}}class ENEMY_g extends ENEMY_f{constructor(_x,_y,_d){super(_x,_y,_d);this._status=1,this.haspc=!0,this.col=[{img:_CANVAS_IMGS.enemy_g_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_4.obj,scale:1}]}}class ENEMY_m extends GameObject_ENEMY{constructor(_x,_y,_d){super(_CANVAS_IMGS.enemy_m_1.obj,_x,_y);this._status=4,this._collision_type="t1",this.direct=_d||this._DEF_DIR._U,this.getscore=200,this._col_c=0,this._isopen=!1,this._open_count=0,this.col=[{img:_CANVAS_IMGS.enemy_m_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_4.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_1.obj,scale:1}],this.col2=[{img:_CANVAS_IMGS.enemy_m_5.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_6.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_7.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_8.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_7.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_6.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_5.obj,scale:1}]}moveDraw(){let _this=this;_this.isalive()?(_this.img=function(_t){let _t_col=_t._status<=1?_t.col2:_t.col;return _t._isopen?(_t._open_count++,3===parseInt(_t._col_c/5)&&_t._open_count<=200?_t_col[parseInt(_t._col_c/5)].img:(_t._open_count>200&&_t._col_c>=5*_t_col.length-1&&(_t._col_c=0,_t._open_count=0,_t._isopen=!1),_t._col_c=_t._col_c>=5*_t_col.length-1?0:_t._col_c+1,_t_col[parseInt(_t._col_c/5)].img)):(_this.x>=690&&_this.x<700&&(_this._isopen=!0),_this.x>=380&&_this.x<400&&(_this._isopen=!0),_t_col[0].img)}(_this),function(_t){if(!_t._isopen)return;if(_t._open_count%15!=0)return;let _cls=new ENEMY_m_small(_this.x+15,_this.y,_this.direct);_ENEMIES.push(_cls)}(_this),_this.setDrawImage()):_this.showCollapes(0,_this.direct===_this._DEF_DIR._U?0:-_MAP.t)}}class ENEMY_m_small extends GameObject_ENEMY{constructor(_x,_y,_d){super(_CANVAS_IMGS.enemy_m_11.obj,_x,_y);this._status=1,this.direct=_d||this._DEF_DIR._U,this.speed=2,this.getscore=100,this._col_c=0,this.col=[{img:_CANVAS_IMGS.enemy_m_11.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_12.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_13.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_14.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_15.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_16.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_17.obj,scale:1}],this._change=!1,this._moveX=0,this._moveY=0}isCanvasOut(){return _GAME.isEnemyCanvasOut(this)}moveDraw(){let _this=this,_p=_PLAYERS_MAIN.getPlayerCenterPosition();var _t;_this._change=!!_this._change||(_this.direct===_this._DEF_DIR._U&&_p._y<_this.y?(_this._moveX=_p._x<_this.x?-1*_this.speed:_this.speed,!0):_this.direct===_this._DEF_DIR._D&&_p._y>_this.y&&(_this._moveX=_p._x<_this.x?-1*_this.speed:_this.speed,!0)),_this._moveY=_this._change?0:_this.direct===_this._DEF_DIR._U?_this.speed:_this.direct===_this._DEF_DIR._D?-1*_this.speed:void 0,_this.x+=_this._moveX,_this.y+=_this._moveY,_this.img=((_t=_this)._col_c=_t._col_c>=5*_t.col.length-1?0:_t._col_c+1,_t.col[parseInt(_t._col_c/5)].img),_this.setDrawImage(),_this.shot()}}class ENEMY_n extends GameObject_ENEMY{constructor(_x,_y){super(_CANVAS_IMGS.enemy_o_1.obj,_x,_y)}isCanvasOut(){return this.x<200}isalive(){return!0}moveDraw(){if(Math.random()>.2)return;let _cls=new ENEMY_n_small(_CANVAS_IMGS[["enemy_o_1","enemy_o_2"][Math.random()>.5?1:0]].obj,this.x,this.y);_ENEMIES.push(_cls)}}class ENEMY_o extends ENEMY_n{constructor(_d,_x,_y){super(_d,_x,_y)}moveDraw(){if(Math.random()>.1)return;let _cls=new ENEMY_o_small(_CANVAS_IMGS[["enemy_o_1","enemy_o_2"][Math.random()>.5?1:0]].obj,this.x,this.y);_ENEMIES.push(_cls)}}class ENEMY_o_small extends GameObject_ENEMY{constructor(_d,_x,_y){super(_d,_x,_y);this._status=1,this.getscore=100,this.speedX=4*Math.random()+1,this.flagX=Math.random()>.5?1:-1,this.speedY=.2,this._v=-10,this._collision_type="t2"}map_collition(){let _this=this,_e=_this.getEnemyCenterPosition(),_map_x=_MAP.getMapX(_e._x),_map_y=_MAP.getMapY(_e._y);_MAP.isMapCollision(_map_x,_map_y-1)&&(_this._status=0)}moveDraw(){this.map_collition(),this.x-=this.speedX*this.flagX,this.y+=this._v,this._v+=this.speedY,_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}}class ENEMY_n_small extends ENEMY_o_small{constructor(_d,_x,_y){super(_d,_x,_y);this.speedY=-.2,this._v=10}map_collition(){let _this=this,_e=_this.getEnemyCenterPosition(),_map_x=_MAP.getMapX(_e._x),_map_y=_MAP.getMapY(_e._y);_MAP.isMapCollision(_map_x,_map_y+1)&&(_this._status=0)}}class ENEMY_p extends GameObject_ENEMY{constructor(_x,_y,_d){super(_CANVAS_IMGS.enemy_p_1.obj,_x,_y);this._status=4,this.getscore=100,this.speedx=_BACKGROUND_SPEED,this.speedy=(Math.random()+1)*(Math.random()>.5?1:-1),this._isbroken=!1,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5}setAlive(){this.isalive()||_SCORE.set(this.getscore)}map_collition(){let _this=this,_e=_this.getEnemyCenterPosition(),_map_x=_MAP.getMapX(_e._x),_map_y=_MAP.getMapY(_e._y);(_MAP.isMapCollision(_map_x,_map_y-1)||_MAP.isMapCollision(_map_x,_map_y+1))&&(_this.speedx=Math.random()>.4?Math.abs(_this.speedx):-1*_this.speedx,_this.speedy=Math.random()>.4?Math.abs(_this.speedy):-1*_this.speedy)}move_bounds(){let _this=this,_eb=_ENEMIES;if(_this.isalive())for(let _i=0;_i<_eb.length;_i++){if(!ENEMY_p.prototype.isPrototypeOf(_eb[_i]))continue;if(!_eb[_i].isalive())continue;if(_eb[_i].x>_CANVAS.width)continue;if(_this.id===_eb[_i].id)continue;_GAME.isSqCollision(_this.shotColMap[0],_this.x+","+_this.y,_eb[_i].shotColMap,_eb[_i].x+","+_eb[_i].y)!==_IS_SQ_NOTCOL&&(_this.speedx=_this.get_move_bound_val(),_this.speedy=_this.get_move_bound_val(),_eb[_i].speedx=_this.get_move_bound_val(),_eb[_i].speedy=_this.get_move_bound_val())}}showCollapes(){let _this=this,_cp=_this.getEnemyCenterPosition();if(_this._status<=0&&!_this._isbroken){for(let _i=0;_i<6;_i++){let _cls=new ENEMY_p_small(_CANVAS_IMGS[["enemy_p_2","enemy_p_2","enemy_p_3","enemy_p_4","enemy_p_5","enemy_p_5"][_i]].obj,_cp._x+[-30,0,30,-30,0,30][_i],_cp._y+[-30,-30,-30,30,30,30][_i]);_ENEMIES.push(_cls)}return _this._isbroken=!0,_GAME._setPlay(_CANVAS_AUDIOS.enemy_collision4),void _this.init()}}moveDraw(){var _t;this.map_collition(),this.move_bounds(),this.x-=((_t=this).x+_t.img.width>_CANVAS.width&&(_t.speedx=Math.abs(_t.speedx)),_t.speedx),this.y+=function(_t){return _t.y<0?_t.speedy=Math.abs(_t.speedy):_t.y+_t.img.height>_CANVAS.height&&(_t.speedy=-1),_t.speedy}(this),_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}}class ENEMY_p_small extends GameObject_ENEMY{constructor(_d,_x,_y){super(_d,_x,_y);this.audio_collision=_CANVAS_AUDIOS.enemy_collision5,this._status=5,this.getscore=500,this.speedx=this.get_move_bound_val(),this.speedy=this.get_move_bound_val(),this.col_date=new Date,this._collision_type="t1"}setAlive(){this.isalive()||(_SCORE.set(this.getscore),_GAME._setPlay(_CANVAS_AUDIOS.enemy_collision5))}move_bounds(){let _this=this;if(new Date-_this.col_date<1e3)return;let _eb=_ENEMIES;if(_this.isalive())for(let _i=0;_i<_eb.length;_i++){if(!ENEMY_p_small.prototype.isPrototypeOf(_eb[_i]))continue;if(!_eb[_i].isalive())continue;if(_eb[_i].x>_CANVAS.width)continue;if(_this.id===_eb[_i].id)continue;_GAME.isSqCollision(_this.shotColMap[0],_this.x+","+_this.y,_eb[_i].shotColMap,_eb[_i].x+","+_eb[_i].y)!==_IS_SQ_NOTCOL&&(_this.speedx=_this.get_move_bound_val(),_this.speedy=_this.get_move_bound_val(),_eb[_i].speedx=_this.get_move_bound_val(),_eb[_i].speedy=_this.get_move_bound_val())}}map_collition(){let _this=this,_e=_this.getEnemyCenterPosition(),_map_x=_MAP.getMapX(_e._x),_map_y=_MAP.getMapY(_e._y);(_MAP.isMapCollision(_map_x,_map_y-1)||_MAP.isMapCollision(_map_x,_map_y+1))&&(_this.speedx=_this.speedx<=0?Math.abs(_this.speedx):-1*_this.speedx,_this.speedy=_this.speedy<=0?Math.abs(_this.speedy):-1*_this.speedy)}moveDraw(){var _t;this.map_collition(),this.move_bounds(),this.x-=((_t=this).x+_t.img.width>_CANVAS.width&&(_t.speedx=1.5),_t.speedx),this.y+=function(_t){return _t.y<0?_t.speedy=Math.abs(_t.speedy):_t.y+_t.img.height>_CANVAS.height&&(_t.speedy=-1.5),_t.speedy}(this),_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}}class ENEMY_q extends GameObject_ENEMY{constructor(_x,_y,_d){super(_CANVAS_IMGS.enemy_m_a_1.obj,_x,_y);let _this=this;_this._status=2,_this.direct=_d||_this._DEF_DIR._U,_this.getscore=500,_this._isSetMapDefCol=!1,_this._isopen=!1,_this._open_count=0,_this.imgs=[_CANVAS_IMGS.enemy_m_a_1.obj,_CANVAS_IMGS.enemy_m_a_2.obj],_this.audio_collision=_CANVAS_AUDIOS.enemy_collision5,_this._collision_type="t8",_this._collision_posy=_this.direct===_this._DEF_DIR._D?25:0,_this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,_this.shotColMap=[_this.direct===_this._DEF_DIR._D?"0,50,35,85":_this.direct===_this._DEF_DIR._U?"0,25,35,50":_this.direct===_this._DEF_DIR._LD?"75,55,100,70":_this.direct===_this._DEF_DIR._LU?"75,35,100,50":void 0]}collision(_s_type,_num){this._isopen&&this.isCollision()&&this.setStatus(_s_type,_num)}isShot(){let _this=this;return!(_this._status<=0)&&(!_GAME.isEnemyCanvasOut(_this)&&(!(Math.abs(_PLAYERS_MAIN.y-_this.y)>100)&&(_this.direct!==_this._DEF_DIR._LU&&_this.direct!==_this._DEF_DIR._LD||!(_PLAYERS_MAIN.x<_this.x))))}shot(){let _this=this;!_this._open_count>0&&!_this.isShot()||_this._open_count++,_this._open_count>0&&(_this.img=_this.imgs[1],_this._isopen=!0),_this._open_count>200&&(_this.img=_this.imgs[0],_this._isopen=!1,_this._open_count=-100),_this._open_count<=0||_this._open_count%10==0&&_ENEMIES.push(new ENEMY_qr(_CANVAS_IMGS.enemy_m_y_1.obj,_this.x+parseInt(_this.shotColMap[0].split(",")[0]),_this.y+parseInt(_this.shotColMap[0].split(",")[1]),_this.direct))}showCollapes(){let _this=this;_this.img=_CANVAS_IMGS.enemy_m_z.obj,_this.setDrawImage(),_this._isSetMapDefCol||(_MAP.set_mapdef_col(_MAP.getMapX(_this.x),_MAP.getMapY(_this.y),_this.direct===_this._DEF_DIR._D?"0000,0000,0000,1111":_this.direct===_this._DEF_DIR._U?"1111,0000,0000,0000":_this.direct===_this._DEF_DIR._LD?"0000,0000,0000,1111":_this.direct===_this._DEF_DIR._LU?"1111,0000,0000,0000":void 0),_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(_this.x+_this.img.width/2,_this.y+_this.img.height/2+_this._collision_posy,_this._collision_type)),_this._isSetMapDefCol=!0)}moveDraw(){this.setDrawImage(),this.shot()}}class ENEMY_r extends ENEMY_q{constructor(_x,_y,_d){super(_x,_y,_d);let _this=this;_this._status=2,_this.direct=_d||_this._DEF_DIR._U,_this.imgs=[_CANVAS_IMGS.enemy_m_b_1.obj,_CANVAS_IMGS.enemy_m_b_2.obj],_this.img=_this.imgs[0],_this._collision_posy=_this.direct===_this._DEF_DIR._D?-10:0,_this.shotColMap=[_this.direct===_this._DEF_DIR._D?"20,40,50,85":_this.direct===_this._DEF_DIR._U?"20,25,50,70":void 0]}}class ENEMY_qr extends GameObject_ENEMY{constructor(_o,_x,_y,_d){super(_o,_x,_y);this._status=1,this.direct=_d||this._DEF_DIR._U,this.imgs_c=0,this.imgs=[_CANVAS_IMGS.enemy_m_y_1.obj,_CANVAS_IMGS.enemy_m_y_2.obj],this.audio_collision=_CANVAS_AUDIOS.enemy_collision2,this.tx=_PLAYERS_MAIN.getPlayerCenterPosition()._x,this.ty=_PLAYERS_MAIN.getPlayerCenterPosition()._y,this.rad=Math.atan2(this.ty-this.y,this.tx-this.x),this.sx=Math.cos(this.rad),this.sy=Math.sin(this.rad),this.speed=1.5*_MAPDEFS[_MAP_PETTERN]._speed,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,this._collision_type="t2",this.direct,this._DEF_DIR._D}isCanvasOut(){return _GAME.isEnemyCanvasOut(this,{up:!1,down:!1,left:!0,right:!0})}map_collition(){let _this=this,_e=_this.getEnemyCenterPosition(),_map_x=_MAP.getMapX(_e._x),_map_y=_MAP.getMapY(_e._y);_MAP.isMapCollision(_map_x,_map_y)&&(_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(_this.x+_this.img.width/2,_this.y+_this.img.height/2,_this._collision_type)),_this.init())}moveDraw(){let _this=this;var _c;_this.map_collition(),_this.x+=_this.sx*_this.speed,_this.y+=_this.sy*_this.speed,_this.img=(_c=_this.imgs_c,_this.imgs_c=_c>=10*_this.imgs.length-1?0:_c+1,_this.imgs[parseInt(_this.imgs_c/10)]),_this.setDrawImage()}}class ENEMY_frame_1 extends GameObject_ENEMY{constructor(_x,_y,_d){super(_CANVAS_IMGS.enemy_frame_1.obj,_x,_y);this._status=1,this.getscore=200,this.speed=-1*(3*Math.random()+3),this.rad=0,this.speedx=0,this.speedy=0,this._isbroken=!1,this._c=0,this.imgs=[_CANVAS_IMGS.enemy_frame_1.obj,_CANVAS_IMGS.enemy_frame_2.obj]}setAlive(){this.isalive()||_SCORE.set(this.getscore)}map_collition(){let _this=this,_e=_this.getEnemyCenterPosition(),_map_x=_MAP.getMapX(_e._x),_map_y=_MAP.getMapY(_e._y);_MAP.isMapCollision(_map_x,_map_y)&&_this.init()}showCollapes(){let _this=this,_cp=_this.getEnemyCenterPosition();if(_this._status>0)return;if(_this._isbroken)return;let _eb_l=0,_eb=_ENEMIES;for(let _i=0;_i<_eb.length;_i++)ENEMY_frame_2.prototype.isPrototypeOf(_eb[_i])&&_eb_l++;let _c=_eb_l>20?1:2;for(let _i=0;_i<_c;_i++){let _cls=new ENEMY_frame_2(_cp._x,_cp._y,_this.direct);_ENEMIES.push(_cls)}_this._isbroken=!0,_GAME._setPlay(_CANVAS_AUDIOS.enemy_collision1),_this.init()}move_standby(){let _this=this;if(_this.x<_CANVAS.width){_PLAYERS_MAIN.getPlayerCenterPosition();_this.rad=Math.atan2(700*Math.random()-100-_this.y,0-_this.x),_this.deg=_this.rad/Math.PI*180,_this.speedx=Math.cos(_this.rad),_this.speedy=Math.sin(_this.rad),_this._standby=!1}}moveDraw(){this.map_collition(),this.x-=this.speedx*this.speed,this.y-=this.speedy*this.speed,this._c=this._c>=5*this.imgs.length-1?0:this._c+1,this.img=this.imgs[parseInt(this._c/5)],this.setDrawImageRotate(this.deg+180)}}class ENEMY_frame_2 extends ENEMY_frame_1{constructor(_x,_y,_d){super(_x,_y,_d);this._status=1,this.speed=-1*(4*Math.random()+4),this.deg=110*Math.random()+125,this.speedx=Math.cos(this.deg*Math.PI/180),this.speedy=Math.sin(this.deg*Math.PI/180),this.getscore=200,this._isbroken=!1,this.img=_CANVAS_IMGS.enemy_frame_3.obj,this.shotColMap=["0,0,"+this.img.width+","+this.img.height],this.imgs=[_CANVAS_IMGS.enemy_frame_3.obj,_CANVAS_IMGS.enemy_frame_4.obj],this._standby=!1}showCollapes(){let _this=this,_cp=_this.getEnemyCenterPosition();if(_this._status>0)return;if(_this._isbroken)return;let _eb_l=0,_eb=_ENEMIES;for(let _i=0;_i<_eb.length;_i++)ENEMY_frame_3.prototype.isPrototypeOf(_eb[_i])&&_eb_l++;let _c=_eb_l>20?0:1;for(let _i=0;_i<_c;_i++){let _cls=new ENEMY_frame_3(_cp._x,_cp._y,_this.direct);_ENEMIES.push(_cls)}_this._isbroken=!0,_GAME._setPlay(_CANVAS_AUDIOS.enemy_collision1),_this.init()}}class ENEMY_frame_3 extends ENEMY_frame_1{constructor(_x,_y,_d){super(_x,_y,_d);this._status=1,this.speed=-1*(4*Math.random()+4),this.deg=110*Math.random()+125,this.speedx=Math.cos(this.deg*Math.PI/180),this.speedy=Math.sin(this.deg*Math.PI/180),this.getscore=200,this._isbroken=!1,this.img=_CANVAS_IMGS.enemy_frame_5.obj,this.shotColMap=["0,0,"+this.img.width+","+this.img.height],this.is_able_collision=!1,this.is_ignore_collision=Math.random()>.05,this._standby=!1,this.imgs=[_CANVAS_IMGS.enemy_frame_5.obj,_CANVAS_IMGS.enemy_frame_6.obj]}}class GameObject_ENEMY_BOSS extends GameObject_ENEMY{constructor(_o,_x,_y){super(_o,_x,_y);this.speed=0,this.getscore=1e4,this._c=0,this._c_self_collision=4e3,this.audio_collision=_CANVAS_AUDIOS.enemy_collision6,this.is_able_collision=!1,this.is_all_set=!1}init(){this._isshow=!1,this._status=0}shot(){}move_init(){}setSelfCollision(){if(!(this._c<this._c_self_collision)){for(let _i=0;_i<_ENEMIES.length;_i++)_ENEMIES[_i]._status=0;_GAME._setPlay(this.audio_collision)}}setWallCollision(){let _this=this;if(void 0!==_this.wall)for(let _i=0;_i<_this.wall.length;_i++){let _w=_this.wall[_i];if(!_w.isalive)continue;_this.getEnemyCenterPosition();_CONTEXT.drawImage(_w.img,_this.x+_w.x,_this.y+_w.y,_w.img.width,_w.img.height),_w.cs>=_this._status&&(_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(_this.x+_w.x,_this.y+_w.y)),_SCORE.set(500),_GAME._setPlay(_CANVAS_AUDIOS.enemy_collision5),_w.isalive=!1)}}moveDraw(){_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}move_Allset(){}isAllset(){let _this=this;return _this.is_all_set?(_this.set_wall_standBy(),!0):(_this.move_Allset(),!1)}isMove(){let _this=this;return _this.isStandBy()?(_this.move_standby(),!1):!!_this.isshow()&&(!!_this.isalive()||(_this.showCollapes(),!1))}move_before(){return!1}move(){}}class ENEMY_BOSS_WALL extends GameObject_ENEMY{constructor(_o,_o_boss,_x,_y){super(_o,_x,_y);this._initx=_x||0,this._inity=_y||0,this._boss=_o_boss,this._status=10,this.getscore=500,this._standby=!0,this.is_able_collision=!1,this.audio_collision=_CANVAS_AUDIOS.enemy_collision5,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5}setStandByDone(){this._standby=!1}moveDraw(){if(!this.isalive())return;let x=void 0===this._boss?0:this._boss.x,y=void 0===this._boss?0:this._boss.y;this.x=x+parseInt(this._initx),this.y=y+parseInt(this._inity),this.setDrawImage()}move(){}}class ENEMY_BOSS_BIGCORE extends GameObject_ENEMY_BOSS{constructor(_x,_y){super(_CANVAS_IMGS.enemy_bigcore.obj,_x,_y);let _this=this;_this._status=1,_this.speed=3,_this.is_able_collision=!1,_this.wall=[new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore_1.obj,_this,15,50),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore_1.obj,_this,25,50),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore_1.obj,_this,35,50),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore_2.obj,_this,45,53),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore_3.obj,_this,70,43)],_this._wall_statuses="";for(let _i=0;_i<_this.wall.length;_i++)_ENEMIES.push(_this.wall[_i]);_this.c_z4_ani=30,_this.z4_ani=[{img:_CANVAS_IMGS.enemy_bigcore_4_1.obj,al:1},{img:_CANVAS_IMGS.enemy_bigcore_4_2.obj,al:.8},{img:_CANVAS_IMGS.enemy_bigcore_4_3.obj,al:.6},{img:_CANVAS_IMGS.enemy_bigcore_4_4.obj,al:.4},{img:_CANVAS_IMGS.enemy_bigcore_4_5.obj,al:.2}],_this.tid=null,_this._moveYStop=!1,_this.shotColMap=["120,0,169,40,false","120,70,169,114,false"],_this._collision_type="t9"}set_wall_standBy(){let _this=this;for(let _i=0;_i<_this.wall.length;_i++)_this.wall[_i].setStandByDone()}set_wall_status(){let _this=this;_this._wall_statuses="";for(let _i=0;_i<_this.wall.length;_i++)_this._wall_statuses+=_this.wall[_i].isalive()?1:0}show_walls(_walls){let _this=this;for(let _i=0;_i<_walls.length;_i++)(void 0===_walls[_i-1]||_walls[_i-1]._status<=0)&&(_walls[_i].is_able_collision=!0),_walls[_i].moveDraw(_this)}shot(){let _this=this;Math.random()>.02||(_this._moveYStop=!0,_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x,_this.y,_CANVAS_IMGS.enemy_bullet_z.obj)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x,_this.y+35,_CANVAS_IMGS.enemy_bullet_z.obj)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x,_this.y+70,_CANVAS_IMGS.enemy_bullet_z.obj)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x,_this.y+105,_CANVAS_IMGS.enemy_bullet_z.obj)),_GAME._setPlay(_CANVAS_AUDIOS.enemy_bullet_laser),_this.tid=setTimeout(function(){_this._moveYStop=!1,clearTimeout(_this.tid)},100))}move_Allset(){let _this=this;_this.x-=4,_this.moveDraw(),_this.set_wall_status(),_this.show_walls(_this.wall),_this.x<_CANVAS.width-_this.img.width-80&&(_this.is_all_set=!0)}move_before(){return!1}move_standby(){let _this=this;_this.move_before()||(_this.x-=4,_this.x<_CANVAS.width&&(_this._standby=!1))}move(){let _this=this;if(_this.isMove()&&_this.isAllset()){if(_this.y+=_this._moveYStop?0:_this.speed,_this.speed=_this.y<50||_this.y+_this.img.height>450?-1*_this.speed:_this.speed,_this.shot(),_this.moveDraw(),_this.set_wall_status(),_this.show_walls(_this.wall),-1===_this._wall_statuses.indexOf("1")&&(_this._status=0,_this.setAlive()),_this._c>=3e3){let _ec=_this.getEnemyCenterPosition();_this.is_able_collision=!1,_this.c_z4_ani=_this.c_z4_ani>0?_this.c_z4_ani-1:0;let _img=_this.z4_ani[parseInt(_this.c_z4_ani/6)].img;_CONTEXT.drawImage(_img,_ec._x-_img.width/2,_ec._y-_img.height/2,_img.width,_img.height)}_this.setSelfCollision(),_this._c++}}}class ENEMY_BOSS_BIGCORE2 extends GameObject_ENEMY_BOSS{constructor(_x,_y){super(_CANVAS_IMGS.enemy_bigcore2.obj,_x,_y);let _this=this;_this._status=1,_this.speed=2,_this.is_able_collision=!1,_this.img=_CANVAS_IMGS.enemy_bigcore2.obj,_this.wall_up=[new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,_this,90,38),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,_this,95,38),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,_this,100,38),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,_this,105,38),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_core.obj,_this,110,36)],_this.wall_down=[new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,_this,90,95),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,_this,95,95),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,_this,100,95),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,_this,105,95),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_core.obj,_this,110,93)],_this._wall_up_statuses="",_this._wall_down_statuses="",_this.back=[{img:_CANVAS_IMGS.enemy_bigcore2_back1.obj},{img:_CANVAS_IMGS.enemy_bigcore2_back2.obj},{img:_CANVAS_IMGS.enemy_bigcore2_back3.obj},{img:_CANVAS_IMGS.enemy_bigcore2_back4.obj},{img:_CANVAS_IMGS.enemy_bigcore2_back5.obj},{img:_CANVAS_IMGS.enemy_bigcore2_back6.obj}],_this.back_img_up={x:200,y:-50,st:0,flag:!0,s1:function(){this.st>=15&&(this.flag=!1),this.st<=6&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},s2:function(){this.st>=6&&(this.flag=!1),this.st<=0&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},f:function(){let img=_this.back[parseInt(this.st/3)].img;_CONTEXT.drawImage(img,_this.x+this.x,_this.y+this.y,img.width,img.height)}},_this.back_img_down={x:200,y:-120,st:0,flag:!0,s1:function(){this.st>=15&&(this.flag=!1),this.st<=6&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},s2:function(){this.st>=6&&(this.flag=!1),this.st<=0&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},f:function(){let img=_this.back[parseInt(this.st/3)].img;_CONTEXT.save(),_CONTEXT.setTransform(1,0,0,-1,0,2*_this.y+img.height),_CONTEXT.drawImage(img,_this.x+this.x,_this.y+this.y,img.width,img.height),_CONTEXT.restore()}},_this.c_z4_ani=30,_this.z4_ani=[{img:_CANVAS_IMGS.enemy_bigcore_4_1.obj,al:1},{img:_CANVAS_IMGS.enemy_bigcore_4_2.obj,al:.8},{img:_CANVAS_IMGS.enemy_bigcore_4_3.obj,al:.6},{img:_CANVAS_IMGS.enemy_bigcore_4_4.obj,al:.4},{img:_CANVAS_IMGS.enemy_bigcore_4_5.obj,al:.2}],_this.tid=null,_this._moveYStop=!1,_this.shotColMap=["130,0,240,156,false"],_this._collision_type="t9";for(let _i=0;_i<_this.wall_up.length;_i++)_ENEMIES.push(_this.wall_up[_i]);for(let _i=0;_i<_this.wall_down.length;_i++)_ENEMIES.push(_this.wall_down[_i]);_this.hands_up=[new ENEMY_BOSS_BIGCORE2_HANDS({_initx:-52,_inity:-30,_dir:_this._DEF_DIR._U})],_ENEMIES.push(_this.hands_up[0]),_this.hands_down=[new ENEMY_BOSS_BIGCORE2_HANDS({_initx:-52,_inity:75,_dir:_this._DEF_DIR._D})],_ENEMIES.push(_this.hands_down[0]),_this._hands_open_flag=!1}init(){this._isshow=!1,this._status=0}set_wall_standBy(){let _this=this;for(let _i=0;_i<_this.wall_up.length;_i++)_this.wall_up[_i].setStandByDone();for(let _i=0;_i<_this.wall_down.length;_i++)_this.wall_down[_i].setStandByDone()}set_wall_status(){let _this=this;_this._wall_up_statuses="",_this._wall_down_statuses="";for(let _i=0;_i<_this.wall_up.length;_i++)_this._wall_up_statuses+=_this.wall_up[_i].isalive()?1:0;for(let _i=0;_i<_this.wall_down.length;_i++)_this._wall_down_statuses+=_this.wall_down[_i].isalive()?1:0}shot(){let _this=this,_ec=_this.getEnemyCenterPosition(),_pc=_PLAYERS_MAIN.getPlayerCenterPosition();if(_this._c%150==0&&(_this._moveYStop=!1),_this._c%150>50&&_this._c%150<99&&(_this._moveYStop=!0),_this._c%150==51&&(_this._hands_open_flag=Math.abs(_pc._y-_ec._y)<100,_this._hands_open_flag)){for(let _i=_this.hands_up.length-1;_i>=0;_i--)_this.hands_up[_i].isHandsOpen=!0;for(let _i=_this.hands_down.length-1;_i>=0;_i--)_this.hands_down[_i].isHandsOpen=!0}if(_this._c%150==70&&(_this._hands_open_flag?(-1!==_this._wall_up_statuses.indexOf("1")&&(_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+85,_this.y-75)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+70,_this.y-45)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+120,_this.y-20)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+100,_this.y+0)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+80,_this.y+25)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+60,_this.y+45)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x,_this.y+55))),-1!==_this._wall_down_statuses.indexOf("1")&&(_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x,_this.y+85)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+60,_this.y+95)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+80,_this.y+115)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+100,_this.y+135)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+120,_this.y+160)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+70,_this.y+170)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+85,_this.y+200)))):(-1!==_this._wall_up_statuses.indexOf("1")&&(_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+60,_this.y+20)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x,_this.y+55))),-1!==_this._wall_down_statuses.indexOf("1")&&(_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x,_this.y+95)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x+60,_this.y+130)))),_GAME._setPlay(_CANVAS_AUDIOS.enemy_bullet_laser)),_this._c%150==110){for(let _i=_this.hands_up.length-1;_i>=0;_i--)_this.hands_up[_i].isHandsClose=!0;for(let _i=_this.hands_down.length-1;_i>=0;_i--)_this.hands_down[_i].isHandsClose=!0}}move_Allset(){let _this=this;_this.x-=4,_this.moveDraw(),_this.back_img_up.s2(),_this.back_img_up.f(),_this.back_img_down.s2(),_this.back_img_down.f();for(let _i=0;_i<_this.wall_up.length;_i++)_this.wall_up[_i].moveDraw(_this);for(let _i=0;_i<_this.wall_down.length;_i++)_this.wall_down[_i].moveDraw(_this);for(let _i=_this.hands_up.length-1;_i>=0;_i--)_this.hands_up[_i].moveDraw(_this);for(let _i=_this.hands_down.length-1;_i>=0;_i--)_this.hands_down[_i].moveDraw(_this);_this.x<_CANVAS.width-_this.img.width-80&&(_this.is_all_set=!0)}move_standby(){let _this=this;_this.move_before()||(_this.x-=4,_this.x<_CANVAS.width&&(_this._standby=!1))}move(){let _this=this;if(_this.isMove()&&_this.isAllset()){_this.y+=_this._moveYStop?0:_this.speed,_this.speed=_this.y<50||_this.y+_this.img.height>450?-1*_this.speed:_this.speed,_this.shot(),_this.moveDraw(),_this.speed>0&&!_this._moveYStop?_this.back_img_up.s1():_this.back_img_up.s2(),_this.back_img_up.f(),_this.speed<0&&!_this._moveYStop?_this.back_img_down.s1():_this.back_img_down.s2(),_this.back_img_down.f(),_this.set_wall_status();for(let _i=0;_i<_this.wall_up.length;_i++)(void 0===_this.wall_up[_i-1]||_this.wall_up[_i-1]._status<=0)&&(_this.wall_up[_i].is_able_collision=!0),_this.wall_up[_i].moveDraw(_this);for(let _i=0;_i<_this.wall_down.length;_i++)(void 0===_this.wall_down[_i-1]||_this.wall_down[_i-1]._status<=0)&&(_this.wall_down[_i].is_able_collision=!0),_this.wall_down[_i].moveDraw(_this);for(let _i=_this.hands_up.length-1;_i>=0;_i--)-1!==_this._wall_up_statuses.indexOf("1")||_this.hands_up[_i].is_hand_stop()||(_GAME._setPlay(_this.audio_collision),_this.hands_up[_i].set_hand_stop()),_this.hands_up[_i].moveDraw(_this);for(let _i=_this.hands_down.length-1;_i>=0;_i--)-1!==_this._wall_down_statuses.indexOf("1")||_this.hands_down[_i].is_hand_stop()||(_GAME._setPlay(_this.audio_collision),_this.hands_down[_i].set_hand_stop()),_this.hands_down[_i].moveDraw(_this);if(-1===_this._wall_up_statuses.indexOf("1")&&-1===_this._wall_down_statuses.indexOf("1")){for(let _i=_this.hands_up.length-1;_i>=0;_i--)_this.hands_up[_i]._status=0;for(let _i=_this.hands_down.length-1;_i>=0;_i--)_this.hands_down[_i]._status=0;_this._status=0,_this.setAlive()}_this.setSelfCollision(),_this._c++}}}class ENEMY_BOSS_BIGCORE2_HANDS extends GameObject_ENEMY{constructor(_d){super(_CANVAS_IMGS.enemy_bigcore2_hand1.obj,_d._initx,_d._inity);let _this=this;_this._initx=_d._initx||0,_this._inity=_d._inity||0,_this._standby=!1,_this.is_able_collision=!1,_this.isshot=void 0!==_d._img,_this.isHandsOpen=!1,_this.isHandsClose=!1,_this.isstop=!1,_this._boss=new Object,_this.direct=_d._dir||_this._DEF_DIR._U,_this.shotColMap=[_this.direct===_this._DEF_DIR._U?"0,30,250,100,false":_this.direct===_this._DEF_DIR._D?"0,30,250,100,false":void 0],_this.shotColMapTmp=_this.direct===_this._DEF_DIR._U?[["90,30,250,70,false","25,70,250,100,false"],["180,30,250,90,false"],["50,10,225,20,false"]]:_this.direct===_this._DEF_DIR._D?[["25,30,250,70,false","90,70,250,100,false"],["180,20,250,60,false"],["50,90,225,100,false"]]:void 0,_this.imgs=[{img:_CANVAS_IMGS.enemy_bigcore2_hand1.obj,x:0,y:(_this.direct,_this._DEF_DIR._U,0)},{img:_CANVAS_IMGS.enemy_bigcore2_hand2.obj,x:0,y:_this.direct===_this._DEF_DIR._U?-40:40},{img:_CANVAS_IMGS.enemy_bigcore2_hand3.obj,x:-5,y:_this.direct===_this._DEF_DIR._U?-30:30}],_this.imgs_x=0,_this.imgs_y=0,_this._c=0}init(){this._isshow=!1,this._status=0}collision(_s_type,_num){}setStatus(){this._status=0}is_hand_stop(){return this.isstop}set_hand_stop(){this.isstop=!0}move_hands_open(){let _this=this;if(!_this.isHandsOpen)return;if(_this.isstop)return;let _ar=_this.imgs[parseInt(_this._c/6)];_this.img=_ar.img,_this.imgs_x=parseInt(_ar.x),_this.imgs_y=parseInt(_ar.y),_this.shotColMap=[];let _shotColAr=_this.shotColMapTmp[parseInt(_this._c/6)];for(let _i=0;_i<_shotColAr.length;_i++)_this.shotColMap.push(_shotColAr[_i]);if(_this._c>=6*_this.imgs.length-1)return _this._c=6*_this.imgs.length-1,void(_this.isHandsOpen=!1);_this._c++}move_hands_close(){let _this=this;if(!_this.isHandsClose)return;if(_this.isstop)return;let _ar=_this.imgs[parseInt(_this._c/6)];_this.img=_this.imgs[parseInt(_this._c/6)].img,_this.imgs_x=parseInt(_ar.x),_this.imgs_y=parseInt(_ar.y),_this.shotColMap=[];let _shotColAr=_this.shotColMapTmp[parseInt(_this._c/6)];for(let _i=0;_i<_shotColAr.length;_i++)_this.shotColMap.push(_shotColAr[_i]);if(_this._c<=0)return _this._c=0,void(_this.isHandsClose=!1);_this._c--}moveDraw(_boss){this._boss=_boss,this.x=this._boss.x+parseInt(this._initx)+this.imgs_x,this.y=this._boss.y+parseInt(this._inity)+this.imgs_y,this.setDrawImage()}move(){this.move_hands_open(),this.move_hands_close()}}class ENEMY_BOSS_CRYSTALCORE extends GameObject_ENEMY_BOSS{constructor(_x,_y){super(_CANVAS_IMGS.enemy_cristalcore.obj,_x,_y);let _this=this;_this._status=70,_this.speed=3,_this.wall=[new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_cristalcore_wall1.obj,_this,47,116),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_cristalcore_wall2.obj,_this,62,116),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_cristalcore_wall2.obj,_this,77,116),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_cristalcore_wall2.obj,_this,92,116),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore_3.obj,_this,102,115)],_this._wall_statuses="",_this.c_z4_ani=30,_this.z4_ani=[{img:_CANVAS_IMGS.enemy_bigcore_4_1.obj,al:1},{img:_CANVAS_IMGS.enemy_bigcore_4_2.obj,al:.8},{img:_CANVAS_IMGS.enemy_bigcore_4_3.obj,al:.6},{img:_CANVAS_IMGS.enemy_bigcore_4_4.obj,al:.4},{img:_CANVAS_IMGS.enemy_bigcore_4_5.obj,al:.2}],_this._collision_type="t9",_this.is_able_collision=!1,_this._shot_count=0,_this.shotColMap=["25,0,227,10,false","25,242,227,250,false","160,0,227,250,false"];for(let _i=0;_i<_this.wall.length;_i++)_ENEMIES.push(_this.wall[_i]);_this.hands_up=[new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_ignore_collision:!0,_initx:50,_inity:80,_cmr:60,_cmsr:70,_initRad:40,_data:"0,0,180,10",_change:!0}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_ignore_collision:!0,_initx:50,_inity:80,_cmr:70,_cmsr:80,_initRad:70,_data:"0,0,185,5",_change:!0}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_initx:50,_inity:80,_cmr:80,_cmsr:100,_initRad:100,_data:"0,0,180,-10",_change:!0}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_initx:50,_inity:80,_cmr:89,_cmsr:125,_initRad:130,_data:"0,0,175,-25",_change:!0}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_initx:50,_inity:80,_cmr:97,_cmsr:145,_initRad:160,_data:"0,0,170,-40",_change:!0}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_initx:50,_inity:80,_cmr:106,_cmsr:160,_initRad:190,_data:"0,0,165,-55",_change:!0}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_img:_CANVAS_IMGS.enemy_cristalcore_hand2.obj,_initx:50,_inity:80,_cmr:115,_cmsr:170,_initRad:215,_data:"0,0,160,-70",_change:!0})];for(let _i=0;_i<_this.hands_up.length;_i++)_ENEMIES.push(_this.hands_up[_i]);_this.hands_down=[new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_ignore_collision:!0,_initx:50,_inity:155,_cmr:60,_cmsr:70,_initRad:40,_data:"0,0,180,-10",_change:!1}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_ignore_collision:!0,_initx:50,_inity:155,_cmr:70,_cmsr:80,_initRad:70,_data:"0,0,175,-5",_change:!1}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_initx:50,_inity:155,_cmr:80,_cmsr:100,_initRad:100,_data:"0,0,180,10",_change:!1}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_initx:50,_inity:155,_cmr:89,_cmsr:125,_initRad:130,_data:"0,0,185,25",_change:!1}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_initx:50,_inity:155,_cmr:97,_cmsr:145,_initRad:160,_data:"0,0,190,40",_change:!1}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_initx:50,_inity:155,_cmr:106,_cmsr:160,_initRad:190,_data:"0,0,195,55",_change:!1}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:_this,_img:_CANVAS_IMGS.enemy_cristalcore_hand2.obj,_initx:50,_inity:155,_cmr:115,_cmsr:170,_initRad:215,_data:"0,0,200,70",_change:!1})];for(let _i=0;_i<_this.hands_down.length;_i++)_ENEMIES.push(_this.hands_down[_i])}init(){}setDrawImageDirect(){}set_wall_standBy(){let _this=this;for(let _i=0;_i<_this.wall.length;_i++)_this.wall[_i].setStandByDone()}set_wall_status(){let _this=this;_this._wall_statuses="";for(let _i=0;_i<_this.wall.length;_i++)_this._wall_statuses+=_this.wall[_i].isalive()?1:0}show_walls(_walls){let _this=this;for(let _i=0;_i<_walls.length;_i++)(void 0===_walls[_i-1]||_walls[_i-1]._status<=0)&&(_walls[_i].is_able_collision=!0),_walls[_i].moveDraw(_this)}shot(){let _this=this;if(_this._shot_count++,_this._c%1200>800){if(_this._shot_count<10)return}else if(_this._c%1200<=800&&_this._shot_count<50)return;_this._shot_count=0,_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x,_this.y+111)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER(_this.x,_this.y+140)),_GAME._setPlay(_CANVAS_AUDIOS.enemy_bullet_laser)}showCollapes(){let _this=this;_this._isshow=!1;for(let _i=_this.hands_up.length-1;_i>=0;_i--)_this.hands_up[_i].showCollapes(_this.hands_up[_i].x,_this.hands_up[_i].y),_this.hands_up[_i].init();for(let _i=_this.hands_down.length-1;_i>=0;_i--)_this.hands_down[_i].showCollapes(_this.hands_down[_i].x,_this.hands_down[_i].y),_this.hands_down[_i].init();_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(_this.x+_this.img.width/2,_this.y+_this.img.height/2,_this._collision_type))}isAllset(){let _this=this;return _this.is_all_set?(_this.set_wall_standBy(),!0):(_this.move_Allset(),!1)}move_Allset(){let _this=this;_this.y-=4;for(let _i=_this.hands_up.length-1;_i>=0;_i--)_this.hands_up[_i].moveDraw(_this);for(let _i=_this.hands_down.length-1;_i>=0;_i--)_this.hands_down[_i].moveDraw(_this);_this.moveDraw(),_this.set_wall_status(),_this.show_walls(_this.wall),_this.y<200&&(_this.is_all_set=!0)}move_standby(){let _this=this;_this.move_before()||(_this.y-=4,_this.y<_CANVAS.height&&(_this._standby=!1))}move(){let _this=this;if(_this.isMove()&&_this.isAllset()){_this.y+=_this.speed,_this._c%1200>800&&_this._c%45==0&&(_this.speed*=-1),(_this.y+_this.img.height>_CANVAS.height||_this.y<0)&&(_this.speed*=-1);for(let _i=_this.hands_up.length-1;_i>=0;_i--)_this.hands_up[_i].moveDraw(_this);for(let _i=_this.hands_down.length-1;_i>=0;_i--)_this.hands_down[_i].moveDraw(_this);if(_this.shot(),_this.moveDraw(),_this.set_wall_status(),_this.show_walls(_this.wall),-1===_this._wall_statuses.indexOf("1")){for(let _i=_this.hands_up.length-1;_i>=0;_i--)_this.hands_up[_i]._status=0;for(let _i=_this.hands_down.length-1;_i>=0;_i--)_this.hands_down[_i]._status=0;_this._status=0,_this.setAlive()}_this.setSelfCollision(),_this._c++}}}class ENEMY_BOSS_CRYSTALCORE_HANDS extends GameObject_ENEMY{constructor(_d){super(_CANVAS_IMGS.enemy_cristalcore_hand1.obj,_d._initx,_d._inity);this._initx=_d._initx||0,this._inity=_d._inity||0,this._boss=_d._boss,this._c_move_round=_d._cmr||0,this._c_move_self_round=_d._cmsr||0,this._initRad=_d._initRad||0,this._data=_d._data||"0,0,0,0",this.img=_d._img||_CANVAS_IMGS.enemy_cristalcore_hand1.obj,this._count_turn=0,this._change=_d._change,this._standby=!0,this._standby_tmp=_d._standby||!1,this.is_able_collision=!1,this.is_ignore_collision=_d._ignore_collision||!1,this.isshot=void 0!==_d._img,this._shot_count=0,this._collision_type="t1",this._c=0;let _sp=this._data.split(","),_deg=parseInt(_sp[2])+(this._change?1:-1),_x=this._initRad*Math.cos(_deg*(Math.PI/180)),_y=this._initRad*Math.sin(_deg*(Math.PI/180)),_z=parseInt(_sp[3])+(this._change?1:-1);this._data=_x+","+_y+","+_deg+","+_z}collision(_s_type,_num){}setStatus(){this._status=0}shot(){if(!1===this.isshot)return;if(this._shot_count++,this._shot_count<20)return;this._shot_count=0;let _d=this._data.split(",");_ENEMIES_SHOTS.push(new ENEMY_SHOT_CRYSTALCORE(this.x,this.y,parseInt(_d[3])))}move_hands(){let _this=this;if(_this._count_turn>=4)return void(_this._c>400&&(_this._c=0,_this._count_turn=0));_this._c>200&&(_this._c=0,_this._count_turn++,_this._change=!_this._change);let _sp=_this._data.split(","),_cmr=_this._c_move_round,_cmsr=_this._c_move_self_round;if(_this._c>_cmsr)return;if(_this._c<=_cmsr&&_this._c>_cmr){let _deg=parseInt(_sp[3])+(_this._change?1:-1);return void(_this._data=_sp[0]+","+_sp[1]+","+_sp[2]+","+_deg)}let _deg=parseInt(_sp[2])+(_this._change?1:-1),_x=_this._initRad*Math.cos(_deg*(Math.PI/180)),_y=_this._initRad*Math.sin(_deg*(Math.PI/180)),_z=parseInt(_sp[3])+(_this._change?1:-1);_this._data=_x+","+_y+","+_deg+","+_z}moveDraw(_o){let _d=this._data.split(","),_ix=this._initx,_iy=this._inity,rad=parseInt(_d[3])*Math.PI/180,cx=this._boss.x+parseInt(_d[0])+_ix+this.img.width,cy=this._boss.y+parseInt(_d[1])+_iy+parseInt(this.img.height/1.5);_CONTEXT.save(),_CONTEXT.setTransform(Math.cos(rad),Math.sin(rad),-Math.sin(rad),Math.cos(rad),cx-cx*Math.cos(rad)+cy*Math.sin(rad),cy-cx*Math.sin(rad)-cy*Math.cos(rad)),_CONTEXT.drawImage(this.img,this._boss.x+parseInt(_d[0])+_ix,this._boss.y+parseInt(_d[1])+_iy,this.img.width,this.img.height),_CONTEXT.restore(),this.x=this._boss.x+parseInt(_d[0])+_ix,this.y=this._boss.y+parseInt(_d[1])+_iy,_o.is_all_set&&(this.shot(),this.move_hands(),this._standby=!1,this._c++)}move(){}}class ENEMY_BOSS_CRYSTALCORE_PT2 extends ENEMY_BOSS_CRYSTALCORE{constructor(_x,_y){super(_x,_y);this._c=0,this._showout_cube=0,this._standby_count=0,this._complete_cube_count=0,this._map_col_reset=!1}move_before(){let _this=this,_as="";if(function(){let _e=_ENEMIES;for(let _i=0;_i<_e.length;_i++)ENEMY_BOSS_CUBE.prototype.isPrototypeOf(_e[_i])&&(_e[_i].setDrawImageAlpha(_this.alpha),_as+=!0===_e[_i]._stop?"1":"0")}(_this.alpha),-1!==_as.indexOf("0")&&(_this._complete_cube_count=_this._standby_count),_this._standby_count%40==0&&_this._showout_cube<100){let _c=new ENEMY_BOSS_CUBE(_CANVAS_IMGS.enemy_a_1.obj,1e3,400*Math.random()+50);_ENEMIES.push(_c),_this._showout_cube++}let _c=_this._standby_count-_this._complete_cube_count;return 50===_c&&(_this.alpha=.7),100===_c&&(_this.alpha=.3),150===_c&&(_this.alpha=0),0===_this.alpha?(_MAP.set_mapdef_col_clear(),!1):(_this._standby_count++,!0)}}class ENEMY_BOSS_CUBE extends GameObject_ENEMY{constructor(_o,_x,_y){super(_o,_x,_y);this._standby=!1,this._c=0,this._status=1,this.speed=5,this.change_speed_c=parseInt(170*Math.random())+10,this._stop=!1,this.is_able_collision=!1,this.audio_collision=_CANVAS_AUDIOS.enemy_cube,this._col_c=0,this.col=[{img:_CANVAS_IMGS.enemy_cube1.obj,scale:1},{img:_CANVAS_IMGS.enemy_cube2.obj,scale:1},{img:_CANVAS_IMGS.enemy_cube3.obj,scale:1},{img:_CANVAS_IMGS.enemy_cube4.obj,scale:1}],this.img=this.col[0].img,this.shotColMap=["10,10,"+parseInt(this.img.width-10)+","+parseInt(this.img.height-10)],this.tx=0,this.ty=0,this.rad=0,this.deg=0,this.sx=0,this.sy=0}isCanvasOut(){return _GAME.isEnemyCanvasOut(this,{up:!0,down:!0,left:!0,right:!0})}isMove(){let _this=this;return _this.isStandBy()?(_this.move_standby(),!1):_this.isCanvasOut()?(_this._status=0,_this._isshow=!1,!1):!!_this.isshow()}move_bounds(){let _this=this,_eb=_ENEMIES;for(let _i=0;_i<_eb.length;_i++){if(!ENEMY_BOSS_CUBE.prototype.isPrototypeOf(_eb[_i]))continue;if(_this.id===_eb[_i].id)continue;if(!_eb[_i]._stop)continue;if(_GAME.isSqCollision(_this.shotColMap[0],_this.x+","+_this.y,_eb[_i].shotColMap,_eb[_i].x+","+_eb[_i].y)!==_IS_SQ_NOTCOL)return!0}return!1}moveDraw(){let _this=this;if(!0!==_this._stop){if(_this.x<0||_this.y<0||_this.y+50>_CANVAS.height||_this.move_bounds()){let _ec=_this.getEnemyCenterPosition();return _MAP.set_mapdef_col(_MAP.getMapX(_ec._x),_MAP.getMapY(_ec._y),"1"),_this._status=0,_this._stop=!0,void _GAME._setPlay(_this.audio_collision)}var _t;_this._c<_this.change_speed_c&&(_this.x-=_this.speed),_this._c===_this.change_speed_c&&(_this.tx=_PLAYERS_MAIN.getPlayerCenterPosition()._x,_this.ty=_PLAYERS_MAIN.getPlayerCenterPosition()._y,_this.rad=Math.atan2(_this.ty-_this.y,_this.tx-_this.x),_this.deg=180*_this.rad/Math.PI,_this.sx=Math.cos(_this.rad),_this.sy=Math.sin(_this.rad),_this.speed=8),_this._c>_this.change_speed_c&&(_this.x+=_this.sx*_this.speed,_this.y+=_this.sy*_this.speed),_this.img=((_t=_this)._col_c=_t._col_c>=8*_t.col.length-1?0:_t._col_c+1,_t.col[parseInt(_t._col_c/8)].img),_this._c++}}move(){let _this=this;_this.isMove()&&(0!==_this.alpha?_this.moveDraw():_this.init())}}class ENEMY_BOSS_FRAME extends GameObject_ENEMY_BOSS{constructor(_x,_y){super(_CANVAS_IMGS.enemy_frame_body1.obj,_x,_y);let _this=this;_this._status=1,_this.x=_CANVAS.width+100,_this.y=250,_this.speed=3,_this.moves_interval=15,_this.shotColMap=[parseInt(_this.img.width/2)+","+parseInt(_this.img.height/2)+","+parseInt(_this.img.width/2+1)+","+parseInt(_this.img.height/2+1)],_this._radX=0,_this._radY=0,_this._rad=100,_this._deg=16,_this._f=!1,_this._mpt=0,_this._collision_type="t9",_this.movePos={_pos:0,_pos_same_count:0,_getPos:function(){return this._pos},_setPos:function(){let _e=_this.getEnemyCenterPosition();_e._x<200?_e._y<150?this._pos=1:_e._y>_CANVAS.height-150?this._pos=7:this._pos=4:_e._x>_CANVAS.width-200?_e._y<150?this._pos=3:_e._y>_CANVAS.height-150?this._pos=9:this._pos=6:_e._y<150?this._pos=2:_e._y>_CANVAS.height-150?this._pos=8:this._pos=5},move:function(){let _p=this._getPos();if(this._setPos(),_p===this._pos){if(this._pos_same_count++,this._pos_same_count<200)return;let _mpt=5===(_t=this)._pos?Math.random()>.4?2:1:3===_t._pos&&1===_this._mpt&&_this._deg<190&&_this._deg>=180?0:3===_t._pos&&2===_this._mpt&&_this._deg<90&&_this._deg>=80?0:6===_t._pos&&1===_this._mpt&&_this._deg<270&&_this._deg>=260?0:6===_t._pos&&2===_this._mpt&&_this._deg<100&&_this._deg>=90?0:9===_t._pos&&1===_this._mpt&&_this._deg<280&&_this._deg>=270?0:9===_t._pos&&2===_this._mpt&&_this._deg<190&&_this._deg>=180?0:2===_t._pos&&1===_this._mpt&&_this._deg<180&&_this._deg>=170?0:2===_t._pos&&2===_this._mpt&&_this._deg<10&&_this._deg>=0?0:8===_t._pos&&1===_this._mpt&&_this._deg<360&&_this._deg>=350?0:8===_t._pos&&2===_this._mpt&&_this._deg<190&&_this._deg>=180?0:1===_t._pos&&1===_this._mpt&&_this._deg<180&&_this._deg>=170?0:1===_t._pos&&2===_this._mpt&&_this._deg<280&&_this._deg>=270?0:4===_t._pos&&1===_this._mpt&&_this._deg<90&&_this._deg>=80?0:4===_t._pos&&2===_this._mpt&&_this._deg<280&&_this._deg>=270?0:7===_t._pos&&1===_this._mpt&&_this._deg<360&&_this._deg>=350?0:7===_t._pos&&2===_this._mpt&&_this._deg<90&&_this._deg>=80?0:_this._mpt;return _this.x<-_this._rad||_this.x>_CANVAS.width+_this._rad||_this.y<-_this._rad||_this.y>_CANVAS.height+_this._rad?(_this.deg=_this.setDegAdd(180),_this.moves_pt[_this._mpt].switch(0),void(_this._mpt=0)):(_mpt!==_this._mpt&&(this._pos_same_count=0),_this.moves_pt[_this._mpt].switch(_mpt),void(_this._mpt=_mpt))}var _t;let _mpt=function(_this){return 5===_this._pos?0:1===_p&&2===_this._pos?2:1===_p&&4===_this._pos?1:4===_p&&1===_this._pos?2:4===_p&&7===_this._pos?1:7===_p&&4===_this._pos?2:7===_p&&8===_this._pos?1:2===_p&&1===_this._pos?1:2===_p&&3===_this._pos?2:8===_p&&7===_this._pos?2:8===_p&&9===_this._pos?1:3===_p&&2===_this._pos?1:3===_p&&6===_this._pos?2:6===_p&&3===_this._pos?1:6===_p&&9===_this._pos?2:9===_p&&6===_this._pos?1:9===_p&&8===_this._pos?2:parseInt(2*Math.random()+1)}(this);_this.moves_pt[_this._mpt].switch(_mpt),_this._mpt=_mpt}},_this.parts=[new ENEMY_BOSS_FRAME_HEAD({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_HEAD({o:null,x:1500,y:250,d:_this._DEF_DIR._L})],_this.moves=[];for(let _i=0;_i<_this.parts.length;_i++)_ENEMIES.push(_this.parts[_i]);_this.moves_pt=[{switch:function(_mpt){1===_mpt?_this._deg=_this.setDegAdd(90):2===_mpt&&(_this._deg=_this.setDegAdd(-90)),0!==_mpt&&(_this._radX=_this.x+Math.cos(_this._deg*Math.PI/180)*_this._rad*-1,_this._radY=_this.y+Math.sin(_this._deg*Math.PI/180)*_this._rad*-1),_this._mpt=_mpt},move:function(){_this.x+=_this.speed*Math.cos(_this._deg*Math.PI/180),_this.y+=_this.speed*Math.sin(_this._deg*Math.PI/180)},setDeg:0},{switch:function(_mpt){0===_mpt?_this._deg=_this.setDegAdd(-90):2===_mpt&&(_this._deg=_this.setDegAdd(-180)),1!==_mpt&&(_this._radX=_this.x+Math.cos(_this._deg*Math.PI/180)*_this._rad*-1,_this._radY=_this.y+Math.sin(_this._deg*Math.PI/180)*_this._rad*-1),_this._mpt=_mpt},move:function(){_this._deg=_this.setDegAdd(-1*_this.speed/2),_this.x=_this._radX+Math.cos(_this._deg*Math.PI/180)*_this._rad,_this.y=_this._radY+Math.sin(_this._deg*Math.PI/180)*_this._rad},setDeg:-90},{switch:function(_mpt){0===_mpt?_this._deg=_this.setDegAdd(90):1===_mpt&&(_this._deg=_this.setDegAdd(-180)),2!==_mpt&&(_this._radX=_this.x+Math.cos(_this._deg*Math.PI/180)*_this._rad*-1,_this._radY=_this.y+Math.sin(_this._deg*Math.PI/180)*_this._rad*-1),_this._mpt=_mpt},move:function(){_this._deg=_this.setDegAdd(_this.speed/2),_this.x=_this._radX+Math.cos(_this._deg*Math.PI/180)*_this._rad,_this.y=_this._radY+Math.sin(_this._deg*Math.PI/180)*_this._rad},setDeg:90}],_this.is_able_collision=!1,_this._standby=!0,_this._heads_statuses="",_this._bodies_statuses=""}setSelfCollision(){let _this=this;if(_this._c>_this._c_self_collision&&(_this._heads_statuses="00"),-1===_this._heads_statuses.indexOf("1")){for(let _i=0;_i<_this.parts.length;_i++)ENEMY_BOSS_FRAME_HEAD.prototype.isPrototypeOf(_this.parts[_i])?_this.parts[_i]._status=0:_this.parts[_i].is_frame_heads_collision=!0;-1===_this._bodies_statuses.indexOf("1")&&_this.init()}}set_heads_bodies_status(){let _this=this;_this._heads_statuses="",_this._bodies_statuses="";for(let _i=0;_i<_this.parts.length;_i++)ENEMY_BOSS_FRAME_HEAD.prototype.isPrototypeOf(_this.parts[_i])?_this._heads_statuses+=_this.parts[_i].isalive()?1:0:_this._bodies_statuses+=_this.parts[_i].isalive()?1:0}setDegAdd(_n){let _num=(this._deg+_n)%360;return _num<0?360+_num:_num}move_standby(){let _this=this;_this._deg=190,_this.x+=_this.speed*Math.cos(_this._deg*Math.PI/180),_this.y+=_this.speed*Math.sin(_this._deg*Math.PI/180),_this.moves.unshift({x:_this.x,y:_this.y,deg:_this._deg}),_this.moves.length>_this.parts.length*_this.moves_interval&&_this.moves.pop();for(let _i=0;_i<_this.parts.length;_i++){let _m=_this.moves[_i*_this.moves_interval];if(void 0===_m)break;_this.parts[_i].moveDraw({x:_m.x,y:_m.y,deg:_m.deg})}_this.x<_CANVAS.width-300&&(_this.movePos._setPos(),_this._standby=!1)}move(){let _this=this;if(_this.isMove()){_this.set_heads_bodies_status(),_this.moves.unshift({x:_this.x,y:_this.y,deg:_this.setDegAdd(_this.moves_pt[_this._mpt].setDeg)}),_this.moves.length>_this.parts.length*_this.moves_interval&&_this.moves.pop(),_this.movePos.move(),_this.moves_pt[_this._mpt].move();for(let _i=0;_i<_this.parts.length&&void 0!==_this.moves[_i*_this.moves_interval];_i++){let _m=_this.moves[_i*_this.moves_interval];_this.parts[_i].moveDraw({x:_m.x,y:_m.y,deg:_m.deg})}_this._f||_this.parts[0].isalive()||(_this._f=!0,_this.parts.reverse(),_this.moves.reverse(),_this.x=_this.moves[0].x,_this.y=_this.moves[0].y,_this.parts[0].setDirect(_this._DEF_DIR._R),_this._deg=_this.moves[0].deg+180,_this.moves_pt[_this._mpt].switch(0),_this._mpt=0),_this.setSelfCollision(),_this._c++}}}class ENEMY_BOSS_FRAME_HEAD extends GameObject_ENEMY{constructor(_d){super(_CANVAS_IMGS.enemy_frame_head1.obj,_d.x,_d.y);this.direct=_d.d||this._DEF_DIR._R,this.img=this.direct===this._DEF_DIR._L?_CANVAS_IMGS.enemy_frame_head3.obj:_CANVAS_IMGS.enemy_frame_head1.obj,this._standby=!1,this._status=75,this.getscore=5e3,this.deg=0,this.shotColMap=["30,30,"+(this.img.width-60)+","+(this.img.height-60)],this._collision_type="t9",this.audio_collision=_CANVAS_AUDIOS.enemy_collision6,this.num_col=6}showCollapes(){let _this=this,_e=_this.getEnemyCenterPosition();_this._isshow=!1;for(let _i=0;_i<(_this.num_col||1);_i++)_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(_e._x+Math.random()*(Math.random()>.5?100:-100),_e._y+Math.random()*(Math.random()>.5?100:-100),_this._collision_type));_GAME._setPlay(_this.audio_collision)}setDirect(_dir){this.direct=_dir}shot(){let _this=this;_this.img=_this._c%200<150&&_this._c%200>0?_this.direct===_this._DEF_DIR._L?_CANVAS_IMGS.enemy_frame_head3.obj:_CANVAS_IMGS.enemy_frame_head1.obj:_this.direct===_this._DEF_DIR._L?_CANVAS_IMGS.enemy_frame_head4.obj:_CANVAS_IMGS.enemy_frame_head2.obj,_this._c%200==150&&_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME(_this.x,_this.y,_this.deg+90))}moveDraw(_loc){let _this=this;_this.isshow()&&(_this.isalive()?(_this.shot(),_this.x=_loc.x,_this.y=_loc.y,_this.deg=_loc.deg,_CONTEXT.save(),_CONTEXT.translate(_this.x+_this.img.width/4,_this.y+_this.img.height/4),_CONTEXT.rotate(_this.deg*Math.PI/180),_CONTEXT.drawImage(_this.img,-_this.img.width/2,-_this.img.height/2,_this.img.width,_this.img.height),_CONTEXT.restore(),_this._c=_this._c>200?0:_this._c+1):_this.showCollapes())}move(){}}class ENEMY_BOSS_FRAME_BODY extends GameObject_ENEMY{constructor(_d){super(_CANVAS_IMGS.enemy_frame_body1.obj,_d.x,_d.y);this.img=_CANVAS_IMGS.enemy_frame_body1.obj,this._standby=!1,this.is_able_collision=!1,this.shotColMap=["5,5,"+(this.img.width-10)+","+(this.img.height-10)],this.deg=0,this.speed=Math.random>.4?-10:10,this.is_frame_heads_collision=!1}showCollapes(){let _this=this;if(_GAME.isEnemyCanvasOut(_this))return _this._status=0,void(_this._isshow=!1);_this.x+=Math.cos(_this.deg*Math.PI/180)*_this.speed,_this.y+=Math.sin(_this.deg*Math.PI/180)*_this.speed,_this.setDrawImageRotate(_this.deg)}moveDraw(_loc){let _this=this;if(_this.isshow()){if(_this.is_frame_heads_collision)return _this._standby=!0,void _this.showCollapes();_this.x=_loc.x,_this.y=_loc.y,_this.deg=_loc.deg,_this.setDrawImageRotate(_this.deg)}}move(){}}class GameObject_ENEMY_SHOT{constructor(_x,_y,_tx,_ty){this.x=_x||500,this.y=_y||300,this.tx=_tx||_PLAYERS_MAIN.getPlayerCenterPosition()._x,this.ty=_ty||_PLAYERS_MAIN.getPlayerCenterPosition()._y,this.img=_CANVAS_IMGS.enemy_bullet1.obj,this._c=0,this.speed=_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SHOT_SPEED,this.rad=Math.atan2(this.ty-this.y,this.tx-this.x),this.deg=180*this.rad/Math.PI,this.sx=Math.cos(this.rad),this.sy=Math.sin(this.rad),this._shot_alive=!0,this._isshow=!0,this.shotColMap=["0,0,"+this.img.width+","+this.img.height]}init(){this._shot_alive=!1,this._isshow=!1}ani_enemy_bullet(){this.img=_CANVAS_IMGS["enemy_bullet"+parseInt(this._c/4+1)].obj,this._c=this._c>=7?0:this._c+1}map_collition(){let _this=this,_map_x=_MAP.getMapX(_this.x),_map_y=_MAP.getMapY(_this.y);_MAP.isMapCollision(_map_x,_map_y)&&_this.init()}getEnemyCenterPosition(){return{_x:this.x+this.img.width/2,_y:this.y+this.img.height/2}}isalive(){return this._shot_alive}isshow(){return this._isshow}setDrawImageRotate(_deg){_CONTEXT.save(),_CONTEXT.translate(this.x+this.img.width/2,this.y+this.img.height/2),_CONTEXT.rotate(this.deg*Math.PI/180),_CONTEXT.drawImage(this.img,-this.img.width/2,-this.img.height/2,this.img.width,this.img.height),_CONTEXT.restore()}setDrawImageDirect(){let rad=this.rad;var cx=this.x+this.img.width,cy=this.y+this.img.height;_CONTEXT.setTransform(Math.cos(rad),Math.sin(rad),-Math.sin(rad),Math.cos(rad),cx-cx*Math.cos(rad)+cy*Math.sin(rad),cy-cx*Math.sin(rad)-cy*Math.cos(rad)),_CONTEXT.drawImage(this.img,this.x+this.img.width,this.y+this.img.height,this.img.width,this.img.height)}move(){let _this=this;_this.map_collition(),_this.y=_MAP.getY(_this.y),_GAME.isEnemyCanvasOut(_this)?_this.init():_this._shot_alive&&(_this.ani_enemy_bullet(),_this.x+=_this.sx*_this.speed,_this.y+=_this.sy*_this.speed,_CONTEXT.drawImage(_this.img,_this.x-_this.img.width/2,_this.y-_this.img.height/2,_this.img.width,_this.img.height),_this._shot_alive=!0)}}class GameObject_ENEMY_SHOT2 extends GameObject_ENEMY_SHOT{constructor(_x,_y,_sx,_sy){super(_x,_y),this.sx=_sx||1,this.sy=_sy||1}}class ENEMY_SHOT_LASER extends GameObject_ENEMY_SHOT{constructor(_x,_y,_img){super(_x,_y),this.img=_img||_CANVAS_IMGS.enemy_bullet_laser.obj,this.speed=10}move(){let _this=this;_GAME.isEnemyCanvasOut(_this)?_this.init():_this._shot_alive&&(_this.map_collition(),_this.x-=_this.speed,_CONTEXT.drawImage(_this.img,_this.x,_this.y,_this.img.width,_this.img.height))}}class ENEMY_SHOT_CRYSTALCORE extends GameObject_ENEMY_SHOT{constructor(_x,_y,_deg){super(_x,_y);this.img=_CANVAS_IMGS.enemy_cristalcore_shot.obj,this.speed=10,this.deg=_deg||0,this.rad=this.deg*Math.PI/180,this.sx=Math.cos(this.rad),this.sy=Math.sin(this.rad)}move(){let _this=this;_GAME.isEnemyCanvasOut(_this)?_this.init():_this._shot_alive&&(_this.map_collition(),_this.x-=_this.sx*_this.speed,_this.y-=_this.sy*_this.speed,_CONTEXT.save(),_this.setDrawImageDirect(),_CONTEXT.restore())}}class ENEMY_SHOT_FRAME extends GameObject_ENEMY_SHOT{constructor(_x,_y,_deg){super(_x,_y);this.img=_CANVAS_IMGS.enemy_frame_3.obj,this.speed=1,this.deg=_deg||0,this.rad=this.deg*Math.PI/180,this.sx=Math.cos(this.rad),this.sy=Math.sin(this.rad),this._c=0}move(){let _this=this;if(_GAME.isEnemyCanvasOut(_this))_this.init();else if(_this._shot_alive){if(_this.map_collition(),_this._c>100){let _e=_this.getEnemyCenterPosition();_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME_SMALL(_e._x,_e._y,0)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME_SMALL(_e._x,_e._y,30)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME_SMALL(_e._x,_e._y,60)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME_SMALL(_e._x,_e._y,90)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME_SMALL(_e._x,_e._y,120)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME_SMALL(_e._x,_e._y,150)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME_SMALL(_e._x,_e._y,180)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME_SMALL(_e._x,_e._y,210)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME_SMALL(_e._x,_e._y,240)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME_SMALL(_e._x,_e._y,270)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME_SMALL(_e._x,_e._y,300)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME_SMALL(_e._x,_e._y,330)),_this.init()}_this._shot_alive&&(_this.map_collition(),_this.x-=_this.sx*_this.speed,_this.y-=_this.sy*_this.speed,_CONTEXT.save(),_this.setDrawImageRotate(),_CONTEXT.restore(),_this._c++)}}}class ENEMY_SHOT_FRAME_SMALL extends GameObject_ENEMY_SHOT{constructor(_x,_y,_deg){super(_x,_y);this.img=_CANVAS_IMGS.enemy_frame_5.obj,this.speed=5,this.deg=_deg||0,this.rad=this.deg*Math.PI/180,this.sx=Math.cos(this.rad),this.sy=Math.sin(this.rad)}move(){let _this=this;_GAME.isEnemyCanvasOut(_this)?_this.init():_this._shot_alive&&(_this.map_collition(),_this.x-=_this.sx*_this.speed,_this.y-=_this.sy*_this.speed,_CONTEXT.save(),_this.setDrawImageRotate(),_CONTEXT.restore())}}class MAP_OBJECT{constructor(){this._s="1",this._c=0,this._DEF_DIR={_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},this.img=new Image,this.imgs=[]}getImg(){return this.img.obj}}class MAP_CUBE_A extends MAP_OBJECT{constructor(){super();this._s="1",this.img=_CANVAS_IMGS.map_cube_A}}class MAP_CRISTAL extends MAP_OBJECT{constructor(){super();this._s="011,111,110",this.img=_CANVAS_IMGS.enemy_p_1}}class MAP_MOAI_A extends MAP_OBJECT{constructor(){super();this._s="0000000000,1111111111,1111111111,0000000000",this.img=_CANVAS_IMGS.map_moai_A}}class MAP_MOAI_B extends MAP_MOAI_A{constructor(){super();this.img=_CANVAS_IMGS.map_moai_B}}class MAP_VOLCANO_A extends MAP_OBJECT{constructor(){super();this._s="111111111,111111111,000000000",this.img=_CANVAS_IMGS.map_volcano_A}}class MAP_VOLCANO_B extends MAP_VOLCANO_A{constructor(){super();this.img=_CANVAS_IMGS.map_volcano_B}}class MAP_VOLCANO_C extends MAP_VOLCANO_A{constructor(){super();this._s="000000000,111111111,111111111",this.img=_CANVAS_IMGS.map_volcano_C}}class MAP_VOLCANO_D extends MAP_VOLCANO_A{constructor(){super();this._s="000000000,111111111,111111111",this.img=_CANVAS_IMGS.map_volcano_D}}class MAP_VOLCANO_F extends MAP_VOLCANO_A{constructor(){super();this._s="000110000,000110000,001111000,011111100,011111110,111111111",this.img=_CANVAS_IMGS.map_volcano_F}}class MAP_VOLCANO_G extends MAP_VOLCANO_A{constructor(){super();this._s="111111110,011111110,011111100,001111000,000110000,000110000",this.img=_CANVAS_IMGS.map_volcano_G}}class MAP_VOLCANO_H extends MAP_VOLCANO_A{constructor(){super();this._s="00000000000000000000,00000111111111111110,00000111111110000000,00000000011110000000,00000000001100000000,00000000001100000000,00000000001100000000,11111111111111111100,01111111111111111100,00000000011000000000,00000000011000000000,00000000111000000000,00000001111110000000",this.img=_CANVAS_IMGS.map_volcano_H}}class MAP_VOLCANO_I extends MAP_VOLCANO_A{constructor(){super();this._s="000000010000000,000000010000000,000000111000000,000001111100000,000011111110000,000111111111000,001111111111100,001111111111100,011111111111110,111111111111111",this.img=_CANVAS_IMGS.map_volcano_I}}class MAP_VOLCANO_J extends MAP_VOLCANO_A{constructor(){super();this._s="111111111111111,011111111111110,001111111111100,001111111111100,000111111111000,000011111110000,000001111100000,000000111000000,000000010000000,000000010000000",this.img=_CANVAS_IMGS.map_volcano_J}}class MAP_VOLCANO_K extends MAP_VOLCANO_A{constructor(){super();this._s="010",this.img=_CANVAS_IMGS.map_volcano_K}}class MAP_VOLCANO_L extends MAP_VOLCANO_A{constructor(){super();this._s="010",this.img=_CANVAS_IMGS.map_volcano_L}}class MAP_VOLCANO_M extends MAP_VOLCANO_A{constructor(){super();this._s="0111,1111",this.img=_CANVAS_IMGS.map_volcano_M}}class MAP_VOLCANO_N extends MAP_VOLCANO_A{constructor(){super();this._s="1111,0111",this.img=_CANVAS_IMGS.map_volcano_N}}class MAP_VOLCANO_O extends MAP_VOLCANO_A{constructor(){super();this._s="1111,1110",this.img=_CANVAS_IMGS.map_volcano_O}}class MAP_VOLCANO_P extends MAP_VOLCANO_A{constructor(){super();this._s="1110,1111",this.img=_CANVAS_IMGS.map_volcano_P}}class MAP_FRAME_A extends MAP_OBJECT{constructor(){super();this._s="000000000,11111111,11111111",this._c=0,this.img=_CANVAS_IMGS.map_frame_A_1,this.imgs=[_CANVAS_IMGS.map_frame_A_1,_CANVAS_IMGS.map_frame_A_2,_CANVAS_IMGS.map_frame_A_3,_CANVAS_IMGS.map_frame_A_4,_CANVAS_IMGS.map_frame_A_5]}getImg(){return this._c=this._c>=10*this.imgs.length-1?0:this._c+1,this.imgs[parseInt(this._c/10)].obj}}class MAP_FRAME_B extends MAP_FRAME_A{constructor(){super();this._s="11111111,11111111,00000000",this.img=_CANVAS_IMGS.map_frame_B_1,this.imgs=[_CANVAS_IMGS.map_frame_B_1,_CANVAS_IMGS.map_frame_B_2,_CANVAS_IMGS.map_frame_B_3,_CANVAS_IMGS.map_frame_B_4,_CANVAS_IMGS.map_frame_B_5]}}class MAP_FRAME_C extends MAP_FRAME_A{constructor(){super();this._s="00,01,11",this.img=_CANVAS_IMGS.map_frame_C_1,this.direct=this._DEF_DIR._LD,this.imgs=[_CANVAS_IMGS.map_frame_C_1,_CANVAS_IMGS.map_frame_C_2,_CANVAS_IMGS.map_frame_C_3,_CANVAS_IMGS.map_frame_C_4,_CANVAS_IMGS.map_frame_C_5]}}class MAP_FRAME_D extends MAP_FRAME_A{constructor(){super();this._s="11,01,00",this.img=_CANVAS_IMGS.map_frame_D_1,this.direct=this._DEF_DIR._LU,this.imgs=[_CANVAS_IMGS.map_frame_D_1,_CANVAS_IMGS.map_frame_D_2,_CANVAS_IMGS.map_frame_D_3,_CANVAS_IMGS.map_frame_D_4,_CANVAS_IMGS.map_frame_D_5]}}class MAP_FRAME_E extends MAP_FRAME_A{constructor(){super();this._s="00,10,11",this.img=_CANVAS_IMGS.map_frame_E_1,this.direct=this._DEF_DIR._LU,this.imgs=[_CANVAS_IMGS.map_frame_E_1,_CANVAS_IMGS.map_frame_E_2,_CANVAS_IMGS.map_frame_E_3,_CANVAS_IMGS.map_frame_E_4,_CANVAS_IMGS.map_frame_E_5]}}class MAP_FRAME_F extends MAP_FRAME_A{constructor(){super();this._s="11,10,00",this.img=_CANVAS_IMGS.map_frame_F_1,this.direct=this._DEF_DIR._LU,this.imgs=[_CANVAS_IMGS.map_frame_F_1,_CANVAS_IMGS.map_frame_F_2,_CANVAS_IMGS.map_frame_F_3,_CANVAS_IMGS.map_frame_F_4,_CANVAS_IMGS.map_frame_F_5]}}class GameObject_PLAYER{constructor(_imgfile,_x,_y,_isalive){this.img=_CANVAS_IMGS[_imgfile].obj,this.x=_x||100,this.y=_y||100,this._x=0,this._y=0,this._isalive=_isalive||!1,this._scalechange=!0,this.width=0,this.height=0,this._c=0,this.accel=3,this.shotflag=!1}isalive(){return this._isalive}isshotflag(){return this.shotflag}enemy_collision(){}getPlayerCenterPosition(){return{_x:this.x+this.img.width/2,_y:this.y+this.img.height/2}}setfalsealive(){this._isalive=!1}settruealive(){this._isalive=!0}}class GameObject_PLAYER_MAIN extends GameObject_PLAYER{constructor(){super("vicviper1",100,200,!0),this._isequipped=!1,this._isequipped_count=0,this.c_vv_ani=20,this.vv_ani=[{img:_CANVAS_IMGS.vicviper3.obj,scale:1},{img:_CANVAS_IMGS.vicviper2.obj,scale:1},{img:_CANVAS_IMGS.vicviper1.obj,scale:1},{img:_CANVAS_IMGS.vicviper4.obj,scale:1},{img:_CANVAS_IMGS.vicviper5.obj,scale:1}],this.vv_e_ani=[{img:_CANVAS_IMGS.vicviper3_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper2_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper1_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper4_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper5_e.obj,scale:1}],this.c_vb_ani=0,this.vb_ani=[{img:_CANVAS_IMGS.vicviper_back1.obj,scale:1},{img:_CANVAS_IMGS.vicviper_back2.obj,scale:1},{img:_CANVAS_IMGS.vicviper_back3.obj,scale:1}],this.vb_e_ani=[{img:_CANVAS_IMGS.vicviper_back1_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper_back1_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper_back1_e.obj,scale:1}],this._eq_ani_c=0,this.eq_ani=[{img:_CANVAS_IMGS.vicviper4.obj,scale:1},{img:_CANVAS_IMGS.vicviper1.obj,scale:1}],this._col_ani_c=0,this.col_ani=[{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.7},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.3},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.1}],this.shotflag=!0}collapes(){null!==_DRAW_SETINTERVAL&&(_GAME._setStopOnBG(),_DRAW_STOP(),_DRAW_PLAYER_COLLAPES())}enemy_collision(_e){1===_PLAYERS_POWER_METER_SHIELD&&_PLAYERS_MAIN_FORCE.isalive()||_GAME.isSqCollision("25,26,35,32",this.x+","+this.y,_e.shotColMap,_e.x+","+_e.y)!==_IS_SQ_NOTCOL&&(_e.collision(),this.setfalsealive())}enemy_shot_collision(_e){1===_PLAYERS_POWER_METER_SHIELD&&_PLAYERS_MAIN_FORCE.isalive()||_GAME.isSqCollision("25,20,35,30",this.x+","+this.y,_e.shotColMap,_e.x+","+_e.y)!==_IS_SQ_NOTCOL&&(_e.init(),this.setfalsealive())}set_equipped(){this._isequipped_count=20}map_collition(){if(1===_PLAYERS_POWER_METER_SHIELD&&_PLAYERS_MAIN_FORCE.isalive())return;let _pl=this.getPlayerCenterPosition(),_map_x=_MAP.getMapX(_pl._x),_map_y=_MAP.getMapY(_pl._y);_MAP.isMapCollision(_map_x,_map_y)&&this.setfalsealive()}set_vv_ani(_e_key){"ArrowUp"!==_e_key&&"Up"!==_e_key||(this.c_vv_ani-=2),"ArrowDown"!==_e_key&&"Down"!==_e_key||(this.c_vv_ani+=2)}set_moveamount_reset(){_MAP.setBackGroundSpeedY(0),this._x=0,this._y=0}set_moveamount(){let _this=this;_PLAYERS_MOVE_FLAG?(_this.x=function(_i){let _x=_this.x+_this._x;return _x<=50?(_this._x=0,50):_x>=_CANVAS.width-100?(_this._x=0,_CANVAS.width-100):_x}(),_this.y=function(_i){let _y=_this.y+_this._y;return _MAP.map_infinite?_y<100?(_MAP.setBackGroundSpeedY(_this._y),100):(_y>=100&&_y<=300&&_MAP.setBackGroundSpeedY(0),_y>300?(_MAP.setBackGroundSpeedY(_this._y),300):_y):_y<=50-_this.img.height/4?(_this._y=0,50-_this.img.height/4):_y>=_CANVAS.height-75-_this.img.height/4?(_this._y=0,_CANVAS.height-75-_this.img.height/4):_y}(),_GAME._setPlayerMoveDraw()):_this.set_moveamount_reset()}move(){let _this=this;if(!_this.isalive())return void _this.collapes();_this.map_collition(),_this.set_moveamount(),_PLAYERS_MOVE_FLAG?_this.c_vv_ani>46?_this.c_vv_ani=46:_this.c_vv_ani<4&&(_this.c_vv_ani=4):_this.c_vv_ani>25?_this.c_vv_ani-=1:_this.c_vv_ani<25?_this.c_vv_ani+=1:_this.c_vv_ani=25;let _img_vv=function(){let _c=parseInt(_this.c_vv_ani/10);return _this._isequipped_count<=0?_this.vv_ani[_c].img:(_this._isequipped_count--,_this._isequipped_count>0&&_this._isequipped_count%2==0?_this.vv_e_ani[_c].img:_this.vv_ani[_c].img)}();_CONTEXT.drawImage(_img_vv,_this.x,_this.y,_img_vv.width,_img_vv.height);let _img_vb=function(){let _c=parseInt(_this.c_vb_ani/3);return _this._isequipped_count>0&&_this._isequipped_count%2==0?_this.vb_e_ani[_c].img:_this.vb_ani[_c].img}();_this.width=_img_vb.width,_this.height=_img_vb.height,_this.c_vb_ani=_GAME._ac._get(_this.c_vb_ani,_this.vb_ani,3),_CONTEXT.drawImage(_img_vb,_this.x,_this.y+22,_img_vb.width,_img_vb.height)}}class GameObject_PLAYER_MAIN_RED extends GameObject_PLAYER_MAIN{constructor(){super("vicviper1",100,200,!0),this.col_ani=[{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.7},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.3},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.1}]}}class GameObject_PLAYER_OPTION extends GameObject_PLAYER{constructor(_imgfile,_x,_y,_isalive){super(_imgfile,_x,_y,_isalive),this.scalemax=1.3,this.scalemin=1,this._ani_c=0,this.ani=[{img:_CANVAS_IMGS.option.obj,scale:1},{img:_CANVAS_IMGS.option.obj,scale:.9},{img:_CANVAS_IMGS.option.obj,scale:.8},{img:_CANVAS_IMGS.option.obj,scale:.7},{img:_CANVAS_IMGS.option.obj,scale:.8},{img:_CANVAS_IMGS.option.obj,scale:.9}]}move(_pmd_elem){let _this=this,_x=_GAME._getPlayerMoveDrawX(_pmd_elem),_y=_GAME._getPlayerMoveDrawY(_pmd_elem);if(null===_x||null===_y)return;if(_this.x=_x,_this.y=_y,!_this._isalive)return;if(void 0===_this.x||void 0===_this.y)return;_this.shotflag=!0;let _pl=_this.getPlayerCenterPosition();_this.img=(_this._ani_c=_this._ani_c>=3*_this.ani.length-1?0:_this._ani_c+1,_this.ani[parseInt(_this._ani_c/3)].img);let _c=parseInt(_this._ani_c/3),_w=_this.img.width,_h=_this.img.height,_sw=_w*_this.ani[_c].scale,_sh=_h*_this.ani[_c].scale;_CONTEXT.drawImage(_this.img,_pl._x-_sw/2,_pl._y-_sh/2,_sw,_sh)}}class GameObject_FORCEFIELD{constructor(){this.img="",this.STATUS_MAX=4,this.x=0,this.y=0,this.width=0,this.height=0,this.type="forcefield",this._c=0,this._scale=0,this._eid=0,this.ani=[{img:_CANVAS_IMGS.forcefield1.obj,scale:1},{img:_CANVAS_IMGS.forcefield2.obj,scale:1}]}init(){this._scale=1,this.img=this.ani[0].img,this.width=this.img.width,this.height=this.img.height}isalive(){return 0!==this._scale}enemy_collision(_e){this.isalive()&&_GAME.isSqCollision(parseInt(this.width/8)+","+parseInt(this.height/8)+","+parseInt(6*this.width/8)+","+parseInt(6*this.height/8),this.x+","+this.y,_e.shotColMap,_e.x+","+_e.y)!==_IS_SQ_NOTCOL&&(_e.collision(),this.reduce())}enemy_shot_collision(_e){this.isalive()&&_GAME.isSqCollision(parseInt(this.width/8)+","+parseInt(this.height/8)+","+parseInt(6*this.width/8)+","+parseInt(6*this.height/8),this.x+","+this.y,_e.shotColMap,_e.x+","+_e.y)!==_IS_SQ_NOTCOL&&(_e.init(),this.reduce())}getPlayerCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}map_collition(){let _pl=this.getPlayerCenterPosition(),_map_x=_MAP.getMapX(_pl._x),_map_y=_MAP.getMapY(_pl._y);_MAP.isMapCollision(_map_x,_map_y)&&this.reduce()}reduce(){this.isalive()&&(this._scale-=.06,this._scale<.7&&(this._scale=0,_POWERMETER._set_meter_on("000001")),this.width*=this._scale,this.height*=this._scale,_GAME._setPlay(_CANVAS_AUDIOS.vicviper_shield_reduce))}move(_GO){let _this=this;if(!_this.isalive())return;_this.map_collition(),_this.x=_GO.getPlayerCenterPosition()._x-_this.width/2-6,_this.y=_GO.getPlayerCenterPosition()._y-_this.height/2-2;let _img=(_this._c=_this._c>=5*_this.ani.length-1?0:_this._c+1,_this.ani[parseInt(_this._c/5)].img);_CONTEXT.drawImage(_img,_this.x,_this.y,_this.width,_this.height)}}class GameObject_FORCEFIELD_RED extends GameObject_FORCEFIELD{constructor(){super(),this.ani=[{img:_CANVAS_IMGS.forcefield_red1.obj,scale:1},{img:_CANVAS_IMGS.forcefield_red2.obj,scale:1}]}}class GameObject_SHIELD extends GameObject_FORCEFIELD{constructor(){super(),this.STATUS_MAX=15,this.type="shield",this.ani=[{img:_CANVAS_IMGS.shield1.obj,scale:1},{img:_CANVAS_IMGS.shield2.obj,scale:1}]}getPlayerCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height}}init(){this._scale=1,this.img=this.ani[0].img,this.width=this.img.width,this.height=this.img.height}isalive(){return 0!==this._scale}enemy_collision(_e){_GAME.isSqCollision("0,0,"+this.width+","+2*this.height,parseInt(this.x)+","+parseInt(this.y),_e.shotColMap,_e.x+","+_e.y)!==_IS_SQ_NOTCOL&&(_e.collision(),this.reduce())}enemy_shot_collision(_e){_GAME.isSqCollision("0,0,"+this.width+","+2*this.height,parseInt(this.x)+","+parseInt(this.y),_e.shotColMap,_e.x+","+_e.y)!==_IS_SQ_NOTCOL&&(_e.init(),this.reduce())}map_collition(_p){let _this=this,_pl=_this.getPlayerCenterPosition(),_map_x=_MAP.getMapX(_pl._x),_map_y=_MAP.getMapY(_pl._y);_MAP.isMapCollision(_map_x,_map_y)?_this.reduce():(_map_y=_MAP.getMapY(_this.y),_MAP.isMapCollision(_map_x,_map_y)?_this.reduce():(_map_y=_MAP.getMapY(_pl._y-10+_this.height),_MAP.isMapCollision(_map_x,_map_y)&&_this.reduce()))}reduce(){this.isalive()&&(this._scale-=.01,this._scale<.86&&(this._scale=0,_POWERMETER._set_meter_on("000001")),this.width*=this._scale,this.height*=this._scale,_GAME._setPlay(_CANVAS_AUDIOS.vicviper_shield_reduce))}move(_p){let _this=this;if(!_this.isalive())return;let _pl=_p.getPlayerCenterPosition();_this.map_collition(_p);let _img=(_this._c=_this._c>=5*_this.ani.length-1?0:_this._c+1,_this.ani[parseInt(_this._c/5)].img),_x=_p.x+_p.img.width,_y1=_pl._y,_y2=_pl._y-_this.height*_this._scale;_CONTEXT.drawImage(_img,_x,_y1,_this.width,_this.height),_CONTEXT.drawImage(_img,_x,_y2,_this.width,_this.height),this.x=_x,this.y=_y2}}class GameObject_SHIELD_RED extends GameObject_SHIELD{constructor(){super(),this.ani=[{img:_CANVAS_IMGS.shield_red1.obj,scale:.4},{img:_CANVAS_IMGS.shield_red2.obj,scale:.4}]}}class GameObject_SHOTS{constructor(_p){this.shots=new Array,this.player=_p,this._sq=0}enemy_collision(_e){if(this.player.isalive())for(let _k=0;_k<this.shots.length;_k++){let _t=this.shots[_k];if(!_t._shot_alive)continue;if(_e.x<this.player.x)continue;let _s=_GAME.isSqCollision("-12,-12,12,12",_t.x+","+_t.y,_e.shotColMap,_e.x+","+_e.y);_s!==_IS_SQ_NOTCOL&&(_s===_IS_SQ_COL&&_e.collision(_SHOTTYPE_NORMAL),_t._init())}}map_collition(){}getshottype(){}move(){}}class GameObject_SHOTS_MISSILE extends GameObject_SHOTS{constructor(_p){super(_p),this.shots=new Array,this.col_mis=[{fs:"rgba(255,246,72,1)",scale:8},{fs:"rgba(255,131,62,1)",scale:10},{fs:"rgba(255,246,72,1)",scale:12},{fs:"rgba(255,131,62,1)",scale:14},{fs:"rgba(133,0,4,1)",scale:12},{fs:"rgba(100,0,4,1)",scale:14},{fs:"rgba(133,0,4,1)",scale:12}];for(let _i=0;_i<_PLAYERS_SHOTS_MAX;_i++)this.shots.push({sid:_SHOTTYPE_MISSILE,id:_i,x:0,y:0,_t:0,_st:"_st1",_img:new Image,_audio:_CANVAS_AUDIOS.missile,_c_mc:0,_c:0,_c_area:25,_enemyid:null,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._t=0,this._c=0,this._c_mc=0,this._c_area=25,this._st="_st1",this._img=new Image,this._enemyid=null,this._shot=!1,this._shot_alive=!1}});let _this=this;this.mis_status={_st1:function(_t){let _p=_this.player.getPlayerCenterPosition();var _i;_t.x=(_i=_t.x,_t._shot_alive?_i+4:_p._x),_t.y=function(_i){return _t._shot_alive?_i+8:_p._y}(_t.y),_t._img=_CANVAS_IMGS.missile1.obj},_st2:function(_t){_t.y+=8,_t._img=_CANVAS_IMGS.missile2.obj},_st3:function(_t){_t.x+=8,_t._img=_CANVAS_IMGS.missile3.obj},_st4:function(_t){_t.x+=2,_t.y+=1,_t._img=_CANVAS_IMGS.missile4.obj},_st5:function(_t){_t.x+=2,_t.y+=2,_t._img=_CANVAS_IMGS.missile5.obj},_st6:function(_t){_t.x+=2,_t.y+=4,_t._img=_CANVAS_IMGS.missile1.obj},_st7:function(_t){_t.x+=4,_t.y+=3,_t._img=_CANVAS_IMGS.missile5.obj},_st8:function(_t){_t.x+=4,_t.y+=1,_t._img=_CANVAS_IMGS.missile4.obj}}}enemy_collision(_e,_t){if(!this.player.isalive())return;if(!_t._shot_alive)return;let _s=_GAME.isSqCollision(0-_t._img.width/4+","+(0-_t._img.height/4)+","+5*_t._img.width/4+","+5*_t._img.height/4,_t.x+","+_t.y,_e.shotColMap,_e.x+","+_e.y);_s!==_IS_SQ_NOTCOL&&(_t._c>0||(0===_t._c&&(_t._c=1),_s!==_IS_SQ_COL_NONE&&_e.collision(_SHOTTYPE_MISSILE)))}get_missile_status(_t){return _t._st}set_missile_status(_t,_st){"_st1"!==this._st&&"_st2"!==this._st&&"_st3"!==this._st&&(_t._c_mc++,_t._c_mc>1?_t._c_mc=0:_t._st=_st)}map_collition(_t){let _this=this,_map_x=_MAP.getMapX(_t.x+_t._img.width),_map_y=_MAP.getMapY(_t.y);var _setToSt3=function(){if(_map_y=_MAP.getMapY(_t.y+_t._img.height),!_MAP.isMapCollision(_map_x,_map_y))return!1;if(!1===_MAP.map_infinite){var _a=parseInt(_t.y/_MAP.t),_b=_t.y%_MAP.t<_MAP.t/2?_a:_a+1;_t.y=_b*_MAP.t}return _this.set_missile_status(_t,"_st3"),!0};if(!_MAP.isMapBefore(_map_x,_map_y)){if(_MAP.isMapOver(_map_x,_map_y)){if("_st3"===_this.get_missile_status(_t))return void _this.set_missile_status(_t,"_st4");if("_st2"===_this.get_missile_status(_t))return}if("_st4"===_this.get_missile_status(_t)&&_this.set_missile_status(_t,"_st5"),"_st6"===_this.get_missile_status(_t)){if(_map_x=_MAP.getMapX(_t.x+_t._img.width),_MAP.isMapCollision(_map_x,_map_y))return void _t._init();if(_setToSt3())return;_this.set_missile_status(_t,"_st7")}if("_st7"===_this.get_missile_status(_t)){if(_map_x=_MAP.getMapX(_t.x+_t._img.width),_MAP.isMapCollision(_map_x,_map_y))return void _t._init();if(_t.x+=2,_setToSt3())return;_this.set_missile_status(_t,"_st8")}if("_st8"===_this.get_missile_status(_t)){if(_map_x=_MAP.getMapX(_t.x+_t._img.width),_MAP.isMapCollision(_map_x,_map_y))return void _t._init();if(_t.x+=2,_setToSt3())return;_this.set_missile_status(_t,"_st3")}if("_st5"===_this.get_missile_status(_t)){if(_map_x=_MAP.getMapX(_t.x+_t._img.width),_MAP.isMapCollision(_map_x,_map_y+1))return void _this.set_missile_status(_t,"_st6");if(_MAP.isMapCollision(_map_x+1,_map_y))return void _t._init();_this.set_missile_status(_t,"_st2"),_t.x+=3}if("_st3"===_this.get_missile_status(_t)){if(_map_x=_MAP.getMapX(_t.x+_t._img.width/2),_map_y=_MAP.getMapY(_t.y+_t._img.height/2),_MAP.isMapCollision(_map_x,_map_y))return void _t._init();if(!_MAP.isMapCollision(_map_x+1,_map_y+1))return void _this.set_missile_status(_t,"_st4");if(_MAP.isMapOver(_map_x,_map_y))return void _this.set_missile_status(_t,"_st4")}if("_st2"===_this.get_missile_status(_t)&&(_map_y=_MAP.getMapY(_t.y+_t._img.height+10),_MAP.isMapCollision(_map_x,_map_y)))_this.set_missile_status(_t,"_st6");else if("_st1"===_this.get_missile_status(_t)){if(_map_y=_MAP.getMapY(_t.y+_t._img.height+16),_MAP.isMapCollision(_map_x+1,_map_y))return void _this.set_missile_status(_t,"_st6");if(_MAP.isMapCollision(_map_x,_map_y))return void _this.set_missile_status(_t,"_st6")}}}collapse_missile(_t,_pos){let _this=this;if(_t.x=_MAP.getX(_t.x),_pos=_pos||-5,_t._c>=5*_this.col_mis.length)return void _t._init();let _c=parseInt(_t._c/5);_t._c_area=_this.col_mis[_c].scale,_CONTEXT.fillStyle=_this.col_mis[_c].fs,_CONTEXT.beginPath(),_CONTEXT.arc(_t.x,_t.y+_pos,_this.col_mis[_c].scale,0,2*Math.PI,!1),_CONTEXT.fill(),void 0!==this.col_mis[_c-1]&&(_CONTEXT.fillStyle=_this.col_mis[_c-1].fs,_CONTEXT.beginPath(),_CONTEXT.arc(_t.x,_t.y+_pos,_this.col_mis[_c-1].scale,0,2*Math.PI,!1),_CONTEXT.fill()),_t._c++}move(){let _this=this,_p=_this.player;if(_p.isalive()&&_p.isshotflag()&&void 0!==_p.x)for(let _j=0;_j<_this.shots.length;_j++){let _t=_this.shots[_j];(_t._shot||_t._shot_alive)&&(_t.y=_MAP.getShotY(_t.y),_t._c>0?_this.collapse_missile(_t,10):_GAME.isShotCanvasOut(_t)?_t._init():(_this.mis_status[_t._st](_t),"_st1"===_this.get_missile_status(_t)&&_MAP.isMapCollision(_MAP.getMapX(_t.x),_MAP.getMapY(_t.y))?_t._init():(_CONTEXT.drawImage(_t._img,_t.x,_t.y,_t._img.width,_t._img.height),_t._shot_alive=!0)))}}}class GameObject_SHOTS_MISSILE_PHOTOM extends GameObject_SHOTS_MISSILE{constructor(_p){super(_p);let _this=this;_this.mis_status._st1=function(_t){let _p=_this.player.getPlayerCenterPosition();var _i;_t.x=(_i=_t.x,_t._shot_alive?_i+4:_p._x),_t.y=function(_i){return _t._shot_alive?_i+8:_p._y}(_t.y),_t._img=_CANVAS_IMGS.missile3.obj}}enemy_collision(_e,_t){if(!this.player.isalive())return;if(!_t._shot_alive)return;let _s=_GAME.isSqCollision(_t._img.width/4+","+_t._img.height/4+","+3*_t._img.width/4+","+3*_t._img.height/4,_t.x+","+_t.y,_e.shotColMap,_e.x+","+_e.y);_s!==_IS_SQ_NOTCOL&&(_t._c>0||(_s!==_IS_SQ_COL_NONE?(_e.collision(_SHOTTYPE_MISSILE),_e.isalive()&&0===_t._c&&(_t._c=1)):0===_t._c&&(_t._c=1)))}}class GameObject_SHOTS_MISSILE_SPREADBOMB extends GameObject_SHOTS_MISSILE{constructor(_p){super(_p),this.col_mis=[{fs:"rgba(198,231,247,1)",scale:30},{fs:"rgba(54,115,255,1)",scale:40},{fs:"rgba(54,115,255,1)",scale:50},{fs:"rgba(54,115,255,1)",scale:60},{fs:"rgba(0,27,145,1)",scale:60},{fs:"rgba(0,27,145,1)",scale:60},{fs:"rgba(0,27,145,1)",scale:70}],this.mis_status={_st1:function(_t){_t._img=_CANVAS_IMGS.missile4.obj},_st2:function(_t){_t._img=_CANVAS_IMGS.missile5.obj},_st3:function(_t){_t._img=_CANVAS_IMGS.missile1.obj}}}enemy_collision(_e,_t){if(!this.player.isalive())return;if(!_t._shot_alive)return;_e.getEnemyCenterPosition();let _s=function(){if(_t._c>0){if(_t._c%20!=0)return _IS_SQ_NOTCOL;let _r=2*_t._c_area;Math.sqrt(2);return _GAME.isSqCollision("0,0,"+_r+","+_r,parseInt(_t.x-_r/2)+","+parseInt(_t.y-_r/2),_e.shotColMap,_e.x+","+_e.y)}return _GAME.isSqCollision(_t._img.width/4+","+_t._img.height/4+","+3*_t._img.width/4+","+3*_t._img.height/4,_t.x+","+_t.y,_e.shotColMap,_e.x+","+_e.y)}();_s!==_IS_SQ_NOTCOL&&(0===_t._c&&(_t._c=1),_s!==_IS_SQ_COL_NONE&&_e.collision(_SHOTTYPE_MISSILE))}map_collition(_t){let _map_x=_MAP.getMapX(_t.x),_map_y=_MAP.getMapY(_t.y);(_MAP.isMapCollision(_map_x,_map_y)||_MAP.isMapCollision(_map_x+1,_map_y))&&this.collapse_missile(_t,-25)}move(){let _this=this,_p=_this.player;if(!_p.isalive())return;if(!_p.isshotflag())return;if(void 0===_p.x)return;let _pl=_p.getPlayerCenterPosition();for(let _j=0;_j<_this.shots.length;_j++){let _t=_this.shots[_j];(_t._shot||_t._shot_alive)&&(_t.y=_MAP.getShotY(_t.y),_t._c>0?_this.collapse_missile(_t):(_t._t++,_t.x=(_i=_t.x,_t._shot_alive?_i+4:_pl._x),_t.y=function(_i){return _t._shot_alive?_i+_t._t*_t._t/200:_pl._y-8}(_t.y),_t._st=_t._t>20&&_t._t<30?"_st2":_t._t>30?"_st3":"_st1",_GAME.isShotCanvasOut(_t)?_t._init():(_this.mis_status[_t._st](_t),_CONTEXT.drawImage(_t._img,_t.x,_t.y,_t._img.width,_t._img.height),_t._shot_alive=!0)))}var _i}}class GameObject_SHOTS_MISSILE_2WAY extends GameObject_SHOTS_MISSILE{constructor(_p){super(_p),this.mis_status={_st1:function(_t){_t._img=_CANVAS_IMGS.missile4.obj},_st2:function(_t){_t._img=_CANVAS_IMGS.missile5.obj},_st3:function(_t){_t._img=_CANVAS_IMGS.missile1.obj},_st4:function(_t){_t._img=_CANVAS_IMGS.missile6.obj},_st5:function(_t){_t._img=_CANVAS_IMGS.missile7.obj},_st6:function(_t){_t._img=_CANVAS_IMGS.missile8.obj}}}enemy_collision(_e,_t){if(!this.player.isalive())return;if(!_t._shot_alive)return;let _s=_GAME.isSqCollision(_t._img.width/4+","+_t._img.height/4+","+3*_t._img.width/4+","+3*_t._img.height/4,_t.x+","+_t.y,_e.shotColMap,_e.x+","+_e.y);_s!==_IS_SQ_NOTCOL&&(_t._c>0||(0===_t._c&&(_t._c=1),_s!==_IS_SQ_COL_NONE&&_e.collision(_SHOTTYPE_MISSILE)))}map_collition(_t){let _map_x=_MAP.getMapX(_t.x),_map_y=_MAP.getMapY(0===_t.id?_t.y:_t.y+_t._img.height);_MAP.isMapCollision(_map_x,_map_y)&&0===_t._c&&(_t._c=1)}move(){let _this=this,_p=_this.player;if(!_p.isalive())return;if(!_p.isshotflag())return;if(void 0===_p.x)return;let _pl=_p.getPlayerCenterPosition(),_s=this.shots[0]._shot|this.shots[1]._shot,_sa=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(_s||_sa){_s&&!_sa&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let _j=0;_j<this.shots.length;_j++){let _t=this.shots[_j];_t._shot_alive&&(_t.y=_MAP.getShotY(_t.y),_t._c>0?_this.collapse_missile(_t,10):(_t._t+=1,_t.x=(_i=_t.x,_sa?_i+1:_pl._x),_t.y=function(_i){return 0===_j?_sa?_i+_t._t*_t._t/100*-1:_pl._y-20:_sa?_i+_t._t*_t._t/100:_pl._y}(_t.y),_GAME.isShotCanvasOut(_t)?_t._init():(_t._st=0===_j?_t._t>20&&_t._t<30?"_st5":_t._t>30?"_st6":"_st4":_t._t>20&&_t._t<30?"_st2":_t._t>30?"_st3":"_st1",_this.mis_status[_t._st](_t),_CONTEXT.drawImage(_t._img,_t.x,_t.y,_t._img.width,_t._img.height),_t._shot_alive=!0)))}var _i}}}class GameObject_SHOTS_NORMAL extends GameObject_SHOTS{constructor(_p){super(_p),this.shots=new Array,this.speed=20;for(let _i=0;_i<_PLAYERS_SHOTS_MAX;_i++)this.shots.push({sid:_SHOTTYPE_NORMAL,x:0,y:0,_img:_CANVAS_IMGS.shot1.obj,_audio:_CANVAS_AUDIOS.shot_normal,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._shot=!1,this._shot_alive=!1}})}map_collition(_t){let _map_x=_MAP.getMapX(_t.x),_map_y=_MAP.getMapY(_t.y);(_MAP.isMapCollision(_map_x,_map_y)||_MAP.isMapCollision(_map_x+1,_map_y))&&_t._init()}move(){let _p=this.player;if(!_p.isalive())return;if(!_p.isshotflag())return;let _pl=_p.getPlayerCenterPosition();for(let _j=0;_j<this.shots.length;_j++){let _t=this.shots[_j];if(!_t._shot&&!_t._shot_alive)continue;let _s=this.speed;if(_t.x=(_i=_t.x,_t._shot_alive?_i+_s:_pl._x),_t.y=function(_i){return _t._shot_alive?_i:_pl._y}(_t.y),_t.y=_MAP.getShotY(_t.y),_GAME.isShotCanvasOut(_t)){_t._init();continue}let _img=_CANVAS_IMGS.shot1.obj;_CONTEXT.drawImage(_img,_t.x,_t.y,_img.width,_img.height),_t._shot_alive=!0}var _i}}class GameObject_SHOTS_DOUBLE extends GameObject_SHOTS{constructor(_p){super(_p),this.shots=new Array,this.speed=30;for(let _i=0;_i<_PLAYERS_SHOTS_MAX;_i++)this.shots.push({sid:_SHOTTYPE_DOUBLE,x:0,y:0,_img:0===_i?_CANVAS_IMGS.shot1.obj:_CANVAS_IMGS.shot2.obj,_audio:_CANVAS_AUDIOS.shot_normal,_enemyid:null,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._enemyid=null,this._shot=!1,this._shot_alive=!1}})}enemy_collision(_e){let _this=this;if(!_this.player.isalive())return;for(let _k=0;_k<_this.shots.length;_k++){let _t=_this.shots[_k],_s=_GAME.isSqCollision("-10,-10,10,10",_t.x+","+_t.y,_e.shotColMap,_e.x+","+_e.y);_s!==_IS_SQ_NOTCOL&&(_s!==_IS_SQ_COL_NONE?_e.isalive()&&(_e.collision(_SHOTTYPE_DOUBLE),_t._init()):_t._init())}}map_collition(_t){let _map_x=_MAP.getMapX(_t.x),_map_y=_MAP.getMapY(_t.y);(_MAP.isMapCollision(_map_x,_map_y)||_MAP.isMapCollision(_map_x+1,_map_y))&&_t._init()}move(){let _p=this.player;if(!_p.isalive())return;if(!_p.isshotflag())return;let _pl=_p.getPlayerCenterPosition(),_s=this.shots[0]._shot|this.shots[1]._shot,_sa=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(_s||_sa){_s&&!_sa&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let _j=0;_j<this.shots.length;_j++){let _t=this.shots[_j];_t._shot_alive&&(_t.x=(_i=_t.x,_sa?_i+30:_pl._x),_t.y=function(_i){return 0===_j?_sa?_i:_pl._y:_sa?_i-23:_pl._y-23}(_t.y),_t.y=_MAP.getShotY(_t.y),_GAME.isShotCanvasOut(_t)?_t._init():(_CONTEXT.drawImage(_t._img,_t.x,_t.y,_t._img.width,_t._img.height),_t._shot_alive=!0))}var _i}}}class GameObject_SHOTS_TAILGUN extends GameObject_SHOTS_DOUBLE{constructor(_p){super(_p)}move(){let _p=this.player;if(!_p.isalive())return;if(!_p.isshotflag())return;let _pl=_p.getPlayerCenterPosition(),_s=this.shots[0]._shot|this.shots[1]._shot,_sa=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(_s||_sa){_s&&!_sa&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let _j=0;_j<this.shots.length;_j++){let _t=this.shots[_j];if(!_t._shot_alive)continue;if(_t.x=(_i=_t.x,0===_j?_sa?_i+30:_pl._x:_sa?_i-30:_pl._x),_t.y=function(_i){return _sa?_i:_pl._y}(_t.y),_t.y=_MAP.getShotY(_t.y),_GAME.isShotCanvasOut(_t)){_t._init();continue}let _img=0===_j?_CANVAS_IMGS.shot1.obj:_CANVAS_IMGS.shot3.obj;_CONTEXT.drawImage(_img,_t.x,_t.y,_img.width,_img.height),_t._shot_alive=!0}var _i}}}class GameObject_SHOTS_RIPPLE_LASER extends GameObject_SHOTS{constructor(_p){super(_p),this.shots=new Array,this.speed=30,this.lineWidth=5,this.strokeStyle="rgba(50,80,255,1)";for(let _i=0;_i<_PLAYERS_SHOTS_MAX;_i++)this.shots.push({sid:_SHOTTYPE_LASER,x:0,y:0,_t:0,_shot:!1,_shot_alive:!1,_width:0,_height:0,_audio:_CANVAS_AUDIOS.shot_ripple,_init:function(){this.x=0,this.y=0,this._t=0,this._shot=!1,this._shot_alive=!1,this._width=0,this._height=0}})}enemy_collision(_e){if(this.player.isalive())for(let _k=0;_k<this.shots.length;_k++){let _t=this.shots[_k];if(!_t._shot_alive)continue;if(_e.isIgnoreCollision())continue;let _s=_GAME.isSqCollision("0,-20,"+_t._width+","+(2*_t._height+20),_t.x+","+(_t.y-_t._height),_e.shotColMap,_e.x+","+_e.y);_s!==_IS_SQ_NOTCOL&&(_s===_IS_SQ_COL&&(_e.collision(_SHOTTYPE_RIPPLE_LASER),function(){let _ens=_ENEMIES;for(let _i=0;_i<_ens.length;_i++){let _en=_ens[_i];_en.isalive()&&(_en.isshow()&&(_en.isIgnoreCollision()||_GAME.isSqCollision("0,0,"+_t._width+","+2*_t._height,_t.x+","+(_t.y-_t._height),_en.shotColMap,_en.x+","+_en.y)===_IS_SQ_COL&&_en.collision(_SHOTTYPE_RIPPLE_LASER)))}}()),_t._init())}}map_collition(_t){let _map_x=_MAP.getMapX(_t.x),_map_y=_MAP.getMapY(_t.y);(_MAP.isMapCollision(_map_x,_map_y)||_MAP.isMapCollision(_map_x+1,_map_y))&&_t._init()}move(){let _this=this,_p=_this.player;if(!_p.isalive())return;if(!_p.isshotflag())return;let _pl=_p.getPlayerCenterPosition();for(let _j=0;_j<_this.shots.length;_j++){let _t=_this.shots[_j];if(!_t._shot&&!_t._shot_alive)continue;let _s=_this.speed;_t.x=(_i=_t.x,_t._shot_alive?_i+_s:_pl._x),_t.y=function(_i){return _t._shot_alive?_i:_pl._y}(_t.y),_t.y=_MAP.getShotY(_t.y),_GAME.isShotCanvasOut(_t)?_t._init():(_t._t=_t._t<20?_t._t+1:_t._t,_t._width=.5+_t._t,_t._height=8+_t._t*_t._t/6,_CONTEXT.beginPath(),_CONTEXT.lineWidth=_this.lineWidth,_CONTEXT.strokeStyle=_this.strokeStyle,_CONTEXT.ellipse(_t.x,_t.y,_t._width,_t._height,0,0,2*Math.PI),_CONTEXT.stroke(),_t._shot_alive=!0)}var _i}}class GameObject_SHOTS_RIPPLE_LASER_RED extends GameObject_SHOTS_RIPPLE_LASER{constructor(_p){super(_p),this.strokeStyle="rgba(255,80,50,1)"}}class GameObject_SHOTS_LASER extends GameObject_SHOTS{constructor(_p){super(_p);let _this=this;_this.shots=new Array,_this.speed=50,_this.lineWidth=3,_this.strokeStyle="rgba(50,80,255,1)",_this.strokeStyle_u="rgba(120,150,255,1)",_this.colimg=[_CANVAS_IMGS.shot_laser_col1.obj,_CANVAS_IMGS.shot_laser_col2.obj];for(let _i=0;_i<1;_i++)_this.shots.push({sid:_SHOTTYPE_LASER,x:0,y:0,_c_col:0,laser_time:500,_sx:0,_enemy:null,_laser_t:0,_laser_ts:0,_laser_MaxX:_CANVAS.width,_l_x:0,_l_sx:0,_shot:!1,_shot_alive:!1,_audio:_CANVAS_AUDIOS.shot_laser,_init:function(){this.x=0,this.y=0,this._c_col=0,this._laser_t=0,this._laser_ts=0,this._sx=0,this._enemy=null,this._l_x=0,this._l_sx=0,this._laser_MaxX=_CANVAS.width,this._shot=!1,this._shot_alive=!1}})}laser_collision(_t,_v){if(_t._laser_MaxX>=_CANVAS.width)return;_t._c_col=_t._c_col>=this.colimg.length-1?0:_t._c_col+1;let _t_img=this.colimg[_t._c_col];_CONTEXT.drawImage(_t_img,(_v||_t._l_x)-_t_img.width,_t.y-_t_img.height/2,_t_img.width,_t_img.height)}enemy_collision(_e){if(this.player.isalive())for(let _k=0;_k<this.shots.length;_k++){if(_e.x<this.player.x)continue;let _t=this.shots[_k];if(!_t._shot_alive)continue;let _s=_GAME.isSqCollision_laser("0,-6,"+parseInt(_t._l_x-_t._l_sx)+",6",_t._l_sx+","+_t.y,_e.shotColMap,_e.x+","+_e.y);return _s.ret===_IS_SQ_NOTCOL?_s.val:_s.ret===_IS_SQ_COL_NONE?_s.val:(_e.collision(_SHOTTYPE_LASER),_e.isalive()?_s.val:_CANVAS.width)}}map_collition(_t){let _this=this;if(!_t._shot_alive)return;let _pl=_this.player.getPlayerCenterPosition(),_map_x=_MAP.getMapX(_t.x+_pl._x),_map_y=_MAP.getMapY(_t.y);(_MAP.isMapCollision(_map_x,_map_y)||_MAP.isMapCollision(_map_x-1,_map_y))&&_this.setLaserMaxX(_t,_MAP.getMapXToPx(_map_x))}setLaserLine(_s,_l_x,_l_sx){_s._l_x=_l_x,_s._l_sx=_l_sx}setLaserMaxX(_t,_v){_t._laser_MaxX=_v}move(){let _this=this,_p=_this.player;if(!_p.isalive())return;if(!_p.isshotflag())return;let _pl=_p.getPlayerCenterPosition();_CONTEXT.beginPath(),_CONTEXT.lineWidth=_this.lineWidth,_CONTEXT.strokeStyle=_this.strokeStyle,_CONTEXT.lineCap="round";for(let _j=0;_j<_this.shots.length;_j++){let _t=_this.shots[_j];if(!_t._shot&&!_t._shot_alive)continue;if(_t.x=(_i=_t.x)>=_t._laser_MaxX-_pl._x?(_t._laser_t+=1e3/_FPS,_t._laser_MaxX-_pl._x):_i+_this.speed,_t._sx=function(_i){return _t._shot?_t._laser_t<=_t.laser_time-200?_i:(_t._laser_ts+=1e3/_FPS,_t._laser_ts>_t.laser_time-200?(_t._init(),0):_i>=_t.x?_t.x:_i+_this.speed):_i>=_t.x?(_t._init(),0):_i+_this.speed}(_t._sx),_t.y=_pl._y,_t.x<_t._sx||Math.abs(_t.x-_t._sx)<50)continue;let _px=_pl._x;_CONTEXT.beginPath(),_CONTEXT.strokeStyle=_this.strokeStyle_u,_CONTEXT.moveTo(_px+_t._sx,_pl._y+1),_CONTEXT.lineTo(_px+_t.x,_pl._y+1),_CONTEXT.stroke(),_CONTEXT.beginPath(),_CONTEXT.strokeStyle=_this.strokeStyle,_CONTEXT.moveTo(_px+_t._sx,_pl._y),_CONTEXT.lineTo(_px+_t.x,_pl._y),_CONTEXT.stroke(),_this.setLaserLine(_t,_px+_t.x,_px+_t._sx),_this.laser_collision(_t,_px+_t.x),_t.x>0&&(_t._shot_alive=!0)}var _i}}class GameObject_SHOTS_LASER_CYCLONE extends GameObject_SHOTS_LASER{constructor(_p){super(_p);this.lineWidth=5,this.strokeStyle="rgba(255,80,50,1)",this.strokeStyle_u="rgba(255,200,150,1)",this.colimg=[_CANVAS_IMGS.shot_laser_col3.obj,_CANVAS_IMGS.shot_laser_col4.obj]}}const _DEF_DIFFICULT=[{_ENEMY_SHOT_RATE:1e-4,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:5e-4,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.002,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.005,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.01,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:2}];let _ENEMY_DIFFICULT=4;const _ENEMY_DEF_ANI_COL={t0:{intv:5,imgs:[{img:_CANVAS_IMGS.enemy_collapes1.obj,scale:.3},{img:_CANVAS_IMGS.enemy_collapes2.obj,scale:.3},{img:_CANVAS_IMGS.enemy_collapes2.obj,scale:.3},{img:_CANVAS_IMGS.enemy_collapes2.obj,scale:.2},{img:_CANVAS_IMGS.enemy_collapes2.obj,scale:.2}]},t1:{intv:5,imgs:[{img:_CANVAS_IMGS.enemy_collapes12.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes13.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes13.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes12.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes11.obj,scale:1}]},t2:{intv:5,imgs:[{img:_CANVAS_IMGS.enemy_collapes21.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes22.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes23.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes24.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes23.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes22.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes21.obj,scale:1}]},t8:{intv:5,imgs:[{img:_CANVAS_IMGS.enemy_collapes81.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes82.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes83.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes84.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes83.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes82.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes81.obj,scale:1}]},t9:{intv:5,imgs:[{img:_CANVAS_IMGS.enemy_collapes91.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes92.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes93.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes94.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes95.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes96.obj,scale:1}]}};class GameObject_ENEMY_COLLISION{constructor(_x,_y,_type_ENEMY_DEF_ANI_COL){this._c_anime_collosion=0,this.x=_x||0,this.y=_y||0,this.type=_type_ENEMY_DEF_ANI_COL||"t0",this._status=!0}isalive(){return this._status}move(){let _this=this,_imgs=_ENEMY_DEF_ANI_COL[_this.type].imgs,_intv=_ENEMY_DEF_ANI_COL[_this.type].intv;if(_this._c_anime_collosion>=_imgs.length*_intv-1)return void(_this._status=!1);let _a=_imgs[parseInt(_this._c_anime_collosion/_intv)];_this.x=_MAP.getX(_this.x),_this.y=_MAP.getY(_this.y),_CONTEXT.drawImage(_a.img,_this.x-parseInt(_a.img.width*_a.scale/2),_this.y-parseInt(_a.img.height*_a.scale/2),_a.img.width*_a.scale,_a.img.height*_a.scale),_this._c_anime_collosion++}}let _MAPDEFS="",_MAPDEF="",_MAP_PETTERN=3,_BACKGROUND_SPEED=0,_MAP_SCROLL_POSITION_X=0,_MAP_SCROLL_POSITION_Y=0;const _MAP_ENEMIES={_DEF_DIR:{_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},_setDir:function(_mx,_my){let _d=_MAP.isMapCollision(_mx,_my-1)?this._DEF_DIR._U:this._DEF_DIR._D;return _d=_MAP.isMapCollision(_mx,_my+1)?this._DEF_DIR._D:this._DEF_DIR._U},_ENEMIES:{a:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_a(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_a_1},b:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_b(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_b_1},c:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_c(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_c_1},d:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_d(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_d_1},e:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_e(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_e_1},f:{_f:function(_mx,_my,_md){_md=_my<_CANVAS.height/2?_MAP_ENEMIES._DEF_DIR._U:_MAP_ENEMIES._DEF_DIR._D,_ENEMIES.push(new ENEMY_f(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_f_1},g:{_f:function(_mx,_my,_md){_md=_my<_CANVAS.height/2?_MAP_ENEMIES._DEF_DIR._U:_MAP_ENEMIES._DEF_DIR._D,_ENEMIES.push(new ENEMY_g(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_g_1},m:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_m(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_m_1},n:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_n(_mx,_my))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_o_1},o:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_o(_mx,_my))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_o_1},p:{_f:function(_mx,_my,_md){let _o=new ENEMY_p(_mx,_my);_ENEMIES.push(_o)},_st:"",_s:"000,000,000",_o:_CANVAS_IMGS.enemy_p_1}}},_MAP_ENEMIES_BOSS={enemy_cristalcore:{_f:function(){return new ENEMY_BOSS_CRYSTALCORE(700,800)}},enemy_bigcore:{_f:function(){return new ENEMY_BOSS_BIGCORE(1300,200)}},enemy_cristalcore_pt2:{_f:function(){return new ENEMY_BOSS_CRYSTALCORE_PT2(700,800)}},enemy_bigcore2:{_f:function(){return new ENEMY_BOSS_BIGCORE2(1300,200)}},enemy_frame:{_f:function(){return new ENEMY_BOSS_FRAME(1e3,200)}}},_MAP_THEME={_THEME1:{_map:{A:{_o:(new MAP_CRISTAL).img,_s:(new MAP_CRISTAL)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_CRISTAL},objs:{}}},_enemies:_MAP_ENEMIES._ENEMIES},_THEME2:{_map:{A:{_o:(new MAP_VOLCANO_A).img,_s:(new MAP_VOLCANO_A)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_A},objs:{}},B:{_o:(new MAP_VOLCANO_B).img,_s:(new MAP_VOLCANO_B)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_B},objs:{}},C:{_o:(new MAP_VOLCANO_C).img,_s:(new MAP_VOLCANO_C)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_C},objs:{}},D:{_o:(new MAP_VOLCANO_D).img,_s:(new MAP_VOLCANO_D)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_D},objs:{}},F:{_o:(new MAP_VOLCANO_F).img,_s:(new MAP_VOLCANO_F)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_F},objs:{}},G:{_o:(new MAP_VOLCANO_G).img,_s:(new MAP_VOLCANO_G)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_G},objs:{}},H:{_o:(new MAP_VOLCANO_H).img,_s:(new MAP_VOLCANO_H)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_H},objs:{}},I:{_o:(new MAP_VOLCANO_I).img,_s:(new MAP_VOLCANO_I)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_I},objs:{}},J:{_o:(new MAP_VOLCANO_J).img,_s:(new MAP_VOLCANO_J)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_J},objs:{}},K:{_o:(new MAP_VOLCANO_K).img,_s:(new MAP_VOLCANO_K)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_K},objs:{}},L:{_o:(new MAP_VOLCANO_L).img,_s:(new MAP_VOLCANO_L)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_L},objs:{}},M:{_o:(new MAP_VOLCANO_M).img,_s:(new MAP_VOLCANO_M)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_M},objs:{}},N:{_o:(new MAP_VOLCANO_N).img,_s:(new MAP_VOLCANO_N)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_N},objs:{}},O:{_o:(new MAP_VOLCANO_O).img,_s:(new MAP_VOLCANO_O)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_O},objs:{}},P:{_o:(new MAP_VOLCANO_P).img,_s:(new MAP_VOLCANO_P)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_VOLCANO_P},objs:{}}},_enemies:_MAP_ENEMIES._ENEMIES},_THEME3:{_map:{A:{_o:(new MAP_CUBE_A).img,_s:(new MAP_CUBE_A)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_CUBE_A},objs:{}}},_enemies:_MAP_ENEMIES._ENEMIES},_THEME5:{_map:{B:{_o:(new MAP_MOAI_A).img,_s:(new MAP_MOAI_A)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_MOAI_A},objs:{}},C:{_o:(new MAP_MOAI_B).img,_s:(new MAP_MOAI_B)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_MOAI_B},objs:{}}},_enemies:{a:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_a(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_a_1},b:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_b(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_b_1},c:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_c(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_c_1},d:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_d(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_d_1},e:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_e(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_e_1},f:{_f:function(_mx,_my,_md){_md=_my<_CANVAS.height/2?_MAP_ENEMIES._DEF_DIR._U:_MAP_ENEMIES._DEF_DIR._D,_ENEMIES.push(new ENEMY_f(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_f_1},g:{_f:function(_mx,_my,_md){_md=_my<_CANVAS.height/2?_MAP_ENEMIES._DEF_DIR._U:_MAP_ENEMIES._DEF_DIR._D,_ENEMIES.push(new ENEMY_g(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_g_1},m:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_m(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_m_1},l:{_f:function(_mx,_my,_md){let _o=new ENEMY_q(_mx,_my,_MAP_ENEMIES._DEF_DIR._U);_ENEMIES.push(_o)},_st:"transform:scale(1,-1);",_s:"1111,0110,0011,0000",_o:_CANVAS_IMGS.enemy_m_a_1},n:{_f:function(_mx,_my,_md){let _o=new ENEMY_q(_mx,_my,_MAP_ENEMIES._DEF_DIR._D);_ENEMIES.push(_o)},_st:"",_s:"0000,0011,0110,1111",_o:_CANVAS_IMGS.enemy_m_a_1},o:{_f:function(_mx,_my,_md){let _o=new ENEMY_r(_mx,_my,_MAP_ENEMIES._DEF_DIR._U);_ENEMIES.push(_o)},_st:"transform:scale(1,-1);",_s:"1111,0010,0000,0000",_o:_CANVAS_IMGS.enemy_m_b_1},p:{_f:function(_mx,_my,_md){let _o=new ENEMY_r(_mx,_my,_MAP_ENEMIES._DEF_DIR._D);_ENEMIES.push(_o)},_st:"",_s:"0000,0000,0010,1111",_o:_CANVAS_IMGS.enemy_m_b_2},q:{_f:function(_mx,_my,_md){let _o=new ENEMY_q(_mx,_my,_MAP_ENEMIES._DEF_DIR._LD);_ENEMIES.push(_o)},_st:"transform:scale(-1,1);",_s:"0000,1100,1110,1111",_o:_CANVAS_IMGS.enemy_m_a_1},r:{_f:function(_mx,_my,_md){let _o=new ENEMY_q(_mx,_my,_MAP_ENEMIES._DEF_DIR._LU);_ENEMIES.push(_o)},_st:"transform:scale(-1,-1);",_s:"1111,1110,1100,0000",_o:_CANVAS_IMGS.enemy_m_a_1}}},_THEME6:{_map:{A:{_o:(new MAP_FRAME_A).img,_s:(new MAP_FRAME_A)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_FRAME_A},objs:{}},B:{_o:(new MAP_FRAME_B).img,_s:(new MAP_FRAME_B)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_FRAME_B},objs:{}},C:{_o:(new MAP_FRAME_C).img,_s:(new MAP_FRAME_C)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_FRAME_C},objs:{}},D:{_o:(new MAP_FRAME_D).img,_s:(new MAP_FRAME_D)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_FRAME_D},objs:{}},E:{_o:(new MAP_FRAME_E).img,_s:(new MAP_FRAME_E)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_FRAME_E},objs:{}},F:{_o:(new MAP_FRAME_F).img,_s:(new MAP_FRAME_F)._s,_mx:function(_j){return _j},_my:function(_i){return _i},obj:function(_key){this.objs[_key]=new MAP_FRAME_F},objs:{}}},_enemies:{a:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_frame_1(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_frame_1},d:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_d(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_d_1},e:{_f:function(_mx,_my,_md){_ENEMIES.push(new ENEMY_e(_mx,_my,_md))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_e_1}}}};class GameObject_MAP{constructor(_pt){this.pt=_pt||0,this.initx=0,this.inity=0,this.x=this.initx,this.y=this.inity,this.collision=new RegExp("[1A-Z]"),this.collision_enemies=new RegExp("[a-z]","g"),this.collision_map=new RegExp("[A-Z]"),this.collision_map_d=new RegExp("[BD]"),this.t=25,this.mapdef=new Array,this.mapdef_col=new Array,this.map_theme=0,this.map_pettern=0,this.map_difficult=0,this.map_background_speed=0,this.map_backgroundY_speed=0,this.map_infinite=!1,this.map_bgmusic="",this.map_boss="",this.isboss=!1}init(_cb){_AJAX("./gradius_map.json","json",function(_d){_MAPDEFS=_d,_cb()})}setInifinite(_f){this.map_infinite=_f}set_stage_map_pattern(_n){this.map_pettern=_n}init_stage_map(){this.map_backgroundY_speed=0,this.x=parseInt(_MAPDEFS[this.map_pettern]._initx),this.y=this.inity,this.initx=parseInt(_MAPDEFS[this.map_pettern]._initx),this.mapdef=_MAPDEFS[this.map_pettern]._map,this.map_difficult=parseInt(_MAPDEFS[this.map_pettern]._difficult)-1,_ENEMY_DIFFICULT=_ISDEBUG?_ENEMY_DIFFICULT:parseInt(_MAPDEFS[this.map_pettern]._difficult)-1,this.map_background_speed=parseInt(_MAPDEFS[this.map_pettern]._speed),_BACKGROUND_SPEED=parseInt(_MAPDEFS[this.map_pettern]._speed),_MAP_PETTERN=this.map_pettern,this.map_theme=_MAPDEFS[this.map_pettern]._theme,this.map_infinite="true"===_MAPDEFS[this.map_pettern]._map_infinite,this.map_bgmusic=_MAPDEFS[this.map_pettern]._bgmusic,this.map_boss=_MAPDEFS[this.map_pettern]._boss,this.isboss=!1,this.init_map_anime(),this.init_mapdef_col()}init_map_anime(){let _this=this;for(let _i=0;_i<_this.mapdef.length;_i++){let _m=_this.mapdef[_i];for(let _j=0;_j<_m.length;_j++)null!==_m[_j].match(/[A-Z]/)&&_MAP_THEME[_this.map_theme]._map[_m[_j]].obj(_j+","+_i)}}init_enemies_location(){let _this=this;for(let _i=0;_i<_this.mapdef.length;_i++)for(let _j=0;_j<_this.mapdef[_i].length;_j++){let _md=_this.mapdef[_i][_j];if(_this.isCollisionBit(_md))continue;if("0"===_md)continue;let _d=function(){let _r=_MAP_ENEMIES._setDir(_j,_i),_e=_MAP_THEME[_this.map_theme]._enemies[_md];return _r=0===_r?_MAP_ENEMIES._setDir(_j,_i+parseInt(_e._o.obj.height/_MAP.t)):_r}();_MAP_THEME[_this.map_theme]._enemies[_md]._f(_this.x+_j*_this.t,_i*_this.t,_d)}}init_mapdef_col(){let _this=this;Object.assign(_this.mapdef_col,_this.mapdef);for(let _i=0;_i<_this.mapdef_col.length;_i++)_this.mapdef_col[_i]=_this.mapdef_col[_i].replace(/[a-zA-Z]/gi,"0");for(let _i=0;_i<_this.mapdef.length;_i++){let _m=_this.mapdef[_i];for(let _j=0;_j<_m.length;_j++){if(null===_m[_j].match(/[A-Za-z]/))continue;let _p=_this.isEnemiesBit(_m[_j])?_MAP_THEME[_this.map_theme]._enemies[_m[_j]]:_MAP_THEME[_this.map_theme]._map[_m[_j]];void 0===_p&&console.log(":"+_this.map_theme+" "+_m[_j]+"");let _p_s=_p._s.split(",");for(let _l=0;_l<_p_s.length;_l++){let _s_mapdef_col=_this.mapdef_col[_i+_l],_s_mapdef=_this.mapdef[_i+_l];_this.mapdef_col[_i+_l]=_s_mapdef_col.substr(0,_j)+(_s_mapdef.substr(_j,_p_s[_l].length),_s_mdc=_s_mapdef_col.substr(_j,_p_s[_l].length),_psl=_p_s[_l],_this.setCollisionBit(_psl,_s_mdc))+_s_mapdef_col.substr(_j+_p_s[_l].length,_m.length)}}}var _s_mdc,_psl}set_mapdef_col(_mx,_my,_bit){let _this=this;if(void 0===_mx||void 0===_my||void 0===_bit)return;let _p_s=_bit.split(",");for(let _l=0;_l<_p_s.length;_l++){let _s_mapdef_col=_this.mapdef_col[_my+_l];_this.mapdef_col[_my+_l]=_s_mapdef_col.substr(0,_mx+1)+_p_s[_l]+_s_mapdef_col.substr(_mx+1+_p_s[_l].length)}}getX(_x){return _x+-1*_BACKGROUND_SPEED}getY(_y){return this.map_infinite?_y-_MAP.map_backgroundY_speed<-250?750+(250+_y-_MAP.map_backgroundY_speed):_y-_MAP.map_backgroundY_speed>750?-250-(750-_y+_MAP.map_backgroundY_speed):(_y-_MAP.map_backgroundY_speed)%1e3:_y}getShotY(_y){return _y-_MAP.map_backgroundY_speed}setCollisionBit(_pb,_mcb){let _s="";for(let _i=0;_i<_pb.length;_i++)"0"!==_pb[_i]?_s+="1":_s+=_mcb[_i];return _s}getCollisionFlag(){return this.collision}setBackGroundSpeedY(_v){this.map_backgroundY_speed=_v}getBackGroundSpeed(){return this.map_background_speed}getBackGroundSpeedY(){return this.map_backgroundY_speed}get_stage_map_pattern(_n){return this.map_pettern}getMapXToPx(_mx){return _mx*this.t+this.initx-_MAP_SCROLL_POSITION_X}getMapYToPx(_y){return _y}getMapX(_x){return parseInt((_x+_MAP_SCROLL_POSITION_X-this.initx)/this.t)}getMapY(_y,_debug){return!0===_debug&&(console.log("_y:"+_y),console.log("_MAP_SCROLL_POSITION_Y:"+_MAP_SCROLL_POSITION_Y)),parseInt((_y+_MAP_SCROLL_POSITION_Y)%1e3/this.t)}isCollisionBit(_bit){return null!==_bit.match(this.collision)}isEnemiesBit(_bit){return null!==_bit.match(this.collision_enemies)}isMapDouble(_s){return null!==_s.match(this.collision_map_d)}isMapBefore(_mx,_my){return _mx<0}isMapLastSide(_mx,_my){return void 0!==this.mapdef[_my]&&(void 0===this.mapdef[_my][_mx]||_mx===this.mapdef[_my].length-1)}isMapOver(_mx,_my){return void 0!==this.mapdef[_my]&&(void 0===this.mapdef[_my][_mx]||_mx>this.mapdef[_my].length-1)}isMapCollision(_mx,_my){return void 0!==this.mapdef_col[_my]&&(void 0!==this.mapdef_col[_my][_mx]&&!!this.isCollisionBit(this.mapdef_col[_my][_mx]))}isPlayersShotCollision(){for(let _i=0;_i<_PLAYERS_SHOTS[_SHOTTYPE].length;_i++){let _ps=_PLAYERS_SHOTS[_SHOTTYPE][_i];for(let _j=0;_j<_ps.shots.length;_j++){let _pss=_ps.shots[_j];_pss._shot_alive&&_ps.map_collition(_pss)}}for(let _i=0;_i<_PLAYERS_MISSILE.length;_i++){let _pm=_PLAYERS_MISSILE[_i];if(_pm.player.isalive())for(let _j=0;_j<_pm.shots.length;_j++){let _pms=_pm.shots[_j];_pms._shot_alive&&(_pms._c>0||_pm.map_collition(_pms))}}}show(){}showMapForStageselect(_m){let _this=this;if(null===_m||void 0===_m)return;let _m_length=_m._map.length;for(let _i=0;_i<(_m_length>20?20:_m_length);_i++){let _ml=_m._map[_i].length;for(let _j=0;_j<(_ml>30?30:_ml);_j++){let _k=_m._map[_i][_j];if("0"!==_k)if(null!==_k.match(_this.collision_enemies)){let _img=_MAP_THEME[_m._theme]._enemies[_k]._o.obj;_CONTEXT.drawImage(_img,50+10*_j,130+10*_i,_img.width/2.5,_img.height/2.5)}else{let _p=_MAP_THEME[_m._theme]._map[_k],_img=_p._o.obj;_CONTEXT.drawImage(_img,50+10*_j,130+10*_p._my(_i),_img.width/2.5,_img.height/2.5)}}}_CONTEXT.fillStyle="rgba(0,0,0,1)",_CONTEXT.fillRect(351,130,_CANVAS.width,200),_CONTEXT.fillRect(0,341,_CANVAS.width,500)}map_draw(){let _this=this;for(let _i=0;_i<_this.mapdef.length;_i++)for(let _j=0;_j<_this.mapdef[_i].length;_j++){let _k=_this.mapdef[_i][_j];if(!_this.isCollisionBit(_k))continue;if(_this.x+_j*_this.t<-500||_this.x+_j*_this.t>_CANVAS.width+100)continue;let _p=_MAP_THEME[_this.map_theme]._map[_k],_img=_p.objs[_j+","+_i].getImg();_CONTEXT.drawImage(_img,_this.x+_p._mx(_j)*_this.t,_this.y+_p._my(_i)*_this.t,_img.width,_img.height),_this.map_infinite&&_CONTEXT.drawImage(_img,_this.x+_p._mx(_j)*_this.t,_this.y+_p._my(_i)*_this.t+(_this.y>0?-1e3:1e3),_img.width,_img.height)}}set_mapdef_col_clear(){let _this=this;for(let _i=0;_i<_this.mapdef_col.length;_i++){let _m=_this.mapdef_col[_i];_this.mapdef_col[_i]=_m.replace(/1/gi,"0")}}set_scroll_on_x(){_BACKGROUND_SPEED=this.map_background_speed}set_scroll_off_x(){_BACKGROUND_SPEED=0}move(){let _this=this;_MAP_SCROLL_POSITION_X+_CANVAS.width>_this.mapdef[0].length*_this.t+_this.initx&&(_this.isboss=!0),_MAP_SCROLL_POSITION_X-100>_this.mapdef[0].length*_this.t+_this.initx&&(_BACKGROUND_SPEED=0),_this.x+=-1*_BACKGROUND_SPEED,_MAP_SCROLL_POSITION_X+=_BACKGROUND_SPEED,_this.y=_this.getY(_this.y),_MAP_SCROLL_POSITION_Y=function(){let _posy=_MAP_SCROLL_POSITION_Y+_this.map_backgroundY_speed;return _posy<0?(1e3+_posy)%1e3:_posy%1e3}()}}let _ISDEBUG=!1,_PLAYERS_POWER_METER=0,_PLAYERS_POWER_METER_SHIELD=0,_DRAW_SETINTERVAL=null,_DRAW_GAMESTART_SETINTERVAL=null,_PLAYERS_SHOTS_SETINTERVAL=null,_EVENT_POWERMETER_FLAG=!1,_EVENT_SELECT_STAGE_FLAG=!1,_DRAW_IS_MATCH_BOSS=!1,_DRAW_IS_MATCH_BOSS_COUNT=0;const _ISSP=null===window.ontouchstart,_EVENT_KEYDOWN=null===window.ontouchstart?"touchstart":"keydown",_EVENT_KEYUP=null===window.ontouchstart?"touchend":"keyup",_FPS=60;let _CANVAS,_CONTEXT,_DRAW_IS_GAMECLEAR=!1;const _SHOTTYPE_MISSILE="_SHOTTYPE_MISSILE",_SHOTTYPE_NORMAL="_SHOTTYPE_NORMAL",_SHOTTYPE_DOUBLE="_SHOTTYPE_DOUBLE",_SHOTTYPE_LASER="_SHOTTYPE_LASER",_SHOTTYPE_RIPPLE_LASER="_SHOTTYPE_RIPPLE_LASER";let _SHOTTYPE=_SHOTTYPE_NORMAL,_SCORE="",_PLAYERS_MAIN="",_PLAYERS_MAIN_FORCE="",_PLAYERS_OPTION=new Array,_PLAYERS_OPTION_ISALIVE=0;const _PLAYERS_OPTION_MAX=4,_PLAYERS_MOVE_DRAW_MAX=100;let _PLAYERS_MOVE_FLAG=!1,_PLAYERS_MOVE_DRAW_X=new Array,_PLAYERS_MOVE_DRAW_Y=new Array;const _PLAYERS_MAX=5,_PLAYERS_SHOTS_MAX=2;let _PLAYERS_SHOTS={_SHOTTYPE_NORMAL:new Array,_SHOTTYPE_DOUBLE:new Array,_SHOTTYPE_LASER:new Array},_PLAYERS_MISSILE=new Array,_PLAYERS_MISSILE_ISALIVE=!1,_ENEMIES=new Array,_ENEMIES_SHOTS=new Array,_ENEMIES_COLLISIONS=new Array,_POWERCAPSELLS=new Array,_POWERMETER="",_STAGESELECT="",_MAP="",_BACKGROUND=new Array;const _BACKGROUND_STAR_MAX=70;let _KEYSAFTERPAUSE=new Array,_DEF_KEYSAFTERPAUSE="38,38,40,40,37,39,37,39,66,65";const _IS_SQ_COL=0,_IS_SQ_COL_NONE=1,_IS_SQ_NOTCOL=2,_AUDIO_CONTEXT=new(window.AudioContext||window.webkitAudioContext),_AJAX=function(_url,_type,_f,_t){let _r=new XMLHttpRequest;_r.onreadystatechange=function(){4===_r.readyState&&(200===_r.status?(console.log("OK"),_f(_r.response,_t)):console.log("NG"))},_r.open("GET",_url+"?date="+(new Date).getTime()),_r.responseType=_type||"json",_r.send(null)},_KEYEVENT_MASTER={addKeydownStart:function(){_ISSP?_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_start):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_start)},removeKeydownStart:function(){_ISSP?_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_start):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_start)},addKeydownSelectStage:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.addEventListener("touchmove",_KEYEVENT_SP.keymove_select_stage),_SP_CONTROLLER._sp_main_center.addEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_stage),_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_stage_a)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_stage)},removeKeydownSelectStage:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.removeEventListener("touchmove",_KEYEVENT_SP.keymove_select_stage),_SP_CONTROLLER._sp_main_center.removeEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_stage),_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_stage_a),_SP_CONTROLLER._set_reset()):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_stage)},addKeydownSelectPowermeter:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.addEventListener("touchmove",_KEYEVENT_SP.keymove_select_powermeter),_SP_CONTROLLER._sp_main_center.addEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_powermeter),_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_powermeter_a)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_powermeter)},removeKeydownSelectPowermeter:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.removeEventListener("touchmove",_KEYEVENT_SP.keymove_select_powermeter),_SP_CONTROLLER._sp_main_center.removeEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_powermeter),_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_powermeter_a),_SP_CONTROLLER._set_reset()):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_powermeter)},addKeydownGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_hide.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_hide),_SP_CONTROLLER._sp_bt_r.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_r),_SP_CONTROLLER._sp_bt_p.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_p),_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_s),_SP_CONTROLLER._sp_bt_b.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_b),_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_a),_SP_CONTROLLER._sp_main_center.addEventListener("touchstart",_KEYEVENT_SP.keymove_game_controller),_SP_CONTROLLER._sp_main_center.addEventListener("touchmove",_KEYEVENT_SP.keymove_game_controller)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_game)},addKeyupGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyup_game_a),_SP_CONTROLLER._sp_main_center.addEventListener("touchend",_KEYEVENT_SP.keyend_game_controller),_SP_CONTROLLER._set_reset()):document.addEventListener(_EVENT_KEYUP,_KEYEVENT.keyup_game)},removeKeydownGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_hide.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_hide),_SP_CONTROLLER._sp_bt_r.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_r),_SP_CONTROLLER._sp_bt_p.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_p),_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_s),_SP_CONTROLLER._sp_bt_b.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_b),_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_a),_SP_CONTROLLER._sp_main_center.removeEventListener("touchstart",_KEYEVENT_SP.keymove_game_controller),_SP_CONTROLLER._sp_main_center.removeEventListener("touchmove",_KEYEVENT_SP.keymove_game_controller)):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_game)},removeKeyupGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyup_game_a),_SP_CONTROLLER._sp_main_center.removeEventListener("touchend",_KEYEVENT_SP.keyend_game_controller),_SP_CONTROLLER._set_reset()):document.removeEventListener(_EVENT_KEYUP,_KEYEVENT.keyup_game)},addKeydownGameclear:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_r),_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_s),_SP_CONTROLLER._sp_bt_p.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_p)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameclear)},removeKeydownGameclear:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_r),_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_s),_SP_CONTROLLER._sp_bt_p.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_p)):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameclear)},addKeydownGameover:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_r),_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_s)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameover)},removeKeydownGameover:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_r),_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_s)):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameover)}},_KEYEVENT={keydown_start:function(e){"S"!==e.key&&"s"!==e.key||(document.querySelector("#game_start_wrapper .text").classList.add("on"),document.querySelector("#game_start_wrapper .text_loading").classList.add("on"),_DRAW_INIT(_CANVAS_IMGS,_DRAW_STAGE_SELECT),_GAME._setPlay(_CANVAS_AUDIOS.playerset))},keydown_select_powermeter:function(e){if(clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,"Enter"===e.key||"enter"===e.key)return _DRAW_SELECT_POWERMETER(),_GAME._setPlay(_CANVAS_AUDIOS.playerset),!1;"ArrowUp"!==e.key&&"Up"!==e.key||(_POWERMETER._c_pms=_POWERMETER._c_pms<=0?0:_POWERMETER._c_pms-1),"ArrowDown"!==e.key&&"Down"!==e.key||(_POWERMETER._c_pms=_POWERMETER._c_pms>=_POWERMETER.pms_selected.length-1?_POWERMETER._c_pms:_POWERMETER._c_pms+1),"ArrowLeft"!==e.key&&"Left"!==e.key||(_POWERMETER._c_pmss=_POWERMETER._c_pmss<=0?0:_POWERMETER._c_pmss-1),"ArrowRight"!==e.key&&"Right"!==e.key||(_POWERMETER._c_pmss=_POWERMETER._c_pmss>=_POWERMETER.pmss_selected.length-1?_POWERMETER._c_pmss:_POWERMETER._c_pmss+1),_POWERMETER.pms_disp(),_POWERMETER.pms_select(),_GAME._setPlay(_CANVAS_AUDIOS.pms_select)},keydown_select_stage:function(e){if("Enter"===e.key||"enter"===e.key)return _MAP.set_stage_map_pattern(_STAGESELECT.mapdef_status),_DRAW_POWER_METER_SELECT(),_GAME._setPlay(_CANVAS_AUDIOS.playerset),!1;"ArrowLeft"!==e.key&&"Left"!==e.key||(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status<=0?0:_STAGESELECT.mapdef_status-1),"ArrowRight"!==e.key&&"Right"!==e.key||(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status>=_MAPDEFS.length-1?_STAGESELECT.mapdef_status:_STAGESELECT.mapdef_status+1),_STAGESELECT.set_map_status(),_STAGESELECT.disp_thumb_map(),_GAME._setPlay(_CANVAS_AUDIOS.pms_select)},keydown_gameclear:function(e){if("R"===e.key||"r"===e.key)return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1;if("S"===e.key||"s"===e.key)return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1;if("P"===e.key||"p"===e.key)return null!==_DRAW_SETINTERVAL?_DRAW_STOP():(_KEYSAFTERPAUSE=[],_DRAW()),!1;if(" "===e.key||"Spacebar"===e.key){if(null!==_PLAYERS_SHOTS_SETINTERVAL)return;_DRAW_PLAYERS_SHOTS()}"ArrowLeft"!==e.key&&"Left"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel),"ArrowRight"!==e.key&&"Right"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=_PLAYERS_MAIN.accel),"ArrowUp"!==e.key&&"Up"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel),"ArrowDown"!==e.key&&"Down"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=_PLAYERS_MAIN.accel),"B"!==e.key&&"b"!==e.key||_POWERMETER.playerset()},keydown_gameover:function(e){return"R"===e.key||"r"===e.key?(_DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1):"S"===e.key||"s"===e.key?(_DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1):void 0},keydown_game:function(e){if(!_PLAYERS_MAIN.isalive())return!1;if("R"===e.key||"r"===e.key)return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1;if("S"===e.key||"s"===e.key)return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1;if("P"===e.key||"p"===e.key)return null!==_DRAW_SETINTERVAL?(_DRAW_STOP(),_GAME._setStopOnBG()):(_KEYSAFTERPAUSE=[],_DRAW(),_GAME._setPlayOnBG(_GAME._audio_now_obj_bg)),!1;if(null===_DRAW_SETINTERVAL){if(_KEYSAFTERPAUSE.push(e.keyCode),_DEF_KEYSAFTERPAUSE===_KEYSAFTERPAUSE.toString()){_SHOTTYPE=_SHOTTYPE_NORMAL,_PLAYERS_MISSILE_ISALIVE=!0;for(let _i=0;_i<_PLAYERS_OPTION_MAX;_i++)_PLAYERS_OPTION[_i].settruealive();_PLAYERS_MAIN_FORCE.init(),_KEYSAFTERPAUSE=[],_POWERMETER._set_current_reset(),_POWERMETER.meterdef_status="101100"}return!1}if(" "===e.key||"Spacebar"===e.key){if(null!==_PLAYERS_SHOTS_SETINTERVAL)return;_DRAW_PLAYERS_SHOTS()}if("ArrowLeft"!==e.key&&"Left"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel),"ArrowRight"!==e.key&&"Right"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=_PLAYERS_MAIN.accel),"ArrowUp"!==e.key&&"Up"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani(e.key)),"ArrowDown"!==e.key&&"Down"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani(e.key)),"B"!==e.key&&"b"!==e.key||_POWERMETER.playerset(),!_ISDEBUG)return!1;"M"!==e.key&&"m"!==e.key||_DRAW_SCROLL_STOP(),"N"!==e.key&&"n"!==e.key||_DRAW_SCROLL_RESUME(),"V"!==e.key&&"v"!==e.key||_POWERMETER.move()},keyup_game:function(e){if(!_PLAYERS_MAIN.isalive())return!1;"ArrowLeft"!==e.key&&"Left"!==e.key||(_PLAYERS_MOVE_FLAG=!1),"ArrowRight"!==e.key&&"Right"!==e.key||(_PLAYERS_MOVE_FLAG=!1),"ArrowUp"!==e.key&&"Up"!==e.key||(_PLAYERS_MOVE_FLAG=!1),"ArrowDown"!==e.key&&"Down"!==e.key||(_PLAYERS_MOVE_FLAG=!1)," "!==e.key&&"Spacebar"!==e.key||_DRAW_STOP_PLAYERS_SHOTS()}},_KEYEVENT_SP={keydown_start:function(e){document.querySelector("#game_start_wrapper .text").classList.add("on"),document.querySelector("#game_start_wrapper .text_loading").classList.add("on"),_DRAW_INIT(_CANVAS_IMGS,_DRAW_STAGE_SELECT),_GAME._setPlay(_CANVAS_AUDIOS.playerset)},keydown_select_powermeter_a:function(e){return _DRAW_SELECT_POWERMETER(),_GAME._setPlay(_CANVAS_AUDIOS.playerset),!1},keymove_select_powermeter:function(e){clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,e.preventDefault();let _r=_SP_CONTROLLER._get_st(e);return!0!==_EVENT_POWERMETER_FLAG&&(_EVENT_POWERMETER_FLAG=!0,_r===_SP_CONTROLLER._DEF_DIR._L?(_POWERMETER._c_pmss=_POWERMETER._c_pmss<=0?0:_POWERMETER._c_pmss-1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),_GAME._setPlay(_CANVAS_AUDIOS.pms_select),!1):_r===_SP_CONTROLLER._DEF_DIR._U?(_POWERMETER._c_pms=_POWERMETER._c_pms<=0?0:_POWERMETER._c_pms-1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),_GAME._setPlay(_CANVAS_AUDIOS.pms_select),!1):_r===_SP_CONTROLLER._DEF_DIR._R?(_POWERMETER._c_pmss=_POWERMETER._c_pmss>=_POWERMETER.pmss_selected.length-1?_POWERMETER._c_pmss:_POWERMETER._c_pmss+1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),_GAME._setPlay(_CANVAS_AUDIOS.pms_select),!1):_r===_SP_CONTROLLER._DEF_DIR._D?(_POWERMETER._c_pms=_POWERMETER._c_pms>=_POWERMETER.pms_selected.length-1?_POWERMETER._c_pms:_POWERMETER._c_pms+1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),_GAME._setPlay(_CANVAS_AUDIOS.pms_select),!1):void 0)},keyend_select_powermeter:function(e){_SP_CONTROLLER._set_reset(),_EVENT_POWERMETER_FLAG=!1},keymove_select_stage:function(e){if(e.preventDefault(),_EVENT_SELECT_STAGE_FLAG)return;_EVENT_SELECT_STAGE_FLAG=!0;let _r=_SP_CONTROLLER._get_st(e);return _r?(_r===_SP_CONTROLLER._DEF_DIR._L&&(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status<=0?0:_STAGESELECT.mapdef_status-1,_GAME._setPlay(_CANVAS_AUDIOS.pms_select)),_SP_CONTROLLER._DEF_DIR._U,_r===_SP_CONTROLLER._DEF_DIR._R&&(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status>=_MAPDEFS.length-1?_STAGESELECT.mapdef_status:_STAGESELECT.mapdef_status+1,_GAME._setPlay(_CANVAS_AUDIOS.pms_select)),_SP_CONTROLLER._DEF_DIR._U,_STAGESELECT.set_map_status(),_STAGESELECT.disp_thumb_map(),!1):void 0},keyend_select_stage:function(e){let _c1=_SP_CONTROLLER._sp_main_center;_c1.style.top="",_c1.style.left="",_EVENT_SELECT_STAGE_FLAG=!1},keydown_select_stage_a:function(e){return _MAP.set_stage_map_pattern(_STAGESELECT.mapdef_status),_DRAW_POWER_METER_SELECT(),_GAME._setPlay(_CANVAS_AUDIOS.playerset),!1},keydown_gameclear_r:function(e){return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_gameclear_s:function(e){return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_gameclear_p:function(e){return null!==_DRAW_SETINTERVAL?_DRAW_STOP():(_KEYSAFTERPAUSE=[],_DRAW()),!1},keydown_gameover_r:function(e){return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_gameover_s:function(e){return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1},keymove_game_controller:function(e){e.preventDefault(),_PLAYERS_MOVE_FLAG=!0;let _r=_SP_CONTROLLER._get_st(e);if(!1!==_r)return _PLAYERS_MAIN._x=0,_PLAYERS_MAIN._y=0,_r===_SP_CONTROLLER._DEF_DIR._L&&(_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel),_r===_SP_CONTROLLER._DEF_DIR._LU&&(_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Up")),_r===_SP_CONTROLLER._DEF_DIR._U&&(_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Up")),_r===_SP_CONTROLLER._DEF_DIR._RU&&(_PLAYERS_MAIN._x=1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Up")),_r===_SP_CONTROLLER._DEF_DIR._R&&(_PLAYERS_MAIN._x=_PLAYERS_MAIN.accel),_r===_SP_CONTROLLER._DEF_DIR._RD&&(_PLAYERS_MAIN._x=1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Down")),_r===_SP_CONTROLLER._DEF_DIR._D&&(_PLAYERS_MAIN._y=_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Down")),_r===_SP_CONTROLLER._DEF_DIR._LD&&(_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Down")),!1},keyend_game_controller:function(e){_SP_CONTROLLER._set_reset(),_PLAYERS_MAIN.set_moveamount_reset(),_PLAYERS_MOVE_FLAG=!1},keydown_game_hide:function(e){_SHOTTYPE=_SHOTTYPE_NORMAL,_PLAYERS_MISSILE_ISALIVE=!0;for(let _i=0;_i<_PLAYERS_OPTION_MAX;_i++)_PLAYERS_OPTION[_i].settruealive();return _PLAYERS_MAIN_FORCE.init(),_KEYSAFTERPAUSE=[],_POWERMETER._set_current_reset(),_POWERMETER.meterdef_status="101100",!1},keydown_game_r:function(e){return _DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_game_s:function(e){return _DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1},keydown_game_p:function(e){return null!==_DRAW_SETINTERVAL?(_DRAW_STOP(),_GAME._setStopOnBG()):(_KEYSAFTERPAUSE=[],_DRAW(),_GAME._setPlayOnBG(_GAME._audio_now_obj_bg)),!1},keydown_game_a:function(e){if(null!==_DRAW_SETINTERVAL&&null===_PLAYERS_SHOTS_SETINTERVAL)return _DRAW_PLAYERS_SHOTS(),!1},keydown_game_b:function(e){if(null!==_DRAW_SETINTERVAL)return _POWERMETER.playerset(),!1},keyup_game_a:function(e){return _DRAW_STOP_PLAYERS_SHOTS(),!1}},_SP_CONTROLLER={_x:0,_y:0,_sp_main_center:new Object,_sp_main:new Object,_sp_bt_hide:new Object,_sp_bt_r:new Object,_sp_bt_p:new Object,_sp_bt_s:new Object,_sp_bt_b:new Object,_sp_bt_a:new Object,_DEF_DIR:{_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},_get_st:function(e){let _c1=this._sp_main_center,_c0=this._sp_main,_tr=_c0.getBoundingClientRect();for(var _i=0;_i<e.touches.length;_i++)_c1===e.touches[_i].target&&(this._x=e.touches[_i].clientX-_tr.left,this._y=e.touches[_i].clientY-_tr.top);let _c1_x=this._x-parseInt(window.getComputedStyle(_c1).width)/2,_c1_y=this._y-parseInt(window.getComputedStyle(_c1).height)/2;_c1.style.left=parseInt(_c1_x)+"px",_c1.style.top=parseInt(_c1_y)+"px";let _w=parseInt(window.getComputedStyle(_c0).width),_h=parseInt(window.getComputedStyle(_c0).height),_dx=_w/2-this._x,_dy=_h/2-this._y;if(Math.sqrt(Math.pow(_dx,2)+Math.pow(_dy,2))<10)return!1;let _a=parseInt(180*Math.atan2(_dy,_dx)/Math.PI);return _a>-40&&_a<=40?this._DEF_DIR._L:_a>40&&_a<=50?this._DEF_DIR._LU:_a>50&&_a<=130?this._DEF_DIR._U:_a>130&&_a<=140?this._DEF_DIR._RU:_a>140&&_a<=180||_a<-140&&_a>=-180?this._DEF_DIR._R:_a<-130&&_a>=-140?this._DEF_DIR._RD:_a<-50&&_a>=-130?this._DEF_DIR._D:_a<-40&&_a>=-50?this._DEF_DIR._LD:void 0},_set_reset(){let _c1=document.querySelector(".sp_controller_main_center");_c1.style.left="",_c1.style.top=""},_set_obj(){this._sp_main_center=document.querySelector(".sp_controller_main_center"),this._sp_main=document.querySelector(".sp_controller_main"),this._sp_bt_hide=document.querySelector(".sp_controller_bt.hide"),this._sp_bt_r=document.querySelector(".sp_controller_bt.r"),this._sp_bt_p=document.querySelector(".sp_controller_bt.p"),this._sp_bt_s=document.querySelector(".sp_controller_bt.s"),this._sp_bt_b=document.querySelector(".sp_controller_bt.b"),this._sp_bt_a=document.querySelector(".sp_controller_bt.a")}};class GameObject_PM{constructor(_src,_sx,_sy){let _this=this;this.img=_CANVAS_IMGS[_src].obj,this.x=_CANVAS.width/2-this.img.width/2,this.y=_CANVAS.height-30,this.meterdef_status="111111",this.meterdef_current="000000",this.meterdef={n_32:{imgobj:new Image,name:"meter_c_speedup",func:function(){_PLAYERS_MAIN.accel>=18?_this._set_meter_status():_PLAYERS_MAIN.accel+=2}},n_16:{imgobj:new Image,name:"meter_c_missile",func:function(){_PLAYERS_MISSILE_ISALIVE=!0,_this._set_meter_status()}},n_8:{imgobj:new Image,name:"meter_c_double",func:function(){_SHOTTYPE=_SHOTTYPE_DOUBLE,_this._set_meter_status()}},n_4:{imgobj:new Image,name:"meter_c_laser",func:function(){_SHOTTYPE=_SHOTTYPE_LASER,_this._set_meter_status()}},n_2:{imgobj:new Image,name:"meter_c_option",func:function(){_PLAYERS_OPTION[_PLAYERS_OPTION_ISALIVE].settruealive(),++_PLAYERS_OPTION_ISALIVE<_PLAYERS_OPTION_MAX||_this._set_meter_status()}},n_1:{imgobj:new Image,name:"meter_c_shield",func:function(){_PLAYERS_MAIN_FORCE.init(),_this._set_meter_status()}}},this._c_pms=0,this.pms_img=_CANVAS_IMGS_INIT.gradius_powermeterselect.obj,this.pms_selected=[{_y:89,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_0.obj},{_y:162,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_1.obj},{_y:233,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_2.obj},{_y:306,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_3.obj}],this._c_pmss=0,this.pmss_selected=[{_x:470,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_shield_0.obj},{_x:570,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_shield_1.obj}]}init(){for(let _i in this.meterdef)this.meterdef[_i].imgobj=_CANVAS_IMGS[this.meterdef[_i].name].obj}_set_current_reset(){this.meterdef_current="000000"}_set_meter_status(){let _ms=this.meterdef_status,_mc=(~parseInt(this.meterdef_current,2)>>>0).toString(2).slice(-6);this.meterdef_status=this._get_bit((parseInt(_ms,2)&parseInt(_mc,2)).toString(2));let _c=parseInt(this.meterdef_current,2);8!==_c&&4!==_c||(this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(8===_c?"000100":"001000",2)).toString(2)))}_set_meter_on(_bit){this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(_bit,2)).toString(2))}_get_bit(_bit){return("000000"+_bit).slice(-6)}_get_meter_current(_num){return 0===parseInt(_num,2)||1===parseInt(_num,2)?"100000":("000000"+(parseInt(_num,2)>>1).toString(2)).slice(-6)}move(){this.meterdef_current=this._get_meter_current(this.meterdef_current)}playerset(){let _mc=parseInt(this.meterdef_current,2),_ms=parseInt(this.meterdef_status,2);0!==_mc&&0!=(_mc&_ms)&&(_PLAYERS_MAIN.set_equipped(),_GAME._setPlay(_CANVAS_AUDIOS.playerset),this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(this.meterdef_current,2)).toString(2)),this.meterdef["n_"+_mc].func(),this._set_current_reset())}show(){_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height);for(let _i=0;_i<this.meterdef_status.length;_i++){if("0"!==this.meterdef_status[_i])continue;let _omb=_CANVAS_IMGS.meter_blank.obj;_CONTEXT.drawImage(_omb,this.x+_omb.width*_i,this.y,_omb.width,_omb.height)}let _mc=parseInt(this.meterdef_current,2);if(0===_mc)return;let _oimg=0!=(_mc&parseInt(this.meterdef_status,2))?this.meterdef["n_"+_mc].imgobj:_CANVAS_IMGS.meter_c_blank.obj;_CONTEXT.drawImage(_oimg,this.x+_oimg.width*this.meterdef_current.indexOf("1"),this.y,_oimg.width,_oimg.height)}pms_disp(){let _s="power meter select";_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_DRAW_DISP_TXT(_s,_CANVAS.width/2-35*_s.length/2,20,.3),_DRAW_DISP_TXT("shield select",_CANVAS.width/2-35*_s.length/2,400,.15),_CONTEXT.drawImage(this.pms_img,_CANVAS.width/2-this.pms_img.width/2,70,this.pms_img.width,this.pms_img.height);let _pmss=_CANVAS_IMGS_INIT.gradius_powermeterselect_shield_.obj;_CONTEXT.drawImage(_pmss,_CANVAS.width/2-this.pms_img.width/2,430,_pmss.width,_pmss.height);let _pms=_CANVAS_IMGS_INIT.gradius_powermeterselect_shield.obj;_CONTEXT.drawImage(_pms,470,390,_pms.width,_pms.height)}pms_select(){let _c_img=this.pms_selected[this._c_pms]._img;_CONTEXT.drawImage(_c_img,_CANVAS.width/2-this.pms_img.width/2,this.pms_selected[this._c_pms]._y,_c_img.width,_c_img.height),_c_img=this.pmss_selected[this._c_pmss]._img,_CONTEXT.drawImage(_c_img,this.pmss_selected[this._c_pmss]._x,390,_c_img.width,_c_img.height)}}class GameObject_STAGESELECT{constructor(){this.x=0,this.y=0,this.speed=100,this.mapdef_status=0,this.mapdef=_MAPDEFS[this.mapdef_status]}get_ajaxdata(_d,_t){_t.mapdef=_d[_t.mapdef_status],_ISDEBUG||_t.disp_thumb_map()}init(){this.mapdef=_MAPDEFS[0],_ISDEBUG?this.mapdef=_MAPDEFS[_MAP_PETTERN]:this.disp_thumb_map()}set_map_status(){this.mapdef=_MAPDEFS[this.mapdef_status]}disp_thumb_map(){_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_DRAW_DISP_TXT("stage select",_CANVAS.width/2-35*"stage select".length/2,20,.3);let _pl=500-20*(_MAPDEFS.length-1);for(let _i=0;_i<_MAPDEFS.length;_i++)_CONTEXT.beginPath(),_CONTEXT.lineWidth=1,_CONTEXT.strokeStyle="rgba(255,255,255,1)",_CONTEXT.fillStyle="rgba(255,255,255,1)",_i===this.mapdef_status?_CONTEXT.fillRect(_pl+20*_i,85,10,10):_CONTEXT.strokeRect(_pl+20*_i,85,10,10);let _md=this.mapdef;_MAP.showMapForStageselect(_md),_CONTEXT.beginPath(),_CONTEXT.lineWidth=1,_CONTEXT.strokeStyle="rgba(255,255,255,1)",_CONTEXT.fillStyle="rgba(255,255,255,1)",_CONTEXT.strokeRect(50,130,300,200),_DRAW_DISP_TXT("stage title",400,130,.2),_CONTEXT.moveTo(400,160),_CONTEXT.lineTo(950,160),_CONTEXT.stroke(),_CONTEXT.font="20px sans-serif";let _ar=_GAME._multilineText(_CONTEXT,this.mapdef._title,550);for(let _i=0;_i<(_ar.length>2?2:_ar.length);_i++)_CONTEXT.fillText(_ar[_i],400,190+26*_i);_DRAW_DISP_TXT("difficult:"+this.mapdef._difficult,400,220,.2),_CONTEXT.moveTo(400,260),_CONTEXT.lineTo(950,260),_CONTEXT.stroke(),_DRAW_DISP_TXT("detail",400,290,.2),_CONTEXT.moveTo(400,330),_CONTEXT.lineTo(950,330),_CONTEXT.stroke(),_ar=_GAME._multilineText(_CONTEXT,this.mapdef._body,520);for(let _i=0;_i<(_ar.length>4?4:_ar.length);_i++)_CONTEXT.fillText(_ar[_i],400,360+30*_i)}}class GameObject_SCORE{constructor(){this.score1p=0,this.score2p=0,this.def_scorehi=57300,this.scorehi=this.def_scorehi}init(){this.score1p=0,this.score2p=0}set(_score){this.score1p+=_score,this.scorehi>=this.score1p||(this.scorehi=this.score1p)}show(){let _s="1p"+("        "+this.score1p).slice(-8);for(let _i=0;_i<_s.length;_i++){if(" "===_s[_i])continue;let _img=_CANVAS_IMGS_INIT["font_"+_s[_i]].obj;_CONTEXT.drawImage(_img,180+.15*_img.width*_i,10,.15*_img.width,.15*_img.height)}_s="hi"+("        "+this.scorehi).slice(-8);for(let _i=0;_i<_s.length;_i++){if(" "===_s[_i])continue;let _img=_CANVAS_IMGS_INIT["font_"+_s[_i]].obj;_CONTEXT.drawImage(_img,400+.15*_img.width*_i,10,.15*_img.width,.15*_img.height)}_s="2p"+("        "+this.score2p).slice(-8);for(let _i=0;_i<_s.length;_i++){if(" "===_s[_i])continue;let _img=_CANVAS_IMGS_INIT["font_"+_s[_i]].obj;_CONTEXT.drawImage(_img,620+.15*_img.width*_i,10,.15*_img.width,.15*_img.height)}}}class GameObject_POWERCAPSELL{constructor(_x,_y){this.x=_x||0,this.y=_y||0,this.getscore=200,this.gotpc=!1,this.type=Math.random()>.1?"red":"blue",this._c_pc_ani=0,this.pc_ani=[{img:_CANVAS_IMGS.pc1.obj,scale:.6},{img:_CANVAS_IMGS.pc2.obj,scale:.6},{img:_CANVAS_IMGS.pc3.obj,scale:.6},{img:_CANVAS_IMGS.pc4.obj,scale:.6},{img:_CANVAS_IMGS.pc5.obj,scale:.6}],this.pc_ani2=[{img:_CANVAS_IMGS.pc11.obj,scale:.6},{img:_CANVAS_IMGS.pc12.obj,scale:.6},{img:_CANVAS_IMGS.pc13.obj,scale:.6},{img:_CANVAS_IMGS.pc14.obj,scale:.6}],this.img="red"===this.type?this.pc_ani:this.pc_ani2}getPCCenterPosition(){let _img=this.img[0].img;return{_x:this.x+_img.width/2,_y:this.y+_img.height/2}}getPowerCapcell(){this.gotpc=!0}move(){let _this=this;if(_this.gotpc)return;_this.x=_MAP.getX(_this.x),_this.y=_MAP.getY(_this.y);let _img=(_this._c_pc_ani=_this._c_pc_ani>=5*_this.img.length-1?0:_this._c_pc_ani+1,_this.img[parseInt(_this._c_pc_ani/5)].img);_CONTEXT.drawImage(_img,_this.x,_this.y,_img.width,_img.height)}}class GameObject_BACKGROUND{constructor(){this.x=_CANVAS.width*Math.random(),this.y=_CANVAS.height*Math.random(),this.rgba="rgba("+parseInt(255*Math.random())+","+parseInt(255*Math.random())+","+parseInt(255*Math.random())+","+Math.random()+")",this.speed=5*Math.random(),this.move_flash_count=0,this._r=1}init(){this._r=Math.random()+this._r}move_flash(){}move(){this.x=this.x<0?_CANVAS.width:this.x,this.x-=0===_BACKGROUND_SPEED?0:this.speed,_CONTEXT.beginPath(),_CONTEXT.arc(this.x,this.y,this._r,0,2*Math.PI,!0),_CONTEXT.fillStyle=this.rgba,_CONTEXT.fill()}}const _IS_GET_POWERCAPSELL=function(){for(let _i=0;_i<_POWERCAPSELLS.length;_i++)_POWERCAPSELLS[_i].gotpc&&_POWERCAPSELLS.splice(_i,1);for(let _i=0;_i<_POWERCAPSELLS.length;_i++){let _pwc=_POWERCAPSELLS[_i];if(_pwc.gotpc)continue;let _pl=_PLAYERS_MAIN.getPlayerCenterPosition(),_pwc_c=_pwc.getPCCenterPosition();if(Math.sqrt(Math.pow(_pwc_c._x-_pl._x,2)+Math.pow(_pwc_c._y-_pl._y,2))<Math.sqrt(Math.pow(_PLAYERS_MAIN.img.width,2)+Math.pow(_PLAYERS_MAIN.img.height,2))/2)if(_pwc.getPowerCapcell(),"red"!==_pwc.type)if("blue"!==_pwc.type);else{var _ar=_ENEMIES.concat();for(let _i=0;_i<_ar.length;_i++){let _e=_ar[_i];_GAME.isEnemyCanvasOut(_e)||(_e.isStandBy()||_e.isAbleCollision()&&(_e._status-=1,_e.isalive()||(_SCORE.set(_e.getscore),_e.showCollapes())))}_ar=_ENEMIES_SHOTS.concat();for(let _i=0;_i<_ar.length;_i++){let _es=_ar[_i];_GAME.isEnemyCanvasOut(_es)||_es.init()}_GAME._setPlay(_CANVAS_AUDIOS.enemy_all_out)}else _POWERMETER.move(),_GAME._setPlay(_CANVAS_AUDIOS.pc),_SCORE.set(_pwc.getscore)}},_IS_ENEMIES_COLLISION=function(){if(!_PLAYERS_MAIN.isalive())return;for(let _i=0;_i<_ENEMIES.length;_i++)_ENEMIES[_i].isshow()||_ENEMIES[_i].isalive()||_ENEMIES.splice(_i,1);let _e=_ENEMIES;if(_SHOTTYPE===_SHOTTYPE_LASER)for(let _j=0;_j<_PLAYERS_SHOTS[_SHOTTYPE].length;_j++){let _os=_PLAYERS_SHOTS[_SHOTTYPE][_j],_ma=_CANVAS.width;_os.shots[0]._laser_MaxX;for(let _i=0;_i<_e.length;_i++){if(_e[_i].isStandBy())continue;if(!_e[_i].isalive())continue;let _oe=_e[_i],_m=_os.enemy_collision(_oe);_ma=_ma>_m?_m:_ma}_os.shots[0]._laser_MaxX=_os.shots[0].x<_ma?_ma:_os.shots[0]._laser_MaxX}else if(_SHOTTYPE!==_SHOTTYPE_LASER)for(let _j=0;_j<_PLAYERS_SHOTS[_SHOTTYPE].length;_j++){let _os=_PLAYERS_SHOTS[_SHOTTYPE][_j];for(let _i=0;_i<_e.length;_i++){if(_e[_i].isStandBy())continue;if(!_e[_i].isalive())continue;let _oe=_e[_i];_os.enemy_collision(_oe)}}for(let _i=0;_i<_e.length;_i++){let _oe=_e[_i];if(!_oe.isStandBy()&&(_oe.isalive()&&(_PLAYERS_MAIN.enemy_collision(_oe),_PLAYERS_MAIN_FORCE.enemy_collision(_oe),_PLAYERS_MISSILE_ISALIVE)))for(let _k=0;_k<_PLAYERS_MISSILE.length;_k++){let _pm=_PLAYERS_MISSILE[_k];if(_pm.player.isalive())for(let _j=0;_j<_pm.shots.length;_j++){let _pms=_pm.shots[_j];_pm.enemy_collision(_oe,_pms)}}}},_IS_ENEMIES_SHOT_COLLISION=function(){if(!_PLAYERS_MAIN.isalive())return;for(let _i=0;_i<_ENEMIES_SHOTS.length;_i++)_ENEMIES_SHOTS[_i].isshow()||_ENEMIES_SHOTS[_i].isalive()||_ENEMIES_SHOTS.splice(_i,1);for(let _i=0;_i<_ENEMIES_SHOTS.length;_i++){let _e=_ENEMIES_SHOTS[_i];_e._shot_alive&&(_PLAYERS_MAIN.enemy_shot_collision(_e),_PLAYERS_MAIN_FORCE.enemy_shot_collision(_e))}},_DRAW=function(){_KEYEVENT_MASTER.addKeydownGame(),_KEYEVENT_MASTER.addKeyupGame();const _loop=function(){_DRAW_SETINTERVAL=window.requestAnimationFrame(_loop),_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);for(let _i=0;_i<70;_i++)_BACKGROUND[_i].move();for(let _i=0;_i<_ENEMIES_SHOTS.length;_i++)_ENEMIES_SHOTS[_i].move();for(let _i=0;_i<_ENEMIES.length;_i++)void 0!==_ENEMIES[_i]&&_ENEMIES[_i].move();_MAP.move(),_IS_GET_POWERCAPSELL(),_IS_ENEMIES_SHOT_COLLISION(),_IS_ENEMIES_COLLISION(),_MAP.isPlayersShotCollision(),_DRAW_ENEMIES_COLLISIONS();for(let _i=0;_i<_POWERCAPSELLS.length;_i++)_POWERCAPSELLS[_i].move();for(let _i=0;_i<5;_i++)_PLAYERS_MISSILE_ISALIVE&&_PLAYERS_MISSILE[_i].move(),_PLAYERS_SHOTS[_SHOTTYPE][_i].move();for(let _i=0;_i<_PLAYERS_OPTION_MAX;_i++)_PLAYERS_OPTION[_i].move(10*(_i+1));_PLAYERS_MAIN_FORCE.move(_PLAYERS_MAIN),_PLAYERS_MAIN.move(),_MAP.map_draw(),_POWERMETER.show(),_SCORE.show(),_MAP.isboss&&_DRAW_MATCH_BOSS()};_DRAW_SETINTERVAL=window.requestAnimationFrame(_loop)},_DRAW_MATCH_BOSS=function(){if(_MAP.setBackGroundSpeedY(0),_MAP.setInifinite(!1),!_DRAW_IS_MATCH_BOSS)return""!==_MAP.map_boss&&void 0!==_MAP.map_boss&&void 0!==_MAP_ENEMIES_BOSS[_MAP.map_boss]||_DRAW_GAMECLEAR(),_DRAW_SCROLL_STOP(),_ENEMIES_SHOTS=[],(_ENEMIES=[]).push(_MAP_ENEMIES_BOSS[_MAP.map_boss]._f()),_DRAW_IS_MATCH_BOSS=!0,void _GAME._setPlayOnBG(_CANVAS_AUDIOS.bg_boss);let _bit="";for(let _i=0;_i<_ENEMIES.length;_i++)_bit+=_ENEMIES[_i].isalive()?"0":"1";-1===_bit.indexOf("0")&&(_DRAW_IS_MATCH_BOSS_COUNT>100?(_DRAW_GAMECLEAR(),_DRAW_SCROLL_RESUME()):_DRAW_IS_MATCH_BOSS_COUNT++)},_DRAW_PLAYER_COLLAPES=function(){_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame();const _this=_PLAYERS_MAIN;if(void 0===_this)return;let _si=null,_pl=_this.getPlayerCenterPosition();_GAME._setPlay(_CANVAS_AUDIOS.vicviper_bomb);const _loop=function(){if(_si=window.requestAnimationFrame(_loop),_this._col_ani_c>=10*_this.col_ani.length-1)return cancelAnimationFrame(_si),void _DRAW_GAMEOVER();let _c=parseInt(_this._col_ani_c/10),_w=_this.col_ani[_c].img.width,_h=_this.col_ani[_c].img.height,_sw=_w*_this.col_ani[_c].scale,_sh=_h*_this.col_ani[_c].scale;_CONTEXT.drawImage(_this.col_ani[_c].img,_pl._x-_sw/2,_pl._y-_sh/2,_sw,_sh),_this._col_ani_c++};_si=window.requestAnimationFrame(_loop)},_DRAW_PLAYERS_SHOTS=function(){let _date=new Date;const _loop=function(){if(_PLAYERS_SHOTS_SETINTERVAL=window.requestAnimationFrame(_loop),!(new Date-_date<50)){_date=new Date;for(var _i=0;_i<_PLAYERS_SHOTS[_SHOTTYPE].length;_i++){let _ps=_PLAYERS_SHOTS[_SHOTTYPE][_i];if(_ps.player._isalive)if(_SHOTTYPE!==_SHOTTYPE_DOUBLE){_ps._sq=_ps._sq===_ps.shots.length-1?0:_ps._sq+1;var _s=_ps.shots[_ps._sq];_s._shot_alive||(_s._shot=!0,0===_i&&_GAME._setPlay(_s._audio))}else{if(_ps.shots[0]._shot_alive||_ps.shots[1]._shot_alive)continue;if(_ps.shots[0]._shot=!0,_ps.shots[1]._shot=!0,0!==_i)continue;_GAME._setPlay(_ps.shots[0]._audio)}}if(_PLAYERS_MISSILE_ISALIVE)for(_i=0;_i<_PLAYERS_MISSILE.length;_i++){let _pm=_PLAYERS_MISSILE[_i];if(_pm.player._isalive)if(3!==_PLAYERS_POWER_METER){_pm._sq=_pm._sq===_pm.shots.length-1?0:_pm._sq+1;var _sm=_pm.shots[_pm._sq];_sm._shot_alive||(_sm._shot=!0,0===_i&&_GAME._setPlay(_sm._audio))}else{if(_pm.shots[0]._shot_alive||_pm.shots[1]._shot_alive)continue;if(_pm.shots[0]._shot=!0,_pm.shots[1]._shot=!0,0!==_i)continue;_GAME._setPlay(_pm.shots[0]._audio)}}}};_PLAYERS_SHOTS_SETINTERVAL=window.requestAnimationFrame(_loop)},_DRAW_STOP=function(){cancelAnimationFrame(_DRAW_SETINTERVAL),_DRAW_SETINTERVAL=null},_DRAW_STOP_GAMESTART=function(){cancelAnimationFrame(_DRAW_GAMESTART_SETINTERVAL),_DRAW_GAMESTART_SETINTERVAL=null},_DRAW_STOP_PLAYERS_SHOTS=function(){cancelAnimationFrame(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null;for(var _i=0;_i<_PLAYERS_SHOTS[_SHOTTYPE].length;_i++){let _ps=_PLAYERS_SHOTS[_SHOTTYPE][_i];for(let _j=0;_j<_ps.shots.length;_j++)_ps.shots[_j]._shot=!1}for(_i=0;_i<_PLAYERS_MISSILE.length;_i++){let _pm=_PLAYERS_MISSILE[_i];for(let _j=0;_j<_pm.shots.length;_j++)_pm.shots[_j]._shot=!1}},_DRAW_SELECT_POWERMETER=function(){_DRAW_STOP_PLAYERS_SHOTS(),_KEYEVENT_MASTER.removeKeydownSelectPowermeter();let _c=0,_si=null;const _loop=function(){_si=window.requestAnimationFrame(_loop),_POWERMETER.pms_disp(),_c%5==0&&_POWERMETER.pms_select(),_c>40&&(_PLAYERS_POWER_METER=_POWERMETER._c_pms,_PLAYERS_POWER_METER_SHIELD=_POWERMETER._c_pmss,cancelAnimationFrame(_si),_DRAW_INIT_OBJECT()),_c++};_si=window.requestAnimationFrame(_loop)},_DRAW_GAMESTART=function(){if(_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_ISDEBUG)return void _DRAW();let _c=0;const _loop=function(){if(_DRAW_GAMESTART_SETINTERVAL=window.requestAnimationFrame(_loop),_c>250)return cancelAnimationFrame(_DRAW_GAMESTART_SETINTERVAL),_DRAW_GAMESTART_SETINTERVAL=null,_GAME._setPlayOnBG(_CANVAS_AUDIOS["bg_"+_MAP.map_bgmusic]),void _DRAW();_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);for(let _i=0;_i<70;_i++)_BACKGROUND[_i].move();if(_POWERMETER.show(),_SCORE.show(),parseInt(_c/50)%2!=0);else{let _txt="start";for(let _i=0;_i<_txt.length;_i++){var _img=_CANVAS_IMGS_INIT["font_"+_txt[_i]].obj,_x=_CANVAS.width/2-.5*_img.width*_txt.length/2,_y=_CANVAS.height/2-_img.height/2;_CONTEXT.drawImage(_img,_x+.5*_img.width*_i,_y,.5*_img.width,.5*_img.height)}}_c++};_DRAW_GAMESTART_SETINTERVAL=window.requestAnimationFrame(_loop),_GAME._setStopOnBG()},_DRAW_GAMECLEAR=function(){var _img=_CANVAS_IMGS_INIT.font_0.obj;let _s="gameclear";_DRAW_DISP_TXT(_s,_CANVAS.width/2-.5*_img.width*_s.length/2,_CANVAS.height/2-_img.height/2,.5),_DRAW_DISP_TXT(_s="press r to restart",_CANVAS.width/2-.15*_img.width*_s.length/2,_CANVAS.height/2+30,.15),_DRAW_DISP_TXT(_s="press s to change another stage",_CANVAS.width/2-.15*_img.width*_s.length/2,_CANVAS.height/2+60,.15),_DRAW_IS_GAMECLEAR=!0},_DRAW_GAMEOVER=function(){_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_DRAW_STOP_PLAYERS_SHOTS(),_KEYEVENT_MASTER.addKeydownGameover(),_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);for(let _i=0;_i<70;_i++)_BACKGROUND[_i].move();_SCORE.show();var _img=_CANVAS_IMGS_INIT.font_0.obj;let _s="gameover";_DRAW_DISP_TXT(_s,_CANVAS.width/2-.5*_img.width*_s.length/2,_CANVAS.height/2-_img.height/2,.5),_DRAW_DISP_TXT(_s="press r to restart",_CANVAS.width/2-.15*_img.width*_s.length/2,_CANVAS.height/2+30,.15),_DRAW_DISP_TXT(_s="press s to change another stage",_CANVAS.width/2-.15*_img.width*_s.length/2,_CANVAS.height/2+60,.15)},_DRAW_ENEMIES_COLLISIONS=function(){for(let _i=0;_i<_ENEMIES_COLLISIONS.length;_i++)_ENEMIES_COLLISIONS[_i].isalive()||_ENEMIES_COLLISIONS.splice(_i,1);for(let _i=0;_i<_ENEMIES_COLLISIONS.length;_i++)_ENEMIES_COLLISIONS[_i].move()},_DRAW_DISP_TXT=function(_s,_x,_y,_r){_r=_r||1;for(let _i=0;_i<_s.length;_i++)if(" "!==_s[_i]){var _img=_CANVAS_IMGS_INIT["font_"+_s[_i]].obj;_CONTEXT.drawImage(_img,_x+_img.width*_r*_i,_y,_img.width*_r,_img.height*_r)}},_DRAW_SCROLL_STOP=function(){_MAP.set_scroll_off_x()},_DRAW_SCROLL_RESUME=function(){_MAP.set_scroll_on_x()},_DRAW_RESET_OBJECT=function(){_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_KEYEVENT_MASTER.removeKeydownGameover(),clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_DRAW_STOP(),_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_PLAYERS_MAIN="",_PLAYERS_MAIN_FORCE="",_PLAYERS_MOVE_FLAG=!1,_PLAYERS_OPTION=[],_PLAYERS_OPTION_ISALIVE=0,_PLAYERS_SHOTS={_SHOTTYPE_NORMAL:[],_SHOTTYPE_DOUBLE:[],_SHOTTYPE_LASER:[]},_PLAYERS_MISSILE=[],_PLAYERS_MISSILE_ISALIVE=!1,_PLAYERS_MOVE_DRAW_X=[],_PLAYERS_MOVE_DRAW_Y=[],_ENEMIES=[],_ENEMIES_SHOTS=[],_ENEMIES_COLLISIONS=[],_POWERMETER="",_SHOTTYPE=_SHOTTYPE_NORMAL,_POWERCAPSELLS=[],_MAP_SCROLL_POSITION_X=0,_MAP_SCROLL_POSITION_Y=0,_DRAW_IS_MATCH_BOSS=!1,_DRAW_IS_MATCH_BOSS_COUNT=0},_DRAW_INIT_OBJECT=function(){var _o;_KEYEVENT_MASTER.removeKeydownSelectPowermeter(),_PLAYERS_MAIN=0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?new GameObject_PLAYER_MAIN:new GameObject_PLAYER_MAIN_RED,_PLAYERS_SHOTS._SHOTTYPE_NORMAL.push(new GameObject_SHOTS_NORMAL(_PLAYERS_MAIN)),_PLAYERS_SHOTS._SHOTTYPE_DOUBLE.push((_o=_PLAYERS_MAIN,0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?new GameObject_SHOTS_DOUBLE(_o):new GameObject_SHOTS_TAILGUN(_o))),_PLAYERS_SHOTS._SHOTTYPE_LASER.push(function(_o){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER(_o):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER_CYCLONE(_o):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER(_o):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER_RED(_o):void 0}(_PLAYERS_MAIN)),_PLAYERS_MISSILE.push(function(_o){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE(_o):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_SPREADBOMB(_o):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_PHOTOM(_o):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_2WAY(_o):void 0}(_PLAYERS_MAIN)),_PLAYERS_MAIN_FORCE=0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?1===_PLAYERS_POWER_METER_SHIELD?new GameObject_FORCEFIELD:new GameObject_SHIELD:1===_PLAYERS_POWER_METER_SHIELD?new GameObject_FORCEFIELD_RED:new GameObject_SHIELD_RED;for(let _i=0;_i<_PLAYERS_OPTION_MAX;_i++)_PLAYERS_OPTION.push(new GameObject_PLAYER_OPTION("option",110,70*(_i+1),!1)),_PLAYERS_SHOTS._SHOTTYPE_NORMAL.push(new GameObject_SHOTS_NORMAL(_PLAYERS_OPTION[_i])),_PLAYERS_SHOTS._SHOTTYPE_DOUBLE.push(function(_o){return 0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?new GameObject_SHOTS_DOUBLE(_o):new GameObject_SHOTS_TAILGUN(_o)}(_PLAYERS_OPTION[_i])),_PLAYERS_SHOTS._SHOTTYPE_LASER.push(function(_o){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER(_o):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER_CYCLONE(_o):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER(_o):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER_RED(_o):void 0}(_PLAYERS_OPTION[_i])),_PLAYERS_MISSILE.push(function(_o){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE(_o):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_SPREADBOMB(_o):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_PHOTOM(_o):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_2WAY(_o):void 0}(_PLAYERS_OPTION[_i]));(_POWERMETER=new GameObject_PM("meter")).init(),_DRAW_IS_GAMECLEAR||_SCORE.init(),_DRAW_IS_GAMECLEAR=!1;for(let _i=0;_i<70;_i++)_BACKGROUND[_i]=new GameObject_BACKGROUND,_BACKGROUND[_i].init();_MAP.init_stage_map(),_MAP.init_enemies_location(),_DRAW_GAMESTART()},_DRAW_POWER_METER_SELECT=function(){clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_KEYEVENT_MASTER.removeKeydownSelectStage(),_KEYEVENT_MASTER.addKeydownSelectPowermeter(),(_POWERMETER=new GameObject_PM("meter")).pms_disp(),_POWERMETER.pms_select()},_DRAW_STAGE_SELECT=function(){clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);let _gsw=document.querySelector("#game_start_wrapper"),_gw=document.querySelector("#game_wrapper");_gsw.classList.remove("on"),_gw.classList.add("on"),_KEYEVENT_MASTER.removeKeydownStart(),_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_KEYEVENT_MASTER.removeKeydownGameover(),_KEYEVENT_MASTER.addKeydownSelectStage(),_MAP.init(function(){(_STAGESELECT=new GameObject_STAGESELECT).init()}),_GAME._setPlayOnBG(_CANVAS_AUDIOS.bg_powermeterselect)},_DRAW_AUDIO_INIT=function(_obj,_func){let _audioLoadedCount=0,_gsl_r=document.querySelector("#game_start_loading .rate");for(let _i in _obj){let _r=new XMLHttpRequest;_r.open("GET",_obj[_i].src,!0),_r.responseType="arraybuffer",_r.onload=function(){_AUDIO_CONTEXT.decodeAudioData(_r.response,function(_buf){_obj[_i].buf=_buf,++_audioLoadedCount>=Object.keys(_obj).length&&_DRAW_INIT(_CANVAS_IMGS_INIT,_GAME._init),_gsl_r.innerHTML=parseInt(_audioLoadedCount/Object.keys(_obj).length*100)+"%"},function(_error){alert(":"+_error)})},_r.send()}},_DRAW_INIT=function(_obj,_func){let _imgLoadedCount=0,_alertFlag=!1;for(let _i in _obj){let _o=_obj[_i];_o.obj.src=_obj[_i].src,_o.obj.onload=function(){_o.obj.width*=_o.rate,_o.obj.height*=_o.rate,++_imgLoadedCount>=Object.keys(_obj).length&&_func();let _s=parseInt(_imgLoadedCount/Object.keys(_obj).length*100);_GAME._setTextToFont(document.querySelector("#game_start>.text_loading"),"now loading "+_s+" per",30)},_o.obj.onabort=function(){},_o.obj.onerror=function(){_alertFlag||(_alertFlag=!0,alert(""))}}},_GAME={_url_params:new Array,_init:function(){_SCORE=new GameObject_SCORE,(_MAP=new GameObject_MAP).init(_GAME._showGameStart)},_audio_buffer_loader:null,_audio_now_obj_bg:null,_audio_context_source_bg:null,_is_audio_context_source_bg:!1,_ac:{_get:function(_c,_a,_p){return _c>=_a.length*_p-1?0:_c+1}},getBit:(_bit,_len)=>("0".repeat(_len)+_bit).slice(-1*_len),getOrBit(_b1,_b2,_l){let _s=(parseInt(_b1,2)|parseInt(_b2,2)).toString(2);return this.getBit(_s,_l)},setUrlParams(){for(var _prm=location.search.slice(1).split(/(&|&amp;)/),_i=0;_i<_prm.length;_i++){var _p=_prm[_i].replace("amp;","").split("=");""!==_p[0]&&void 0!==_p[0]&&("&"!==_p[0]&&(this._url_params[_p[0]]=_p[1]))}},isShotCanvasOut:_t=>_t.x<-50||_t.x>_CANVAS.width+50||_t.y<-50||_t.y>_CANVAS.height+50,isEnemyCanvasOut(_oe,_dir){let _e=_oe.getEnemyCenterPosition(),_d=_dir||{up:!0,down:!0,left:!0,right:!0},_e_w=_oe.img.width,_e_h=_oe.img.height;return _e._x<0-_e_w&&!0===_d.left||_e._x>_CANVAS.width+_e_w&&!0===_d.right||_e._y<0-_e_h&&!0===_d.up||_e._y>_CANVAS.height+_e_h&&!0===_d.down},isSqCollision:function(_s1,_s1_n,_s2,_s2_n,_d){return this.isSqCollision_laser(_s1,_s1_n,_s2,_s2_n,_d).ret},isSqCollision_laser:function(_s1,_s1_n,_s2,_s2_n,_d){let _s1_n_x=parseInt(void 0===_s1_n?0:_s1_n.split(",")[0]),_s1_n_y=parseInt(void 0===_s1_n?0:_s1_n.split(",")[1]),_s2_n_x=parseInt(void 0===_s2_n?0:_s2_n.split(",")[0]),_s2_n_y=parseInt(void 0===_s2_n?0:_s2_n.split(",")[1]),_s1_p=_s1.split(","),_s1_w=parseInt(_s1_p[2])-parseInt(_s1_p[0]),_s1_h=parseInt(_s1_p[3])-parseInt(_s1_p[1]),_s1_c_x=(Math.sqrt(Math.pow(_s1_w,2)+Math.pow(_s1_h,2)),_s1_w/2+_s1_n_x+parseInt(_s1_p[0])),_s1_c_y=_s1_h/2+_s1_n_y+parseInt(_s1_p[1]);_d&&console.log(_s1_c_x+":"+_s1_c_y);for(let _i=0;_i<_s2.length;_i++){let _s2_p=_s2[_i].split(","),_s2_w=parseInt(_s2_p[2])-parseInt(_s2_p[0]),_s2_h=parseInt(_s2_p[3])-parseInt(_s2_p[1]),_s2_col=void 0===_s2_p[4],_s2_c_x=(Math.sqrt(Math.pow(_s2_w,2)+Math.pow(_s2_h,2)),_s2_w/2+_s2_n_x+parseInt(_s2_p[0])),_s2_c_y=_s2_h/2+_s2_n_y+parseInt(_s2_p[1]),_d_x=Math.abs(_s2_c_x-_s1_c_x),_d_y=Math.abs(_s2_c_y-_s1_c_y),_tmpx=(Math.sqrt(Math.pow(_d_x,2)+Math.pow(_d_y,2)),_s2_n_x+parseInt(_s2_p[0]));if(_s1_w/2+_s2_w/2>_d_x&&_s1_h/2+_s2_h/2>_d_y)return _s2_col?{ret:_IS_SQ_COL,val:_tmpx+10}:{ret:_IS_SQ_COL_NONE,val:_tmpx+10}}return{ret:_IS_SQ_NOTCOL,val:_CANVAS.width}},_showGameStart:function(){if(document.querySelector("#game_start_loading").classList.remove("on"),_ISSP){document.querySelector("#sp_controller").classList.add("on"),_SP_CONTROLLER._set_obj()}if(_ISDEBUG){return document.querySelector("#game_wrapper").classList.add("on"),(_STAGESELECT=new GameObject_STAGESELECT).init(),_MAP.set_stage_map_pattern(_MAP_PETTERN),void _DRAW_INIT(_CANVAS_IMGS,_DRAW_POWER_METER_SELECT)}_KEYEVENT_MASTER.addKeydownStart(),document.querySelector("#game_start_wrapper").classList.add("on"),_GAME._setTextToFont(document.querySelector("#game_start>.title"),"no pakuri",50),_GAME._setTextToFont(document.querySelector("#game_start>.text"),"press s to start",30),_GAME._setTextToFont(document.querySelector("#game_start>.text_loading"),"now loading",30)},_setTextToFont:function(_o,_str,_w){if(void 0===_o||null===_o)return;_w=_w||30;let _s="";for(let _i=0;_i<_str.length;_i++)" "!==_str[_i]?_s+='<img src="./images/gradius_font_'+_str[_i]+'.png" width="'+_w+'">':_s+='<img src="./images/gradius_spacer.png" width="'+_w+'">';_o.innerHTML=_s},_getPlayerMoveDrawX:_elem=>void 0===_PLAYERS_MOVE_DRAW_X[_elem]?null:_PLAYERS_MOVE_DRAW_X[_elem],_getPlayerMoveDrawY:_elem=>void 0===_PLAYERS_MOVE_DRAW_Y[_elem]?null:_PLAYERS_MOVE_DRAW_Y[_elem],_setPlayerMoveDraw(){let _w=_PLAYERS_MAIN.img.width,_h=_PLAYERS_MAIN.img.height,_x=_PLAYERS_MAIN.x+parseInt(_w/10),_y=_PLAYERS_MAIN.y+parseInt(_h/4),_mgs=-1*_MAP.getBackGroundSpeedY(),_pmdy=_PLAYERS_MOVE_DRAW_Y;if(100===_PLAYERS_MOVE_DRAW_X.length&&_PLAYERS_MOVE_DRAW_X.pop(),100===_PLAYERS_MOVE_DRAW_Y.length&&_PLAYERS_MOVE_DRAW_Y.pop(),_PLAYERS_MOVE_DRAW_X.unshift(_x),_MAP.map_infinite)if(0!==_mgs)for(let _i=0;_i<100;_i++)void 0!==_pmdy[_i]?_mgs>0?_pmdy[_i]=_pmdy[_i]>=_y+_mgs*_i?_y+_mgs*_i:_pmdy[_i]+_mgs:_mgs<0&&(_pmdy[_i]=_pmdy[_i]<=_y+_mgs*_i?_y+_mgs*_i:_pmdy[_i]+_mgs):_pmdy.push(_y+_mgs*_i);else _pmdy.unshift(_y);else _pmdy.unshift(_y)},_setPlay(_obj){if(null!==_obj&&void 0!==_obj){var _s=_AUDIO_CONTEXT.createBufferSource();_s.buffer=_obj.buf,_s.loop=!1,_s.connect(_AUDIO_CONTEXT.destination),_s.start(0)}},_setPlayOnBG(_obj){if(null===_obj||void 0===_obj)return;!0===this._is_audio_context_source_bg&&(this._audio_context_source_bg.stop(),this._is_audio_context_source_bg=!1);let _t=_AUDIO_CONTEXT.createBufferSource();_t.buffer=_obj.buf,this._audio_now_obj_bg=_obj,_t.loop=!0,_t.loopStart=0,_t.connect(_AUDIO_CONTEXT.destination),_t.start(0),this._audio_context_source_bg=_t,this._is_audio_context_source_bg=!0},_setStopOnBG(){this._is_audio_context_source_bg&&(this._audio_context_source_bg.stop(),this._is_audio_context_source_bg=!1)},_multilineText(context,text,width){let len=text.length,strArray=[],_tmp="";if(len<1)return strArray;for(let _i=0;_i<len;_i++){let _c=text.charAt(_i);"\n"!==_c?context.measureText(_tmp+_c).width<=width?_tmp+=_c:(strArray.push(_tmp),_tmp=_c):(strArray.push(_tmp),_tmp="")}return _tmp.length>0&&strArray.push(_tmp),strArray}};window.addEventListener("load",function(){_CANVAS=document.getElementById("game"),_CONTEXT=_CANVAS.getContext("2d"),_GAME.setUrlParams(),_ISDEBUG="true"===_GAME._url_params.debug,_MAP_PETTERN=_GAME._url_params.mp||0,_ENEMY_DIFFICULT=_GAME._url_params.ed||0,_ISSP&&document.querySelector("body").classList.add("sp"),_DRAW_AUDIO_INIT(_CANVAS_AUDIOS)}),window.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1});