"use strict";const _CANVAS_IMGS={vicviper:{src:"images/gradius_vicviper.png",rate:1,obj:new Image},vicviper_back:{src:"images/gradius_vicviper_back.png",rate:1,obj:new Image},vicviper_bomb:{src:"images/gradius_vicviper_bomb.png",rate:1,obj:new Image},vicviper_bomb_red:{src:"images/gradius_vicviper_bomb_red.png",rate:1,obj:new Image},option:{src:"images/option.png",rate:1,obj:new Image},forcefield:{src:"images/gradius_forcefield.png",rate:1,obj:new Image},shield:{src:"images/gradius_shield.png",rate:1,obj:new Image},gradius_missile:{src:"images/gradius_missile.png",rate:1,obj:new Image},shot1:{src:"images/gradius_shot1.png",rate:.4,obj:new Image},shot2:{src:"images/gradius_shot2.png",rate:.4,obj:new Image},shot3:{src:"images/gradius_shot3.png",rate:.4,obj:new Image},shot_laser_col:{src:"images/gradius_shot_laser_col.png",rate:1,obj:new Image},meter:{src:"images/gradius_meter.png",rate:1,obj:new Image},meter_c:{src:"images/gradius_meter_c.png",rate:1,obj:new Image},enemy_fan:{src:"images/gradius_enemy_fan.png",rate:1,obj:new Image},enemy_a_1:{src:"images/gradius_enemy_a_1.png",rate:.55,obj:new Image},enemy_a_2:{src:"images/gradius_enemy_a_2.png",rate:.55,obj:new Image},enemy_b_1:{src:"images/gradius_enemy_b_1.png",rate:.55,obj:new Image},enemy_b_2:{src:"images/gradius_enemy_b_2.png",rate:.55,obj:new Image},enemy_c_1:{src:"images/gradius_enemy_c_1.png",rate:.4,obj:new Image},enemy_c_2:{src:"images/gradius_enemy_c_2.png",rate:.4,obj:new Image},enemy_c_3:{src:"images/gradius_enemy_c_3.png",rate:.4,obj:new Image},enemy_c_4:{src:"images/gradius_enemy_c_4.png",rate:.4,obj:new Image},enemy_d_1:{src:"images/gradius_enemy_d_1.png",rate:.2,obj:new Image},enemy_d_2:{src:"images/gradius_enemy_d_2.png",rate:.2,obj:new Image},enemy_d_3:{src:"images/gradius_enemy_d_3.png",rate:.2,obj:new Image},enemy_d_4:{src:"images/gradius_enemy_d_4.png",rate:.2,obj:new Image},enemy_e_1:{src:"images/gradius_enemy_e_1.png",rate:.2,obj:new Image},enemy_e_2:{src:"images/gradius_enemy_e_2.png",rate:.2,obj:new Image},enemy_e_3:{src:"images/gradius_enemy_e_3.png",rate:.2,obj:new Image},enemy_e_4:{src:"images/gradius_enemy_e_4.png",rate:.2,obj:new Image},enemy_f_1:{src:"images/gradius_enemy_f_1.png",rate:.4,obj:new Image},enemy_f_2:{src:"images/gradius_enemy_f_2.png",rate:.4,obj:new Image},enemy_f_3:{src:"images/gradius_enemy_f_3.png",rate:.4,obj:new Image},enemy_f_4:{src:"images/gradius_enemy_f_4.png",rate:.4,obj:new Image},enemy_g_1:{src:"images/gradius_enemy_g_1.png",rate:.4,obj:new Image},enemy_g_2:{src:"images/gradius_enemy_g_2.png",rate:.4,obj:new Image},enemy_g_3:{src:"images/gradius_enemy_g_3.png",rate:.4,obj:new Image},enemy_g_4:{src:"images/gradius_enemy_g_4.png",rate:.4,obj:new Image},enemy_m_1:{src:"images/gradius_enemy_m_1.png",rate:.24,obj:new Image},enemy_m_2:{src:"images/gradius_enemy_m_2.png",rate:.24,obj:new Image},enemy_m_3:{src:"images/gradius_enemy_m_3.png",rate:.24,obj:new Image},enemy_m_4:{src:"images/gradius_enemy_m_4.png",rate:.24,obj:new Image},enemy_m_5:{src:"images/gradius_enemy_m_5.png",rate:.24,obj:new Image},enemy_m_6:{src:"images/gradius_enemy_m_6.png",rate:.24,obj:new Image},enemy_m_7:{src:"images/gradius_enemy_m_7.png",rate:.24,obj:new Image},enemy_m_8:{src:"images/gradius_enemy_m_8.png",rate:.24,obj:new Image},enemy_m_group:{src:"images/gradius_enemy_m_group.png",rate:1,obj:new Image},enemy_o_1:{src:"images/gradius_enemy_o_1.png",rate:.3,obj:new Image},enemy_o_2:{src:"images/gradius_enemy_o_2.png",rate:.3,obj:new Image},enemy_p_1:{src:"images/gradius_enemy_p_1.png",rate:1,obj:new Image},enemy_p_2:{src:"images/gradius_enemy_p_2.png",rate:.3,obj:new Image},enemy_p_3:{src:"images/gradius_enemy_p_3.png",rate:.3,obj:new Image},enemy_p_4:{src:"images/gradius_enemy_p_4.png",rate:.3,obj:new Image},enemy_p_5:{src:"images/gradius_enemy_p_5.png",rate:.3,obj:new Image},enemy_m_a_1:{src:"images/gradius_enemy_m_a_1.png",rate:.25,obj:new Image},enemy_m_a_2:{src:"images/gradius_enemy_m_a_2.png",rate:.25,obj:new Image},enemy_m_b_1:{src:"images/gradius_enemy_m_b_1.png",rate:.25,obj:new Image},enemy_m_b_2:{src:"images/gradius_enemy_m_b_2.png",rate:.25,obj:new Image},enemy_m_z:{src:"images/gradius_enemy_m_z.png",rate:.25,obj:new Image},enemy_moai_ring:{src:"images/gradius_enemy_moai_ring.png",rate:1,obj:new Image},enemy_cell_boss:{src:"images/gradius_enemy_cell_boss.png",rate:1,obj:new Image},enemy_cell_boss_eye:{src:"images/gradius_enemy_cell_boss_eye.png",rate:1,obj:new Image},enemy_cell_core:{src:"images/gradius_enemy_cell_core.png",rate:1,obj:new Image},enemy_cell_hand_1:{src:"images/gradius_enemy_cell_hand_1.png",rate:1,obj:new Image},enemy_cell_hand_2:{src:"images/gradius_enemy_cell_hand_2.png",rate:1,obj:new Image},enemy_cell_hand_3:{src:"images/gradius_enemy_cell_hand_3.png",rate:1,obj:new Image},enemy_cell_a_1:{src:"images/gradius_enemy_cell_a_1.png",rate:1,obj:new Image},enemy_cell_a_2:{src:"images/gradius_enemy_cell_a_2.png",rate:1,obj:new Image},enemy_cell_b_1:{src:"images/gradius_enemy_cell_b_1.png",rate:1,obj:new Image},enemy_cell_b_2:{src:"images/gradius_enemy_cell_b_2.png",rate:1,obj:new Image},enemy_frame_1:{src:"images/gradius_enemy_frame_1.png",rate:1,obj:new Image},enemy_frame_2:{src:"images/gradius_enemy_frame_2.png",rate:1,obj:new Image},enemy_frame_3:{src:"images/gradius_enemy_frame_3.png",rate:1,obj:new Image},enemy_frame_4:{src:"images/gradius_enemy_frame_4.png",rate:1,obj:new Image},enemy_frame_5:{src:"images/gradius_enemy_frame_5.png",rate:1,obj:new Image},enemy_frame_6:{src:"images/gradius_enemy_frame_6.png",rate:1,obj:new Image},enemy_frame_head1:{src:"images/gradius_enemy_frame_head_1.png",rate:1,obj:new Image},enemy_frame_head2:{src:"images/gradius_enemy_frame_head_2.png",rate:1,obj:new Image},enemy_frame_head3:{src:"images/gradius_enemy_frame_head_3.png",rate:1,obj:new Image},enemy_frame_head4:{src:"images/gradius_enemy_frame_head_4.png",rate:1,obj:new Image},enemy_frame_body1:{src:"images/gradius_enemy_frame_body_1.png",rate:1,obj:new Image},enemy_bigcore:{src:"images/gradius_enemy_bigcore.png",rate:.6,obj:new Image},enemy_bigcore_1:{src:"images/gradius_enemy_bigcore_1.png",rate:.6,obj:new Image},enemy_bigcore_2:{src:"images/gradius_enemy_bigcore_2.png",rate:.6,obj:new Image},enemy_bigcore_3:{src:"images/gradius_enemy_bigcore_3.png",rate:.6,obj:new Image},enemy_bigcore_4_1:{src:"images/gradius_enemy_bigcore_4_1.png",rate:.6,obj:new Image},enemy_bigcore_4_2:{src:"images/gradius_enemy_bigcore_4_2.png",rate:.6,obj:new Image},enemy_bigcore_4_3:{src:"images/gradius_enemy_bigcore_4_3.png",rate:.6,obj:new Image},enemy_bigcore_4_4:{src:"images/gradius_enemy_bigcore_4_4.png",rate:.6,obj:new Image},enemy_bigcore_4_5:{src:"images/gradius_enemy_bigcore_4_5.png",rate:.6,obj:new Image},enemy_cristalcore:{src:"images/gradius_enemy_cristalcore.png",rate:1,obj:new Image},enemy_cristalcore_hand1:{src:"images/gradius_enemy_cristalcore_hand1.png",rate:.3,obj:new Image},enemy_cristalcore_hand2:{src:"images/gradius_enemy_cristalcore_hand2.png",rate:.4,obj:new Image},enemy_cristalcore_wall1:{src:"images/gradius_enemy_cristalcore_wall1.png",rate:1,obj:new Image},enemy_cristalcore_wall2:{src:"images/gradius_enemy_cristalcore_wall2.png",rate:1,obj:new Image},enemy_cristalcore_shot:{src:"images/gradius_enemy_cristalcore_shot.png",rate:1,obj:new Image},enemy_cube:{src:"images/gradius_enemy_cube.png",rate:1,obj:new Image},enemy_bigcore2:{src:"images/gradius_enemy_bigcore2.png",rate:1,obj:new Image},enemy_bigcore2_hand:{src:"images/gradius_enemy_bigcore2_hand.png",rate:1,obj:new Image},enemy_bigcore2_wall:{src:"images/gradius_enemy_bigcore2_wall.png",rate:1,obj:new Image},enemy_bigcore2_core:{src:"images/gradius_enemy_bigcore2_core.png",rate:1,obj:new Image},enemy_bigcore2_back:{src:"images/gradius_enemy_bigcore2_back.png",rate:1,obj:new Image},enemy_collapes0:{src:"images/gradius_enemy_collapes0.png",rate:1,obj:new Image},enemy_collapes1:{src:"images/gradius_enemy_collapes1.png",rate:1,obj:new Image},enemy_collapes2:{src:"images/gradius_enemy_collapes2.png",rate:1,obj:new Image},enemy_collapes8:{src:"images/gradius_enemy_collapes8.png",rate:1,obj:new Image},enemy_collapes9:{src:"images/gradius_enemy_collapes9.png",rate:1,obj:new Image},enemy_bullet:{src:"images/gradius_enemy_bullet.png",rate:1,obj:new Image},enemy_bullet_cell:{src:"images/gradius_enemy_bullet_cell.png",rate:1,obj:new Image},enemy_bullet_z:{src:"images/gradius_enemy_bullet_z.png",rate:1,obj:new Image},enemy_bullet_laser:{src:"images/gradius_enemy_bullet_laser.png",rate:1,obj:new Image},pc_red:{src:"images/gradius_pc_red.png",rate:1,obj:new Image},pc_blue:{src:"images/gradius_pc_blue.png",rate:1,obj:new Image},map_cube_A:{src:"images/gradius_map_cube_A.png",rate:1,obj:new Image},map_moai_A:{src:"images/gradius_map_moai_A.png",rate:1,obj:new Image},map_moai_B:{src:"images/gradius_map_moai_B.png",rate:1,obj:new Image},map_volcano_A:{src:"images/gradius_map_volcano_A.png",rate:1,obj:new Image},map_volcano_B:{src:"images/gradius_map_volcano_B.png",rate:1,obj:new Image},map_volcano_C:{src:"images/gradius_map_volcano_C.png",rate:1,obj:new Image},map_volcano_D:{src:"images/gradius_map_volcano_D.png",rate:1,obj:new Image},map_volcano_E:{src:"images/gradius_map_volcano_E.png",rate:1,obj:new Image},map_volcano_F:{src:"images/gradius_map_volcano_F.png",rate:1,obj:new Image},map_volcano_G:{src:"images/gradius_map_volcano_G.png",rate:1,obj:new Image},map_volcano_H:{src:"images/gradius_map_volcano_H.png",rate:1,obj:new Image},map_volcano_I:{src:"images/gradius_map_volcano_I.png",rate:1,obj:new Image},map_volcano_J:{src:"images/gradius_map_volcano_J.png",rate:1,obj:new Image},map_volcano_K:{src:"images/gradius_map_volcano_K.png",rate:1,obj:new Image},map_volcano_L:{src:"images/gradius_map_volcano_L.png",rate:1,obj:new Image},map_volcano_M:{src:"images/gradius_map_volcano_M.png",rate:1,obj:new Image},map_volcano_N:{src:"images/gradius_map_volcano_N.png",rate:1,obj:new Image},map_volcano_O:{src:"images/gradius_map_volcano_O.png",rate:1,obj:new Image},map_volcano_P:{src:"images/gradius_map_volcano_P.png",rate:1,obj:new Image},map_frame_A:{src:"images/gradius_map_frame_A.png",rate:1,obj:new Image},map_frame_B:{src:"images/gradius_map_frame_B.png",rate:1,obj:new Image},map_frame_C:{src:"images/gradius_map_frame_C.png",rate:1,obj:new Image},map_frame_D:{src:"images/gradius_map_frame_D.png",rate:1,obj:new Image},map_frame_E:{src:"images/gradius_map_frame_E.png",rate:1,obj:new Image},map_frame_F:{src:"images/gradius_map_frame_F.png",rate:1,obj:new Image},map_cell_A:{src:"images/gradius_map_cell_A.png",rate:1,obj:new Image},map_cell_B:{src:"images/gradius_map_cell_B.png",rate:1,obj:new Image},map_cell_C:{src:"images/gradius_map_cell_C.png",rate:1,obj:new Image},map_cell_D:{src:"images/gradius_map_cell_D.png",rate:1,obj:new Image},map_cell_V:{src:"images/gradius_map_cell_V.png",rate:1,obj:new Image},map_cell_W:{src:"images/gradius_map_cell_W.png",rate:1,obj:new Image},map_cell_Y:{src:"images/gradius_map_cell_Y.png",rate:1,obj:new Image},map_cell_Z:{src:"images/gradius_map_cell_Z.png",rate:1,obj:new Image},map_cell_wall:{src:"images/gradius_map_cell_wall.png",rate:1,obj:new Image}},_CANVAS_IMGS_INIT={font:{src:"images/gradius_font.png",rate:1,obj:new Image},gradius_powermeterselect:{src:"images/gradius_powermeterselect.png",rate:.28,obj:new Image},gradius_powermeterselect_shield:{src:"images/gradius_powermeterselect_shield.png",rate:.28,obj:new Image},gradius_powermeterselect_0:{src:"images/gradius_powermeterselect_0.png",rate:.28,obj:new Image},gradius_powermeterselect_1:{src:"images/gradius_powermeterselect_1.png",rate:.28,obj:new Image},gradius_powermeterselect_2:{src:"images/gradius_powermeterselect_2.png",rate:.28,obj:new Image},gradius_powermeterselect_3:{src:"images/gradius_powermeterselect_3.png",rate:.28,obj:new Image},gradius_powermeterselect_shield_0:{src:"images/gradius_powermeterselect_shield_0.png",rate:.28,obj:new Image},gradius_powermeterselect_shield_1:{src:"images/gradius_powermeterselect_shield_1.png",rate:.28,obj:new Image}},_CANVAS_AUDIOS={shot_laser:{src:"audios/shot_laser.mp3",volume:1,obj:null,buf:new Object},missile:{src:"audios/missile.mp3",volume:1,obj:null,buf:new Object},shot_normal:{src:"audios/shot_normal.mp3",volume:1,obj:null,buf:new Object},shot_ripple:{src:"audios/shot_ripple.mp3",volume:1,obj:null,buf:new Object},vicviper_bomb:{src:"audios/vicviper_bomb.mp3",volume:1,obj:null,buf:new Object},vicviper_shield_reduce:{src:"audios/vicviper_shield_reduce.mp3",volume:1,obj:null,buf:new Object},pc:{src:"audios/pc.mp3",volume:1,obj:null,buf:new Object},playerset:{src:"audios/playerset.mp3",volume:1,obj:null,buf:new Object},pms_select:{src:"audios/pms_select.mp3",volume:1,obj:null,buf:new Object},enemy_bullet_laser:{src:"audios/enemy_bullet_laser.mp3",volume:1,obj:null,buf:new Object},enemy_collision1:{src:"audios/enemy_collision1.mp3",volume:1,obj:null,buf:new Object},enemy_collision2:{src:"audios/enemy_collision2.mp3",volume:1,obj:null,buf:new Object},enemy_collision3:{src:"audios/enemy_collision3.mp3",volume:1,obj:null,buf:new Object},enemy_collision4:{src:"audios/enemy_collision4.mp3",volume:1,obj:null,buf:new Object},enemy_collision5:{src:"audios/enemy_collision5.mp3",volume:1,obj:null,buf:new Object},enemy_collision6:{src:"audios/enemy_collision6.mp3",volume:1,obj:null,buf:new Object},enemy_collision7:{src:"audios/enemy_collision7.mp3",volume:1,obj:null,buf:new Object},enemy_all_out:{src:"audios/enemy_all_out.mp3",volume:1,obj:null,buf:new Object},enemy_cube:{src:"audios/enemy_cube.mp3",volume:1,obj:null,buf:new Object},map_cell_wall:{src:"audios/map_cell_wall.mp3",volume:1,obj:null,buf:new Object},bg_powermeterselect:{src:"audios/bg_powermeterselect.mp3",volume:1,obj:null,buf:new Object},bg_boss:{src:"audios/bg_boss.mp3",volume:1,obj:null,buf:new Object},bg_type1:{src:"audios/bg_moai.mp3",volume:1,obj:null,buf:new Object},bg_type2:{src:"audios/bg_volcano.mp3",volume:1,obj:null,buf:new Object},bg_type3:{src:"audios/bg_crystal.mp3",volume:1,obj:null,buf:new Object},bg_type4:{src:"audios/bg_frame.mp3",volume:1,obj:null,buf:new Object},bg_type5:{src:"audios/bg_thunderbolt.mp3",volume:1,obj:null,buf:new Object},bg_type6:{src:"audios/bg_cell.mp3",volume:1,obj:null,buf:new Object}};let _ISDEBUG=!1,_PLAYERS_POWER_METER=0,_PLAYERS_POWER_METER_SHIELD=0,_DRAW_SETINTERVAL=null,_DRAW_GAMESTART_SETINTERVAL=null,_PLAYERS_SHOTS_SETINTERVAL=null,_EVENT_POWERMETER_FLAG=!1,_EVENT_SELECT_STAGE_FLAG=!1,_DRAW_IS_MATCH_BOSS=!1,_DRAW_IS_MATCH_BOSS_COUNT=0;const _ISSP=null===window.ontouchstart,_EVENT_KEYDOWN=null===window.ontouchstart?"touchstart":"keydown",_EVENT_KEYUP=null===window.ontouchstart?"touchend":"keyup",_FPS=60;let _CANVAS,_CONTEXT,_DRAW_IS_GAMECLEAR=!1;const _SHOTTYPE_MISSILE="_SHOTTYPE_MISSILE",_SHOTTYPE_NORMAL="_SHOTTYPE_NORMAL",_SHOTTYPE_DOUBLE="_SHOTTYPE_DOUBLE",_SHOTTYPE_LASER="_SHOTTYPE_LASER",_SHOTTYPE_RIPPLE_LASER="_SHOTTYPE_RIPPLE_LASER";let _SHOTTYPE=_SHOTTYPE_NORMAL,_SCORE="",_PLAYERS_MAIN="",_PLAYERS_MAIN_FORCE="",_PLAYERS_OPTION=new Array,_PLAYERS_OPTION_ISALIVE=0;const _PLAYERS_OPTION_MAX=4,_PLAYERS_MOVE_DRAW_MAX=100;let _PLAYERS_MOVE_FLAG=!1,_PLAYERS_MOVE_DRAW_X=new Array,_PLAYERS_MOVE_DRAW_Y=new Array;const _PLAYERS_MAX=5,_PLAYERS_SHOTS_MAX=2;let _PLAYERS_SHOTS={_SHOTTYPE_NORMAL:new Array,_SHOTTYPE_DOUBLE:new Array,_SHOTTYPE_LASER:new Array},_PLAYERS_MISSILE=new Array,_PLAYERS_MISSILE_ISALIVE=!1,_ENEMIES=new Array,_ENEMIES_SHOTS=new Array,_ENEMIES_COLLISIONS=new Array,_POWERCAPSELLS=new Array,_POWERMETER="",_STAGESELECT="",_MAP="",_BACKGROUND=new Array;const _BACKGROUND_STAR_MAX=70;let _KEYSAFTERPAUSE=new Array,_DEF_KEYSAFTERPAUSE="38,38,40,40,37,39,37,39,66,65";const _IS_SQ_COL=0,_IS_SQ_COL_NONE=1,_IS_SQ_NOTCOL=2,_AUDIO_CONTEXT=new(window.AudioContext||window.webkitAudioContext);class GameObject_ENEMY_SHOT{constructor(_){let e=this;e.x=_.x||500,e.y=_.y||300,e.tx=_PLAYERS_MAIN.getPlayerCenterPosition()._x,e.ty=_PLAYERS_MAIN.getPlayerCenterPosition()._y,e.img=_.img||_CANVAS_IMGS.enemy_bullet.obj,e.imgPos=_.imgPos||[0,18],e._c=0,e.aniItv=_.aniItv||5,e.width=_.width||18,e.height=_.height||e.img.height,e.speed=_.speed||_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SHOT_SPEED,e.rad=void 0===_.deg?_GAME.getRad({x:e.tx,y:e.ty},{x:e.x,y:e.y}):_.deg*Math.PI/180,e.deg=_.deg||_GAME.getDeg({x:e.tx,y:e.ty},{x:e.x,y:e.y}),e.sx=Math.cos(e.rad),e.sy=Math.sin(e.rad),e._shot_alive=!0,e._isshow=!0,e.shotColMap=["1,1,"+(e.width-1)+","+(e.height-1)]}init(){this._shot_alive=!1,this._isshow=!1}map_collition(){let _=this,e=_MAP.getMapX(_.x),t=_MAP.getMapY(_.y);_MAP.isMapCollision(e,t)&&_.init()}getEnemyCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}isalive(){return this._shot_alive}isshow(){return this._isshow}move(){let _=this;_.map_collition(),_.y=_MAP.getY(_.y),_GAME.isEnemyCanvasOut(_)?_.init():_._shot_alive&&(_._c=_._c>=7?0:_._c+1,_.x+=_.sx*_.speed,_.y+=_.sy*_.speed,_GAME._setDrawImage({img:_.img,x:_.x,y:_.y,width:_.width,imgPosx:_.imgPos[parseInt(_._c/_.aniItv)]}),_._shot_alive=!0)}}class ENEMY_SHOT_LASER extends GameObject_ENEMY_SHOT{constructor(_){super({x:_.x,y:_.y}),this.img=_.img||_CANVAS_IMGS.enemy_bullet_laser.obj,this.speed=10}move(){let _=this;_GAME.isEnemyCanvasOut(_)?_.init():_._shot_alive&&(_.map_collition(),_.x-=_.speed,_GAME._setDrawImage({img:_.img,x:_.x,y:_.y}))}}class ENEMY_SHOT_CRYSTALCORE extends GameObject_ENEMY_SHOT{constructor(_){super({x:_.x,y:_.y,deg:_.deg});this.img=_CANVAS_IMGS.enemy_cristalcore_shot.obj,this.speed=10}move(){let _=this;_GAME.isEnemyCanvasOut(_)?_.init():_._shot_alive&&(_.map_collition(),_.x-=_.sx*_.speed,_.y-=_.sy*_.speed,_GAME._setDrawImage({img:_.img,x:_.x,y:_.y,deg:_.deg}))}}class ENEMY_SHOT_FRAME extends GameObject_ENEMY_SHOT{constructor(_){super({x:_.x,y:_.y,deg:_.deg});this.img=_CANVAS_IMGS.enemy_frame_3.obj,this.speed=1,this._c=0}shot(){let _=this;if(_._c>100){let e=_.getEnemyCenterPosition();for(let _=30;_<=360;_+=30)_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME_SMALL({x:e._x,y:e._y,deg:_}));_.init()}}move(){let _=this;_GAME.isEnemyCanvasOut(_)?_.init():_._shot_alive&&(_.shot(),_.map_collition(),_.x-=_.sx*_.speed,_.y-=_.sy*_.speed,_GAME._setDrawImage({img:_.img,x:_.x,y:_.y,deg:_.deg}),_._c++)}}class ENEMY_SHOT_FRAME_SMALL extends ENEMY_SHOT_FRAME{constructor(_){super({x:_.x,y:_.y,deg:_.deg});this.img=_CANVAS_IMGS.enemy_frame_5.obj,this.speed=5}shot(){}}class GameObject_ENEMY{constructor(_,e,t,s,i,a,n){this.id=_ENEMIES.length,this.gid=0,this.img=_,this.imgPos=s||[0],this.aniItv=i||10,this.width=a||this.img.width,this.height=n||this.img.height,this.x=e||0,this.y=t||0,this.audio_collision=_CANVAS_AUDIOS.enemy_collision1,this.audio_alive=_CANVAS_AUDIOS.enemy_collision3,this.isshot=!1,this._DEF_DIR={_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},this._DEF_SHOTSTATUS={_SHOTTYPE_NORMAL:1,_SHOTTYPE_MISSILE:2,_SHOTTYPE_DOUBLE:1,_SHOTTYPE_RIPPLE_LASER:1.5,_SHOTTYPE_LASER:1},this.alpha=1,this._c=0,this.speed=1,this.getscore=200,this.direct=this._DEF_DIR._U,this._standby=!0,this._isshow=!0,this._status=1,this.haspc=!1,this._collision_type="t0",this.is_ignore=!1,this.is_able_collision=!0,this.is_ignore_collision=!1,this.shotColMap=["0,0,"+this.width+","+this.height],this.col_date=null,this.col_canint=150,this.mapdef_col="0"}init(){this._status=0,this._isshow=!1}collision(_,e){return!!this.isCollision()&&(!this.is_able_collision||(this.setStatus(_,e),!0))}isAbleCollision(){return this.is_able_collision}isIgnore(){return this.is_ignore}isIgnoreCollision(){return this.is_ignore_collision}isCollision(){let _=this;return null===_.col_date?(_.col_date=new Date,!0):new Date-_.col_date>_.col_canint&&(_.col_date=new Date,!0)}setAlive(){let _=this;_.isalive()?_GAME._setPlay(_.audio_alive):(_SCORE.set(_.getscore),_GAME._setPlay(_.audio_collision))}setStatus(_){this._status-=this._DEF_SHOTSTATUS[_]||1,this.setAlive()}getEnemyCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}isalive(){return this._status>0}isshow(){return this._isshow}shot(){_GAME.isEnemyCanvasOut(this)||Math.random()>=_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SHOT_RATE||_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT({x:this.getEnemyCenterPosition()._x,y:this.getEnemyCenterPosition()._y}))}get_move_bound_val(){return parseInt(2*Math.random()+1)*(Math.random()>.5?1:-1)}set_imgPos(){this._c=this._c>=this.imgPos.length*this.aniItv-1?0:this._c+1}get_imgPos(){return this.imgPos[parseInt(this._c/this.aniItv)]}setDrawImage(_,e,t,s){let i=this,a=s||0,n=(t||i.img.width,_||i.img.width),o=e||i.img.height;_CONTEXT.save(),i.setDrawImageDirect(),void 0===s||void 0===t||void 0===_||void 0===e?_CONTEXT.drawImage(i.img,i.x,i.y,i.img.width,i.img.height):_CONTEXT.drawImage(i.img,a,0,n,o,i.x,i.y,n,o),_CONTEXT.restore()}setDrawImageDirect(){let _=this;_.direct===_._DEF_DIR._U&&_CONTEXT.setTransform(1,0,0,-1,0,2*_.y+_.img.height),_.direct===_._DEF_DIR._LU&&_CONTEXT.setTransform(-1,0,0,-1,2*_.x+_.img.width,2*_.y+_.img.height),_.direct===_._DEF_DIR._LD&&_CONTEXT.setTransform(-1,0,0,1,2*_.x+_.img.width,0)}isStandBy(){return this._standby}isCanvasOut(){return _GAME.isEnemyCanvasOut(this,{up:!1,down:!1,left:!0,right:!1})}showCollapes(_,e){let t=this;t._isshow=!1,t.haspc?_POWERCAPSELLS.push(new GameObject_POWERCAPSELL(t.x,t.y)):_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(_||t.x+t.width/2,e||t.y+t.height/2,t._collision_type))}isMove(){let _=this;return _.isStandBy()?(_.move_standby(),!1):_.isCanvasOut()?(_._status=0,_._isshow=!1,!1):!!_.isshow()&&(!!_.isalive()||(_.showCollapes(),!1))}moveDraw(){this.setDrawImage(),this.shot()}move_standby(){let _=this;_.x<_CANVAS.width-20&&(_._standby=!1)}move(){this.x=_MAP.getX(this.x),this.y=_MAP.getY(this.y),this.isMove()&&this.moveDraw()}}class ENEMY_FAN extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_fan.obj,_,e,[0,25,50,75,100,125,150,175],5,25,25);this.haspc=!0,this.parts=[],this.is_ignore=!0}move_standby(){let _=this;if(!(_.x>_CANVAS.width)){_._standby=!1,_.parts=[new ENEMY_FAN_MAIN({x:_.x+_.width,y:_.y}),new ENEMY_FAN_MAIN({x:_.x+.5*_.width,y:_.y}),new ENEMY_FAN_MAIN({x:_.x+_.width,y:_.y}),new ENEMY_FAN_MAIN({x:_.x+1.5*_.width,y:_.y}),new ENEMY_FAN_MAIN({x:_.x+2*_.width,y:_.y}),new ENEMY_FAN_MAIN({x:_.x+2.5*_.width,y:_.y})];for(let e=0;e<_.parts.length;e++)_ENEMIES.push(_.parts[e])}}moveDraw(){let _=this;for(let e=_.parts.length-1;e>=0;e--){let t=_.parts[e];t.moveDraw(),t.isalive()||_.parts.splice(e,1)}if(0===_.parts.length)return _.x<_CANVAS.width&&_.showCollapes(),void _.init();_.x=_.parts[_.parts.length-1].x,_.y=_.parts[_.parts.length-1].y}}class ENEMY_FAN_MAIN extends GameObject_ENEMY{constructor(_){super(_CANVAS_IMGS.enemy_fan.obj,_.x,_.y,[0,25,50,75,100,125,150,175],5,25,25);this._status=1,this.speed=2,this.pos_y=_.y>250,this.change_x=!1,this.change_y=!1}isCanvasOut(){return _GAME.isEnemyCanvasOut(this,{up:!1,down:!1,left:!0,right:this.change_x})}moveDraw(){let _=this;if(_.x=_MAP.getX(_.x),_.y=_MAP.getY(_.y),!_.isMove())return;const e=_.pos_y?275:200;_.change_x=_.change_x||_.x<500,_.x+=_.change_x?_.speed+_MAP.getBackGroundSpeed():-1*_.speed,_.change_y=_.change_y||_.pos_y&&_.y<e||!_.pos_y&&_.y>e,_.y+=(()=>_.change_x?_.change_y?0:_.pos_y?-1*_.speed:_.speed:0)(),_.set_imgPos(),_GAME._setDrawImage({img:_.img,x:_.x,y:_.y,imgPosx:_.get_imgPos(),width:_.width,basePoint:1}),_.shot()}move(){}}class ENEMY_a extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_a_1.obj,_,e);this._status=1,this.direct=t||this._DEF_DIR._U,this.defimg=[_CANVAS_IMGS.enemy_a_1.obj,_CANVAS_IMGS.enemy_a_2.obj]}setDrawImageDirect(){let _=this;_.direct===_._DEF_DIR._U&&(_PLAYERS_MAIN.x<_.x?_CONTEXT.setTransform(1,0,0,-1,0,2*_.y+_.img.height):_CONTEXT.setTransform(-1,0,0,-1,2*_.x+_.img.width,2*_.y+_.img.height)),_.direct===_._DEF_DIR._D&&(_PLAYERS_MAIN.x<_.x?_CONTEXT.setTransform(1,0,0,1,0,0):_CONTEXT.setTransform(-1,0,0,1,2*_.x+_.img.width,0))}moveDraw(){this.img=Math.abs(_PLAYERS_MAIN.y-this.y)>100?this.defimg[0]:this.defimg[1],this.setDrawImage(),this.shot()}}class ENEMY_b extends ENEMY_a{constructor(_,e,t){super(_,e,t);this.direct=t||this._DEF_DIR._U,this.haspc=!0,this.defimg=[_CANVAS_IMGS.enemy_b_1.obj,_CANVAS_IMGS.enemy_b_2.obj]}}class ENEMY_c extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_c_1.obj,_,e);let s=this;s.x=_,s.y=t===s._DEF_DIR._D?e-(_CANVAS_IMGS.enemy_c_1.obj.height-_MAP.t):e,s._st="_st1",s._shot=!1,s._status=1,s.direct=t||s._DEF_DIR._U,s._collision_type="t1",s.speed=_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SPEED,s._c_shotstep=0,s.shotstep=[{img:_CANVAS_IMGS.enemy_c_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_4.obj,scale:1}],s._c_walkstep=0,s.walkstep=[{img:_CANVAS_IMGS.enemy_c_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_2.obj,scale:1}],s._c_walk=0;s.shotColMap=t===s._DEF_DIR._D?["10,10,43,42"]:["0,0,43,32"],s._ene_status={_st1:{_f:function(){!0!==s._shot&&(s._c_walkstep=19===s._c_walkstep?0:s._c_walkstep+1,s.img=s.walkstep[parseInt(s._c_walkstep/10)].img,s._c_walk++)},_setX:function(){return s.x+2*s.speed}},_st2:{_f:function(){if(!(s.x>=_CANVAS.width)){if(s._shot=!0,s._c_shotstep>=19)return s.shot(),s._c_shotstep=0,s._shot=!1,void(s._st="_st1");s._c_shotstep+=1,s.img=s.img=s.shotstep[parseInt(s._c_shotstep/10)].img}},_setX:function(){return s.x}}}}map_collition(){let _=this,e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);_MAP.isMapBefore(t,s)&&(_.speed=Math.abs(_.speed)),_MAP.isMapLastSide(t,s)&&(_.speed=-1*_.speed);let i=_MAP.t;i=2*Math.abs(_.speed);let a=_MAP.isMapCollision(t+1,s)||_MAP.isMapCollision(t-1,s);var n;_.y=(n=_).direct===_._DEF_DIR._U?a?n.y+i:n.y:n.direct===_._DEF_DIR._D?a?n.y-i:n.y:void 0,_.y=function(e){return e.direct===_._DEF_DIR._U?_MAP.isMapCollision(t,s-1)?e.y:e.y-i:e.direct===_._DEF_DIR._D?_MAP.isMapCollision(t,s+1)?e.y:e.y+i:void 0}(_)}setDrawImageDirect(){let _=this;_.direct===_._DEF_DIR._U&&(_PLAYERS_MAIN.x<_.x?_CONTEXT.setTransform(1,0,0,-1,0,2*_.y+_.img.height):_CONTEXT.setTransform(-1,0,0,-1,2*_.x+_.img.width,2*_.y+_.img.height)),_.direct===_._DEF_DIR._D&&(_PLAYERS_MAIN.x<_.x?_CONTEXT.setTransform(1,0,0,1,0,0):_CONTEXT.setTransform(-1,0,0,1,2*_.x+_.img.width,0))}set_speed(){let _=_PLAYERS_MAIN.getPlayerCenterPosition();this._c_walk>5e3*Math.random()&&(this._c_walk=0,this.speed=_._x<this.x?-1*this.speed:Math.abs(this.speed))}shot(){if(_GAME.isEnemyCanvasOut(this))return;let _=_PLAYERS_MAIN.getPlayerCenterPosition(),e=this.getEnemyCenterPosition(),t=_GAME.getDeg({x:_._x,y:_._y},{x:e._x,y:e._y});_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT({x:e._x,y:e._y,deg:t-10})),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT({x:e._x,y:e._y,deg:t+10}))}moveDraw(){this.map_collition(),this.set_speed(),this._st=Math.random()<_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SHOT_RATE||this._shot?"_st2":"_st1",this._ene_status[this._st]._f(),this.x=this._ene_status[this._st]._setX(),this.setDrawImage()}}class ENEMY_d extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_d_1.obj,_,e);this._status=1,this.speed=2,this._col_c=0,this.col=[{img:_CANVAS_IMGS.enemy_d_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_4.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_2.obj,scale:1}]}moveDraw(){this.x+=-1*this.speed;let _=this.x,e=Math.cos(_*Math.PI/180);var t;this.y+=e,this.img=((t=this)._col_c=t._col_c>=5*t.col.length-1?0:t._col_c+1,t.col[parseInt(t._col_c/5)].img),this.setDrawImage(),this.shot()}}class ENEMY_e extends ENEMY_d{constructor(_,e,t){super(_,e,t);this.haspc=!0,this._col_c=0,this.col=[{img:_CANVAS_IMGS.enemy_e_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_4.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_2.obj,scale:1}],this.defimg=this.col}}class ENEMY_f extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_f_1.obj,_,e);this._status=1,this.haspc=!1,this._v=0,this.direct=t||this._DEF_DIR._U,this.speed=t===this._DEF_DIR._U?-.05:.05,this._col_c=0,this.col=[{img:_CANVAS_IMGS.enemy_f_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_4.obj,scale:1}]}getDir(){return this.x>_CANVAS.width/2?-1:.5}isCanvasOut(){return _GAME.isEnemyCanvasOut(this,{up:!0,down:!0,left:!1,right:!1})}shot(){let _=this.getEnemyCenterPosition();for(let e=30;e<=360;e+=30)_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT({x:_._x,y:_._y,deg:e}))}move_standby(){let _=this;_.x+_.img.width<0&&(_._standby=!1)}moveDraw(){let _=this;_.x+=4*_.getDir(),_.y+=_._v,_._v+=_.speed;let e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);var i;_MAP.isMapCollision(t,s)&&(_._v+=_.speed,_._v*=-1),_.img=((i=_)._col_c=i._col_c>=5*i.col.length-1?0:i._col_c+1,i.col[parseInt(i._col_c/5)].img),_.setDrawImage(),_._v>0&&_._v<.05&&_.shot()}}class ENEMY_g extends ENEMY_f{constructor(_,e,t){super(_,e,t);this._status=1,this.haspc=!0,this.col=[{img:_CANVAS_IMGS.enemy_g_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_4.obj,scale:1}]}}class ENEMY_m extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_m_1.obj,_,e);this._status=4,this._collision_type="t1",this.direct=t||this._DEF_DIR._U,this.getscore=200,this._col_c=0,this._isopen=!1,this._open_count=0,this.col=[{img:_CANVAS_IMGS.enemy_m_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_4.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_1.obj,scale:1}],this.col2=[{img:_CANVAS_IMGS.enemy_m_5.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_6.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_7.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_8.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_7.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_6.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_5.obj,scale:1}]}moveDraw(){let _=this;_.isalive()?(_.img=function(e){let t=e._status<=1?e.col2:e.col;return e._isopen?(e._open_count++,3===parseInt(e._col_c/5)&&e._open_count<=200?t[parseInt(e._col_c/5)].img:(e._open_count>200&&e._col_c>=5*t.length-1&&(e._col_c=0,e._open_count=0,e._isopen=!1),e._col_c=e._col_c>=5*t.length-1?0:e._col_c+1,t[parseInt(e._col_c/5)].img)):(_.x>=690&&_.x<700&&(_._isopen=!0),_.x>=380&&_.x<400&&(_._isopen=!0),t[0].img)}(_),function(e){if(!e._isopen)return;if(e._open_count%15!=0)return;let t=new ENEMY_m_group({x:_.x+15,y:_.y,direct:_.direct});_ENEMIES.push(t)}(_),_.setDrawImage()):_.showCollapes(0,_.direct===_._DEF_DIR._U?0:-_MAP.t)}}class ENEMY_m_group extends GameObject_ENEMY{constructor(_){super(_CANVAS_IMGS.enemy_m_group.obj,_.x,_.y,[0,25,50,75,100,125,150],5,25,25);this._status=1,this.direct=_.direct||this._DEF_DIR._U,this.speed=2,this.getscore=100,this._change=!1,this._moveX=0,this._moveY=0}isCanvasOut(){return _GAME.isEnemyCanvasOut(this)}moveDraw(){let _=this,e=_PLAYERS_MAIN.getPlayerCenterPosition();_._change=!!_._change||(_.direct===_._DEF_DIR._U&&e._y<_.y?(_._moveX=e._x<_.x?-1*_.speed:_.speed,!0):_.direct===_._DEF_DIR._D&&e._y>_.y&&(_._moveX=e._x<_.x?-1*_.speed:_.speed,!0)),_._moveY=_._change?0:_.direct===_._DEF_DIR._U?_.speed:_.direct===_._DEF_DIR._D?-1*_.speed:void 0,_.x+=_._moveX,_.y+=_._moveY,_.set_imgPos(),_GAME._setDrawImage({img:_.img,x:_.x,y:_.y,imgPosx:_.get_imgPos(),width:_.width,basePoint:1}),_.shot()}}class ENEMY_n extends GameObject_ENEMY{constructor(_,e){super(_CANVAS_IMGS.enemy_o_1.obj,_,e)}isCanvasOut(){return this.x<200}isalive(){return!0}moveDraw(){if(Math.random()>.2)return;let _=new ENEMY_n_small(_CANVAS_IMGS[["enemy_o_1","enemy_o_2"][Math.random()>.5?1:0]].obj,this.x,this.y);_ENEMIES.push(_)}}class ENEMY_o extends ENEMY_n{constructor(_,e,t){super(_,e,t)}moveDraw(){if(Math.random()>.1)return;let _=new ENEMY_o_small(_CANVAS_IMGS[["enemy_o_1","enemy_o_2"][Math.random()>.5?1:0]].obj,this.x,this.y);_ENEMIES.push(_)}}class ENEMY_o_small extends GameObject_ENEMY{constructor(_,e,t){super(_,e,t);this._status=1,this.getscore=100,this.speedX=4*Math.random()+1,this.flagX=Math.random()>.5?1:-1,this.speedY=.2,this._v=-10,this._collision_type="t2"}map_collition(){let _=this,e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);_MAP.isMapCollision(t,s-1)&&(_._status=0)}moveDraw(){this.map_collition(),this.x-=this.speedX*this.flagX,this.y+=this._v,this._v+=this.speedY,_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}}class ENEMY_n_small extends ENEMY_o_small{constructor(_,e,t){super(_,e,t);this.speedY=-.2,this._v=10}map_collition(){let _=this,e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);_MAP.isMapCollision(t,s+1)&&(_._status=0)}}class ENEMY_p extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_p_1.obj,_,e);this._status=4,this.getscore=100,this.speedx=_BACKGROUND_SPEED,this.speedy=(Math.random()+1)*(Math.random()>.5?1:-1),this._isbroken=!1,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,this.mapdef_col="000,000,000"}setAlive(){this.isalive()||_SCORE.set(this.getscore)}map_collition(){let _=this,e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);(_MAP.isMapCollision(t,s-1)||_MAP.isMapCollision(t,s+1))&&(_.speedx=Math.random()>.4?Math.abs(_.speedx):-1*_.speedx,_.speedy=Math.random()>.4?Math.abs(_.speedy):-1*_.speedy)}move_bounds(){let _=this,e=_ENEMIES;if(_.isalive())for(let t=0;t<e.length;t++){if(!ENEMY_p.prototype.isPrototypeOf(e[t]))continue;if(!e[t].isalive())continue;if(e[t].x>_CANVAS.width)continue;if(_.id===e[t].id)continue;_GAME.isSqCollision(_.shotColMap[0],_.x+","+_.y,e[t].shotColMap,e[t].x+","+e[t].y)!==_IS_SQ_NOTCOL&&(_.speedx=_.get_move_bound_val(),_.speedy=_.get_move_bound_val(),e[t].speedx=_.get_move_bound_val(),e[t].speedy=_.get_move_bound_val())}}showCollapes(){let _=this,e=_.getEnemyCenterPosition();if(_._status<=0&&!_._isbroken){for(let _=0;_<6;_++){let t=new ENEMY_p_small(_CANVAS_IMGS[["enemy_p_2","enemy_p_2","enemy_p_3","enemy_p_4","enemy_p_5","enemy_p_5"][_]].obj,e._x+[-30,0,30,-30,0,30][_],e._y+[-30,-30,-30,30,30,30][_]);_ENEMIES.push(t)}return _._isbroken=!0,_GAME._setPlay(_CANVAS_AUDIOS.enemy_collision4),void _.init()}}moveDraw(){var _;this.map_collition(),this.move_bounds(),this.x-=((_=this).x+_.img.width>_CANVAS.width&&(_.speedx=Math.abs(_.speedx)),_.speedx),this.y+=function(_){return _.y<0?_.speedy=Math.abs(_.speedy):_.y+_.img.height>_CANVAS.height&&(_.speedy=-1),_.speedy}(this),_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}}class ENEMY_p_small extends GameObject_ENEMY{constructor(_,e,t){super(_,e,t);this.audio_collision=_CANVAS_AUDIOS.enemy_collision5,this._status=5,this.getscore=500,this.speedx=this.get_move_bound_val(),this.speedy=this.get_move_bound_val(),this.col_date=new Date,this._collision_type="t1"}setAlive(){this.isalive()||(_SCORE.set(this.getscore),_GAME._setPlay(_CANVAS_AUDIOS.enemy_collision5))}move_bounds(){let _=this;if(new Date-_.col_date<1e3)return;let e=_ENEMIES;if(_.isalive())for(let t=0;t<e.length;t++){if(!ENEMY_p_small.prototype.isPrototypeOf(e[t]))continue;if(!e[t].isalive())continue;if(e[t].x>_CANVAS.width)continue;if(_.id===e[t].id)continue;_GAME.isSqCollision(_.shotColMap[0],_.x+","+_.y,e[t].shotColMap,e[t].x+","+e[t].y)!==_IS_SQ_NOTCOL&&(_.speedx=_.get_move_bound_val(),_.speedy=_.get_move_bound_val(),e[t].speedx=_.get_move_bound_val(),e[t].speedy=_.get_move_bound_val())}}map_collition(){let _=this,e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);(_MAP.isMapCollision(t,s-1)||_MAP.isMapCollision(t,s+1))&&(_.speedx=_.speedx<=0?Math.abs(_.speedx):-1*_.speedx,_.speedy=_.speedy<=0?Math.abs(_.speedy):-1*_.speedy)}moveDraw(){var _;this.map_collition(),this.move_bounds(),this.x-=((_=this).x+_.img.width>_CANVAS.width&&(_.speedx=1.5),_.speedx),this.y+=function(_){return _.y<0?_.speedy=Math.abs(_.speedy):_.y+_.img.height>_CANVAS.height&&(_.speedy=-1.5),_.speedy}(this),_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}}class ENEMY_q extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_m_a_1.obj,_,e);let s=this;s._status=2,s.direct=t||s._DEF_DIR._U,s.getscore=500,s._isSetMapDefCol=!1,s._isopen=!1,s._open_count=0,s.imgs=[_CANVAS_IMGS.enemy_m_a_1.obj,_CANVAS_IMGS.enemy_m_a_2.obj],s.audio_collision=_CANVAS_AUDIOS.enemy_collision5,s._collision_type="t8",s._collision_posy=s.direct===s._DEF_DIR._D?25:0,s._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,s.shotColMap=[s.direct===s._DEF_DIR._D?"0,50,35,85":s.direct===s._DEF_DIR._U?"0,25,35,50":s.direct===s._DEF_DIR._LD?"75,55,100,70":s.direct===s._DEF_DIR._LU?"75,35,100,50":void 0]}collision(_,e){this._isopen&&this.isCollision()&&this.setStatus(_,e)}isShot(){let _=this;return!(_._status<=0)&&(!_GAME.isEnemyCanvasOut(_)&&(!(Math.abs(_PLAYERS_MAIN.y-_.y)>100)&&(_.direct!==_._DEF_DIR._LU&&_.direct!==_._DEF_DIR._LD||!(_PLAYERS_MAIN.x<_.x))))}shot(){let _=this;!_._open_count>0&&!_.isShot()||_._open_count++,_._open_count>0&&(_.img=_.imgs[1],_._isopen=!0),_._open_count>200&&(_.img=_.imgs[0],_._isopen=!1,_._open_count=-100),_._open_count<=0||_._open_count%10==0&&_ENEMIES.push(new ENEMY_moai_ring({x:_.x+parseInt(_.shotColMap[0].split(",")[0]),y:_.y+parseInt(_.shotColMap[0].split(",")[1]),direct:_.direct}))}showCollapes(){let _=this;_.img=_CANVAS_IMGS.enemy_m_z.obj,_.setDrawImage(),_._isSetMapDefCol||(_MAP.set_mapdef_col(_MAP.getMapX(_.x),_MAP.getMapY(_.y),_.direct===_._DEF_DIR._D?"0000,0000,0000,1111":_.direct===_._DEF_DIR._U?"1111,0000,0000,0000":_.direct===_._DEF_DIR._LD?"0000,0000,0000,1111":_.direct===_._DEF_DIR._LU?"1111,0000,0000,0000":void 0),_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(_.x+_.img.width/2,_.y+_.img.height/2+_._collision_posy,_._collision_type)),_._isSetMapDefCol=!0)}moveDraw(){this.setDrawImage(),this.shot()}}class ENEMY_r extends ENEMY_q{constructor(_,e,t){super(_,e,t);let s=this;s._status=2,s.direct=t||s._DEF_DIR._U,s.imgs=[_CANVAS_IMGS.enemy_m_b_1.obj,_CANVAS_IMGS.enemy_m_b_2.obj],s.img=s.imgs[0],s._collision_posy=s.direct===s._DEF_DIR._D?-10:0,s.shotColMap=[s.direct===s._DEF_DIR._D?"20,40,50,85":s.direct===s._DEF_DIR._U?"20,25,50,70":void 0]}}class ENEMY_moai_ring extends GameObject_ENEMY{constructor(_){super(_CANVAS_IMGS.enemy_moai_ring.obj,_.x,_.y,[0,25],5,25,25);this._status=1,this.direct=_.direct||this._DEF_DIR._U,this.audio_collision=_CANVAS_AUDIOS.enemy_collision2,this.rad=_GAME.getRad(_PLAYERS_MAIN,{x:_.x,y:_.y}),this.sx=Math.cos(this.rad),this.sy=Math.sin(this.rad),this.speed=1.5*_MAPDEFS[_MAP_PETTERN]._speed,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,this._collision_type="t2",this.direct,this._DEF_DIR._D}isCanvasOut(){return _GAME.isEnemyCanvasOut(this,{up:!1,down:!1,left:!0,right:!0})}map_collition(){let _=this,e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);_MAP.isMapCollision(t,s)&&(_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(e._x,e._y,_._collision_type)),_.init())}moveDraw(){this.map_collition(),this.x+=this.sx*this.speed,this.y+=this.sy*this.speed,this.set_imgPos(),_GAME._setDrawImage({img:this.img,x:this.x,y:this.y,imgPosx:this.get_imgPos(),width:this.width,basePoint:1})}}class ENEMY_frame_1 extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_frame_1.obj,_,e);this._status=1,this.getscore=200,this.speed=-1*(3*Math.random()+3),this.rad=0,this.speedx=0,this.speedy=0,this._isbroken=!1,this._c=0,this.imgs=[_CANVAS_IMGS.enemy_frame_1.obj,_CANVAS_IMGS.enemy_frame_2.obj]}setAlive(){this.isalive()||_SCORE.set(this.getscore)}map_collition(){let _=this,e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);_MAP.isMapCollision(t,s)&&_.init()}showCollapes(){let _=this,e=_.getEnemyCenterPosition();if(_._status>0)return;if(_._isbroken)return;let t=0,s=_ENEMIES;for(let _=0;_<s.length;_++)ENEMY_frame_2.prototype.isPrototypeOf(s[_])&&t++;let i=t>20?1:2;for(let t=0;t<i;t++){let t=new ENEMY_frame_2(e._x,e._y,_.direct);_ENEMIES.push(t)}_._isbroken=!0,_GAME._setPlay(_CANVAS_AUDIOS.enemy_collision1),_.init()}move_standby(){this.x>=_CANVAS.width||(this.rad=Math.atan2(700*Math.random()-100-this.y,0-this.x),this.deg=this.rad/Math.PI*180,this.speedx=Math.cos(this.rad),this.speedy=Math.sin(this.rad),this._standby=!1)}moveDraw(){this.map_collition(),this.x-=this.speedx*this.speed,this.y-=this.speedy*this.speed,this._c=this._c>=5*this.imgs.length-1?0:this._c+1,this.img=this.imgs[parseInt(this._c/5)],_GAME._setDrawImage({img:this.img,x:this.x,y:this.y,deg:this.deg+180})}}class ENEMY_frame_2 extends ENEMY_frame_1{constructor(_,e,t){super(_,e,t);this._status=1,this.speed=-1*(4*Math.random()+4),this.deg=110*Math.random()+125,this.speedx=Math.cos(this.deg*Math.PI/180),this.speedy=Math.sin(this.deg*Math.PI/180),this.getscore=200,this._isbroken=!1,this.img=_CANVAS_IMGS.enemy_frame_3.obj,this.shotColMap=["0,0,"+this.img.width+","+this.img.height],this.imgs=[_CANVAS_IMGS.enemy_frame_3.obj,_CANVAS_IMGS.enemy_frame_4.obj],this._standby=!1}showCollapes(){let _=this,e=_.getEnemyCenterPosition();if(_._status>0)return;if(_._isbroken)return;let t=0,s=_ENEMIES;for(let _=0;_<s.length;_++)ENEMY_frame_3.prototype.isPrototypeOf(s[_])&&t++;let i=t>20?0:1;for(let t=0;t<i;t++){let t=new ENEMY_frame_3(e._x,e._y,_.direct);_ENEMIES.push(t)}_._isbroken=!0,_GAME._setPlay(_CANVAS_AUDIOS.enemy_collision1),_.init()}}class ENEMY_frame_3 extends ENEMY_frame_1{constructor(_,e,t){super(_,e,t);this._status=1,this.speed=-1*(4*Math.random()+4),this.deg=110*Math.random()+125,this.speedx=Math.cos(this.deg*Math.PI/180),this.speedy=Math.sin(this.deg*Math.PI/180),this.getscore=200,this._isbroken=!1,this.img=_CANVAS_IMGS.enemy_frame_5.obj,this.shotColMap=["0,0,"+this.img.width+","+this.img.height],this.is_able_collision=!1,this.is_ignore_collision=Math.random()>.05,this._standby=!1,this.imgs=[_CANVAS_IMGS.enemy_frame_5.obj,_CANVAS_IMGS.enemy_frame_6.obj]}}class ENEMY_cell_core extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_cell_core.obj,_,e);this._status=10,this.getscore=500,this.audio_alive=_CANVAS_AUDIOS.enemy_collision7,this._collision_type="t9",this.rad=0,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,this.ani=[{scale:1},{scale:.95},{scale:.9},{scale:.85},{scale:.9},{scale:.95}],this.hands_up_rad=[],this.hands_up=[],this.hands_down_rad=[],this.hands_down=[],this.hands_distance=12}set_hands_rad(_,e,t){let s=_PLAYERS_MAIN.getPlayerCenterPosition(),i=t.getEnemyCenterPosition(),a=parseInt(100*Math.random())-50,n=s._x+a-i._x,o=s._y+a-i._y,E=(_=>{let e=Math.random()/50;return(_=(_=t.flag?Math.cos(_)>0?t.rad+e:t.rad-e:Math.cos(_)>0?t.rad-e:t.rad+e)<0?2*Math.PI+_:_)>=t.rad_min&&_<=t.rad_max?_:t.rad})(Math.atan2(o,n));t.rad=E,_.unshift(E)}set_hands_pos(_,e,t,s,i){e.x=(s||0)+t.x+Math.cos(_)*this.hands_distance,e.y=(i||0)+t.y+Math.sin(_)*this.hands_distance}is_hands_up_status(){let _=this;for(let e=0;e<_.hands_up.length;e++)if(ENEMY_cell_hand_2.prototype.isPrototypeOf(_.hands_up[e]))return _.hands_up[e].isalive()}is_hands_down_status(){let _=this;for(let e=0;e<_.hands_down.length;e++)if(ENEMY_cell_hand_2.prototype.isPrototypeOf(_.hands_down[e]))return _.hands_down[e].isalive()}showCollapes(){let _=this,e=_.getEnemyCenterPosition();_._isshow=!1;for(let e=0;e<_.hands_up.length;e++)_.hands_up[e].showCollapes();for(let e=0;e<_.hands_down.length;e++)_.hands_down[e].showCollapes();_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(e._x,e._y,_._collision_type)),_GAME._setPlay(_.audio_collision)}move_standby(){let _=this;if(_.x<_CANVAS.width-20){_._standby=!1,_.hands_up=[new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:3*Math.PI/2,rad_min:Math.PI+1.5,rad_max:Math.PI+2,flag:!0,ignore_collision:!1}),new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:3*Math.PI/2-.2,rad_min:Math.PI+1,rad_max:Math.PI+2.2,flag:!0,ignore_collision:!1}),new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:3*Math.PI/2-.4,rad_min:Math.PI+.7,rad_max:Math.PI+2.4,flag:!0,ignore_collision:!1}),new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:3*Math.PI/2-.4,rad_min:Math.PI+.7,rad_max:Math.PI+2.4,flag:!0,ignore_collision:!1}),new ENEMY_cell_hand_2({x:_.x,y:_.y,rad:3*Math.PI/2-.6,rad_min:Math.PI+.5,rad_max:Math.PI+2.6,flag:!0}),new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:3*Math.PI/2-.8,rad_min:Math.PI+.5,rad_max:Math.PI+2.8,flag:!0}),new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:3*Math.PI/2-1,rad_min:Math.PI+.3,rad_max:Math.PI+2.8,flag:!0}),new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:3*Math.PI/2-1.2,rad_min:Math.PI+.3,rad_max:Math.PI+2.8,flag:!0}),new ENEMY_cell_hand_3({x:_.x,y:_.y,rad:3*Math.PI/2-1.4,rad_min:Math.PI+.3,rad_max:Math.PI+2.6,flag:!0})];for(let e=0;e<_.hands_up.length;e++)_ENEMIES.push(_.hands_up[e]);_.hands_down=[new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:Math.PI-1,rad_min:Math.PI-2,rad_max:Math.PI-1,flag:!1,ignore_collision:!1}),new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:Math.PI-1,rad_min:Math.PI-2.1,rad_max:Math.PI-.9,flag:!1,ignore_collision:!1}),new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:Math.PI-.9,rad_min:Math.PI-2.2,rad_max:Math.PI-.9,flag:!1,ignore_collision:!1}),new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:Math.PI-.9,rad_min:Math.PI-2.3,rad_max:Math.PI-.6,flag:!1,ignore_collision:!1}),new ENEMY_cell_hand_2({x:_.x,y:_.y,rad:Math.PI-.9,rad_min:Math.PI-2.7,rad_max:Math.PI-.6,flag:!1}),new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:Math.PI-.8,rad_min:Math.PI-2.7,rad_max:Math.PI-.6,flag:!1}),new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:Math.PI-.8,rad_min:Math.PI-2.8,rad_max:Math.PI-.1,flag:!1}),new ENEMY_cell_hand_1({x:_.x,y:_.y,rad:Math.PI-.7,rad_min:Math.PI-2.8,rad_max:Math.PI-.1,flag:!1}),new ENEMY_cell_hand_3({x:_.x,y:_.y,rad:Math.PI-.7,rad_min:Math.PI-2.8,rad_max:Math.PI-.1,flag:!1})];for(let e=0;e<_.hands_down.length;e++)_ENEMIES.push(_.hands_down[e])}}moveDraw(){let _=this;_._c=_._c>=20*_.ani.length-1?0:_._c+1;let e=parseInt(_._c/20);const t=_.getEnemyCenterPosition(),s=_PLAYERS_MAIN.getPlayerCenterPosition();let i=_GAME.getRad({x:s._x,y:s._y},{x:t._x,y:t._y});if(_.y+=Math.sin(i)*_.speed,!_.is_hands_up_status()&&0!==_.hands_up.length){for(let e=0;e<_.hands_up.length;e++)_.hands_up[e].showCollapes();_.hands_up=[]}if(!_.is_hands_down_status()&&0!==_.hands_down.length){for(let e=0;e<_.hands_down.length;e++)_.hands_down[e].showCollapes();_.hands_down=[]}_.hands_up_rad=[];for(let e=_.hands_up.length-1;e>=0;e--){if(void 0===_.hands_up[e-1]){_.set_hands_rad(_.hands_up_rad,_,_.hands_up[e]);break}_.set_hands_rad(_.hands_up_rad,_.hands_up[e-1],_.hands_up[e])}for(let e=0;e<_.hands_up.length;e++)0!==e?(_.set_hands_pos(_.hands_up_rad[e],_.hands_up[e],_.hands_up[e-1]),_.hands_up[e].moveDraw()):(_.set_hands_pos(_.hands_up_rad[e],_.hands_up[e],_,_.img.width/2-_.hands_up[e].img.width/2,10),_.hands_up[e].moveDraw());_.hands_down_rad=[];for(let e=_.hands_down.length-1;e>=0;e--){if(void 0===_.hands_down[e-1]){_.set_hands_rad(_.hands_down_rad,_,_.hands_down[e]);break}_.set_hands_rad(_.hands_down_rad,_.hands_down[e-1],_.hands_down[e])}for(let e=0;e<_.hands_down.length;e++)0!==e?(_.set_hands_pos(_.hands_down_rad[e],_.hands_down[e],_.hands_down[e-1]),_.hands_down[e].moveDraw()):(_.set_hands_pos(_.hands_down_rad[e],_.hands_down[e],_,_.img.width/2-_.hands_down[e].img.width/2,_.img.height-30),_.hands_down[e].moveDraw());_GAME._setDrawImage({img:_.img,x:t._x,y:t._y,scale:_.ani[e].scale*(_._status/10>.7?_._status/10:.7)});let a=_.img.width/2-_.img.width*_.ani[e].scale/2+","+(_.img.height/2-_.img.height*_.ani[e].scale/2)+","+_.img.width*_.ani[e].scale+","+_.img.height*_.ani[e].scale;_.shotColMap=[a]}}class ENEMY_cell_hand_1 extends GameObject_ENEMY{constructor(_){super(_CANVAS_IMGS.enemy_cell_hand_1.obj,_.x,_.y);this._initx=_.x||0,this._inity=_.y||0,this.rad=_.rad,this.rad_min=_.rad_min||-1,this.rad_max=_.rad_max||-2,this.flag=_.flag||!1,this.is_able_collision=!1,this._collision_type="t2",this.is_ignore_collision=_.ignore_collision||!0,this.ani=[{scale:1},{scale:.95},{scale:.9},{scale:.85},{scale:.9},{scale:.95}],this._c=0}showCollapes(){let _=this.getEnemyCenterPosition();_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(_._x,_._y,this._collision_type)),this.init()}shot(){}moveDraw(){this._c=this._c>=20*this.ani.length-1?0:this._c+1;let _=parseInt(this._c/20);const e=this.getEnemyCenterPosition();_GAME._setDrawImage({img:this.img,x:e._x,y:e._y,scale:this.ani[_].scale}),this.shot()}move(){this.x=_MAP.getX(this.x),this.y=_MAP.getY(this.y),this.isMove()}}class ENEMY_cell_hand_2 extends ENEMY_cell_hand_1{constructor(_){super(_);this.img=_CANVAS_IMGS.enemy_cell_hand_2.obj,this.is_able_collision=!0,this.audio_alive=_CANVAS_AUDIOS.enemy_collision7,this._status=10,this.is_ignore_collision=!1,this.shotColMap=["-10,-10,"+(this.img.width+10)+","+(this.img.height+10)]}shot(){}}class ENEMY_cell_hand_3 extends ENEMY_cell_hand_1{constructor(_){super(_);this.img=_CANVAS_IMGS.enemy_cell_hand_3.obj}shot(){_GAME.isEnemyCanvasOut(this)||Math.random()>=_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SHOT_RATE||_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT({x:this.getEnemyCenterPosition()._x,y:this.getEnemyCenterPosition()._y,img:_CANVAS_IMGS.enemy_bullet_cell.obj,imgPos:[0,15]}))}moveDraw(){let _=_PLAYERS_MAIN.getPlayerCenterPosition(),e=this.getEnemyCenterPosition(),t=Math.atan2(e._y-_._y,e._x-_._x);_GAME._setDrawImage({img:this.img,x:e._x,y:e._y,deg:t/Math.PI*180}),this.shot()}}class ENEMY_CELL_A extends ENEMY_a{constructor(_,e,t){super(_,e,t);this.direct=t||this._DEF_DIR._U,this.haspc=!1,this.defimg=[_CANVAS_IMGS.enemy_cell_a_1.obj,_CANVAS_IMGS.enemy_cell_a_2.obj]}}class ENEMY_CELL_B extends ENEMY_a{constructor(_,e,t){super(_,e,t);this.direct=t||this._DEF_DIR._U,this.haspc=!0,this.defimg=[_CANVAS_IMGS.enemy_cell_b_1.obj,_CANVAS_IMGS.enemy_cell_b_2.obj]}}class GameObject_ENEMY_BOSS extends GameObject_ENEMY{constructor(_,e,t){super(_,e,t);this.speed=0,this.getscore=1e4,this._c=0,this._c_self_collision=4e3,this.audio_collision=_CANVAS_AUDIOS.enemy_collision6,this.is_able_collision=!1,this.is_all_set=!1}init(){this._isshow=!1,this._status=0}shot(){}move_init(){}setSelfCollision(){if(!(this._c<this._c_self_collision)){for(let _=0;_<_ENEMIES.length;_++)_ENEMIES[_]._status=0;_GAME._setPlay(this.audio_collision)}}setWallCollision(){let _=this;if(void 0!==_.wall)for(let e=0;e<_.wall.length;e++){let t=_.wall[e];if(!t.isalive)continue;_.getEnemyCenterPosition();_CONTEXT.drawImage(t.img,_.x+t.x,_.y+t.y,t.img.width,t.img.height),t.cs>=_._status&&(_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(_.x+t.x,_.y+t.y)),_SCORE.set(500),_GAME._setPlay(_CANVAS_AUDIOS.enemy_collision5),t.isalive=!1)}}moveDraw(){_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}move_Allset(){}isAllset(){let _=this;return _.is_all_set?(_.set_wall_standBy(),!0):(_.move_Allset(),!1)}isMove(){let _=this;return _.isStandBy()?(_.move_standby(),!1):!!_.isshow()&&(!!_.isalive()||(_.showCollapes(),!1))}move_before(){return!1}move(){}}class ENEMY_BOSS_WALL extends GameObject_ENEMY{constructor(_,e,t,s){super(_,t,s);this._initx=t||0,this._inity=s||0,this._boss=e,this.x=this._boss.x+this._initx,this.y=this._boss.y+this._inity,this._status=10,this.getscore=500,this._standby=!0,this.is_able_collision=!1,this.audio_collision=_CANVAS_AUDIOS.enemy_collision5,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5}setStandByDone(){this._standby=!1}moveDraw(){if(!this.isalive())return;let _=void 0===this._boss?0:this._boss.x,e=void 0===this._boss?0:this._boss.y;this.x=_+parseInt(this._initx),this.y=e+parseInt(this._inity),this.setDrawImage()}move(){}}class ENEMY_BOSS_BIGCORE extends GameObject_ENEMY_BOSS{constructor(_,e){super(_CANVAS_IMGS.enemy_bigcore.obj,_,e);let t=this;t._status=1,t.speed=3,t.is_able_collision=!1,t.wall=[new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore_1.obj,t,15,50),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore_1.obj,t,25,50),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore_1.obj,t,35,50),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore_2.obj,t,45,53),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore_3.obj,t,70,43)],t._wall_statuses="";for(let _=0;_<t.wall.length;_++)_ENEMIES.push(t.wall[_]);t.c_z4_ani=30,t.z4_ani=[{img:_CANVAS_IMGS.enemy_bigcore_4_1.obj,al:1},{img:_CANVAS_IMGS.enemy_bigcore_4_2.obj,al:.8},{img:_CANVAS_IMGS.enemy_bigcore_4_3.obj,al:.6},{img:_CANVAS_IMGS.enemy_bigcore_4_4.obj,al:.4},{img:_CANVAS_IMGS.enemy_bigcore_4_5.obj,al:.2}],t.tid=null,t._moveYStop=!1,t.shotColMap=["120,0,169,40,false","120,70,169,114,false"],t._collision_type="t9"}set_wall_standBy(){let _=this;for(let e=0;e<_.wall.length;e++)_.wall[e].setStandByDone()}set_wall_status(){let _=this;_._wall_statuses="";for(let e=0;e<_.wall.length;e++)_._wall_statuses+=_.wall[e].isalive()?1:0}show_walls(_){let e=this;for(let t=0;t<_.length;t++)(void 0===_[t-1]||_[t-1]._status<=0)&&(_[t].is_able_collision=!0),_[t].moveDraw(e)}shot(){let _=this;Math.random()>.02||(_._moveYStop=!0,_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x,y:_.y,img:_CANVAS_IMGS.enemy_bullet_z.obj})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x,y:_.y+35,img:_CANVAS_IMGS.enemy_bullet_z.obj})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x,y:_.y+70,img:_CANVAS_IMGS.enemy_bullet_z.obj})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x,y:_.y+105,img:_CANVAS_IMGS.enemy_bullet_z.obj})),_GAME._setPlay(_CANVAS_AUDIOS.enemy_bullet_laser),_.tid=setTimeout(function(){_._moveYStop=!1,clearTimeout(_.tid)},100))}move_Allset(){let _=this;_.x-=4,_.moveDraw(),_.set_wall_status(),_.show_walls(_.wall),_.x<_CANVAS.width-_.img.width-80&&(_.is_all_set=!0)}move_before(){return!1}move_standby(){let _=this;_.move_before()||(_.x-=4,_.x<_CANVAS.width&&(_._standby=!1))}move(){let _=this;if(_.isMove()&&_.isAllset()){if(_.y+=_._moveYStop?0:_.speed,_.speed=_.y<50||_.y+_.img.height>450?-1*_.speed:_.speed,_.shot(),_.moveDraw(),_.set_wall_status(),_.show_walls(_.wall),-1===_._wall_statuses.indexOf("1")&&(_._status=0,_.setAlive()),_._c>=3e3){let e=_.getEnemyCenterPosition();_.is_able_collision=!1,_.c_z4_ani=_.c_z4_ani>0?_.c_z4_ani-1:0;let t=_.z4_ani[parseInt(_.c_z4_ani/6)].img;_CONTEXT.drawImage(t,e._x-t.width/2,e._y-t.height/2,t.width,t.height)}_.setSelfCollision(),_._c++}}}class ENEMY_BOSS_BIGCORE2 extends GameObject_ENEMY_BOSS{constructor(_,e){super(_CANVAS_IMGS.enemy_bigcore2.obj,_,e);let t=this;t._status=1,t.speed=2,t.is_able_collision=!1,t.img=_CANVAS_IMGS.enemy_bigcore2.obj,t.wall_up=[new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,t,90,38),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,t,95,38),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,t,100,38),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,t,105,38),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_core.obj,t,110,36)],t.wall_down=[new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,t,90,95),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,t,95,95),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,t,100,95),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_wall.obj,t,105,95),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore2_core.obj,t,110,93)],t._wall_up_statuses="",t._wall_down_statuses="",t.back=[0,85,170,255,340,425],t.back_img_up={x:200,y:-50,st:0,flag:!0,s1:function(){this.st>=15&&(this.flag=!1),this.st<=6&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},s2:function(){this.st>=6&&(this.flag=!1),this.st<=0&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},f:function(){let _=_CANVAS_IMGS.enemy_bigcore2_back.obj,e=(_.height,_.height);_CONTEXT.drawImage(_,85*parseInt(this.st/3),0,85,e,t.x+this.x,t.y+this.y,85,e)}},t.back_img_down={x:200,y:-120,st:0,flag:!0,s1:function(){this.st>=15&&(this.flag=!1),this.st<=6&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},s2:function(){this.st>=6&&(this.flag=!1),this.st<=0&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},f:function(){let _=_CANVAS_IMGS.enemy_bigcore2_back.obj,e=(_.height,_.height);_CONTEXT.save(),_CONTEXT.setTransform(1,0,0,-1,0,2*t.y+_.height),_CONTEXT.drawImage(_,85*parseInt(this.st/3),0,85,e,t.x+this.x,t.y+this.y,85,e),_CONTEXT.restore()}},t.c_z4_ani=30,t.z4_ani=[{img:_CANVAS_IMGS.enemy_bigcore_4_1.obj,al:1},{img:_CANVAS_IMGS.enemy_bigcore_4_2.obj,al:.8},{img:_CANVAS_IMGS.enemy_bigcore_4_3.obj,al:.6},{img:_CANVAS_IMGS.enemy_bigcore_4_4.obj,al:.4},{img:_CANVAS_IMGS.enemy_bigcore_4_5.obj,al:.2}],t.tid=null,t._moveYStop=!1,t.shotColMap=["130,0,240,156,false"],t._collision_type="t9";for(let _=0;_<t.wall_up.length;_++)_ENEMIES.push(t.wall_up[_]);for(let _=0;_<t.wall_down.length;_++)_ENEMIES.push(t.wall_down[_]);t.hands_up=[new ENEMY_BOSS_BIGCORE2_HANDS({_initx:-52,_inity:-30,_dir:t._DEF_DIR._U,_boss:t})],_ENEMIES.push(t.hands_up[0]),t.hands_down=[new ENEMY_BOSS_BIGCORE2_HANDS({_initx:-52,_inity:75,_dir:t._DEF_DIR._D,_boss:t})],_ENEMIES.push(t.hands_down[0]),t._hands_open_flag=!1}init(){this._isshow=!1,this._status=0}set_wall_standBy(){let _=this;for(let e=0;e<_.wall_up.length;e++)_.wall_up[e].setStandByDone();for(let e=0;e<_.wall_down.length;e++)_.wall_down[e].setStandByDone()}set_wall_status(){let _=this;_._wall_up_statuses="",_._wall_down_statuses="";for(let e=0;e<_.wall_up.length;e++)_._wall_up_statuses+=_.wall_up[e].isalive()?1:0;for(let e=0;e<_.wall_down.length;e++)_._wall_down_statuses+=_.wall_down[e].isalive()?1:0}shot(){let _=this,e=_.getEnemyCenterPosition(),t=_PLAYERS_MAIN.getPlayerCenterPosition();if(_._c%150==0&&(_._moveYStop=!1),_._c%150>50&&_._c%150<99&&(_._moveYStop=!0),_._c%150==51&&(_._hands_open_flag=Math.abs(t._y-e._y)<100,_._hands_open_flag)){for(let e=_.hands_up.length-1;e>=0;e--)_.hands_up[e].isHandsOpen=!0;for(let e=_.hands_down.length-1;e>=0;e--)_.hands_down[e].isHandsOpen=!0}if(_._c%150==70&&(_._hands_open_flag?(-1!==_._wall_up_statuses.indexOf("1")&&(_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+85,y:_.y-75})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+70,y:_.y-45})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+120,y:_.y-20})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+100,y:_.y+0})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+80,y:_.y+25})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+60,y:_.y+45})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x,y:_.y+55}))),-1!==_._wall_down_statuses.indexOf("1")&&(_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x,y:_.y+85})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+60,y:_.y+95})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+80,y:_.y+115})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+100,y:_.y+135})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+120,y:_.y+160})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+70,y:_.y+170})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+85,y:_.y+200})))):(-1!==_._wall_up_statuses.indexOf("1")&&(_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+60,y:_.y+20})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x,y:_.y+55}))),-1!==_._wall_down_statuses.indexOf("1")&&(_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x,y:_.y+95})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x+60,y:_.y+130})))),_GAME._setPlay(_CANVAS_AUDIOS.enemy_bullet_laser)),_._c%150==110){for(let e=_.hands_up.length-1;e>=0;e--)_.hands_up[e].isHandsClose=!0;for(let e=_.hands_down.length-1;e>=0;e--)_.hands_down[e].isHandsClose=!0}}move_Allset(){let _=this;_.x-=4,_.moveDraw(),_.back_img_up.s2(),_.back_img_up.f(),_.back_img_down.s2(),_.back_img_down.f();for(let e=0;e<_.wall_up.length;e++)_.wall_up[e].moveDraw(_);for(let e=0;e<_.wall_down.length;e++)_.wall_down[e].moveDraw(_);for(let e=_.hands_up.length-1;e>=0;e--)_.hands_up[e].moveDraw(_);for(let e=_.hands_down.length-1;e>=0;e--)_.hands_down[e].moveDraw(_);_.x<_CANVAS.width-_.img.width-80&&(_.is_all_set=!0)}move_standby(){let _=this;_.move_before()||(_.x-=4,_.x<_CANVAS.width&&(_._standby=!1))}move(){let _=this;if(_.isMove()&&_.isAllset()){_.y+=_._moveYStop?0:_.speed,_.speed=_.y<50||_.y+_.img.height>450?-1*_.speed:_.speed,_.shot(),_.moveDraw(),_.speed>0&&!_._moveYStop?_.back_img_up.s1():_.back_img_up.s2(),_.back_img_up.f(),_.speed<0&&!_._moveYStop?_.back_img_down.s1():_.back_img_down.s2(),_.back_img_down.f(),_.set_wall_status();for(let e=0;e<_.wall_up.length;e++)(void 0===_.wall_up[e-1]||_.wall_up[e-1]._status<=0)&&(_.wall_up[e].is_able_collision=!0),_.wall_up[e].moveDraw(_);for(let e=0;e<_.wall_down.length;e++)(void 0===_.wall_down[e-1]||_.wall_down[e-1]._status<=0)&&(_.wall_down[e].is_able_collision=!0),_.wall_down[e].moveDraw(_);for(let e=_.hands_up.length-1;e>=0;e--)-1!==_._wall_up_statuses.indexOf("1")||_.hands_up[e].is_hand_stop()||(_GAME._setPlay(_.audio_collision),_.hands_up[e].set_hand_stop()),_.hands_up[e].moveDraw(_);for(let e=_.hands_down.length-1;e>=0;e--)-1!==_._wall_down_statuses.indexOf("1")||_.hands_down[e].is_hand_stop()||(_GAME._setPlay(_.audio_collision),_.hands_down[e].set_hand_stop()),_.hands_down[e].moveDraw(_);if(-1===_._wall_up_statuses.indexOf("1")&&-1===_._wall_down_statuses.indexOf("1")){for(let e=_.hands_up.length-1;e>=0;e--)_.hands_up[e]._status=0;for(let e=_.hands_down.length-1;e>=0;e--)_.hands_down[e]._status=0;_._status=0,_.setAlive()}_.setSelfCollision(),_._c++}}}class ENEMY_BOSS_BIGCORE2_HANDS extends GameObject_ENEMY{constructor(_){super(_CANVAS_IMGS.enemy_bigcore2_hand.obj,_._initx,_._inity);let e=this;e._initx=_._initx||0,e._inity=_._inity||0,e.x=e._initx+_._boss.x,e.y=e._inity+_._boss.y,e._standby=!1,e.is_able_collision=!1,e.isshot=void 0!==_._img,e.isHandsOpen=!1,e.isHandsClose=!1,e.isstop=!1,e._boss=new Object,e.direct=_._dir||e._DEF_DIR._U,e.shotColMap=[e.direct===e._DEF_DIR._U?"0,30,250,100,false":e.direct===e._DEF_DIR._D?"0,30,250,100,false":void 0],e.shotColMapTmp=e.direct===e._DEF_DIR._U?[["90,30,250,70,false","25,70,250,100,false"],["180,30,250,90,false"],["50,10,225,20,false"]]:e.direct===e._DEF_DIR._D?[["25,30,250,70,false","90,70,250,100,false"],["180,20,250,60,false"],["50,90,225,100,false"]]:void 0,e.imgs=[0,250,500],e.imgsPos=[{x:0,y:(e.direct,e._DEF_DIR._U,0)},{x:0,y:e.direct===e._DEF_DIR._U?-40:40},{x:-5,y:e.direct===e._DEF_DIR._U?-30:30}],e.imgs_x=0,e.imgs_y=0,e._c=0}init(){this._isshow=!1,this._status=0}collision(_,e){}setStatus(){this._status=0}is_hand_stop(){return this.isstop}set_hand_stop(){this.isstop=!0}move_hands_open(){let _=this;if(!_.isHandsOpen)return;if(_.isstop)return;let e=_.imgsPos[parseInt(_._c/6)];_.imgs_x=parseInt(e.x),_.imgs_y=parseInt(e.y),_.shotColMap=[];let t=_.shotColMapTmp[parseInt(_._c/6)];for(let e=0;e<t.length;e++)_.shotColMap.push(t[e]);if(_._c>=6*_.imgs.length-1)return _._c=6*_.imgs.length-1,void(_.isHandsOpen=!1);_._c++}move_hands_close(){let _=this;if(!_.isHandsClose)return;if(_.isstop)return;let e=_.imgsPos[parseInt(_._c/6)];_.imgs_x=parseInt(e.x),_.imgs_y=parseInt(e.y),_.shotColMap=[];let t=_.shotColMapTmp[parseInt(_._c/6)];for(let e=0;e<t.length;e++)_.shotColMap.push(t[e]);if(_._c<=0)return _._c=0,void(_.isHandsClose=!1);_._c--}moveDraw(_){this._boss=_,this.move_hands_open(),this.move_hands_close(),this.x=this._boss.x+parseInt(this._initx)+this.imgs_x,this.y=this._boss.y+parseInt(this._inity)+this.imgs_y,this.setDrawImage(250,110,250,this.imgs[parseInt(this._c/6)])}move(){}}class ENEMY_BOSS_CRYSTALCORE extends GameObject_ENEMY_BOSS{constructor(_,e){super(_CANVAS_IMGS.enemy_cristalcore.obj,_,e);let t=this;t._status=70,t.speed=3,t.wall=[new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_cristalcore_wall1.obj,t,47,116),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_cristalcore_wall2.obj,t,62,116),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_cristalcore_wall2.obj,t,77,116),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_cristalcore_wall2.obj,t,92,116),new ENEMY_BOSS_WALL(_CANVAS_IMGS.enemy_bigcore_3.obj,t,102,115)],t._wall_statuses="",t.c_z4_ani=30,t.z4_ani=[{img:_CANVAS_IMGS.enemy_bigcore_4_1.obj,al:1},{img:_CANVAS_IMGS.enemy_bigcore_4_2.obj,al:.8},{img:_CANVAS_IMGS.enemy_bigcore_4_3.obj,al:.6},{img:_CANVAS_IMGS.enemy_bigcore_4_4.obj,al:.4},{img:_CANVAS_IMGS.enemy_bigcore_4_5.obj,al:.2}],t._collision_type="t9",t.is_able_collision=!1,t._shot_count=0,t.shotColMap=["25,0,227,10,false","25,242,227,250,false","160,0,227,250,false"];for(let _=0;_<t.wall.length;_++)_ENEMIES.push(t.wall[_]);t.hands_up=[new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_ignore_collision:!0,_initx:50,_inity:80,_cmr:60,_cmsr:70,_initRad:40,_data:"0,0,180,10",_change:!0}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_ignore_collision:!0,_initx:50,_inity:80,_cmr:70,_cmsr:80,_initRad:70,_data:"0,0,185,5",_change:!0}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_initx:50,_inity:80,_cmr:80,_cmsr:100,_initRad:100,_data:"0,0,180,-10",_change:!0}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_initx:50,_inity:80,_cmr:89,_cmsr:125,_initRad:130,_data:"0,0,175,-25",_change:!0}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_initx:50,_inity:80,_cmr:97,_cmsr:145,_initRad:160,_data:"0,0,170,-40",_change:!0}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_initx:50,_inity:80,_cmr:106,_cmsr:160,_initRad:190,_data:"0,0,165,-55",_change:!0}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_img:_CANVAS_IMGS.enemy_cristalcore_hand2.obj,_initx:50,_inity:80,_cmr:115,_cmsr:170,_initRad:215,_data:"0,0,160,-70",_change:!0})];for(let _=0;_<t.hands_up.length;_++)_ENEMIES.push(t.hands_up[_]);t.hands_down=[new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_ignore_collision:!0,_initx:50,_inity:155,_cmr:60,_cmsr:70,_initRad:40,_data:"0,0,180,-10",_change:!1}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_ignore_collision:!0,_initx:50,_inity:155,_cmr:70,_cmsr:80,_initRad:70,_data:"0,0,175,-5",_change:!1}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_initx:50,_inity:155,_cmr:80,_cmsr:100,_initRad:100,_data:"0,0,180,10",_change:!1}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_initx:50,_inity:155,_cmr:89,_cmsr:125,_initRad:130,_data:"0,0,185,25",_change:!1}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_initx:50,_inity:155,_cmr:97,_cmsr:145,_initRad:160,_data:"0,0,190,40",_change:!1}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_initx:50,_inity:155,_cmr:106,_cmsr:160,_initRad:190,_data:"0,0,195,55",_change:!1}),new ENEMY_BOSS_CRYSTALCORE_HANDS({_boss:t,_img:_CANVAS_IMGS.enemy_cristalcore_hand2.obj,_initx:50,_inity:155,_cmr:115,_cmsr:170,_initRad:215,_data:"0,0,200,70",_change:!1})];for(let _=0;_<t.hands_down.length;_++)_ENEMIES.push(t.hands_down[_])}init(){}setDrawImageDirect(){}set_wall_standBy(){let _=this;for(let e=0;e<_.wall.length;e++)_.wall[e].setStandByDone()}set_wall_status(){let _=this;_._wall_statuses="";for(let e=0;e<_.wall.length;e++)_._wall_statuses+=_.wall[e].isalive()?1:0}show_walls(_){let e=this;for(let t=0;t<_.length;t++)(void 0===_[t-1]||_[t-1]._status<=0)&&(_[t].is_able_collision=!0),_[t].moveDraw(e)}shot(){let _=this;if(_._shot_count++,_._c%1200>800){if(_._shot_count<10)return}else if(_._c%1200<=800&&_._shot_count<50)return;_._shot_count=0,_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x,y:_.y+111})),_ENEMIES_SHOTS.push(new ENEMY_SHOT_LASER({x:_.x,y:_.y+140})),_GAME._setPlay(_CANVAS_AUDIOS.enemy_bullet_laser)}showCollapes(){let _=this;_._isshow=!1;for(let e=_.hands_up.length-1;e>=0;e--)_.hands_up[e].showCollapes(_.hands_up[e].x,_.hands_up[e].y),_.hands_up[e].init();for(let e=_.hands_down.length-1;e>=0;e--)_.hands_down[e].showCollapes(_.hands_down[e].x,_.hands_down[e].y),_.hands_down[e].init();_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(_.x+_.img.width/2,_.y+_.img.height/2,_._collision_type))}isAllset(){let _=this;return _.is_all_set?(_.set_wall_standBy(),!0):(_.move_Allset(),!1)}move_Allset(){let _=this;_.y-=4;for(let e=_.hands_up.length-1;e>=0;e--)_.hands_up[e].moveDraw(_);for(let e=_.hands_down.length-1;e>=0;e--)_.hands_down[e].moveDraw(_);_.moveDraw(),_.set_wall_status(),_.show_walls(_.wall),_.y<200&&(_.is_all_set=!0)}move_standby(){let _=this;_.move_before()||(_.y-=4,_.y<_CANVAS.height&&(_._standby=!1))}move(){let _=this;if(_.isMove()&&_.isAllset()){_.y+=_.speed,_._c%1200>800&&_._c%45==0&&(_.speed*=-1),(_.y+_.img.height>_CANVAS.height||_.y<0)&&(_.speed*=-1);for(let e=_.hands_up.length-1;e>=0;e--)_.hands_up[e].moveDraw(_);for(let e=_.hands_down.length-1;e>=0;e--)_.hands_down[e].moveDraw(_);if(_.shot(),_.moveDraw(),_.set_wall_status(),_.show_walls(_.wall),-1===_._wall_statuses.indexOf("1")){for(let e=_.hands_up.length-1;e>=0;e--)_.hands_up[e]._status=0;for(let e=_.hands_down.length-1;e>=0;e--)_.hands_down[e]._status=0;_._status=0,_.setAlive()}_.setSelfCollision(),_._c++}}}class ENEMY_BOSS_CRYSTALCORE_HANDS extends GameObject_ENEMY{constructor(_){super(_CANVAS_IMGS.enemy_cristalcore_hand1.obj,_._initx,_._inity);this._initx=_._initx||0,this._inity=_._inity||0,this._boss=_._boss,this._c_move_round=_._cmr||0,this._c_move_self_round=_._cmsr||0,this._initRad=_._initRad||0,this._data=_._data||"0,0,0,0",this.img=_._img||_CANVAS_IMGS.enemy_cristalcore_hand1.obj,this._count_turn=0,this._change=_._change,this._standby=!0,this._standby_tmp=_._standby||!1,this.is_able_collision=!1,this.is_ignore_collision=_._ignore_collision||!1,this.isshot=void 0!==_._img,this._shot_count=0,this._collision_type="t1",this._c=0;let e=this._data.split(","),t=parseInt(e[2])+(this._change?1:-1),s=this._initRad*Math.cos(t*(Math.PI/180)),i=this._initRad*Math.sin(t*(Math.PI/180)),a=parseInt(e[3])+(this._change?1:-1);this._data=s+","+i+","+t+","+a}collision(_,e){}setStatus(){this._status=0}shot(){if(!1===this.isshot)return;if(this._shot_count++,this._shot_count<20)return;this._shot_count=0;let _=this._data.split(",");_ENEMIES_SHOTS.push(new ENEMY_SHOT_CRYSTALCORE({x:this.x,y:this.y,deg:parseInt(_[3])}))}move_hands(){let _=this;if(_._count_turn>=4)return void(_._c>400&&(_._c=0,_._count_turn=0));_._c>200&&(_._c=0,_._count_turn++,_._change=!_._change);let e=_._data.split(","),t=_._c_move_round,s=_._c_move_self_round;if(_._c>s)return;if(_._c<=s&&_._c>t){let t=parseInt(e[3])+(_._change?1:-1);return void(_._data=e[0]+","+e[1]+","+e[2]+","+t)}let i=parseInt(e[2])+(_._change?1:-1),a=_._initRad*Math.cos(i*(Math.PI/180)),n=_._initRad*Math.sin(i*(Math.PI/180)),o=parseInt(e[3])+(_._change?1:-1);_._data=a+","+n+","+i+","+o}moveDraw(_){let e=this._data.split(","),t=this._initx,s=this._inity,i=parseInt(e[3])*Math.PI/180,a=this._boss.x+parseInt(e[0])+t+this.img.width,n=this._boss.y+parseInt(e[1])+s+parseInt(this.img.height/1.5);_CONTEXT.save(),_CONTEXT.setTransform(Math.cos(i),Math.sin(i),-Math.sin(i),Math.cos(i),a-a*Math.cos(i)+n*Math.sin(i),n-a*Math.sin(i)-n*Math.cos(i)),_CONTEXT.drawImage(this.img,this._boss.x+parseInt(e[0])+t,this._boss.y+parseInt(e[1])+s,this.img.width,this.img.height),_CONTEXT.restore(),this.x=this._boss.x+parseInt(e[0])+t,this.y=this._boss.y+parseInt(e[1])+s,_.is_all_set&&(this.shot(),this.move_hands(),this._standby=!1,this._c++)}move(){}}class ENEMY_BOSS_CRYSTALCORE_PT2 extends ENEMY_BOSS_CRYSTALCORE{constructor(_,e){super(_,e);this._c=0,this._showout_cube=0,this._standby_count=0,this._complete_cube_count=0,this._map_col_reset=!1,this._cube_shot_max=100}move_before(){let _=this,e="";if(function(){let t=_ENEMIES;for(let s=0;s<t.length;s++)ENEMY_BOSS_CUBE.prototype.isPrototypeOf(t[s])&&(t[s].alpha=_.alpha,e+=!0===t[s]._stop?"1":"0")}(_.alpha),-1!==e.indexOf("0")&&(_._complete_cube_count=_._standby_count),_._standby_count%40==0&&_._showout_cube<_._cube_shot_max){let e=new ENEMY_BOSS_CUBE({x:1e3,y:400*Math.random()+50});_ENEMIES.push(e),_._showout_cube++}let t=_._standby_count-_._complete_cube_count;return 50===t&&(_.alpha=.7),100===t&&(_.alpha=.3),150===t&&(_.alpha=0),0===_.alpha?(_MAP.set_mapdef_col_clear(),!1):(_._standby_count++,!0)}}class ENEMY_BOSS_CUBE extends GameObject_ENEMY{constructor(_){super(_CANVAS_IMGS.enemy_cube.obj,_.x,_.y,[0,45,90,135],10,45,45);this._standby=!1,this._status=1,this.speed=5,this.change_speed_c=parseInt(150*Math.random())+10,this._stop=!1,this.is_able_collision=!1,this.audio_collision=_CANVAS_AUDIOS.enemy_cube,this._col_c=0,this.tx=0,this.ty=0,this.rad=0,this.deg=0,this.sx=0,this.sy=0}isCanvasOut(){return _GAME.isEnemyCanvasOut(this,{up:!0,down:!0,left:!0,right:!0})}isMove(){let _=this;return _.isStandBy()?(_.move_standby(),!1):_.isCanvasOut()?(_._status=0,_._isshow=!1,!1):!!_.isshow()}move_bounds(){let _=this,e=_ENEMIES;for(let t=0;t<e.length;t++){if(!ENEMY_BOSS_CUBE.prototype.isPrototypeOf(e[t]))continue;if(_.id===e[t].id)continue;if(!e[t]._stop)continue;if(_GAME.isSqCollision("10,10,35,35",_.x+","+_.y,["10,10,35,35"],e[t].x+","+e[t].y)!==_IS_SQ_NOTCOL)return!0}return!1}moveDraw(){let _=this;if(_GAME._setDrawImage({img:_.img,x:_.x,y:_.y,imgPosx:_.imgPos[parseInt(_._col_c/_.aniItv)],width:_.width,alpha:_.alpha,basePoint:1}),!0!==_._stop){if(_.x<0||_.y<0||_.y+50>_CANVAS.height||_.move_bounds()){let e=_.getEnemyCenterPosition();return _MAP.set_mapdef_col(_MAP.getMapX(e._x),_MAP.getMapY(e._y),"1"),_._status=0,_._stop=!0,void _GAME._setPlay(_.audio_collision)}_._c<_.change_speed_c&&(_.x-=_.speed),_._c===_.change_speed_c&&(_.tx=_PLAYERS_MAIN.getPlayerCenterPosition()._x,_.ty=_PLAYERS_MAIN.getPlayerCenterPosition()._y,_.rad=Math.atan2(_.ty-_.y,_.tx-_.x),_.deg=180*_.rad/Math.PI,_.sx=Math.cos(_.rad),_.sy=Math.sin(_.rad),_.speed=10),_._c>_.change_speed_c&&(_.x+=_.sx*_.speed,_.y+=_.sy*_.speed),_._col_c=_._col_c>=8*_.imgPos.length-1?0:_._col_c+1,_._c++}}move(){let _=this;_.isMove()&&(0!==_.alpha?_.moveDraw():_.init())}}class ENEMY_BOSS_FRAME extends GameObject_ENEMY_BOSS{constructor(_,e){super(_CANVAS_IMGS.enemy_frame_body1.obj,_,e);let t=this;t._status=1,t.x=_CANVAS.width+100,t.y=250,t.speed=3,t.moves_interval=15,t.shotColMap=[parseInt(t.img.width/2)+","+parseInt(t.img.height/2)+","+parseInt(t.img.width/2+1)+","+parseInt(t.img.height/2+1)],t._radX=0,t._radY=0,t._rad=100,t._deg=16,t._f=!1,t._mpt=0,t._collision_type="t9",t.movePos={_pos:0,_pos_same_count:0,_getPos:function(){return this._pos},_setPos:function(){let _=t.getEnemyCenterPosition();_._x<200?_._y<150?this._pos=1:_._y>_CANVAS.height-150?this._pos=7:this._pos=4:_._x>_CANVAS.width-200?_._y<150?this._pos=3:_._y>_CANVAS.height-150?this._pos=9:this._pos=6:_._y<150?this._pos=2:_._y>_CANVAS.height-150?this._pos=8:this._pos=5},move:function(){let _=this._getPos();if(this._setPos(),_===this._pos){if(this._pos_same_count++,this._pos_same_count<100)return;let _=5===(e=this)._pos?Math.random()>.4?2:1:3===e._pos&&1===t._mpt&&t._deg<190&&t._deg>=180?0:3===e._pos&&2===t._mpt&&t._deg<90&&t._deg>=80?0:6===e._pos&&1===t._mpt&&t._deg<270&&t._deg>=260?0:6===e._pos&&2===t._mpt&&t._deg<100&&t._deg>=90?0:9===e._pos&&1===t._mpt&&t._deg<280&&t._deg>=270?0:9===e._pos&&2===t._mpt&&t._deg<190&&t._deg>=180?0:2===e._pos&&1===t._mpt&&t._deg<180&&t._deg>=170?0:2===e._pos&&2===t._mpt&&t._deg<10&&t._deg>=0?0:8===e._pos&&1===t._mpt&&t._deg<360&&t._deg>=350?0:8===e._pos&&2===t._mpt&&t._deg<190&&t._deg>=180?0:1===e._pos&&1===t._mpt&&t._deg<180&&t._deg>=170?0:1===e._pos&&2===t._mpt&&t._deg<280&&t._deg>=270?0:4===e._pos&&1===t._mpt&&t._deg<90&&t._deg>=80?0:4===e._pos&&2===t._mpt&&t._deg<280&&t._deg>=270?0:7===e._pos&&1===t._mpt&&t._deg<360&&t._deg>=350?0:7===e._pos&&2===t._mpt&&t._deg<90&&t._deg>=80?0:t._mpt;return t.x<-t._rad||t.x>_CANVAS.width+t._rad||t.y<-t._rad||t.y>_CANVAS.height+t._rad?(t.deg=t.setDegAdd(180),t.moves_pt[t._mpt].switch(0),void(t._mpt=0)):(_!==t._mpt&&(this._pos_same_count=0),t.moves_pt[t._mpt].switch(_),void(t._mpt=_))}var e;let s=function(e){return 5===e._pos?0:1===_&&2===e._pos?2:1===_&&4===e._pos?1:4===_&&1===e._pos?2:4===_&&7===e._pos?1:7===_&&4===e._pos?2:7===_&&8===e._pos?1:2===_&&1===e._pos?1:2===_&&3===e._pos?2:8===_&&7===e._pos?2:8===_&&9===e._pos?1:3===_&&2===e._pos?1:3===_&&6===e._pos?2:6===_&&3===e._pos?1:6===_&&9===e._pos?2:9===_&&6===e._pos?1:9===_&&8===e._pos?2:parseInt(2*Math.random()+1)}(this);t.moves_pt[t._mpt].switch(s),t._mpt=s}},t.parts=[new ENEMY_BOSS_FRAME_HEAD({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_BODY({o:null,x:1500,y:250}),new ENEMY_BOSS_FRAME_HEAD({o:null,x:1500,y:250,d:t._DEF_DIR._L})],t.moves=[];for(let _=0;_<t.parts.length;_++)_ENEMIES.push(t.parts[_]);t.moves_pt=[{switch:function(_){1===_?t._deg=t.setDegAdd(90):2===_&&(t._deg=t.setDegAdd(-90)),0!==_&&(t._radX=t.x+Math.cos(t._deg*Math.PI/180)*t._rad*-1,t._radY=t.y+Math.sin(t._deg*Math.PI/180)*t._rad*-1),t._mpt=_},move:function(){t.x+=t.speed*Math.cos(t._deg*Math.PI/180),t.y+=t.speed*Math.sin(t._deg*Math.PI/180)},setDeg:0},{switch:function(_){0===_?t._deg=t.setDegAdd(-90):2===_&&(t._deg=t.setDegAdd(-180)),1!==_&&(t._radX=t.x+Math.cos(t._deg*Math.PI/180)*t._rad*-1,t._radY=t.y+Math.sin(t._deg*Math.PI/180)*t._rad*-1),t._mpt=_},move:function(){t._deg=t.setDegAdd(-1*t.speed/2),t.x=t._radX+Math.cos(t._deg*Math.PI/180)*t._rad,t.y=t._radY+Math.sin(t._deg*Math.PI/180)*t._rad},setDeg:-90},{switch:function(_){0===_?t._deg=t.setDegAdd(90):1===_&&(t._deg=t.setDegAdd(-180)),2!==_&&(t._radX=t.x+Math.cos(t._deg*Math.PI/180)*t._rad*-1,t._radY=t.y+Math.sin(t._deg*Math.PI/180)*t._rad*-1),t._mpt=_},move:function(){t._deg=t.setDegAdd(t.speed/2),t.x=t._radX+Math.cos(t._deg*Math.PI/180)*t._rad,t.y=t._radY+Math.sin(t._deg*Math.PI/180)*t._rad},setDeg:90}],t.is_able_collision=!1,t._standby=!0,t._heads_statuses="",t._bodies_statuses=""}setSelfCollision(){let _=this;if(_._c>_._c_self_collision&&(_._heads_statuses="00"),-1===_._heads_statuses.indexOf("1")){for(let e=0;e<_.parts.length;e++)ENEMY_BOSS_FRAME_HEAD.prototype.isPrototypeOf(_.parts[e])?_.parts[e]._status=0:_.parts[e].is_frame_heads_collision=!0;-1===_._bodies_statuses.indexOf("1")&&_.init()}}set_heads_bodies_status(){let _=this;_._heads_statuses="",_._bodies_statuses="";for(let e=0;e<_.parts.length;e++)ENEMY_BOSS_FRAME_HEAD.prototype.isPrototypeOf(_.parts[e])?_._heads_statuses+=_.parts[e].isalive()?1:0:_._bodies_statuses+=_.parts[e].isalive()?1:0}setDegAdd(_){let e=(this._deg+_)%360;return e<0?360+e:e}move_standby(){let _=this;_._deg=190,_.x+=_.speed*Math.cos(_._deg*Math.PI/180),_.y+=_.speed*Math.sin(_._deg*Math.PI/180),_.moves.unshift({x:_.x,y:_.y,deg:_._deg}),_.moves.length>_.parts.length*_.moves_interval&&_.moves.pop();for(let e=0;e<_.parts.length;e++){let t=_.moves[e*_.moves_interval];if(void 0===t)break;_.parts[e].moveDraw({x:t.x,y:t.y,deg:t.deg})}_.x<_CANVAS.width-300&&(_.movePos._setPos(),_._standby=!1)}move(){let _=this;if(_.isMove()){_.set_heads_bodies_status(),_.moves.unshift({x:_.x,y:_.y,deg:_.setDegAdd(_.moves_pt[_._mpt].setDeg)}),_.moves.length>_.parts.length*_.moves_interval&&_.moves.pop(),_.movePos.move(),_.moves_pt[_._mpt].move();for(let e=0;e<_.parts.length&&void 0!==_.moves[e*_.moves_interval];e++){let t=_.moves[e*_.moves_interval];_.parts[e].moveDraw({x:t.x,y:t.y,deg:t.deg})}_._f||_.parts[0].isalive()||(_._f=!0,_.parts.reverse(),_.moves.reverse(),_.x=_.moves[0].x,_.y=_.moves[0].y,_.parts[0].setDirect(_._DEF_DIR._R),_._deg=_.moves[0].deg+180,_.moves_pt[_._mpt].switch(0),_._mpt=0),_.setSelfCollision(),_._c++}}}class ENEMY_BOSS_FRAME_HEAD extends GameObject_ENEMY{constructor(_){super(_CANVAS_IMGS.enemy_frame_head1.obj,_.x,_.y);this.direct=_.d||this._DEF_DIR._R,this.img=this.direct===this._DEF_DIR._L?_CANVAS_IMGS.enemy_frame_head3.obj:_CANVAS_IMGS.enemy_frame_head1.obj,this._standby=!1,this._status=75,this.getscore=5e3,this._deg=0,this.shotColMap=["30,30,"+(this.img.width-60)+","+(this.img.height-60)],this._collision_type="t9",this.audio_collision=_CANVAS_AUDIOS.enemy_collision6,this.num_col=6}showCollapes(){let _=this,e=_.getEnemyCenterPosition();_._isshow=!1;for(let t=0;t<(_.num_col||1);t++)_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(e._x+Math.random()*(Math.random()>.5?100:-100),e._y+Math.random()*(Math.random()>.5?100:-100),_._collision_type));_GAME._setPlay(_.audio_collision)}setDirect(_){this.direct=_}shot(){let _=this;_.img=_._c%200<150&&_._c%200>0?_.direct===_._DEF_DIR._L?_CANVAS_IMGS.enemy_frame_head3.obj:_CANVAS_IMGS.enemy_frame_head1.obj:_.direct===_._DEF_DIR._L?_CANVAS_IMGS.enemy_frame_head4.obj:_CANVAS_IMGS.enemy_frame_head2.obj,_._c%200==150&&_ENEMIES_SHOTS.push(new ENEMY_SHOT_FRAME({x:_.x,y:_.y,deg:_._deg+90}))}moveDraw(_){let e=this;e.isshow()&&(e.isalive()?(e.shot(),e.x=_.x,e.y=_.y,e._deg=_.deg,_GAME._setDrawImage({img:e.img,x:e.x+e.img.width/4,y:e.y+e.img.height/4,deg:e._deg}),e._c=e._c>200?0:e._c+1):e.showCollapes())}move(){}}class ENEMY_BOSS_FRAME_BODY extends GameObject_ENEMY{constructor(_){super(_CANVAS_IMGS.enemy_frame_body1.obj,_.x,_.y);this.img=_CANVAS_IMGS.enemy_frame_body1.obj,this._standby=!1,this.is_able_collision=!1,this.shotColMap=["5,5,"+(this.img.width-10)+","+(this.img.height-10)],this._deg=0,this.speed=Math.random>.4?-10:10,this.is_frame_heads_collision=!1,this.ani=[{scale:1},{scale:.95},{scale:.9},{scale:.85},{scale:.9},{scale:.95}]}showCollapes(){let _=this;if(_GAME.isEnemyCanvasOut(_))return _._status=0,void(_._isshow=!1);_.x+=Math.cos(_._deg*Math.PI/180)*_.speed,_.y+=Math.sin(_._deg*Math.PI/180)*_.speed,_GAME._setDrawImage({img:_.img,x:_.getEnemyCenterPosition()._x,y:_.getEnemyCenterPosition()._y,deg:_._deg})}moveDraw(_){let e=this;e._c=e._c>=20*e.ani.length-1?0:e._c+1;let t=parseInt(e._c/20);if(e.isshow()){if(e.is_frame_heads_collision)return e._standby=!0,void e.showCollapes();e.x=_.x,e.y=_.y,e._deg=_.deg,_GAME._setDrawImage({img:e.img,x:e.getEnemyCenterPosition()._x,y:e.getEnemyCenterPosition()._y,deg:e._deg,scale:e.ani[t].scale})}}move(){}}class ENEMY_BOSS_CELL extends GameObject_ENEMY_BOSS{constructor(_,e){super(_CANVAS_IMGS.enemy_cell_boss.obj,_,e);this._status=1,this.x=_||_CANVAS.width+200,this.y=e||250,this.rad=Math.random()*Math.PI-Math.PI/2,this._standby=!1,this.is_all_set=!1,this.ani=[0,200,400],this.ani_c=0,this.ani_c_intv=20,this.moves=[],this.speed=1,this.moves_interval=50,this.parts=[new ENEMY_BOSS_CELL_MAIN({x:this.x,y:this.y,alpha:1}),new ENEMY_BOSS_CELL_MAIN({x:this.x,y:this.y,alpha:.7}),new ENEMY_BOSS_CELL_MAIN({x:this.x,y:this.y,alpha:.7}),new ENEMY_BOSS_CELL_MAIN({x:this.x,y:this.y,alpha:.7}),new ENEMY_BOSS_CELL_MAIN({x:this.x,y:this.y,alpha:.7}),new ENEMY_BOSS_CELL_MAIN({x:this.x,y:this.y,alpha:.7}),new ENEMY_BOSS_CELL_MAIN({x:this.x,y:this.y,alpha:.7})],this.parts_eye=new ENEMY_BOSS_CELL_EYE({x:this.x,y:this.y}),this.width=200,this.height=this.img.height,this.shotColMap=["50,0,"+this.width+","+this.height],this.is_able_collision=!1,this.is_ignore_collision=!0,this._collision_type="t9",this._col_c=0}is_parts_eye_status(){return this.parts_eye.isalive()}setSelfCollision(){this._c<this._c_self_collision||(this.parts_eye._status=0,this.setCollapes())}setCollapes(){let _=this;if(0===_.parts.length)return _._status=0,void _SCORE.set(_.getscore);for(let e=_.parts.length-1;e>=0;e--)_.parts[e].moveDraw();let e=_.parts[_.parts.length-1];0===_._col_c?(e.showCollapes(),_.parts.pop()):_._col_c%8==0&&(_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(e.x+100*Math.random(),e.y+100*Math.random(),_._collision_type)),_GAME._setPlay(_.audio_collision)),_._col_c=_._col_c>40?0:_._col_c+1}isAllset(){return!!this.is_all_set||(this.move_Allset(),!1)}move_Allset(){let _=this;_.x-=2;for(let e=0;e<_.parts.length;e++)_.parts[e].moveSet({x:_.x,y:_.y});if(_.parts[0].moveDraw(),!(_.x>=_CANVAS.width-300)){_.is_all_set=!0;for(let e=0;e<_.parts.length;e++)_ENEMIES.push(_.parts[e]);_ENEMIES.push(_.parts_eye)}}showCollapes(){}move_standby(){}move(){let _=this;if(_.ani_c=_.ani_c>=_.ani.length*_.ani_c_intv-1?0:_.ani_c+1,!_.isMove())return;if(!_.isAllset())return;if(!_.is_parts_eye_status())return void _.setCollapes();(_.x<400||_.x>700||_.y<100||_.y>300)&&(_.rad+=Math.PI/2),_.x+=Math.cos(_.rad)*_.speed,_.y+=Math.sin(_.rad)*_.speed,_.moves.unshift({x:_.x,y:_.y}),_.moves.length>_.parts.length*_.moves_interval&&_.moves.pop();for(let e=0;e<_.parts.length;e++){let t=_.moves[e*_.moves_interval];if(void 0===t)break;_.parts[e].moveSet({x:t.x,y:t.y})}for(let e=_.parts.length-1;e>=0;e--)_.parts[e].moveDraw();let e=_.moves[0];_._c%300>100&&_._c%300<200&&(_.parts_eye.move_eye_open(),_.parts_eye.moveDraw({x:e.x,y:e.y+_.height/2-_.parts_eye.height/2})),_._c%300>=200&&_._c%300<300&&(_.parts_eye.move_eye_close(),_.parts_eye.moveDraw({x:e.x,y:e.y+_.height/2-_.parts_eye.height/2})),_.setSelfCollision(),_._c++}}class ENEMY_BOSS_CELL_MAIN extends GameObject_ENEMY{constructor(_){super(_CANVAS_IMGS.enemy_cell_boss.obj,_.x,_.y);this._status=1,this.x=_.x||_CANVAS.width+200,this.y=_.y||250,this.alpha=_.alpha,this.speed=2,this._standby=!1,this.ani=[0,200,400],this.ani_c=0,this.ani_c_intv=20,this.width=200,this.height=this.img.height,this.shotColMap=["50,0,"+this.width+","+this.height],this.is_able_collision=!1,this.is_ignore_collision=!1,this._collision_type="t9"}showCollapes(){let _=this.getEnemyCenterPosition();_ENEMIES_COLLISIONS.push(new GameObject_ENEMY_COLLISION(this.x+this.width/2,_._y,this._collision_type)),this.init()}moveSet(_){this.x=_.x,this.y=_.y}moveDraw(){this.ani_c=this.ani_c>=this.ani.length*this.ani_c_intv-1?0:this.ani_c+1,_GAME._setDrawImage({img:this.img,x:this.x,y:this.y,imgPosx:this.ani[parseInt(this.ani_c/this.ani_c_intv)],width:this.width,basePoint:1,alpha:this.alpha})}move(){}}class ENEMY_BOSS_CELL_EYE extends GameObject_ENEMY{constructor(_){super(_CANVAS_IMGS.enemy_cell_boss_eye.obj,_.x,_.y);this._status=100,this.x=_.x||_CANVAS.width+200,this.y=_.y||250,this._standby=!1,this.audio_alive=_CANVAS_AUDIOS.enemy_collision7,this.is_able_collision=!1,this.ani=[0,60,120,180],this.ani_c=0,this.ani_c_intv=20,this.setAliveHit=!1,this.width=60,this.height=this.img.height,this.shotColMap=["0,0,"+this.width+","+this.height],this._collision_type="t1"}showCollapes(){this.init()}shot(){let _=this,e=_GAME.getDeg(_PLAYERS_MAIN,_);for(let t=-30;t<=30;t+=30)_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT({x:_.x+20,y:this.getEnemyCenterPosition()._y,img:_CANVAS_IMGS.enemy_bullet_cell.obj,imgPos:[0,15],width:15,speed:3,aniItv:10,deg:e+t}))}move_eye_open(){let _=this;_.ani_c>=_.ani.length*_.ani_c_intv-1||(_.ani_c%10==0&&_.shot(),_.ani_c++)}move_eye_close(){let _=this;_.ani_c<0||(_.ani_c%10==0&&_.shot(),_.ani_c--)}setAlive(){_GAME._setDrawImage({img:this.img,x:this.x+20,y:this.y,imgPosx:this.ani[parseInt(this.ani_c/this.ani_c_intv)],width:this.width,basePoint:1}),_GAME._setPlay(this.audio_alive)}moveDraw(_){this.x=_.x,this.y=_.y,this.is_able_collision=this.ani_c>0,_GAME._setDrawImage({img:this.img,x:this.x,y:this.y,imgPosx:this.ani[parseInt(this.ani_c/this.ani_c_intv)],width:this.width,basePoint:1})}move(){this.x=_MAP.getX(this.x),this.y=_MAP.getY(this.y),this.isMove()}}class MAP_OBJECT{constructor(_){void 0!==_&&(this.img=_.img,this.imgPos=_.imgPos||[0],this.aniItv=_.aniItv||1,this.width=_.width||this.img.obj.width,this.height=_.height||this.img.obj.height,this.dir=_.dir||1,this.x=_.x||0,this.y=_.y||0,this._s="1",this._c=0,this._DEF_DIR={_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},this.is_able_collision=!1,this._DEF_SHOTSTATUS={_SHOTTYPE_NORMAL:1,_SHOTTYPE_MISSILE:2,_SHOTTYPE_DOUBLE:1,_SHOTTYPE_RIPPLE_LASER:1.5,_SHOTTYPE_LASER:1},this._c=0)}getImg(){return this.img.obj}collision(){}moveDraw(_,e){this._c=this._c>=this.imgPos.length*this.aniItv-1?0:this._c+1,_GAME._setDrawImage({img:this.img,imgPosx:this.imgPos[parseInt(this._c/this.aniItv)],x:_,y:e,width:this.width,height:this.height,basePoint:1})}}class MAP_CUBE_A extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_cube_A.obj,width:25,height:25});this._s="1"}}class MAP_CRISTAL extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.enemy_p_1.obj,width:84,height:83});this._s="011,111,110"}}class MAP_MOAI_A extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_moai_A.obj,width:250,height:100});this._s="0000000000,1111111111,1111111111,0000000000"}}class MAP_MOAI_B extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_moai_B.obj,width:250,height:100});this._s="0000000000,1111111111,1111111111,0000000000"}}class MAP_VOLCANO_A extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_A.obj,width:225,height:75});this._s="111111111,111111111,000000000"}}class MAP_VOLCANO_B extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_B.obj,width:225,height:75});this._s="111111111,111111111,000000000"}}class MAP_VOLCANO_C extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_C.obj,width:225,height:75});this._s="000000000,111111111,111111111"}}class MAP_VOLCANO_D extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_D.obj,width:225,height:75});this._s="000000000,111111111,111111111"}}class MAP_VOLCANO_F extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_F.obj,width:225,height:150});this._s="000110000,000110000,001111000,011111100,011111110,111111111"}}class MAP_VOLCANO_G extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_G.obj,width:225,height:150});this._s="111111110,011111110,011111100,001111000,000110000,000110000"}}class MAP_VOLCANO_H extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_H.obj,width:500,height:325});this._s="00000000000000000000,00000111111111111110,00000111111110000000,00000000011110000000,00000000001100000000,00000000001100000000,00000000001100000000,11111111111111111100,01111111111111111100,00000000011000000000,00000000011000000000,00000000111000000000,00000001111110000000"}}class MAP_VOLCANO_I extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_I.obj,width:375,height:250});this._s="000000010000000,000000010000000,000000111000000,000001111100000,000011111110000,000111111111000,001111111111100,001111111111100,011111111111110,111111111111111"}}class MAP_VOLCANO_J extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_J.obj,width:375,height:250});this._s="111111111111111,011111111111110,001111111111100,001111111111100,000111111111000,000011111110000,000001111100000,000000111000000,000000010000000,000000010000000"}}class MAP_VOLCANO_K extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_K.obj,width:75,height:25});this._s="010"}}class MAP_VOLCANO_L extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_L.obj,width:75,height:25});this._s="010"}}class MAP_VOLCANO_M extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_M.obj,width:100,height:50});this._s="0111,1111"}}class MAP_VOLCANO_N extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_N.obj,width:100,height:50});this._s="1111,0111"}}class MAP_VOLCANO_O extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_O.obj,width:100,height:50});this._s="1111,1110"}}class MAP_VOLCANO_P extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_volcano_P.obj,width:100,height:50});this._s="1110,1111"}}class MAP_FRAME_A extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_frame_A.obj,imgPos:[0,200,400,600,800],aniItv:10,width:200,height:75});this._s="000000000,11111111,11111111"}}class MAP_FRAME_B extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_frame_B.obj,imgPos:[0,200,400,600,800],aniItv:10,width:200,height:75});this._s="11111111,11111111,00000000"}}class MAP_FRAME_C extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_frame_C.obj,imgPos:[0,50,100,150],aniItv:10,width:50,height:75});this._s="00,01,11",this.direct=this._DEF_DIR._LD}}class MAP_FRAME_D extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_frame_D.obj,imgPos:[0,50,100,150],aniItv:10,width:50,height:75});this._s="11,01,00",this.direct=this._DEF_DIR._LU}}class MAP_FRAME_E extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_frame_E.obj,imgPos:[0,50,100,150],aniItv:10,width:50,height:75});this._s="00,10,11",this.direct=this._DEF_DIR._LU}}class MAP_FRAME_F extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_frame_F.obj,imgPos:[0,50,100,150],aniItv:10,width:50,height:75});this._s="11,10,00",this.direct=this._DEF_DIR._LU}}class MAP_CELL_A extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_cell_A.obj,imgPos:[0,475,950],aniItv:20,width:475,height:100});this._s="0000000000000000000,0011111111111111100,0111111111111111110,1111111111111111111"}}class MAP_CELL_B extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_cell_B.obj,imgPos:[0,475,950],aniItv:20,width:475,height:100});this._s="1111111111111111111,0111111111111111110,0011111111111111100,0000000000000000000"}}class MAP_CELL_C extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_cell_C.obj,imgPos:[0,125,250],aniItv:20,width:125,height:100});this._s="00100,01110,01110,11111"}}class MAP_CELL_D extends MAP_OBJECT{constructor(){super({img:_CANVAS_IMGS.map_cell_D.obj,imgPos:[0,125,250],aniItv:20,width:125,height:100});this._s="11111,01110,01110,00100"}}class MAP_CELL_VWYZ extends MAP_OBJECT{constructor(_){super({img:_.img,imgPos:[0,300,600],aniItv:20,width:300,height:50});this._s=_._s}}class MAP_CELL_V extends MAP_CELL_VWYZ{constructor(){super({img:_CANVAS_IMGS.map_cell_V.obj,_s:"001111111100,111111111111"})}}class MAP_CELL_W extends MAP_CELL_VWYZ{constructor(){super({img:_CANVAS_IMGS.map_cell_W.obj,_s:"111111111111,001111111100"})}}class MAP_CELL_Y extends MAP_CELL_VWYZ{constructor(){super({img:_CANVAS_IMGS.map_cell_Y.obj,_s:"111111111111,111111111111"})}}class MAP_CELL_Z extends MAP_CELL_VWYZ{constructor(){super({img:_CANVAS_IMGS.map_cell_Z.obj,_s:"111111111111,111111111111"})}}class MAP_CELL_WALL extends MAP_OBJECT{constructor(_){super({img:_CANVAS_IMGS.map_cell_wall.obj,imgPos:_.imgPos||[0],width:25,height:25});this._s="1",this.is_able_collision=!0,this._status=1,this._status_count=0,this.audio_collision=_CANVAS_AUDIOS.map_cell_wall,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.1}collision(_){this._status-=this._DEF_SHOTSTATUS[_]||1}moveDraw(_,e){let t=this;if(t._status_count>=200&&(t._status_count=0,t._status=1,_MAP.set_mapdef_col(_MAP.getMapX(_),_MAP.getMapY(e),"1")),t._status<=0)return 0===t._status_count&&_GAME._setPlay(t.audio_collision),_MAP.set_mapdef_col(_MAP.getMapX(_),_MAP.getMapY(e),"0"),void t._status_count++;_GAME._setDrawImage({img:t.img,x:_,y:e,width:t.width,imgPosx:t.imgPos[0],basePoint:1})}}class MAP_CELL_G extends MAP_CELL_WALL{constructor(){super({imgPos:[0]})}}class MAP_CELL_H extends MAP_CELL_WALL{constructor(){super({imgPos:[25]})}}class MAP_CELL_I extends MAP_CELL_WALL{constructor(){super({imgPos:[50]})}}class MAP_CELL_J extends MAP_CELL_WALL{constructor(){super({imgPos:[75]})}}class MAP_CELL_K extends MAP_CELL_WALL{constructor(){super({imgPos:[100]})}}class MAP_CELL_L extends MAP_CELL_WALL{constructor(){super({imgPos:[125]})}}class MAP_CELL_M extends MAP_CELL_WALL{constructor(){super({imgPos:[150]})}}class MAP_CELL_N extends MAP_CELL_WALL{constructor(){super({imgPos:[175]})}}class MAP_CELL_O extends MAP_CELL_WALL{constructor(){super({imgPos:[200]})}}class GameObject_PLAYER{constructor(_,e,t,s){this.img=_CANVAS_IMGS[_].obj,this.x=e||100,this.y=t||100,this._x=0,this._y=0,this._isalive=s||!1,this._scalechange=!0,this.width=0,this.height=0,this._c=0,this.accel=3,this.shotflag=!1}isalive(){return this._isalive}isshotflag(){return this.shotflag}enemy_collision(){}getPlayerCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}setfalsealive(){this._isalive=!1}settruealive(){this._isalive=!0}}class GameObject_PLAYER_MAIN extends GameObject_PLAYER{constructor(){super("vicviper",100,200,!0),this._isequipped=!1,this._isequipped_count=0,this.img=_CANVAS_IMGS.vicviper.obj,this.imgsize=this.img.height,this.width=this.imgsize,this.height=this.imgsize,this.img_vb=_CANVAS_IMGS.vicviper_back.obj,this.imgsize_vb=this.img_vb.height,this.width_vb=this.imgsize_vb,this.height_vb=this.imgsize_vb,this.c_vv_ani=20,this.vv_ani=[120,60,0,180,240],this.vv_e_ani=[420,360,300,480,540],this.c_vb_ani=0,this.vb_ani=[0,14,28],this.vb_e_ani=[42,42,42],this._col_ani_c=0,this.col_ani=[{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.7},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.3},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.1}],this.shotflag=!0}collapes(){null!==_DRAW_SETINTERVAL&&(_GAME._setStopOnBG(),_DRAW_STOP(),_DRAW_PLAYER_COLLAPES())}enemy_collision(_){1===_PLAYERS_POWER_METER_SHIELD&&_PLAYERS_MAIN_FORCE.isalive()||_GAME.isSqCollision("25,26,35,32",this.x+","+this.y,_.shotColMap,_.x+","+_.y)!==_IS_SQ_NOTCOL&&(_.collision(),this.setfalsealive())}enemy_shot_collision(_){1===_PLAYERS_POWER_METER_SHIELD&&_PLAYERS_MAIN_FORCE.isalive()||_GAME.isSqCollision("25,26,35,32",this.x+","+this.y,_.shotColMap,_.x+","+_.y)!==_IS_SQ_NOTCOL&&(_.init(),this.setfalsealive())}set_equipped(){this._isequipped_count=20}map_collition(){if(1===_PLAYERS_POWER_METER_SHIELD&&_PLAYERS_MAIN_FORCE.isalive())return;let _=this.getPlayerCenterPosition(),e=_MAP.getMapX(_._x),t=_MAP.getMapY(_._y);_MAP.isMapCollision(e,t)&&this.setfalsealive()}set_vv_ani(_){"ArrowUp"!==_&&"Up"!==_||(this.c_vv_ani-=2),"ArrowDown"!==_&&"Down"!==_||(this.c_vv_ani+=2)}set_moveamount_reset(){_MAP.setBackGroundSpeedY(0),this._x=0,this._y=0}set_moveamount(){let _=this;_PLAYERS_MOVE_FLAG?(_.x=function(e){let t=_.x+_._x;return t<=50?(_._x=0,50):t>=_CANVAS.width-100?(_._x=0,_CANVAS.width-100):t}(),_.y=function(e){let t=_.y+_._y;return _MAP.map_infinite?t<100?(_MAP.setBackGroundSpeedY(_._y),100):(t>=100&&t<=300&&_MAP.setBackGroundSpeedY(0),t>300?(_MAP.setBackGroundSpeedY(_._y),300):t):t<=50-_.img.height/4?(_._y=0,50-_.img.height/4):t>=_CANVAS.height-75-_.img.height/4?(_._y=0,_CANVAS.height-75-_.img.height/4):t}(),_GAME._setPlayerMoveDraw()):_.set_moveamount_reset()}move(){let _=this;if(!_.isalive())return void _.collapes();_.map_collition(),_.set_moveamount(),_PLAYERS_MOVE_FLAG?_.c_vv_ani>46?_.c_vv_ani=46:_.c_vv_ani<4&&(_.c_vv_ani=4):_.c_vv_ani>25?_.c_vv_ani-=1:_.c_vv_ani<25?_.c_vv_ani+=1:_.c_vv_ani=25;let e=function(){let e=parseInt(_.c_vv_ani/10);return _._isequipped_count<=0?_.vv_ani[e]:(_._isequipped_count--,_._isequipped_count>0&&_._isequipped_count%2==0?_.vv_e_ani[e]:_.vv_ani[e])}();_CONTEXT.drawImage(_.img,e,0,_.imgsize,_.imgsize,_.x,_.y,_.imgsize,_.imgsize);let t=function(){let e=parseInt(_.c_vb_ani/3);return _._isequipped_count>0&&_._isequipped_count%2==0?_.vb_e_ani[e]:_.vb_ani[e]}();_.c_vb_ani=_GAME._ac._get(_.c_vb_ani,_.vb_ani,3),_CONTEXT.drawImage(_.img_vb,t,0,_.imgsize_vb,_.imgsize_vb,_.x,_.y+22,_.imgsize_vb,_.imgsize_vb)}}class GameObject_PLAYER_MAIN_RED extends GameObject_PLAYER_MAIN{constructor(){super("vicviper1",100,200,!0),this.col_ani=[{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.7},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.3},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.1}]}}class GameObject_PLAYER_OPTION extends GameObject_PLAYER{constructor(_,e,t,s){super(_,e,t,s),this._ani_c=0,this.ani=[{scale:1},{scale:.9},{scale:.8},{scale:.7},{scale:.8},{scale:.9}],this.imgsize=this.img.height,this.width=this.imgsize,this.height=this.imgsize}move(_){if(this.x=_GAME._getPlayerMoveDrawX(_),this.y=_GAME._getPlayerMoveDrawY(_),!this._isalive)return;if(null===this.x||null===this.y||void 0===this.x||void 0===this.y)return;this.shotflag=!0;let e=this.getPlayerCenterPosition();this._ani_c=this._ani_c>=3*this.ani.length-1?0:this._ani_c+1;let t=parseInt(this._ani_c/3);_GAME._setDrawImage({img:this.img,x:e._x,y:e._y,scale:this.ani[t].scale})}}class GameObject_FORCEFIELD{constructor(){this.img=_CANVAS_IMGS.forcefield.obj,this.x=0,this.y=0,this.width=0,this.height=0,this._c=0,this._scale=0,this.ani=[0,106],this.col_date=null,this.col_canint=50}init(){this._scale=1,this.width=this.img.width/4,this.height=this.img.height}isalive(){return 0!==this._scale}enemy_collision(_){this.isalive()&&_GAME.isSqCollision(parseInt(this._scale*this.width/8)+","+parseInt(this._scale*this.height/8)+","+parseInt(this._scale*this.width*6/8)+","+parseInt(this._scale*this.height*6/8),this.x+","+this.y,_.shotColMap,_.x+","+_.y)!==_IS_SQ_NOTCOL&&(_.collision(),this.reduce())}enemy_shot_collision(_){this.isalive()&&_GAME.isSqCollision(parseInt(this._scale*this.width/8)+","+parseInt(this._scale*this.height/8)+","+parseInt(this._scale*this.width*6/8)+","+parseInt(this._scale*this.height*6/8),this.x+","+this.y,_.shotColMap,_.x+","+_.y)!==_IS_SQ_NOTCOL&&(_.init(),this.reduce())}getPlayerCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}map_collition(){let _=this.getPlayerCenterPosition(),e=_MAP.getMapX(_._x),t=_MAP.getMapY(_._y);_MAP.isMapCollision(e,t)&&this.reduce()}isCollision(){let _=this;return null===_.col_date?(_.col_date=new Date,!0):new Date-_.col_date>_.col_canint&&(_.col_date=new Date,!0)}reduce(){let _=this;_.isalive()&&_.isCollision()&&(_._scale-=.09,_._scale<=.55&&(_._scale=0,_POWERMETER._set_meter_on("000001")),_GAME._setPlay(_CANVAS_AUDIOS.vicviper_shield_reduce))}move(_){this.isalive()&&(this.map_collition(),this.x=_.x,this.y=_.y,this._c=this._c>=5*this.ani.length-1?0:this._c+1,_GAME._setDrawImage({img:this.img,x:_.getPlayerCenterPosition()._x-6,y:_.getPlayerCenterPosition()._y-2,imgPosx:this.ani[parseInt(this._c/5)],width:this.width,height:this.height,scale:this._scale}))}}class GameObject_FORCEFIELD_RED extends GameObject_FORCEFIELD{constructor(){super(),this.ani=[210,315]}}class GameObject_SHIELD extends GameObject_FORCEFIELD{constructor(){super(),this.ani=[0,40]}getPlayerCenterPosition(){return{_x:this.x+this.width/2*this._scale,_y:this.y+this.height*this._scale}}init(){this._scale=1,this.img=_CANVAS_IMGS.shield.obj,this.width=this.img.width/4,this.height=this.img.height}isalive(){return 0!==this._scale}enemy_collision(_){this.isalive()&&_GAME.isSqCollision("0,0,"+parseInt(this._scale*this.width)+","+parseInt(this._scale*this.height*2),this.x+","+this.y,_.shotColMap,_.x+","+_.y)!==_IS_SQ_NOTCOL&&(_.collision(),this.reduce())}enemy_shot_collision(_){this.isalive()&&_GAME.isSqCollision("0,0,"+parseInt(this._scale*this.width)+","+parseInt(this._scale*this.height*2),this.x+","+this.y,_.shotColMap,_.x+","+_.y)!==_IS_SQ_NOTCOL&&(_.init(),this.reduce())}map_collition(_){let e=this,t=e.getPlayerCenterPosition(),s=_MAP.getMapX(t._x),i=_MAP.getMapY(t._y);_MAP.isMapCollision(s,i)?e.reduce():(i=_MAP.getMapY(e.y+10),_MAP.isMapCollision(s,i)?e.reduce():(i=_MAP.getMapY(t._y-15+e.height*e._scale),_MAP.isMapCollision(s,i)&&e.reduce()))}reduce(){let _=this;_.isalive()&&_.isCollision()&&(_._scale-=.04,_._scale<.35&&(_._scale=0,_POWERMETER._set_meter_on("000001")),_GAME._setPlay(_CANVAS_AUDIOS.vicviper_shield_reduce))}move(_){if(!this.isalive())return;let e=_.getPlayerCenterPosition();this.map_collition(_),this.x=e.x,this.y=e.y,this._c=this._c>=5*this.ani.length-1?0:this._c+1;let t=_.x+_.width,s=e._y,i=e._y-this.height*this._scale;_GAME._setDrawImage({img:this.img,x:t,y:s,imgPosx:this.ani[parseInt(this._c/5)],width:this.width,height:this.height,scale:this._scale,basePoint:7}),_GAME._setDrawImage({img:this.img,x:t,y:s,imgPosx:this.ani[parseInt(this._c/5)],width:this.width,height:this.height,scale:this._scale,basePoint:1}),this.x=t,this.y=i}}class GameObject_SHIELD_RED extends GameObject_SHIELD{constructor(){super(),this.ani=[80,120]}}class GameObject_SHOTS{constructor(_){this.shots=new Array,this.player=_,this._sq=0}enemy_collision(_){if(this.player.isalive())for(let e=0;e<this.shots.length;e++){let t=this.shots[e];if(!t._shot_alive)continue;if(_.x<this.player.x)continue;let s=_GAME.isSqCollision("-12,-12,12,12",t.x+","+t.y,_.shotColMap,_.x+","+_.y);s!==_IS_SQ_NOTCOL&&(s===_IS_SQ_COL&&_.collision(_SHOTTYPE_NORMAL),t._init())}}map_collition(){}getshottype(){}move(){}}class GameObject_SHOTS_MISSILE extends GameObject_SHOTS{constructor(_){super(_),this.shots=new Array,this.col_mis=[{fs:"rgba(255,246,72,1)",scale:8},{fs:"rgba(255,131,62,1)",scale:10},{fs:"rgba(255,131,72,1)",scale:12},{fs:"rgba(255,131,62,1)",scale:14},{fs:"rgba(133,0,4,1)",scale:12},{fs:"rgba(133,0,4,1)",scale:14},{fs:"rgba(100,0,4,1)",scale:16}],this.st={_st1:0,_st2:24,_st3:48,_st4:72,_st5:96,_st6:0,_st7:96,_st8:72},this.imgsize=_CANVAS_IMGS.gradius_missile.obj.height;for(let _=0;_<_PLAYERS_SHOTS_MAX;_++)this.shots.push({sid:_SHOTTYPE_MISSILE,id:_,x:0,y:0,_t:0,_st:"_st1",_img:_CANVAS_IMGS.gradius_missile.obj,_audio:_CANVAS_AUDIOS.missile,_c_mc:0,_c:0,_c_area:25,_enemyid:null,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._t=0,this._c=0,this._c_mc=0,this._c_area=25,this._st="_st1",this._enemyid=null,this._shot=!1,this._shot_alive=!1}});let e=this;this.mis_status={_st1:function(_){let t=e.player.getPlayerCenterPosition();var s;_.x=(s=_.x,_._shot_alive?s+4:t._x),_.y=function(e){return _._shot_alive?e+8:t._y}(_.y)},_st2:function(_){_.x+=0,_.y+=8},_st3:function(_){_.x+=8,_.y+=0},_st4:function(_){_.x+=2,_.y+=1},_st5:function(_){_.x+=2,_.y+=2},_st6:function(_){_.x+=2,_.y+=2},_st7:function(_){_.x+=6,_.y+=1},_st8:function(_){_.x+=6,_.y+=1}}}enemy_collision(_,e){if(!this.player.isalive())return;if(!e._shot_alive)return;let t=_GAME.isSqCollision(0-e._img.height/4+","+(0-e._img.height/4)+","+5*e._img.height/4+","+5*e._img.height/4,e.x+","+e.y,_.shotColMap,_.x+","+_.y);t!==_IS_SQ_NOTCOL&&(e._c>0||(0===e._c&&(e._c=1),t!==_IS_SQ_COL_NONE&&_.collision(_SHOTTYPE_MISSILE)))}get_missile_status(_){return _._st}set_missile_status(_,e){"_st1"!==this._st&&"_st2"!==this._st&&"_st3"!==this._st&&(_._c_mc++,_._c_mc>1?_._c_mc=0:_._st=e)}map_collition(_){let e=this,t=_MAP.getMapX(_.x+e.imgsize),s=_MAP.getMapY(_.y);if(!_MAP.isMapBefore(t,s)){if(_MAP.isMapOver(t,s)){if("_st3"===e.get_missile_status(_))return void e.set_missile_status(_,"_st4");if("_st2"===e.get_missile_status(_))return}if("_st4"===e.get_missile_status(_)&&e.set_missile_status(_,"_st5"),"_st6"===e.get_missile_status(_)&&e.set_missile_status(_,"_st7"),"_st7"===e.get_missile_status(_)&&e.set_missile_status(_,"_st8"),"_st8"===e.get_missile_status(_)&&e.set_missile_status(_,"_st3"),"_st5"===e.get_missile_status(_)){if(t=_MAP.getMapX(_.x+e.imgsize),_MAP.isMapCollision(t,s+1))return void e.set_missile_status(_,"_st6");e.set_missile_status(_,"_st2")}if("_st3"===e.get_missile_status(_)){if(function(){if(s=_MAP.getMapY(_.y+e.imgsize),!_MAP.isMapCollision(t,s))return!1;if(!1===_MAP.map_infinite){var i=parseInt(_.y/_MAP.t),a=_.y%_MAP.t<_MAP.t/2?i:i+1;_.y=a*_MAP.t}}(),t=_MAP.getMapX(_.x+e.imgsize/2),s=_MAP.getMapY(_.y+e.imgsize/2),_MAP.isMapCollision(t,s))return void _._init();if(!_MAP.isMapCollision(t+1,s+1))return void e.set_missile_status(_,"_st4");if(_MAP.isMapOver(t,s))return void e.set_missile_status(_,"_st4")}if("_st2"===e.get_missile_status(_)&&(s=_MAP.getMapY(_.y+e.imgsize+14),_MAP.isMapCollision(t,s)))e.set_missile_status(_,"_st6");else if("_st1"===e.get_missile_status(_)){if(s=_MAP.getMapY(_.y+e.imgsize+14),_MAP.isMapCollision(t+1,s))return void e.set_missile_status(_,"_st6");if(_MAP.isMapCollision(t,s))return void e.set_missile_status(_,"_st6")}}}collapse_missile(_,e){let t=this;if(_.x=_MAP.getX(_.x),e=e||-5,_._c>=5*t.col_mis.length)return void _._init();let s=parseInt(_._c/5);_._c_area=t.col_mis[s].scale,_CONTEXT.fillStyle=t.col_mis[s].fs,_CONTEXT.beginPath(),_CONTEXT.arc(_.x,_.y+e,t.col_mis[s].scale,0,2*Math.PI,!1),_CONTEXT.fill(),void 0!==this.col_mis[s-1]&&(_CONTEXT.fillStyle=t.col_mis[s-1].fs,_CONTEXT.beginPath(),_CONTEXT.arc(_.x,_.y+e,t.col_mis[s-1].scale,0,2*Math.PI,!1),_CONTEXT.fill()),_._c++}move(){let _=this,e=_.player;if(e.isalive()&&e.isshotflag()&&void 0!==e.x)for(let e=0;e<_.shots.length;e++){let t=_.shots[e];(t._shot||t._shot_alive)&&(t.y=_MAP.getShotY(t.y),t._c>0?_.collapse_missile(t,10):_GAME.isShotCanvasOut(t)?t._init():(_.mis_status[t._st](t),"_st1"===_.get_missile_status(t)&&_MAP.isMapCollision(_MAP.getMapX(t.x),_MAP.getMapY(t.y))?t._init():(_CONTEXT.drawImage(t._img,_.st[_.get_missile_status(t)],0,_.imgsize,_.imgsize,t.x,t.y,_.imgsize,_.imgsize),t._shot_alive=!0)))}}}class GameObject_SHOTS_MISSILE_PHOTOM extends GameObject_SHOTS_MISSILE{constructor(_){super(_);let e=this;this.st._st1=48,e.mis_status._st1=function(_){let t=e.player.getPlayerCenterPosition();var s;_.x=(s=_.x,_._shot_alive?s+4:t._x),_.y=function(e){return _._shot_alive?e+8:t._y}(_.y)}}enemy_collision(_,e){if(!this.player.isalive())return;if(!e._shot_alive)return;let t=_GAME.isSqCollision(this.imgsize/4+","+this.imgsize/4+","+3*this.imgsize/4+","+3*this.imgsize/4,e.x+","+e.y,_.shotColMap,_.x+","+_.y);t!==_IS_SQ_NOTCOL&&(e._c>0||(t!==_IS_SQ_COL_NONE?(_.collision(_SHOTTYPE_MISSILE),_.isalive()&&0===e._c&&(e._c=1)):0===e._c&&(e._c=1)))}}class GameObject_SHOTS_MISSILE_SPREADBOMB extends GameObject_SHOTS_MISSILE{constructor(_){super(_),this.col_mis=[{fs:"rgba(198,231,247,1)",scale:30},{fs:"rgba(54,115,255,1)",scale:40},{fs:"rgba(54,115,255,1)",scale:50},{fs:"rgba(54,115,255,1)",scale:60},{fs:"rgba(0,27,145,1)",scale:60},{fs:"rgba(0,27,145,1)",scale:60},{fs:"rgba(0,27,100,1)",scale:70}],this.st={_st1:72,_st2:96,_st3:0}}enemy_collision(_,e){let t=this;if(!t.player.isalive())return;if(!e._shot_alive)return;_.getEnemyCenterPosition();let s=function(){if(e._c>0){if(e._c%20!=0)return _IS_SQ_NOTCOL;let t=2*e._c_area;Math.sqrt(2);return _GAME.isSqCollision("0,0,"+t+","+t,parseInt(e.x-t/2)+","+parseInt(e.y-t/2),_.shotColMap,_.x+","+_.y)}return _GAME.isSqCollision(t.imgsize/4+","+t.imgsize/4+","+3*t.imgsize/4+","+3*t.imgsize/4,e.x+","+e.y,_.shotColMap,_.x+","+_.y)}();s!==_IS_SQ_NOTCOL&&(0===e._c&&(e._c=1),s!==_IS_SQ_COL_NONE&&_.collision(_SHOTTYPE_MISSILE))}map_collition(_){let e=_MAP.getMapX(_.x),t=_MAP.getMapY(_.y);(_MAP.isMapCollision(e,t)||_MAP.isMapCollision(e+1,t))&&this.collapse_missile(_,-25)}move(){let _=this,e=_.player;if(!e.isalive())return;if(!e.isshotflag())return;if(void 0===e.x)return;let t=e.getPlayerCenterPosition();for(let e=0;e<_.shots.length;e++){let i=_.shots[e];(i._shot||i._shot_alive)&&(i.y=_MAP.getShotY(i.y),i._c>0?_.collapse_missile(i):(i._t++,i.x=(s=i.x,i._shot_alive?s+4:t._x),i.y=function(_){return i._shot_alive?_+i._t*i._t/200:t._y-8}(i.y),i._st=i._t>20&&i._t<30?"_st2":i._t>30?"_st3":"_st1",_GAME.isShotCanvasOut(i)?i._init():(_CONTEXT.drawImage(i._img,_.st[_.get_missile_status(i)],0,_.imgsize,_.imgsize,i.x,i.y,_.imgsize,_.imgsize),i._shot_alive=!0)))}var s}}class GameObject_SHOTS_MISSILE_2WAY extends GameObject_SHOTS_MISSILE{constructor(_){super(_),this.st={_st1:72,_st2:96,_st3:0,_st4:120,_st5:144,_st6:168}}enemy_collision(_,e){if(!this.player.isalive())return;if(!e._shot_alive)return;let t=_GAME.isSqCollision("-10,-10,"+(this.imgsize+10)+","+(this.imgsize+10),e.x+","+e.y,_.shotColMap,_.x+","+_.y);t!==_IS_SQ_NOTCOL&&(e._c>0||(0===e._c&&(e._c=1),t!==_IS_SQ_COL_NONE&&_.collision(_SHOTTYPE_MISSILE)))}map_collition(_){let e=_MAP.getMapX(_.x),t=_MAP.getMapY(0===_.id?_.y:_.y+this.imgsize);_MAP.isMapCollision(e,t)&&0===_._c&&(_._c=1)}move(){let _=this,e=_.player;if(!e.isalive())return;if(!e.isshotflag())return;if(void 0===e.x)return;let t=e.getPlayerCenterPosition(),s=this.shots[0]._shot|this.shots[1]._shot,i=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(s||i){s&&!i&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let e=0;e<this.shots.length;e++){let s=this.shots[e];s._shot_alive&&(s.y=_MAP.getShotY(s.y),s._c>0?_.collapse_missile(s,10):(s._t+=1,s.x=(a=s.x,i?a+1:t._x),s.y=function(_){return 0===e?i?_+s._t*s._t/100*-1:t._y-20:i?_+s._t*s._t/100:t._y}(s.y),_GAME.isShotCanvasOut(s)?s._init():(s._st=0===e?s._t>20&&s._t<30?"_st5":s._t>30?"_st6":"_st4":s._t>20&&s._t<30?"_st2":s._t>30?"_st3":"_st1",_CONTEXT.drawImage(s._img,_.st[_.get_missile_status(s)],0,_.imgsize,_.imgsize,s.x,s.y,_.imgsize,_.imgsize),s._shot_alive=!0)))}var a}}}class GameObject_SHOTS_NORMAL extends GameObject_SHOTS{constructor(_){super(_),this.shots=new Array,this.speed=20;for(let _=0;_<_PLAYERS_SHOTS_MAX;_++)this.shots.push({sid:_SHOTTYPE_NORMAL,x:0,y:0,_img:_CANVAS_IMGS.shot1.obj,_audio:_CANVAS_AUDIOS.shot_normal,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._shot=!1,this._shot_alive=!1}})}map_collition(_){let e=_MAP.getMapX(_.x),t=_MAP.getMapY(_.y);if(_MAP.isMapCollision(e,t))return _._init(),void _MAP.setPlayersShotAbleCollision(e,t);_MAP.isMapCollision(e+1,t)&&(_._init(),_MAP.setPlayersShotAbleCollision(e+1,t))}move(){let _=this.player;if(!_.isalive())return;if(!_.isshotflag())return;let e=_.getPlayerCenterPosition();for(let _=0;_<this.shots.length;_++){let s=this.shots[_];if(!s._shot&&!s._shot_alive)continue;let i=this.speed;if(s.x=(t=s.x,s._shot_alive?t+i:e._x),s.y=function(_){return s._shot_alive?_:e._y}(s.y),s.y=_MAP.getShotY(s.y),_GAME.isShotCanvasOut(s)){s._init();continue}let a=_CANVAS_IMGS.shot1.obj;_CONTEXT.drawImage(a,s.x,s.y,a.width,a.height),s._shot_alive=!0}var t}}class GameObject_SHOTS_DOUBLE extends GameObject_SHOTS{constructor(_){super(_),this.shots=new Array,this.speed=30;for(let _=0;_<_PLAYERS_SHOTS_MAX;_++)this.shots.push({sid:_SHOTTYPE_DOUBLE,x:0,y:0,_img:0===_?_CANVAS_IMGS.shot1.obj:_CANVAS_IMGS.shot2.obj,_audio:_CANVAS_AUDIOS.shot_normal,_enemyid:null,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._enemyid=null,this._shot=!1,this._shot_alive=!1}})}enemy_collision(_){let e=this;if(!e.player.isalive())return;for(let t=0;t<e.shots.length;t++){let s=e.shots[t],i=_GAME.isSqCollision("-10,-10,10,10",s.x+","+s.y,_.shotColMap,_.x+","+_.y);i!==_IS_SQ_NOTCOL&&(i!==_IS_SQ_COL_NONE?_.isalive()&&(_.collision(_SHOTTYPE_DOUBLE),s._init()):s._init())}}map_collition(_){let e=_MAP.getMapX(_.x),t=_MAP.getMapY(_.y);if(_MAP.isMapCollision(e,t))return _._init(),void _MAP.setPlayersShotAbleCollision(e,t);_MAP.isMapCollision(e+1,t)&&(_._init(),_MAP.setPlayersShotAbleCollision(e+1,t))}move(){let _=this.player;if(!_.isalive())return;if(!_.isshotflag())return;let e=_.getPlayerCenterPosition(),t=this.shots[0]._shot|this.shots[1]._shot,s=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(t||s){t&&!s&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let _=0;_<this.shots.length;_++){let t=this.shots[_];t._shot_alive&&(t.x=(i=t.x,s?i+30:e._x),t.y=function(t){return 0===_?s?t:e._y:s?t-23:e._y-23}(t.y),t.y=_MAP.getShotY(t.y),_GAME.isShotCanvasOut(t)?t._init():(_CONTEXT.drawImage(t._img,t.x,t.y,t._img.width,t._img.height),t._shot_alive=!0))}var i}}}class GameObject_SHOTS_TAILGUN extends GameObject_SHOTS_DOUBLE{constructor(_){super(_)}map_collition(_){let e=_MAP.getMapX(_.x),t=_MAP.getMapY(_.y);if(_MAP.isMapCollision(e,t))return _._init(),void _MAP.setPlayersShotAbleCollision(e,t);_MAP.isMapCollision(e-1,t)&&(_._init(),_MAP.setPlayersShotAbleCollision(e-1,t))}move(){let _=this.player;if(!_.isalive())return;if(!_.isshotflag())return;let e=_.getPlayerCenterPosition(),t=this.shots[0]._shot|this.shots[1]._shot,s=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(t||s){t&&!s&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let _=0;_<this.shots.length;_++){let t=this.shots[_];if(!t._shot_alive)continue;if(t.x=(i=t.x,0===_?s?i+30:e._x:s?i-30:e._x),t.y=function(_){return s?_:e._y}(t.y),t.y=_MAP.getShotY(t.y),_GAME.isShotCanvasOut(t)){t._init();continue}let a=0===_?_CANVAS_IMGS.shot1.obj:_CANVAS_IMGS.shot3.obj;_CONTEXT.drawImage(a,t.x,t.y,a.width,a.height),t._shot_alive=!0}var i}}}class GameObject_SHOTS_RIPPLE_LASER extends GameObject_SHOTS{constructor(_){super(_),this.shots=new Array,this.speed=30,this.lineWidth_1=3,this.strokeStyle_1="rgba(40,70,255,1)",this.lineWidth_2=4,this.strokeStyle_2="rgba(100,180,255,0.7)";for(let _=0;_<_PLAYERS_SHOTS_MAX;_++)this.shots.push({sid:_SHOTTYPE_LASER,x:0,y:0,_t:0,_shot:!1,_shot_alive:!1,_width:0,_height:0,_audio:_CANVAS_AUDIOS.shot_ripple,_init:function(){this.x=0,this.y=0,this._t=0,this._shot=!1,this._shot_alive=!1,this._width=0,this._height=0}})}enemy_collision(_){if(this.player.isalive())for(let e=0;e<this.shots.length;e++){let t=this.shots[e];if(!t._shot_alive)continue;if(_.isIgnore())continue;if(_.isIgnoreCollision())continue;let s=_GAME.isSqCollision("0,-20,"+t._width+","+(2*t._height+20),t.x+","+(t.y-t._height),_.shotColMap,_.x+","+_.y);s!==_IS_SQ_NOTCOL&&(s===_IS_SQ_COL&&(_.collision(_SHOTTYPE_RIPPLE_LASER),function(){let _=_ENEMIES;for(let e=0;e<_.length;e++){let s=_[e];s.isIgnore()||s.isalive()&&s.isshow()&&(s.isIgnoreCollision()||_GAME.isSqCollision("0,0,"+t._width+","+2*t._height,t.x+","+(t.y-t._height),s.shotColMap,s.x+","+s.y)===_IS_SQ_COL&&s.collision(_SHOTTYPE_RIPPLE_LASER))}}()),t._init())}}map_collition(_){let e=_MAP.getMapX(_.x),t=_MAP.getMapY(_.y);if(_MAP.isMapCollision(e,t)||_MAP.isMapCollision(e+1,t)){let s=parseInt(_._height/_MAP.t/2);for(let _=t-s;_<=t+s;_++)_MAP.isMapCollision(e+1,_)&&_MAP.setPlayersShotAbleCollision(e+1,_);_._init()}}move(){let _=this,e=_.player;if(!e.isalive())return;if(!e.isshotflag())return;let t=e.getPlayerCenterPosition();for(let e=0;e<_.shots.length;e++){let i=_.shots[e];if(!i._shot&&!i._shot_alive)continue;let a=_.speed;i.x=(s=i.x,i._shot_alive?s+a:t._x),i.y=function(_){return i._shot_alive?_:t._y}(i.y),i.y=_MAP.getShotY(i.y),_GAME.isShotCanvasOut(i)?i._init():(i._t=i._t<20?i._t+1:i._t,i._width=.4+i._t,i._height=8+i._t*i._t/6,_CONTEXT.beginPath(),_CONTEXT.lineWidth=_.lineWidth_2,_CONTEXT.strokeStyle=_.strokeStyle_2,_CONTEXT.ellipse(i.x+1,i.y+1,i._width,i._height,0,0,2*Math.PI),_CONTEXT.stroke(),_CONTEXT.beginPath(),_CONTEXT.lineWidth=_.lineWidth_1,_CONTEXT.strokeStyle=_.strokeStyle_1,_CONTEXT.ellipse(i.x,i.y,i._width,i._height,0,0,2*Math.PI),_CONTEXT.stroke(),i._shot_alive=!0)}var s}}class GameObject_SHOTS_RIPPLE_LASER_RED extends GameObject_SHOTS_RIPPLE_LASER{constructor(_){super(_),this.strokeStyle_1="rgba(255,80,50,1)",this.strokeStyle_2="rgba(255,180,100,0.7)"}}class GameObject_SHOTS_LASER extends GameObject_SHOTS{constructor(_){super(_);let e=this;e.shots=new Array,e.speed=50,e.lineWidth=3,e.strokeStyle="rgba(50,80,255,1)",e.strokeStyle_u="rgba(120,150,255,1)",e.img_col=_CANVAS_IMGS.shot_laser_col.obj,e.imgsize_col=e.img_col.height,e.width_col=e.imgsize_col,e.height_col=e.imgsize_col,e.img_col_ani=[0,25];for(let _=0;_<1;_++)e.shots.push({sid:_SHOTTYPE_LASER,x:0,y:0,_c_col:0,laser_time:500,_sx:0,_enemy:null,_laser_t:0,_laser_ts:0,_laser_MaxX:_CANVAS.width,_l_x:0,_l_sx:0,_shot:!1,_shot_alive:!1,_audio:_CANVAS_AUDIOS.shot_laser,_init:function(){this.x=0,this.y=0,this._c_col=0,this._laser_t=0,this._laser_ts=0,this._sx=0,this._enemy=null,this._l_x=0,this._l_sx=0,this._laser_MaxX=_CANVAS.width,this._shot=!1,this._shot_alive=!1}})}laser_collision(_,e){_._laser_MaxX>=_CANVAS.width||(_._c_col=_._c_col>=this.img_col_ani.length-1?0:_._c_col+1,_CONTEXT.drawImage(this.img_col,this.img_col_ani[_._c_col],0,this.imgsize_col,this.imgsize_col,(e||_._l_x)-this.width_col,_.y-this.img_col.height/2,this.imgsize_col,this.imgsize_col))}enemy_collision(_){if(this.player.isalive())for(let e=0;e<this.shots.length;e++){if(_.x<this.player.x)continue;let t=this.shots[e];if(!t._shot_alive)continue;let s=_GAME.isSqCollision_laser("0,-6,"+parseInt(t._l_x-t._l_sx)+",6",t._l_sx+","+t.y,_.shotColMap,_.x+","+_.y);return s.ret===_IS_SQ_NOTCOL?s.val:s.ret===_IS_SQ_COL_NONE?s.val:(_.collision(_SHOTTYPE_LASER),_.isalive()?s.val:_CANVAS.width)}}map_collition(_){let e=this;if(!_._shot_alive)return;e.player.getPlayerCenterPosition();let t=_MAP.getMapX(_._l_x),s=_MAP.getMapY(_.y);(_MAP.isMapCollision(t,s)||_MAP.isMapCollision(t-1,s))&&e.setLaserMaxX(_,_MAP.getMapXToPx(t));for(let e=_MAP.getMapX(_._l_sx)+1;e<=t;e++)_MAP.isMapCollision(e,s)&&_MAP.setPlayersShotAbleCollision(e,s,_SHOTTYPE_LASER)}setLaserLine(_,e,t){_._l_x=e,_._l_sx=t}setLaserMaxX(_,e){_._laser_MaxX=e}move(){let _=this,e=_.player;if(!e.isalive())return;if(!e.isshotflag())return;let t=e.getPlayerCenterPosition();_CONTEXT.beginPath(),_CONTEXT.lineWidth=_.lineWidth,_CONTEXT.strokeStyle=_.strokeStyle,_CONTEXT.lineCap="round";for(let e=0;e<_.shots.length;e++){let i=_.shots[e];if(!i._shot&&!i._shot_alive)continue;if(i.x=(s=i.x)>=i._laser_MaxX-t._x?(i._laser_t+=1e3/_FPS,i._laser_MaxX-t._x):s+_.speed,i._sx=function(e){return i._shot?i._laser_t<=i.laser_time-200?e:(i._laser_ts+=1e3/_FPS,i._laser_ts>i.laser_time-200?(i._init(),0):e>=i.x?i.x:e+_.speed):e>=i.x?(i._init(),0):e+_.speed}(i._sx),i.y=t._y,i.x<i._sx||Math.abs(i.x-i._sx)<50)continue;let a=t._x;_CONTEXT.beginPath(),_CONTEXT.strokeStyle=_.strokeStyle_u,_CONTEXT.moveTo(a+i._sx,t._y+1),_CONTEXT.lineTo(a+i.x,t._y+1),_CONTEXT.stroke(),_CONTEXT.beginPath(),_CONTEXT.strokeStyle=_.strokeStyle,_CONTEXT.moveTo(a+i._sx,t._y),_CONTEXT.lineTo(a+i.x,t._y),_CONTEXT.stroke(),_.setLaserLine(i,a+i.x,a+i._sx),_.laser_collision(i,a+i.x),i.x>0&&(i._shot_alive=!0)}var s}}class GameObject_SHOTS_LASER_CYCLONE extends GameObject_SHOTS_LASER{constructor(_){super(_);this.lineWidth=5,this.strokeStyle="rgba(255,80,50,1)",this.strokeStyle_u="rgba(255,200,150,1)",this.img_col_ani=[50,75]}}const _DEF_DIFFICULT=[{_ENEMY_SHOT_RATE:1e-4,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:5e-4,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.002,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.005,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.01,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:2}];let _ENEMY_DIFFICULT=4;const _ENEMY_DEF_ANI_COL={t0:{intv:5,img:_CANVAS_IMGS.enemy_collapes0.obj},t1:{intv:5,img:_CANVAS_IMGS.enemy_collapes1.obj},t2:{intv:5,img:_CANVAS_IMGS.enemy_collapes2.obj},t8:{intv:5,img:_CANVAS_IMGS.enemy_collapes8.obj},t9:{intv:5,img:_CANVAS_IMGS.enemy_collapes9.obj}};class GameObject_ENEMY_COLLISION{constructor(_,e,t){this._c_anime_collosion=0,this.x=_||0,this.y=e||0,this.type=t||"t0",this._status=!0}isalive(){return this._status}move(){let _=this,e=_ENEMY_DEF_ANI_COL[_.type].img,t=_ENEMY_DEF_ANI_COL[_.type].intv,s=parseInt(e.width/e.height);if(_._c_anime_collosion>=s*t-1)_._status=!1;else{var i=e.height;_.x=_MAP.getX(_.x),_.y=_MAP.getY(_.y),_CONTEXT.drawImage(e,i*parseInt(_._c_anime_collosion/t),0,i,i,_.x-i/2,_.y-i/2,i,i),_._c_anime_collosion++}}}let _MAPDEFS="",_MAPDEF="",_MAP_PETTERN=3,_BACKGROUND_SPEED=0,_MAP_SCROLL_POSITION_X=0,_MAP_SCROLL_POSITION_Y=0;const _MAP_ENEMIES={_DEF_DIR:{_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},_setDir:function(_,e){let t=_MAP.isMapCollision(_,e-1)?this._DEF_DIR._U:this._DEF_DIR._D;return t=_MAP.isMapCollision(_,e+1)?this._DEF_DIR._D:this._DEF_DIR._U},_ENEMIES:{a:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_a(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_a_1},b:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_b(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_b_1},c:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_c(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_c_1},d:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_d(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_d_1},e:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_e(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_e_1},f:{_gamestart:function(_,e,t){t=e<_CANVAS.height/2?_MAP_ENEMIES._DEF_DIR._U:_MAP_ENEMIES._DEF_DIR._D,_ENEMIES.push(new ENEMY_f(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_f_1},g:{_gamestart:function(_,e,t){t=e<_CANVAS.height/2?_MAP_ENEMIES._DEF_DIR._U:_MAP_ENEMIES._DEF_DIR._D,_ENEMIES.push(new ENEMY_g(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_g_1},m:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_m(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_m_1},n:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_n(_,e))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_o_1},o:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_o(_,e))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_o_1},p:{_gamestart:function(_,e,t){let s=new ENEMY_p(_,e);_ENEMIES.push(s)},_st:"",_s:"000,000,000",_o:_CANVAS_IMGS.enemy_p_1},z:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_FAN(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_fan}}},_MAP_ENEMIES_BOSS={enemy_cristalcore:{_f:function(){return new ENEMY_BOSS_CRYSTALCORE(700,800)}},enemy_bigcore:{_f:function(){return new ENEMY_BOSS_BIGCORE(_CANVAS.width+200,200)}},enemy_cristalcore_pt2:{_f:function(){return new ENEMY_BOSS_CRYSTALCORE_PT2(700,800)}},enemy_bigcore2:{_f:function(){return new ENEMY_BOSS_BIGCORE2(_CANVAS.width+200,200)}},enemy_frame:{_f:function(){return new ENEMY_BOSS_FRAME(1e3,200)}},enemy_cell:{_f:function(){return new ENEMY_BOSS_CELL(_CANVAS.width+200,200)}}},_MAP_THEME={_THEME1:{_map:{A:{_o:(new MAP_CRISTAL).img,_s:(new MAP_CRISTAL)._s,_gamestart:function(_){this.objs[_]=new MAP_CRISTAL},objs:{},_obj:new MAP_CRISTAL}},_enemies:_MAP_ENEMIES._ENEMIES},_THEME2:{_map:{A:{_o:(new MAP_VOLCANO_A).img,_s:(new MAP_VOLCANO_A)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_A},objs:{},_obj:new MAP_VOLCANO_A},B:{_o:(new MAP_VOLCANO_B).img,_s:(new MAP_VOLCANO_B)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_B},objs:{},_obj:new MAP_VOLCANO_B},C:{_o:(new MAP_VOLCANO_C).img,_s:(new MAP_VOLCANO_C)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_C},objs:{},_obj:new MAP_VOLCANO_C},D:{_o:(new MAP_VOLCANO_D).img,_s:(new MAP_VOLCANO_D)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_D},objs:{},_obj:new MAP_VOLCANO_D},F:{_o:(new MAP_VOLCANO_F).img,_s:(new MAP_VOLCANO_F)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_F},objs:{},_obj:new MAP_VOLCANO_F},G:{_o:(new MAP_VOLCANO_G).img,_s:(new MAP_VOLCANO_G)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_G},objs:{},_obj:new MAP_VOLCANO_G},H:{_o:(new MAP_VOLCANO_H).img,_s:(new MAP_VOLCANO_H)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_H},objs:{},_obj:new MAP_VOLCANO_H},I:{_o:(new MAP_VOLCANO_I).img,_s:(new MAP_VOLCANO_I)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_I},objs:{},_obj:new MAP_VOLCANO_I},J:{_o:(new MAP_VOLCANO_J).img,_s:(new MAP_VOLCANO_J)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_J},objs:{},_obj:new MAP_VOLCANO_J},K:{_o:(new MAP_VOLCANO_K).img,_s:(new MAP_VOLCANO_K)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_K},objs:{},_obj:new MAP_VOLCANO_K},L:{_o:(new MAP_VOLCANO_L).img,_s:(new MAP_VOLCANO_L)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_L},objs:{},_obj:new MAP_VOLCANO_L},M:{_o:(new MAP_VOLCANO_M).img,_s:(new MAP_VOLCANO_M)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_M},objs:{},_obj:new MAP_VOLCANO_M},N:{_o:(new MAP_VOLCANO_N).img,_s:(new MAP_VOLCANO_N)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_N},objs:{},_obj:new MAP_VOLCANO_N},O:{_o:(new MAP_VOLCANO_O).img,_s:(new MAP_VOLCANO_O)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_O},objs:{},_obj:new MAP_VOLCANO_O},P:{_o:(new MAP_VOLCANO_P).img,_s:(new MAP_VOLCANO_P)._s,_gamestart:function(_){this.objs[_]=new MAP_VOLCANO_P},objs:{},_obj:new MAP_VOLCANO_P}},_enemies:_MAP_ENEMIES._ENEMIES},_THEME3:{_map:{A:{_o:(new MAP_CUBE_A).img,_s:(new MAP_CUBE_A)._s,_gamestart:function(_){this.objs[_]=new MAP_CUBE_A},objs:{},_obj:new MAP_CUBE_A}},_enemies:_MAP_ENEMIES._ENEMIES},_THEME5:{_map:{B:{_o:(new MAP_MOAI_A).img,_s:(new MAP_MOAI_A)._s,_gamestart:function(_){this.objs[_]=new MAP_MOAI_A},objs:{},_obj:new MAP_MOAI_A},C:{_o:(new MAP_MOAI_B).img,_s:(new MAP_MOAI_B)._s,_gamestart:function(_){this.objs[_]=new MAP_MOAI_B},objs:{},_obj:new MAP_MOAI_B}},_enemies:{a:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_a(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_a_1},b:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_b(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_b_1},c:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_c(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_c_1},d:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_d(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_d_1},e:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_e(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_e_1},f:{_gamestart:function(_,e,t){t=e<_CANVAS.height/2?_MAP_ENEMIES._DEF_DIR._U:_MAP_ENEMIES._DEF_DIR._D,_ENEMIES.push(new ENEMY_f(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_f_1},g:{_gamestart:function(_,e,t){t=e<_CANVAS.height/2?_MAP_ENEMIES._DEF_DIR._U:_MAP_ENEMIES._DEF_DIR._D,_ENEMIES.push(new ENEMY_g(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_g_1},m:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_m(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_m_1},l:{_gamestart:function(_,e,t){let s=new ENEMY_q(_,e,_MAP_ENEMIES._DEF_DIR._U);_ENEMIES.push(s)},_st:"transform:scale(1,-1);",_s:"1111,0110,0011,0000",_o:_CANVAS_IMGS.enemy_m_a_1},n:{_gamestart:function(_,e,t){let s=new ENEMY_q(_,e,_MAP_ENEMIES._DEF_DIR._D);_ENEMIES.push(s)},_st:"",_s:"0000,0011,0110,1111",_o:_CANVAS_IMGS.enemy_m_a_1},o:{_gamestart:function(_,e,t){let s=new ENEMY_r(_,e,_MAP_ENEMIES._DEF_DIR._U);_ENEMIES.push(s)},_st:"transform:scale(1,-1);",_s:"1111,0010,0000,0000",_o:_CANVAS_IMGS.enemy_m_b_1},p:{_gamestart:function(_,e,t){let s=new ENEMY_r(_,e,_MAP_ENEMIES._DEF_DIR._D);_ENEMIES.push(s)},_st:"",_s:"0000,0000,0010,1111",_o:_CANVAS_IMGS.enemy_m_b_2},q:{_gamestart:function(_,e,t){let s=new ENEMY_q(_,e,_MAP_ENEMIES._DEF_DIR._LD);_ENEMIES.push(s)},_st:"transform:scale(-1,1);",_s:"0000,1100,1110,1111",_o:_CANVAS_IMGS.enemy_m_a_1},r:{_gamestart:function(_,e,t){let s=new ENEMY_q(_,e,_MAP_ENEMIES._DEF_DIR._LU);_ENEMIES.push(s)},_st:"transform:scale(-1,-1);",_s:"1111,1110,1100,0000",_o:_CANVAS_IMGS.enemy_m_a_1},z:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_FAN(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_fan}}},_THEME6:{_map:{A:{_o:(new MAP_FRAME_A).img,_s:(new MAP_FRAME_A)._s,_gamestart:function(_){this.objs[_]=new MAP_FRAME_A},objs:{},_obj:new MAP_FRAME_A},B:{_o:(new MAP_FRAME_B).img,_s:(new MAP_FRAME_B)._s,_gamestart:function(_){this.objs[_]=new MAP_FRAME_B},objs:{},_obj:new MAP_FRAME_B},C:{_o:(new MAP_FRAME_C).img,_s:(new MAP_FRAME_C)._s,_gamestart:function(_){this.objs[_]=new MAP_FRAME_C},objs:{},_obj:new MAP_FRAME_C},D:{_o:(new MAP_FRAME_D).img,_s:(new MAP_FRAME_D)._s,_gamestart:function(_){this.objs[_]=new MAP_FRAME_D},objs:{},_obj:new MAP_FRAME_D},E:{_o:(new MAP_FRAME_E).img,_s:(new MAP_FRAME_E)._s,_gamestart:function(_){this.objs[_]=new MAP_FRAME_E},objs:{},_obj:new MAP_FRAME_E},F:{_o:(new MAP_FRAME_F).img,_s:(new MAP_FRAME_F)._s,_gamestart:function(_){this.objs[_]=new MAP_FRAME_F},objs:{},_obj:new MAP_FRAME_F}},_enemies:{a:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_frame_1(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_frame_1},d:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_d(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_d_1},e:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_e(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_e_1},z:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_FAN(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_fan}}},_THEME7:{_map:{A:{_o:(new MAP_CELL_A).img,_s:(new MAP_CELL_A)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_A},objs:{},_obj:new MAP_CELL_A},B:{_o:(new MAP_CELL_B).img,_s:(new MAP_CELL_B)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_B},objs:{},_obj:new MAP_CELL_B},C:{_o:(new MAP_CELL_C).img,_s:(new MAP_CELL_C)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_C},objs:{},_obj:new MAP_CELL_C},D:{_o:(new MAP_CELL_D).img,_s:(new MAP_CELL_D)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_D},objs:{},_obj:new MAP_CELL_D},G:{_o:(new MAP_CELL_G).img,_s:(new MAP_CELL_G)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_G},objs:{},_obj:new MAP_CELL_G},H:{_o:(new MAP_CELL_H).img,_s:(new MAP_CELL_H)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_H},objs:{},_obj:new MAP_CELL_H},I:{_o:(new MAP_CELL_I).img,_s:(new MAP_CELL_I)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_I},objs:{},_obj:new MAP_CELL_I},J:{_o:(new MAP_CELL_J).img,_s:(new MAP_CELL_J)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_J},objs:{},_obj:new MAP_CELL_J},K:{_o:(new MAP_CELL_K).img,_s:(new MAP_CELL_K)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_K},objs:{},_obj:new MAP_CELL_K},L:{_o:(new MAP_CELL_L).img,_s:(new MAP_CELL_L)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_L},objs:{},_obj:new MAP_CELL_L},M:{_o:(new MAP_CELL_M).img,_s:(new MAP_CELL_M)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_M},objs:{},_obj:new MAP_CELL_M},N:{_o:(new MAP_CELL_N).img,_s:(new MAP_CELL_N)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_N},objs:{},_obj:new MAP_CELL_N},O:{_o:(new MAP_CELL_O).img,_s:(new MAP_CELL_O)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_O},objs:{},_obj:new MAP_CELL_O},V:{_o:(new MAP_CELL_V).img,_s:(new MAP_CELL_V)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_V},objs:{},_obj:new MAP_CELL_V},W:{_o:(new MAP_CELL_W).img,_s:(new MAP_CELL_W)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_W},objs:{},_obj:new MAP_CELL_W},Y:{_o:(new MAP_CELL_Y).img,_s:(new MAP_CELL_Y)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_Y},objs:{},_obj:new MAP_CELL_Y},Z:{_o:(new MAP_CELL_Z).img,_s:(new MAP_CELL_Z)._s,_gamestart:function(_){this.objs[_]=new MAP_CELL_Z},objs:{},_obj:new MAP_CELL_Z}},_enemies:{a:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_cell_core(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_cell_core},b:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_CELL_A(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_cell_a_1},c:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_CELL_B(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_cell_b_1},d:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_d(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_d_1},e:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_e(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_e_1},z:{_gamestart:function(_,e,t){_ENEMIES.push(new ENEMY_FAN(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_fan}}}};class GameObject_MAP{constructor(_){this.pt=_||0,this.initx=0,this.inity=0,this.x=this.initx,this.y=this.inity,this.collision=new RegExp("[1A-Z]"),this.collision_enemies=new RegExp("[a-z]","g"),this.collision_map=new RegExp("[A-Z]"),this.collision_map_d=new RegExp("[BD]"),this.t=25,this.mapdef=new Array,this.mapdef_col=new Array,this.map_theme=0,this.map_pettern=0,this.map_difficult=0,this.map_background_speed=0,this.map_backgroundY_speed=0,this.map_infinite=!1,this.map_bgmusic="",this.map_boss="",this.isboss=!1}init(_){_AJAX("./gradius_map.json","json",function(e){_MAPDEFS=e,_()})}setInifinite(_){this.map_infinite=_}set_stage_map_pattern(_){this.map_pettern=_}set_gamestart(){this.map_backgroundY_speed=0,this.x=parseInt(_MAPDEFS[this.map_pettern]._initx),this.y=this.inity,this.initx=parseInt(_MAPDEFS[this.map_pettern]._initx),this.mapdef=_MAPDEFS[this.map_pettern]._map,this.map_difficult=parseInt(_MAPDEFS[this.map_pettern]._difficult)-1,_ENEMY_DIFFICULT=_ISDEBUG?_ENEMY_DIFFICULT:parseInt(_MAPDEFS[this.map_pettern]._difficult)-1,this.map_background_speed=parseInt(_MAPDEFS[this.map_pettern]._speed),_BACKGROUND_SPEED=parseInt(_MAPDEFS[this.map_pettern]._speed),_MAP_PETTERN=this.map_pettern,this.map_theme=_MAPDEFS[this.map_pettern]._theme,this.map_infinite="true"===_MAPDEFS[this.map_pettern]._map_infinite,this.map_bgmusic=_MAPDEFS[this.map_pettern]._bgmusic,this.map_boss=_MAPDEFS[this.map_pettern]._boss,this.isboss=!1,this.set_gamestart_mapdef_col(),this.set_gamestart_map_theme_objs()}set_gamestart_map_theme_objs(){let _=this;for(let e=0;e<_.mapdef.length;e++){let t=_.mapdef[e];for(let s=0;s<t.length;s++)if(_.isEnemiesBit(t[s])){let i=_MAP_ENEMIES._setDir(s,e);_MAP_THEME[_.map_theme]._enemies[t[s]]._gamestart(_.x+s*_.t,e*_.t,i)}else _.isCollisionBit(t[s])&&_MAP_THEME[_.map_theme]._map[t[s]]._gamestart(s+","+e)}}set_gamestart_mapdef_col(){let _=this;Object.assign(_.mapdef_col,_.mapdef);for(let e=0;e<_.mapdef_col.length;e++)_.mapdef_col[e]=_.mapdef_col[e].replace(/[a-zA-Z]/gi,"0");for(let s=0;s<_.mapdef.length;s++){let i=_.mapdef[s];for(let a=0;a<i.length;a++){if(null===i[a].match(/[A-Za-z]/))continue;let n=_.isEnemiesBit(i[a])?_MAP_THEME[_.map_theme]._enemies[i[a]]:_MAP_THEME[_.map_theme]._map[i[a]];void 0===n&&console.log("テーマ:"+_.map_theme+"に対して "+i[a]+"の定義がありません。");let o=n._s.split(",");for(let n=0;n<o.length;n++){let E=_.mapdef_col[s+n],l=_.mapdef[s+n];_.mapdef_col[s+n]=E.substr(0,a)+(l.substr(a,o[n].length),e=E.substr(a,o[n].length),t=o[n],_.setCollisionBit(t,e))+E.substr(a+o[n].length,i.length)}}}var e,t}set_mapdef_col(_,e,t){let s=this;if(void 0===_||void 0===e||void 0===t)return;let i=t.split(",");for(let t=0;t<i.length;t++){let a=s.mapdef_col[e+t];s.mapdef_col[e+t]=a.substr(0,_)+i[t]+a.substr(_+i[t].length)}}getX(_){return _+-1*_BACKGROUND_SPEED}getY(_){return this.map_infinite?_-_MAP.map_backgroundY_speed<-250?750+(250+_-_MAP.map_backgroundY_speed):_-_MAP.map_backgroundY_speed>750?-250-(750-_+_MAP.map_backgroundY_speed):(_-_MAP.map_backgroundY_speed)%1e3:_}getShotY(_){return _-_MAP.map_backgroundY_speed}setCollisionBit(_,e){let t="";for(let s=0;s<_.length;s++)"0"!==_[s]?t+="1":t+=e[s];return t}getCollisionFlag(){return this.collision}setBackGroundSpeedY(_){this.map_backgroundY_speed=_}getBackGroundSpeed(){return this.map_background_speed}getBackGroundSpeedY(){return this.map_backgroundY_speed}get_stage_map_pattern(_){return this.map_pettern}getMapXToPx(_){return _*this.t+this.initx-_MAP_SCROLL_POSITION_X}getMapYToPx(_){return _}getMapX(_){return Math.floor((_+_MAP_SCROLL_POSITION_X-this.initx)/this.t)}getMapY(_,e){return!0===e&&(console.log("_y:"+_),console.log("_MAP_SCROLL_POSITION_Y:"+_MAP_SCROLL_POSITION_Y)),Math.floor((_+_MAP_SCROLL_POSITION_Y)%1e3/this.t)}isCollisionBit(_){return null!==_.match(this.collision)}isEnemiesBit(_){return null!==_.match(this.collision_enemies)}isMapDouble(_){return null!==_.match(this.collision_map_d)}isMapBefore(_,e){return _<0}isMapLastSide(_,e){return void 0!==this.mapdef[e]&&(void 0===this.mapdef[e][_]||_===this.mapdef[e].length-1)}isMapOver(_,e){return void 0!==this.mapdef[e]&&(void 0===this.mapdef[e][_]||_>this.mapdef[e].length-1)}isMapCollision(_,e){return void 0!==this.mapdef_col[e]&&(void 0!==this.mapdef_col[e][_]&&!!this.isCollisionBit(this.mapdef_col[e][_]))}setPlayersShotAbleCollision(_,e,t){let s=_MAP_THEME[this.map_theme]._map;if(void 0===s)return;let i=this.mapdef[e][_];if(void 0===s[i])return;let a=s[i].objs[_+","+e];void 0!==a&&a.is_able_collision&&a.collision(t)}isPlayersShotCollision(){for(let _=0;_<_PLAYERS_SHOTS[_SHOTTYPE].length;_++){let e=_PLAYERS_SHOTS[_SHOTTYPE][_];for(let _=0;_<e.shots.length;_++){let t=e.shots[_];t._shot_alive&&e.map_collition(t)}}for(let _=0;_<_PLAYERS_MISSILE.length;_++){let e=_PLAYERS_MISSILE[_];if(e.player.isalive())for(let _=0;_<e.shots.length;_++){let t=e.shots[_];t._shot_alive&&(t._c>0||e.map_collition(t))}}}show(){}showMapForStageselect(_){let e=this;if(null==_)return;let t=_._map.length;for(let s=0;s<(t>20?20:t);s++){let t=_._map[s].length;for(let i=0;i<(t>30?30:t);i++){let t=_._map[s][i+20];if(void 0!==t&&"0"!==t)if(null!==t.match(e.collision_enemies)){let e=_MAP_THEME[_._theme]._enemies[t]._o.obj;_CONTEXT.drawImage(e,50+10*i,130+10*s,e.width/2.5,e.height/2.5)}else{let e=_MAP_THEME[_._theme]._map[t];e._o.obj;_CONTEXT.save(),_CONTEXT.translate(50+10*i,130+10*s),_CONTEXT.scale(.25,.25),_CONTEXT.drawImage(e._obj.img,e._obj.imgPos[0],0,e._obj.width,e._obj.height,0,0,1.6*e._obj.width,1.6*e._obj.height),_CONTEXT.restore()}}}_CONTEXT.fillStyle="rgba(0,0,0,1)",_CONTEXT.fillRect(350,130,500,500),_CONTEXT.fillRect(50,330,500,500)}map_draw(){let _=this;for(let e=0;e<_.mapdef.length;e++)for(let t=0;t<_.mapdef[e].length;t++){let s=_.mapdef[e][t];if(!_.isCollisionBit(s))continue;if(_.x+t*_.t<-500||_.x+t*_.t>_CANVAS.width+100)continue;let i=_MAP_THEME[_.map_theme]._map[s];i.objs[t+","+e].moveDraw(_.x+t*_.t,_.y+e*_.t),_.map_infinite&&i.objs[t+","+e].moveDraw(_.x+t*_.t,_.y+e*_.t+(_.y>0?-1e3:1e3))}}set_mapdef_col_clear(){let _=this;for(let e=0;e<_.mapdef_col.length;e++){let t=_.mapdef_col[e];_.mapdef_col[e]=t.replace(/1/gi,"0")}}set_scroll_on_x(){_BACKGROUND_SPEED=this.map_background_speed}set_scroll_off_x(){_BACKGROUND_SPEED=0}move(){let _=this;_MAP_SCROLL_POSITION_X+_CANVAS.width>_.mapdef[0].length*_.t+_.initx&&(_.isboss=!0),_MAP_SCROLL_POSITION_X-100>_.mapdef[0].length*_.t+_.initx&&(_BACKGROUND_SPEED=0),_.x+=-1*_BACKGROUND_SPEED,_MAP_SCROLL_POSITION_X+=_BACKGROUND_SPEED,_.y=_.getY(_.y),_MAP_SCROLL_POSITION_Y=function(){let e=_MAP_SCROLL_POSITION_Y+_.map_backgroundY_speed;return e<0?(1e3+e)%1e3:e%1e3}()}}const _AJAX=function(_,e,t,s){let i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&(200===i.status?(console.log("OK"),t(i.response,s)):console.log("NG"))},i.open("GET",_+"?date="+(new Date).getTime()),i.responseType=e||"json",i.send(null)},_KEYEVENT_MASTER={addKeydownStart:function(){_ISSP?_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_start):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_start)},removeKeydownStart:function(){_ISSP?_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_start):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_start)},addKeydownSelectStage:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.addEventListener("touchmove",_KEYEVENT_SP.keymove_select_stage),_SP_CONTROLLER._sp_main_center.addEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_stage),_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_stage_a)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_stage)},removeKeydownSelectStage:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.removeEventListener("touchmove",_KEYEVENT_SP.keymove_select_stage),_SP_CONTROLLER._sp_main_center.removeEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_stage),_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_stage_a),_SP_CONTROLLER._set_reset()):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_stage)},addKeydownSelectPowermeter:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.addEventListener("touchmove",_KEYEVENT_SP.keymove_select_powermeter),_SP_CONTROLLER._sp_main_center.addEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_powermeter),_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_powermeter_a)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_powermeter)},removeKeydownSelectPowermeter:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.removeEventListener("touchmove",_KEYEVENT_SP.keymove_select_powermeter),_SP_CONTROLLER._sp_main_center.removeEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_powermeter),_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_powermeter_a),_SP_CONTROLLER._set_reset()):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_powermeter)},addKeydownGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_hide.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_hide),_SP_CONTROLLER._sp_bt_r.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_r),_SP_CONTROLLER._sp_bt_p.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_p),_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_s),_SP_CONTROLLER._sp_bt_b.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_b),_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_a),_SP_CONTROLLER._sp_main_center.addEventListener("touchstart",_KEYEVENT_SP.keymove_game_controller),_SP_CONTROLLER._sp_main_center.addEventListener("touchmove",_KEYEVENT_SP.keymove_game_controller)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_game)},addKeyupGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyup_game_a),_SP_CONTROLLER._sp_main_center.addEventListener("touchend",_KEYEVENT_SP.keyend_game_controller),_SP_CONTROLLER._set_reset()):document.addEventListener(_EVENT_KEYUP,_KEYEVENT.keyup_game)},removeKeydownGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_hide.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_hide),_SP_CONTROLLER._sp_bt_r.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_r),_SP_CONTROLLER._sp_bt_p.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_p),_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_s),_SP_CONTROLLER._sp_bt_b.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_b),_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_a),_SP_CONTROLLER._sp_main_center.removeEventListener("touchstart",_KEYEVENT_SP.keymove_game_controller),_SP_CONTROLLER._sp_main_center.removeEventListener("touchmove",_KEYEVENT_SP.keymove_game_controller)):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_game)},removeKeyupGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyup_game_a),_SP_CONTROLLER._sp_main_center.removeEventListener("touchend",_KEYEVENT_SP.keyend_game_controller),_SP_CONTROLLER._set_reset()):document.removeEventListener(_EVENT_KEYUP,_KEYEVENT.keyup_game)},addKeydownGameclear:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_r),_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_s),_SP_CONTROLLER._sp_bt_p.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_p)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameclear)},removeKeydownGameclear:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_r),_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_s),_SP_CONTROLLER._sp_bt_p.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_p)):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameclear)},addKeydownGameover:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_r),_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_s)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameover)},removeKeydownGameover:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_r),_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_s)):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameover)}},_KEYEVENT={keydown_start:function(_){"S"!==_.key&&"s"!==_.key||(document.querySelector("#game_start_wrapper .text").classList.add("on"),document.querySelector("#game_start_wrapper .text_loading").classList.add("on"),_DRAW_INIT(_CANVAS_IMGS,_DRAW_STAGE_SELECT),_GAME._setPlay(_CANVAS_AUDIOS.playerset))},keydown_select_powermeter:function(_){if(clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,"Enter"===_.key||"enter"===_.key)return _DRAW_SELECT_POWERMETER(),_GAME._setPlay(_CANVAS_AUDIOS.playerset),!1;"ArrowUp"!==_.key&&"Up"!==_.key||(_POWERMETER._c_pms=_POWERMETER._c_pms<=0?0:_POWERMETER._c_pms-1),"ArrowDown"!==_.key&&"Down"!==_.key||(_POWERMETER._c_pms=_POWERMETER._c_pms>=_POWERMETER.pms_selected.length-1?_POWERMETER._c_pms:_POWERMETER._c_pms+1),"ArrowLeft"!==_.key&&"Left"!==_.key||(_POWERMETER._c_pmss=_POWERMETER._c_pmss<=0?0:_POWERMETER._c_pmss-1),"ArrowRight"!==_.key&&"Right"!==_.key||(_POWERMETER._c_pmss=_POWERMETER._c_pmss>=_POWERMETER.pmss_selected.length-1?_POWERMETER._c_pmss:_POWERMETER._c_pmss+1),_POWERMETER.pms_disp(),_POWERMETER.pms_select(),_GAME._setPlay(_CANVAS_AUDIOS.pms_select)},keydown_select_stage:function(_){if("Enter"===_.key||"enter"===_.key)return _MAP.set_stage_map_pattern(_STAGESELECT.mapdef_status),_DRAW_POWER_METER_SELECT(),_GAME._setPlay(_CANVAS_AUDIOS.playerset),!1;"ArrowLeft"!==_.key&&"Left"!==_.key||(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status<=0?0:_STAGESELECT.mapdef_status-1),"ArrowRight"!==_.key&&"Right"!==_.key||(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status>=_MAPDEFS.length-1?_STAGESELECT.mapdef_status:_STAGESELECT.mapdef_status+1),_STAGESELECT.set_map_status(),_STAGESELECT.disp_thumb_map(),_GAME._setPlay(_CANVAS_AUDIOS.pms_select)},keydown_gameclear:function(_){if("R"===_.key||"r"===_.key)return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1;if("S"===_.key||"s"===_.key)return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1;if("P"===_.key||"p"===_.key)return null!==_DRAW_SETINTERVAL?_DRAW_STOP():(_KEYSAFTERPAUSE=[],_DRAW()),!1;if(" "===_.key||"Spacebar"===_.key){if(null!==_PLAYERS_SHOTS_SETINTERVAL)return;_DRAW_PLAYERS_SHOTS()}"ArrowLeft"!==_.key&&"Left"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel),"ArrowRight"!==_.key&&"Right"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=_PLAYERS_MAIN.accel),"ArrowUp"!==_.key&&"Up"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel),"ArrowDown"!==_.key&&"Down"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=_PLAYERS_MAIN.accel),"B"!==_.key&&"b"!==_.key||_POWERMETER.playerset()},keydown_gameover:function(_){return"R"===_.key||"r"===_.key?(_DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1):"S"===_.key||"s"===_.key?(_DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1):void 0},keydown_game:function(_){if(!_PLAYERS_MAIN.isalive())return!1;if("R"===_.key||"r"===_.key)return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1;if("S"===_.key||"s"===_.key)return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1;if("P"===_.key||"p"===_.key)return null!==_DRAW_SETINTERVAL?(_DRAW_STOP(),_GAME._setStopOnBG()):(_KEYSAFTERPAUSE=[],_DRAW(),_GAME._setPlayOnBG(_GAME._audio_now_obj_bg)),!1;if(null===_DRAW_SETINTERVAL){if(_KEYSAFTERPAUSE.push(_.keyCode),_DEF_KEYSAFTERPAUSE===_KEYSAFTERPAUSE.toString()){_SHOTTYPE=_SHOTTYPE_NORMAL,_PLAYERS_MISSILE_ISALIVE=!0;for(let _=0;_<_PLAYERS_OPTION_MAX;_++)_PLAYERS_OPTION[_].settruealive();_PLAYERS_MAIN_FORCE.init(),_KEYSAFTERPAUSE=[],_POWERMETER._set_current_reset(),_POWERMETER.meterdef_status="101100"}return!1}if(" "===_.key||"Spacebar"===_.key){if(null!==_PLAYERS_SHOTS_SETINTERVAL)return;_DRAW_PLAYERS_SHOTS()}if("ArrowLeft"!==_.key&&"Left"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel),"ArrowRight"!==_.key&&"Right"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=_PLAYERS_MAIN.accel),"ArrowUp"!==_.key&&"Up"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani(_.key)),"ArrowDown"!==_.key&&"Down"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani(_.key)),"B"!==_.key&&"b"!==_.key||_POWERMETER.playerset(),!_ISDEBUG)return!1;"M"!==_.key&&"m"!==_.key||_DRAW_SCROLL_STOP(),"N"!==_.key&&"n"!==_.key||_DRAW_SCROLL_RESUME(),"V"!==_.key&&"v"!==_.key||_POWERMETER.move()},keyup_game:function(_){if(!_PLAYERS_MAIN.isalive())return!1;"ArrowLeft"!==_.key&&"Left"!==_.key||(_PLAYERS_MOVE_FLAG=!1),"ArrowRight"!==_.key&&"Right"!==_.key||(_PLAYERS_MOVE_FLAG=!1),"ArrowUp"!==_.key&&"Up"!==_.key||(_PLAYERS_MOVE_FLAG=!1),"ArrowDown"!==_.key&&"Down"!==_.key||(_PLAYERS_MOVE_FLAG=!1)," "!==_.key&&"Spacebar"!==_.key||_DRAW_STOP_PLAYERS_SHOTS()}},_KEYEVENT_SP={keydown_start:function(_){document.querySelector("#game_start_wrapper .text").classList.add("on"),document.querySelector("#game_start_wrapper .text_loading").classList.add("on"),_DRAW_INIT(_CANVAS_IMGS,_DRAW_STAGE_SELECT),_GAME._setPlay(_CANVAS_AUDIOS.playerset)},keydown_select_powermeter_a:function(_){return _DRAW_SELECT_POWERMETER(),_GAME._setPlay(_CANVAS_AUDIOS.playerset),!1},keymove_select_powermeter:function(_){clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_.preventDefault();let e=_SP_CONTROLLER._get_st(_);return!0!==_EVENT_POWERMETER_FLAG&&(_EVENT_POWERMETER_FLAG=!0,e===_SP_CONTROLLER._DEF_DIR._L?(_POWERMETER._c_pmss=_POWERMETER._c_pmss<=0?0:_POWERMETER._c_pmss-1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),_GAME._setPlay(_CANVAS_AUDIOS.pms_select),!1):e===_SP_CONTROLLER._DEF_DIR._U?(_POWERMETER._c_pms=_POWERMETER._c_pms<=0?0:_POWERMETER._c_pms-1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),_GAME._setPlay(_CANVAS_AUDIOS.pms_select),!1):e===_SP_CONTROLLER._DEF_DIR._R?(_POWERMETER._c_pmss=_POWERMETER._c_pmss>=_POWERMETER.pmss_selected.length-1?_POWERMETER._c_pmss:_POWERMETER._c_pmss+1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),_GAME._setPlay(_CANVAS_AUDIOS.pms_select),!1):e===_SP_CONTROLLER._DEF_DIR._D?(_POWERMETER._c_pms=_POWERMETER._c_pms>=_POWERMETER.pms_selected.length-1?_POWERMETER._c_pms:_POWERMETER._c_pms+1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),_GAME._setPlay(_CANVAS_AUDIOS.pms_select),!1):void 0)},keyend_select_powermeter:function(_){_SP_CONTROLLER._set_reset(),_EVENT_POWERMETER_FLAG=!1},keymove_select_stage:function(_){if(_.preventDefault(),_EVENT_SELECT_STAGE_FLAG)return;_EVENT_SELECT_STAGE_FLAG=!0;let e=_SP_CONTROLLER._get_st(_);return e?(e===_SP_CONTROLLER._DEF_DIR._L&&(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status<=0?0:_STAGESELECT.mapdef_status-1,_GAME._setPlay(_CANVAS_AUDIOS.pms_select)),_SP_CONTROLLER._DEF_DIR._U,e===_SP_CONTROLLER._DEF_DIR._R&&(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status>=_MAPDEFS.length-1?_STAGESELECT.mapdef_status:_STAGESELECT.mapdef_status+1,_GAME._setPlay(_CANVAS_AUDIOS.pms_select)),_SP_CONTROLLER._DEF_DIR._U,_STAGESELECT.set_map_status(),_STAGESELECT.disp_thumb_map(),!1):void 0},keyend_select_stage:function(_){let e=_SP_CONTROLLER._sp_main_center;e.style.top="",e.style.left="",_EVENT_SELECT_STAGE_FLAG=!1},keydown_select_stage_a:function(_){return _MAP.set_stage_map_pattern(_STAGESELECT.mapdef_status),_DRAW_POWER_METER_SELECT(),_GAME._setPlay(_CANVAS_AUDIOS.playerset),!1},keydown_gameclear_r:function(_){return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_gameclear_s:function(_){return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_gameclear_p:function(_){return null!==_DRAW_SETINTERVAL?_DRAW_STOP():(_KEYSAFTERPAUSE=[],_DRAW()),!1},keydown_gameover_r:function(_){return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_gameover_s:function(_){return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1},keymove_game_controller:function(_){_.preventDefault(),_PLAYERS_MOVE_FLAG=!0;let e=_SP_CONTROLLER._get_st(_);if(!1!==e)return _PLAYERS_MAIN._x=0,_PLAYERS_MAIN._y=0,e===_SP_CONTROLLER._DEF_DIR._L&&(_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel),e===_SP_CONTROLLER._DEF_DIR._LU&&(_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Up")),e===_SP_CONTROLLER._DEF_DIR._U&&(_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Up")),e===_SP_CONTROLLER._DEF_DIR._RU&&(_PLAYERS_MAIN._x=1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Up")),e===_SP_CONTROLLER._DEF_DIR._R&&(_PLAYERS_MAIN._x=_PLAYERS_MAIN.accel),e===_SP_CONTROLLER._DEF_DIR._RD&&(_PLAYERS_MAIN._x=1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Down")),e===_SP_CONTROLLER._DEF_DIR._D&&(_PLAYERS_MAIN._y=_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Down")),e===_SP_CONTROLLER._DEF_DIR._LD&&(_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Down")),!1},keyend_game_controller:function(_){_SP_CONTROLLER._set_reset(),_PLAYERS_MAIN.set_moveamount_reset(),_PLAYERS_MOVE_FLAG=!1},keydown_game_hide:function(_){_SHOTTYPE=_SHOTTYPE_NORMAL,_PLAYERS_MISSILE_ISALIVE=!0;for(let _=0;_<_PLAYERS_OPTION_MAX;_++)_PLAYERS_OPTION[_].settruealive();return _PLAYERS_MAIN_FORCE.init(),_KEYSAFTERPAUSE=[],_POWERMETER._set_current_reset(),_POWERMETER.meterdef_status="101100",!1},keydown_game_r:function(_){return _DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_game_s:function(_){return _DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1},keydown_game_p:function(_){return null!==_DRAW_SETINTERVAL?(_DRAW_STOP(),_GAME._setStopOnBG()):(_KEYSAFTERPAUSE=[],_DRAW(),_GAME._setPlayOnBG(_GAME._audio_now_obj_bg)),!1},keydown_game_a:function(_){if(null!==_DRAW_SETINTERVAL&&null===_PLAYERS_SHOTS_SETINTERVAL)return _DRAW_PLAYERS_SHOTS(),!1},keydown_game_b:function(_){if(null!==_DRAW_SETINTERVAL)return _POWERMETER.playerset(),!1},keyup_game_a:function(_){return _DRAW_STOP_PLAYERS_SHOTS(),!1}},_SP_CONTROLLER={_x:0,_y:0,_sp_main_center:new Object,_sp_main:new Object,_sp_bt_hide:new Object,_sp_bt_r:new Object,_sp_bt_p:new Object,_sp_bt_s:new Object,_sp_bt_b:new Object,_sp_bt_a:new Object,_DEF_DIR:{_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},_get_st:function(_){let e=this._sp_main_center,t=this._sp_main,s=t.getBoundingClientRect();for(var i=0;i<_.touches.length;i++)e===_.touches[i].target&&(this._x=_.touches[i].clientX-s.left,this._y=_.touches[i].clientY-s.top);let a=this._x-parseInt(window.getComputedStyle(e).width)/2,n=this._y-parseInt(window.getComputedStyle(e).height)/2;e.style.left=parseInt(a)+"px",e.style.top=parseInt(n)+"px";let o=parseInt(window.getComputedStyle(t).width),E=parseInt(window.getComputedStyle(t).height),l=o/2-this._x,r=E/2-this._y;if(Math.sqrt(Math.pow(l,2)+Math.pow(r,2))<10)return!1;let h=parseInt(180*Math.atan2(r,l)/Math.PI);return h>-40&&h<=40?this._DEF_DIR._L:h>40&&h<=50?this._DEF_DIR._LU:h>50&&h<=130?this._DEF_DIR._U:h>130&&h<=140?this._DEF_DIR._RU:h>140&&h<=180||h<-140&&h>=-180?this._DEF_DIR._R:h<-130&&h>=-140?this._DEF_DIR._RD:h<-50&&h>=-130?this._DEF_DIR._D:h<-40&&h>=-50?this._DEF_DIR._LD:void 0},_set_reset(){let _=document.querySelector(".sp_controller_main_center");_.style.left="",_.style.top=""},_set_obj(){this._sp_main_center=document.querySelector(".sp_controller_main_center"),this._sp_main=document.querySelector(".sp_controller_main"),this._sp_bt_hide=document.querySelector(".sp_controller_bt.hide"),this._sp_bt_r=document.querySelector(".sp_controller_bt.r"),this._sp_bt_p=document.querySelector(".sp_controller_bt.p"),this._sp_bt_s=document.querySelector(".sp_controller_bt.s"),this._sp_bt_b=document.querySelector(".sp_controller_bt.b"),this._sp_bt_a=document.querySelector(".sp_controller_bt.a")}};class GameObject_PM{constructor(){let _=this;_.img=_CANVAS_IMGS.meter.obj,_.x=_CANVAS.width/2-_.img.width/2,_.y=_CANVAS.height-30,_.meterdef_status="111111",_.meterdef_current="000000",_.meterdef={n_32:{imgobj:new Image,name:"meter_c_speedup",func:function(){_PLAYERS_MAIN.accel>=18?_._set_meter_status():_PLAYERS_MAIN.accel+=2}},n_16:{imgobj:new Image,name:"meter_c_missile",func:function(){_PLAYERS_MISSILE_ISALIVE=!0,_._set_meter_status()}},n_8:{imgobj:new Image,name:"meter_c_double",func:function(){_SHOTTYPE=_SHOTTYPE_DOUBLE,_._set_meter_status()}},n_4:{imgobj:new Image,name:"meter_c_laser",func:function(){_SHOTTYPE=_SHOTTYPE_LASER,_._set_meter_status()}},n_2:{imgobj:new Image,name:"meter_c_option",func:function(){_PLAYERS_OPTION[_PLAYERS_OPTION_ISALIVE].settruealive(),++_PLAYERS_OPTION_ISALIVE<_PLAYERS_OPTION_MAX||_._set_meter_status()}},n_1:{imgobj:new Image,name:"meter_c_shield",func:function(){_PLAYERS_MAIN_FORCE.init(),_._set_meter_status()}}},_._c_pms=0,_.pms_img=_CANVAS_IMGS_INIT.gradius_powermeterselect.obj,_.pms_selected=[{_y:89,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_0.obj},{_y:162,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_1.obj},{_y:233,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_2.obj},{_y:306,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_3.obj}],_._c_pmss=0,_.pmss_selected=[{_x:470,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_shield_0.obj},{_x:570,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_shield_1.obj}]}_set_current_reset(){this.meterdef_current="000000"}_set_meter_status(){let _=this.meterdef_status,e=(~parseInt(this.meterdef_current,2)>>>0).toString(2).slice(-6);this.meterdef_status=this._get_bit((parseInt(_,2)&parseInt(e,2)).toString(2));let t=parseInt(this.meterdef_current,2);8!==t&&4!==t||(this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(8===t?"000100":"001000",2)).toString(2)))}_set_meter_on(_){this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(_,2)).toString(2))}_get_bit(_){return("000000"+_).slice(-6)}_get_meter_current(_){return 0===parseInt(_,2)||1===parseInt(_,2)?"100000":("000000"+(parseInt(_,2)>>1).toString(2)).slice(-6)}move(){this.meterdef_current=this._get_meter_current(this.meterdef_current)}playerset(){let _=parseInt(this.meterdef_current,2),e=parseInt(this.meterdef_status,2);0!==_&&0!=(_&e)&&(_PLAYERS_MAIN.set_equipped(),_GAME._setPlay(_CANVAS_AUDIOS.playerset),this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(this.meterdef_current,2)).toString(2)),this.meterdef["n_"+_].func(),this._set_current_reset())}show(){let _=this;_CONTEXT.drawImage(_.img,0,0,_.img.width-71,_.img.height,_.x+36,_.y,_.img.width-71,_.img.height);for(let e=0;e<this.meterdef_status.length;e++)"0"===this.meterdef_status[e]&&_CONTEXT.drawImage(_.img,_.img.width-72,0,72,_.img.height,_.x+36+72*e,_.y,72,_.img.height);let e=parseInt(this.meterdef_current,2);if(0===e)return;let t=parseInt(this.meterdef_status,2),s=_CANVAS_IMGS.meter_c.obj,i=0!=(e&t)?72*_.meterdef_current.indexOf("1"):s.width-72;_CONTEXT.drawImage(s,i,0,72,s.height,_.x+36+72*_.meterdef_current.indexOf("1"),_.y,72,s.height)}pms_disp(){_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_GAME._setDrawTextToFont("power meter select",_CANVAS.width/2-36*"power meter select".length/2,20,.6),_GAME._setDrawTextToFont("shield select",200,400,.3),_CONTEXT.drawImage(this.pms_img,_CANVAS.width/2-this.pms_img.width/2,70,this.pms_img.width,this.pms_img.height);let _=_CANVAS_IMGS.meter.obj;_CONTEXT.drawImage(_,360,0,72,19,290,430,72,19);let e=_CANVAS_IMGS_INIT.gradius_powermeterselect_shield.obj;_CONTEXT.drawImage(e,470,390,e.width,e.height)}pms_select(){let _=this.pms_selected[this._c_pms]._img;_CONTEXT.drawImage(_,_CANVAS.width/2-this.pms_img.width/2,this.pms_selected[this._c_pms]._y,_.width,_.height),_=this.pmss_selected[this._c_pmss]._img,_CONTEXT.drawImage(_,this.pmss_selected[this._c_pmss]._x,390,_.width,_.height)}}class GameObject_STAGESELECT{constructor(){this.x=0,this.y=0,this.speed=100,this.mapdef_status=0,this.mapdef=_MAPDEFS[this.mapdef_status]}get_ajaxdata(_,e){e.mapdef=_[e.mapdef_status],_ISDEBUG||e.disp_thumb_map()}init(){this.mapdef=_MAPDEFS[0],_ISDEBUG?this.mapdef=_MAPDEFS[_MAP_PETTERN]:this.disp_thumb_map()}set_map_status(){this.mapdef=_MAPDEFS[this.mapdef_status]}disp_thumb_map(){_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_GAME._setDrawTextToFont("stage select",_CANVAS.width/2-35*"stage select".length/2,20,.6);let _=500-(_MAPDEFS.length/2*20+10);for(let e=0;e<_MAPDEFS.length;e++)_CONTEXT.beginPath(),_CONTEXT.lineWidth=1,_CONTEXT.strokeStyle="rgba(255,255,255,1)",_CONTEXT.fillStyle="rgba(255,255,255,1)",e===this.mapdef_status?_CONTEXT.fillRect(_+20*e,85,10,10):_CONTEXT.strokeRect(_+20*e,85,10,10);let e=this.mapdef;_MAP.showMapForStageselect(e),_CONTEXT.beginPath(),_CONTEXT.lineWidth=1,_CONTEXT.strokeStyle="rgba(255,255,255,1)",_CONTEXT.fillStyle="rgba(255,255,255,1)",_CONTEXT.strokeRect(50,130,300,200),_GAME._setDrawTextToFont("stage title",400,130,.3),_CONTEXT.moveTo(400,160),_CONTEXT.lineTo(950,160),_CONTEXT.stroke(),_CONTEXT.font="20px sans-serif";let t=_GAME._multilineText(_CONTEXT,this.mapdef._title,550);for(let _=0;_<(t.length>2?2:t.length);_++)_CONTEXT.fillText(t[_],400,190+26*_);_GAME._setDrawTextToFont("difficult:"+this.mapdef._difficult,400,230,.3),_CONTEXT.moveTo(400,260),_CONTEXT.lineTo(950,260),_CONTEXT.stroke(),_GAME._setDrawTextToFont("detail",400,300,.3),_CONTEXT.moveTo(400,330),_CONTEXT.lineTo(950,330),_CONTEXT.stroke(),t=_GAME._multilineText(_CONTEXT,this.mapdef._body,520);for(let _=0;_<(t.length>4?4:t.length);_++)_CONTEXT.fillText(t[_],400,360+30*_)}}class GameObject_SCORE{constructor(){this.score1p=0,this.score2p=0,this.def_scorehi=57300,this.scorehi=this.def_scorehi}init(){this.score1p=0,this.score2p=0}set(_){this.score1p+=_,this.scorehi>=this.score1p||(this.scorehi=this.score1p)}show(){_CANVAS_IMGS_INIT.font.obj;let _="1p"+("        "+this.score1p).slice(-8);_GAME._setDrawTextToFont(_,180,10,.3),_="hi"+("        "+this.scorehi).slice(-8),_GAME._setDrawTextToFont(_,400,10,.3),_="2p"+("        "+this.score2p).slice(-8),_GAME._setDrawTextToFont(_,620,10,.3)}}class GameObject_POWERCAPSELL{constructor(_,e){this.x=_||0,this.y=e||0,this.getscore=200,this.gotpc=!1,this.type=Math.random()>.1?"red":"blue",this._c_pc_ani=0,this.img="red"===this.type?_CANVAS_IMGS.pc_red.obj:_CANVAS_IMGS.pc_blue.obj}getPCCenterPosition(){return{_x:this.x+this.img.height/2,_y:this.y+this.img.height/2}}getPowerCapcell(){this.gotpc=!0}move(){if(this.gotpc)return;this.x=_MAP.getX(this.x),this.y=_MAP.getY(this.y);let _=parseInt(this.img.width/this.img.height),e=this.img.height;this._c_pc_ani=this._c_pc_ani>=5*_-1?0:this._c_pc_ani+1,_CONTEXT.drawImage(this.img,e*parseInt(this._c_pc_ani/5),0,e,e,this.x,this.y,e,e)}}class GameObject_BACKGROUND{constructor(){this.x=_CANVAS.width*Math.random(),this.y=_CANVAS.height*Math.random(),this.rgba="rgba("+parseInt(255*Math.random())+","+parseInt(255*Math.random())+","+parseInt(255*Math.random())+","+Math.random()+")",this.speed=5*Math.random(),this.move_flash_count=0,this._r=Math.random()+1}move(){this.x=this.x<0?_CANVAS.width:this.x,this.x-=0===_BACKGROUND_SPEED?0:this.speed,_CONTEXT.beginPath(),_CONTEXT.arc(this.x,this.y,this._r,0,2*Math.PI,!0),_CONTEXT.fillStyle=this.rgba,_CONTEXT.fill()}}const _IS_GET_POWERCAPSELL=()=>{for(let _=0;_<_POWERCAPSELLS.length;_++)_POWERCAPSELLS[_].gotpc&&_POWERCAPSELLS.splice(_,1);for(let e=0;e<_POWERCAPSELLS.length;e++){let t=_POWERCAPSELLS[e];if(t.gotpc)continue;let s=_PLAYERS_MAIN.getPlayerCenterPosition(),i=t.getPCCenterPosition();if(Math.sqrt(Math.pow(i._x-s._x,2)+Math.pow(i._y-s._y,2))<Math.sqrt(Math.pow(_PLAYERS_MAIN.width,2)+Math.pow(_PLAYERS_MAIN.height,2))/2)if(t.getPowerCapcell(),"red"!==t.type)if("blue"!==t.type);else{var _=_ENEMIES.concat();for(let e=0;e<_.length;e++){let t=_[e];_GAME.isEnemyCanvasOut(t)||(t.isStandBy()||t.isAbleCollision()&&(t._status-=1,t.isalive()||(_SCORE.set(t.getscore),t.showCollapes())))}_=_ENEMIES_SHOTS.concat();for(let e=0;e<_.length;e++){let t=_[e];_GAME.isEnemyCanvasOut(t)||t.init()}_GAME._setPlay(_CANVAS_AUDIOS.enemy_all_out)}else _POWERMETER.move(),_GAME._setPlay(_CANVAS_AUDIOS.pc),_SCORE.set(t.getscore)}},_IS_ENEMIES_COLLISION=()=>{if(!_PLAYERS_MAIN.isalive())return;for(let _=0;_<_ENEMIES.length;_++)_ENEMIES[_].isshow()||_ENEMIES[_].isalive()||_ENEMIES.splice(_,1);let _=_ENEMIES;if(_SHOTTYPE===_SHOTTYPE_LASER)for(let e=0;e<_PLAYERS_SHOTS[_SHOTTYPE].length;e++){let t=_PLAYERS_SHOTS[_SHOTTYPE][e],s=_CANVAS.width;t.shots[0]._laser_MaxX;for(let e=0;e<_.length;e++){if(_[e].isIgnore())continue;if(_[e].isStandBy())continue;if(!_[e].isalive())continue;let i=_[e],a=t.enemy_collision(i);s=s>a?a:s}t.shots[0]._laser_MaxX=t.shots[0].x<s?s:t.shots[0]._laser_MaxX}else if(_SHOTTYPE!==_SHOTTYPE_LASER)for(let e=0;e<_PLAYERS_SHOTS[_SHOTTYPE].length;e++){let t=_PLAYERS_SHOTS[_SHOTTYPE][e];for(let e=0;e<_.length;e++){if(_[e].isIgnore())continue;if(_[e].isStandBy())continue;if(!_[e].isalive())continue;let s=_[e];t.enemy_collision(s)}}for(let e=0;e<_.length;e++){let t=_[e];if(!t.isIgnore()&&(!t.isStandBy()&&t.isalive()&&(_PLAYERS_MAIN.enemy_collision(t),_PLAYERS_MAIN_FORCE.enemy_collision(t),_PLAYERS_MISSILE_ISALIVE)))for(let _=0;_<_PLAYERS_MISSILE.length;_++){let e=_PLAYERS_MISSILE[_];if(e.player.isalive())for(let _=0;_<e.shots.length;_++){let s=e.shots[_];e.enemy_collision(t,s)}}}},_IS_ENEMIES_SHOT_COLLISION=()=>{if(_PLAYERS_MAIN.isalive()){for(let _=0;_<_ENEMIES_SHOTS.length;_++)_ENEMIES_SHOTS[_].isshow()||_ENEMIES_SHOTS[_].isalive()||_ENEMIES_SHOTS.splice(_,1);for(let _=0;_<_ENEMIES_SHOTS.length;_++){let e=_ENEMIES_SHOTS[_];e._shot_alive&&(_PLAYERS_MAIN.enemy_shot_collision(e),_PLAYERS_MAIN_FORCE.enemy_shot_collision(e))}}},_DRAW=()=>{_KEYEVENT_MASTER.addKeydownGame(),_KEYEVENT_MASTER.addKeyupGame();const _=function(){_DRAW_SETINTERVAL=window.requestAnimationFrame(_),_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);for(let _=0;_<70;_++)_BACKGROUND[_].move();for(let _=0;_<_ENEMIES_SHOTS.length;_++)_ENEMIES_SHOTS[_].move();_MAP.move();for(let _=0;_<_ENEMIES.length;_++)void 0!==_ENEMIES[_]&&_ENEMIES[_].move();_IS_GET_POWERCAPSELL(),_IS_ENEMIES_SHOT_COLLISION(),_IS_ENEMIES_COLLISION(),_MAP.isPlayersShotCollision(),_DRAW_ENEMIES_COLLISIONS();for(let _=0;_<_POWERCAPSELLS.length;_++)_POWERCAPSELLS[_].move();for(let _=0;_<5;_++)_PLAYERS_MISSILE_ISALIVE&&_PLAYERS_MISSILE[_].move(),_PLAYERS_SHOTS[_SHOTTYPE][_].move();for(let _=0;_<_PLAYERS_OPTION_MAX;_++)_PLAYERS_OPTION[_].move(10*(_+1));_PLAYERS_MAIN_FORCE.move(_PLAYERS_MAIN),_PLAYERS_MAIN.move(),_MAP.map_draw(),_POWERMETER.show(),_SCORE.show(),_MAP.isboss&&_DRAW_MATCH_BOSS()};_DRAW_SETINTERVAL=window.requestAnimationFrame(_)},_DRAW_MATCH_BOSS=()=>{if(_MAP.setBackGroundSpeedY(0),_MAP.setInifinite(!1),!_DRAW_IS_MATCH_BOSS)return""!==_MAP.map_boss&&void 0!==_MAP.map_boss&&void 0!==_MAP_ENEMIES_BOSS[_MAP.map_boss]||_DRAW_GAMECLEAR(),_DRAW_SCROLL_STOP(),_ENEMIES_SHOTS=[],(_ENEMIES=[]).push(_MAP_ENEMIES_BOSS[_MAP.map_boss]._f()),_DRAW_IS_MATCH_BOSS=!0,void _GAME._setPlayOnBG(_CANVAS_AUDIOS.bg_boss);let _="";for(let e=0;e<_ENEMIES.length;e++)_+=_ENEMIES[e].isalive()?"0":"1";-1===_.indexOf("0")&&(_DRAW_IS_MATCH_BOSS_COUNT>100?(_DRAW_GAMECLEAR(),_DRAW_SCROLL_RESUME()):_DRAW_IS_MATCH_BOSS_COUNT++)},_DRAW_PLAYER_COLLAPES=()=>{_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame();const _=_PLAYERS_MAIN;if(void 0===_)return;let e=null,t=_.getPlayerCenterPosition();_GAME._setPlay(_CANVAS_AUDIOS.vicviper_bomb);const s=function(){if(e=window.requestAnimationFrame(s),_._col_ani_c>=10*_.col_ani.length-1)return cancelAnimationFrame(e),void _DRAW_GAMEOVER();let i=parseInt(_._col_ani_c/10),a=_.col_ani[i].img.width,n=_.col_ani[i].img.height,o=a*_.col_ani[i].scale,E=n*_.col_ani[i].scale;_CONTEXT.drawImage(_.col_ani[i].img,t._x-o/2,t._y-E/2,o,E),_._col_ani_c++};e=window.requestAnimationFrame(s)},_DRAW_PLAYERS_SHOTS=()=>{let _=new Date;const e=function(){if(_PLAYERS_SHOTS_SETINTERVAL=window.requestAnimationFrame(e),!(new Date-_<50)){_=new Date;for(var t=0;t<_PLAYERS_SHOTS[_SHOTTYPE].length;t++){let _=_PLAYERS_SHOTS[_SHOTTYPE][t];if(_.player._isalive)if(_SHOTTYPE!==_SHOTTYPE_DOUBLE){_._sq=_._sq===_.shots.length-1?0:_._sq+1;var s=_.shots[_._sq];s._shot_alive||(s._shot=!0,0===t&&_GAME._setPlay(s._audio))}else{if(_.shots[0]._shot_alive||_.shots[1]._shot_alive)continue;if(_.shots[0]._shot=!0,_.shots[1]._shot=!0,0!==t)continue;_GAME._setPlay(_.shots[0]._audio)}}if(_PLAYERS_MISSILE_ISALIVE)for(t=0;t<_PLAYERS_MISSILE.length;t++){let _=_PLAYERS_MISSILE[t];if(_.player._isalive)if(3!==_PLAYERS_POWER_METER){_._sq=_._sq===_.shots.length-1?0:_._sq+1;var i=_.shots[_._sq];i._shot_alive||(i._shot=!0,0===t&&_GAME._setPlay(i._audio))}else{if(_.shots[0]._shot_alive||_.shots[1]._shot_alive)continue;if(_.shots[0]._shot=!0,_.shots[1]._shot=!0,0!==t)continue;_GAME._setPlay(_.shots[0]._audio)}}}};_PLAYERS_SHOTS_SETINTERVAL=window.requestAnimationFrame(e)},_DRAW_STOP=()=>{cancelAnimationFrame(_DRAW_SETINTERVAL),_DRAW_SETINTERVAL=null},_DRAW_STOP_GAMESTART=()=>{cancelAnimationFrame(_DRAW_GAMESTART_SETINTERVAL),_DRAW_GAMESTART_SETINTERVAL=null},_DRAW_STOP_PLAYERS_SHOTS=()=>{cancelAnimationFrame(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null;for(var _=0;_<_PLAYERS_SHOTS[_SHOTTYPE].length;_++){let e=_PLAYERS_SHOTS[_SHOTTYPE][_];for(let _=0;_<e.shots.length;_++)e.shots[_]._shot=!1}for(_=0;_<_PLAYERS_MISSILE.length;_++){let e=_PLAYERS_MISSILE[_];for(let _=0;_<e.shots.length;_++)e.shots[_]._shot=!1}},_DRAW_SELECT_POWERMETER=()=>{_DRAW_STOP_PLAYERS_SHOTS(),_KEYEVENT_MASTER.removeKeydownSelectPowermeter();let _=0,e=null;const t=function(){e=window.requestAnimationFrame(t),_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_POWERMETER.pms_disp(),_%5==0&&_POWERMETER.pms_select(),_>40&&(_PLAYERS_POWER_METER=_POWERMETER._c_pms,_PLAYERS_POWER_METER_SHIELD=_POWERMETER._c_pmss,cancelAnimationFrame(e),_DRAW_INIT_OBJECT()),_++};e=window.requestAnimationFrame(t)},_DRAW_GAMESTART=()=>{if(_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_ISDEBUG)return void _DRAW();let _=0;const e=function(){if(_DRAW_GAMESTART_SETINTERVAL=window.requestAnimationFrame(e),_>250)return cancelAnimationFrame(_DRAW_GAMESTART_SETINTERVAL),_DRAW_GAMESTART_SETINTERVAL=null,_GAME._setPlayOnBG(_CANVAS_AUDIOS["bg_"+_MAP.map_bgmusic]),void _DRAW();_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);for(let _=0;_<70;_++)_BACKGROUND[_].move();if(_POWERMETER.show(),_SCORE.show(),parseInt(_/50)%2!=0);else{let _="start";_GAME._setDrawTextToFont(_,_CANVAS.width/2-60*_.length/2,_CANVAS.height/2-30-20,1)}_++};_DRAW_GAMESTART_SETINTERVAL=window.requestAnimationFrame(e),_GAME._setStopOnBG()},_DRAW_GAMECLEAR=()=>{_CANVAS_IMGS_INIT.font.obj;let _="gameclear";_GAME._setDrawTextToFont(_,_CANVAS.width/2-60*_.length/2,_CANVAS.height/2-30-40,1),_="press r to restart",_GAME._setDrawTextToFont(_,_CANVAS.width/2-18*_.length/2,_CANVAS.height/2+30,.3),_="press s to change to another stage",_GAME._setDrawTextToFont(_,_CANVAS.width/2-18*_.length/2,_CANVAS.height/2+60,.3),_DRAW_IS_GAMECLEAR=!0},_DRAW_GAMEOVER=()=>{_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_DRAW_STOP_PLAYERS_SHOTS(),_KEYEVENT_MASTER.addKeydownGameover(),_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);for(let _=0;_<70;_++)_BACKGROUND[_].move();_SCORE.show();_CANVAS_IMGS_INIT.font.obj;let _="gameover";_GAME._setDrawTextToFont(_,_CANVAS.width/2-60*_.length/2,_CANVAS.height/2-30-40,1),_="press r to restart",_GAME._setDrawTextToFont(_,_CANVAS.width/2-18*_.length/2,_CANVAS.height/2+30,.3),_="press s to change to another stage",_GAME._setDrawTextToFont(_,_CANVAS.width/2-18*_.length/2,_CANVAS.height/2+60,.3)},_DRAW_ENEMIES_COLLISIONS=()=>{for(let _=0;_<_ENEMIES_COLLISIONS.length;_++)_ENEMIES_COLLISIONS[_].isalive()||_ENEMIES_COLLISIONS.splice(_,1);for(let _=0;_<_ENEMIES_COLLISIONS.length;_++)_ENEMIES_COLLISIONS[_].move()},_DRAW_SCROLL_STOP=()=>{_MAP.set_scroll_off_x()},_DRAW_SCROLL_RESUME=()=>{_MAP.set_scroll_on_x()},_DRAW_RESET_OBJECT=()=>{_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_KEYEVENT_MASTER.removeKeydownGameover(),clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_DRAW_STOP(),_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_PLAYERS_MAIN="",_PLAYERS_MAIN_FORCE="",_PLAYERS_MOVE_FLAG=!1,_PLAYERS_OPTION=[],_PLAYERS_OPTION_ISALIVE=0,_PLAYERS_SHOTS={_SHOTTYPE_NORMAL:[],_SHOTTYPE_DOUBLE:[],_SHOTTYPE_LASER:[]},_PLAYERS_MISSILE=[],_PLAYERS_MISSILE_ISALIVE=!1,_PLAYERS_MOVE_DRAW_X=[],_PLAYERS_MOVE_DRAW_Y=[],_ENEMIES=[],_ENEMIES_SHOTS=[],_ENEMIES_COLLISIONS=[],_POWERMETER="",_SHOTTYPE=_SHOTTYPE_NORMAL,_POWERCAPSELLS=[],_MAP_SCROLL_POSITION_X=0,_MAP_SCROLL_POSITION_Y=0,_DRAW_IS_MATCH_BOSS=!1,_DRAW_IS_MATCH_BOSS_COUNT=0},_DRAW_INIT_OBJECT=()=>{_KEYEVENT_MASTER.removeKeydownSelectPowermeter(),_PLAYERS_MAIN=0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?new GameObject_PLAYER_MAIN:new GameObject_PLAYER_MAIN_RED,_PLAYERS_SHOTS._SHOTTYPE_NORMAL.push(new GameObject_SHOTS_NORMAL(_PLAYERS_MAIN)),_PLAYERS_SHOTS._SHOTTYPE_DOUBLE.push(function(_){return 0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?new GameObject_SHOTS_DOUBLE(_):new GameObject_SHOTS_TAILGUN(_)}(_PLAYERS_MAIN)),_PLAYERS_SHOTS._SHOTTYPE_LASER.push(function(_){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER(_):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER_CYCLONE(_):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER(_):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER_RED(_):void 0}(_PLAYERS_MAIN)),_PLAYERS_MISSILE.push(function(_){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE(_):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_SPREADBOMB(_):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_PHOTOM(_):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_2WAY(_):void 0}(_PLAYERS_MAIN)),_PLAYERS_MAIN_FORCE=0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?1===_PLAYERS_POWER_METER_SHIELD?new GameObject_FORCEFIELD:new GameObject_SHIELD:1===_PLAYERS_POWER_METER_SHIELD?new GameObject_FORCEFIELD_RED:new GameObject_SHIELD_RED;for(let _=0;_<_PLAYERS_OPTION_MAX;_++)_PLAYERS_OPTION.push(new GameObject_PLAYER_OPTION("option",110,70*(_+1),!1)),_PLAYERS_SHOTS._SHOTTYPE_NORMAL.push(new GameObject_SHOTS_NORMAL(_PLAYERS_OPTION[_])),_PLAYERS_SHOTS._SHOTTYPE_DOUBLE.push(function(_){return 0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?new GameObject_SHOTS_DOUBLE(_):new GameObject_SHOTS_TAILGUN(_)}(_PLAYERS_OPTION[_])),_PLAYERS_SHOTS._SHOTTYPE_LASER.push(function(_){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER(_):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER_CYCLONE(_):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER(_):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER_RED(_):void 0}(_PLAYERS_OPTION[_])),_PLAYERS_MISSILE.push(function(_){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE(_):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_SPREADBOMB(_):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_PHOTOM(_):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_2WAY(_):void 0}(_PLAYERS_OPTION[_]));_POWERMETER=new GameObject_PM,_DRAW_IS_GAMECLEAR||_SCORE.init(),_DRAW_IS_GAMECLEAR=!1;for(let _=0;_<70;_++)_BACKGROUND[_]=new GameObject_BACKGROUND;_MAP.set_gamestart(),_DRAW_GAMESTART()},_DRAW_POWER_METER_SELECT=()=>{clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_KEYEVENT_MASTER.removeKeydownSelectStage(),_KEYEVENT_MASTER.addKeydownSelectPowermeter(),(_POWERMETER=new GameObject_PM).pms_disp(),_POWERMETER.pms_select()},_DRAW_STAGE_SELECT=()=>{clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);let _=document.querySelector("#game_start_wrapper"),e=document.querySelector("#game_wrapper");_.classList.remove("on"),e.classList.add("on"),_KEYEVENT_MASTER.removeKeydownStart(),_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_KEYEVENT_MASTER.removeKeydownGameover(),_KEYEVENT_MASTER.addKeydownSelectStage(),_MAP.init(function(){(_STAGESELECT=new GameObject_STAGESELECT).init()}),_GAME._setPlayOnBG(_CANVAS_AUDIOS.bg_powermeterselect)},_DRAW_AUDIO_INIT=(_,e)=>{let t=0,s=document.querySelector("#game_start_loading .rate");for(let e in _){let i=new XMLHttpRequest;i.open("GET",_[e].src,!0),i.responseType="arraybuffer",i.onload=function(){_AUDIO_CONTEXT.decodeAudioData(i.response,function(i){_[e].buf=i,++t>=Object.keys(_).length&&_DRAW_INIT(_CANVAS_IMGS_INIT,_GAME._init),s.innerHTML=parseInt(t/Object.keys(_).length*100)+"%"},function(_){alert("一部音声読み込みに失敗しました。再度立ち上げなおしてください:"+_)})},i.send()}},_DRAW_INIT=(_,e)=>{let t=0,s=!1;for(let i in _){let a=_[i];a.obj.src=_[i].src,a.obj.onload=function(){a.obj.width*=a.rate,a.obj.height*=a.rate,++t>=Object.keys(_).length&&e();let s=parseInt(t/Object.keys(_).length*100);_GAME._setTextToFont(document.querySelector("#game_start>.text_loading"),"now loading "+s+" per",30)},a.obj.onabort=function(){},a.obj.onerror=function(){s||(s=!0,alert("一部画像読み込みに失敗しました。再度立ち上げなおしてください"))}}},_GAME={_url_params:new Array,_init(){_SCORE=new GameObject_SCORE,(_MAP=new GameObject_MAP).init(_GAME._showGameStart)},_txt:{0:"0",1:"60",2:"120",3:"180",4:"240",5:"300",6:"360",7:"420",8:"480",9:"540",a:"600",b:"660",c:"720",d:"780",e:"840",f:"900",g:"960",h:"1020",i:"1080",j:"1140",k:"1200",l:"1260",m:"1320",n:"1380",o:"1440",p:"1500",q:"1560",r:"1620",s:"1680",t:"1740",u:"1800",v:"1860",w:"1920",x:"1980",y:"2040",z:"2100",":":"2160"},_audio_buffer_loader:null,_audio_now_obj_bg:null,_audio_context_source_bg:null,_is_audio_context_source_bg:!1,_ac:{_get:function(_,e,t){return _>=e.length*t-1?0:_+1}},getRad(_,e){if(void 0!==_&&void 0!==e)return Math.atan2(_.y-e.y,_.x-e.x)},getDeg(_,e){if(void 0===_||void 0===e)return;return Math.atan2(_.y-e.y,_.x-e.x)/Math.PI*180},getRadToDeg:_=>void 0===_||""===_?null:_/Math.PI*180,getBit:(_,e)=>("0".repeat(e)+_).slice(-1*e),getOrBit(_,e,t){let s=(parseInt(_,2)|parseInt(e,2)).toString(2);return this.getBit(s,t)},setUrlParams(){for(var _=location.search.slice(1).split(/(&|&amp;)/),e=0;e<_.length;e++){var t=_[e].replace("amp;","").split("=");""!==t[0]&&void 0!==t[0]&&("&"!==t[0]&&(this._url_params[t[0]]=t[1]))}},isShotCanvasOut:_=>_.x<-_MAP.t||_.x>_CANVAS.width+_MAP.t||_.y<-_MAP.t||_.y>_CANVAS.height+_MAP.t,isEnemyCanvasOut(_,e){let t=_.getEnemyCenterPosition(),s=e||{up:!0,down:!0,left:!0,right:!0},i=_.width,a=_.height;return t._x<0-i&&!0===s.left||t._x>_CANVAS.width+i&&!0===s.right||t._y<0-a&&!0===s.up||t._y>_CANVAS.height+a&&!0===s.down},isSqCollision(_,e,t,s,i){return this.isSqCollision_laser(_,e,t,s,i).ret},isSqCollision_laser(_,e,t,s,i){let a=parseInt(void 0===e?0:e.split(",")[0]),n=parseInt(void 0===e?0:e.split(",")[1]),o=parseInt(void 0===s?0:s.split(",")[0]),E=parseInt(void 0===s?0:s.split(",")[1]),l=_.split(","),r=parseInt(l[2])-parseInt(l[0]),h=parseInt(l[3])-parseInt(l[1]),m=(Math.sqrt(Math.pow(r,2)+Math.pow(h,2)),r/2+a+parseInt(l[0])),c=h/2+n+parseInt(l[1]);i&&console.log(m+":"+c);for(let _=0;_<t.length;_++){let e=t[_].split(","),s=parseInt(e[2])-parseInt(e[0]),i=parseInt(e[3])-parseInt(e[1]),a=void 0===e[4],n=(Math.sqrt(Math.pow(s,2)+Math.pow(i,2)),s/2+o+parseInt(e[0])),l=i/2+E+parseInt(e[1]),S=Math.abs(n-m),A=Math.abs(l-c),g=(Math.sqrt(Math.pow(S,2)+Math.pow(A,2)),o+parseInt(e[0]));if(r/2+s/2>S&&h/2+i/2>A)return a?{ret:_IS_SQ_COL,val:g+10}:{ret:_IS_SQ_COL_NONE,val:g+10}}return{ret:_IS_SQ_NOTCOL,val:_CANVAS.width}},_showGameStart(){if(document.querySelector("#game_start_loading").classList.remove("on"),_ISSP){document.querySelector("#sp_controller").classList.add("on"),_SP_CONTROLLER._set_obj()}if(_ISDEBUG){return document.querySelector("#game_wrapper").classList.add("on"),(_STAGESELECT=new GameObject_STAGESELECT).init(),_MAP.set_stage_map_pattern(_MAP_PETTERN),void _DRAW_INIT(_CANVAS_IMGS,_DRAW_POWER_METER_SELECT)}_KEYEVENT_MASTER.addKeydownStart(),document.querySelector("#game_start_wrapper").classList.add("on"),_GAME._setTextToFont(document.querySelector("#game_start>.title"),"no pakuri",50),_GAME._setTextToFont(document.querySelector("#game_start>.text"),"press s to start",30),_GAME._setTextToFont(document.querySelector("#game_start>.text_loading"),"now loading",30)},_setDrawTextToFont(_,e,t,s){let i=this;const a=_CANVAS_IMGS_INIT.font.obj,n=a.height;s=s||1;for(let o=0;o<_.length;o++)" "!==_[o]&&_GAME._setDrawImage({img:a,x:e+n*s*o,y:t,imgPosx:parseInt(i._txt[_[o]]),width:n,height:n,scale:s,basePoint:1})},_setTextToFont(_,e,t){if(null==_)return;let s=this;t=t||30;let i="";for(let _=0;_<e.length;_++){if(" "===e[_]){i+='<img src="./images/gradius_spacer.png" width="'+t+'">';continue}i+='<div style="background:url(./images/gradius_font.png) no-repeat;width:'+t+"px;height:"+t+"px;background-position:"+parseInt(s._txt[e[_]])*(t/60)*-1+'px 0px;background-size:cover;display:inline-block;"></div>'}_.innerHTML=i},_getPlayerMoveDrawX:_=>void 0===_PLAYERS_MOVE_DRAW_X[_]?null:_PLAYERS_MOVE_DRAW_X[_],_getPlayerMoveDrawY:_=>void 0===_PLAYERS_MOVE_DRAW_Y[_]?null:_PLAYERS_MOVE_DRAW_Y[_],_setPlayerMoveDraw(){let _=_PLAYERS_MAIN.width,e=_PLAYERS_MAIN.height,t=_PLAYERS_MAIN.x+parseInt(_/4),s=_PLAYERS_MAIN.y+parseInt(e/4),i=-1*_MAP.getBackGroundSpeedY(),a=_PLAYERS_MOVE_DRAW_Y;if(100===_PLAYERS_MOVE_DRAW_X.length&&_PLAYERS_MOVE_DRAW_X.pop(),100===_PLAYERS_MOVE_DRAW_Y.length&&_PLAYERS_MOVE_DRAW_Y.pop(),_PLAYERS_MOVE_DRAW_X.unshift(t),_MAP.map_infinite)if(0!==i)for(let _=0;_<100;_++)void 0!==a[_]?i>0?a[_]=a[_]>=s+i*_?s+i*_:a[_]+i:i<0&&(a[_]=a[_]<=s+i*_?s+i*_:a[_]+i):a.push(s+i*_);else a.unshift(s);else a.unshift(s)},_setPlay(_){if(null!=_){var e=_AUDIO_CONTEXT.createBufferSource();e.buffer=_.buf,e.loop=!1,e.connect(_AUDIO_CONTEXT.destination),e.start(0)}},_setPlayOnBG(_){if(null==_)return;!0===this._is_audio_context_source_bg&&(this._audio_context_source_bg.stop(),this._is_audio_context_source_bg=!1);let e=_AUDIO_CONTEXT.createBufferSource();e.buffer=_.buf,this._audio_now_obj_bg=_,e.loop=!0,e.loopStart=0,e.connect(_AUDIO_CONTEXT.destination),e.start(0),this._audio_context_source_bg=e,this._is_audio_context_source_bg=!0},_setStopOnBG(){this._is_audio_context_source_bg&&(this._audio_context_source_bg.stop(),this._is_audio_context_source_bg=!1)},_setDrawImage(_){if(void 0===_||void 0===_.img||0===_.scale)return;let e=_.width||_.img.width,t=_.height||_.img.height,s=_.deg||0,i=_.imgPosx||0,a=_.imgPosy||0,n=_.scale||1,o=_.x||0,E=_.y||0,l=_.basePoint||5,r=_.alpha||1;const h=[{x:0,y:0},{x:0,y:0},{x:-e/2,y:0},{x:-e,y:0},{x:0,y:-t/2},{x:-e/2,y:-t/2},{x:-e,y:-t/2},{x:0,y:-t},{x:-e/2,y:-t},{x:-e,y:-t}];_CONTEXT.save(),_CONTEXT.globalAlpha=r,_CONTEXT.translate(o,E),_CONTEXT.rotate(s*Math.PI/180),_CONTEXT.scale(n,n),_CONTEXT.drawImage(_.img,i,a,e,t,h[l].x,h[l].y,e,t),_CONTEXT.restore()},_multilineText(_,e,t){let s=e.length,i=[],a="";if(s<1)return i;for(let n=0;n<s;n++){let s=e.charAt(n);"\n"!==s?_.measureText(a+s).width<=t?a+=s:(i.push(a),a=s):(i.push(a),a="")}return a.length>0&&i.push(a),i}};window.addEventListener("load",function(){_CANVAS=document.getElementById("game"),_CONTEXT=_CANVAS.getContext("2d"),_GAME.setUrlParams(),_ISDEBUG="true"===_GAME._url_params.debug,_MAP_PETTERN=_GAME._url_params.mp||0,_ENEMY_DIFFICULT=_GAME._url_params.ed||0,_ISSP&&document.querySelector("body").classList.add("sp"),_DRAW_AUDIO_INIT(_CANVAS_AUDIOS)}),window.addEventListener("touchmove",function(_){_.preventDefault()},{passive:!1});