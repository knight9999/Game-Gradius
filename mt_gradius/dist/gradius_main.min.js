"use strict";const e={vicviper:{src:"images/gradius_vicviper.png",rate:1,obj:new Image},vicviper_back:{src:"images/gradius_vicviper_back.png",rate:1,obj:new Image},vicviper_bomb:{src:"images/gradius_vicviper_bomb.png",rate:1,obj:new Image},vicviper_bomb_red:{src:"images/gradius_vicviper_bomb_red.png",rate:1,obj:new Image},option:{src:"images/option.png",rate:1,obj:new Image},forcefield:{src:"images/gradius_forcefield.png",rate:1,obj:new Image},shield:{src:"images/gradius_shield.png",rate:1,obj:new Image},gradius_missile:{src:"images/gradius_missile.png",rate:1,obj:new Image},shot1:{src:"images/gradius_shot1.png",rate:.4,obj:new Image},shot2:{src:"images/gradius_shot2.png",rate:.4,obj:new Image},shot3:{src:"images/gradius_shot3.png",rate:.4,obj:new Image},shot_laser_col:{src:"images/gradius_shot_laser_col.png",rate:1,obj:new Image},meter:{src:"images/gradius_meter.png",rate:1,obj:new Image},meter_c:{src:"images/gradius_meter_c.png",rate:1,obj:new Image},enemy_fan:{src:"images/gradius_enemy_fan.png",rate:1,obj:new Image},enemy_a_1:{src:"images/gradius_enemy_a_1.png",rate:.55,obj:new Image},enemy_a_2:{src:"images/gradius_enemy_a_2.png",rate:.55,obj:new Image},enemy_b_1:{src:"images/gradius_enemy_b_1.png",rate:.55,obj:new Image},enemy_b_2:{src:"images/gradius_enemy_b_2.png",rate:.55,obj:new Image},enemy_c_1:{src:"images/gradius_enemy_c_1.png",rate:.4,obj:new Image},enemy_c_2:{src:"images/gradius_enemy_c_2.png",rate:.4,obj:new Image},enemy_c_3:{src:"images/gradius_enemy_c_3.png",rate:.4,obj:new Image},enemy_c_4:{src:"images/gradius_enemy_c_4.png",rate:.4,obj:new Image},enemy_d_1:{src:"images/gradius_enemy_d_1.png",rate:.2,obj:new Image},enemy_d_2:{src:"images/gradius_enemy_d_2.png",rate:.2,obj:new Image},enemy_d_3:{src:"images/gradius_enemy_d_3.png",rate:.2,obj:new Image},enemy_d_4:{src:"images/gradius_enemy_d_4.png",rate:.2,obj:new Image},enemy_e_1:{src:"images/gradius_enemy_e_1.png",rate:.2,obj:new Image},enemy_e_2:{src:"images/gradius_enemy_e_2.png",rate:.2,obj:new Image},enemy_e_3:{src:"images/gradius_enemy_e_3.png",rate:.2,obj:new Image},enemy_e_4:{src:"images/gradius_enemy_e_4.png",rate:.2,obj:new Image},enemy_f_1:{src:"images/gradius_enemy_f_1.png",rate:.4,obj:new Image},enemy_f_2:{src:"images/gradius_enemy_f_2.png",rate:.4,obj:new Image},enemy_f_3:{src:"images/gradius_enemy_f_3.png",rate:.4,obj:new Image},enemy_f_4:{src:"images/gradius_enemy_f_4.png",rate:.4,obj:new Image},enemy_g_1:{src:"images/gradius_enemy_g_1.png",rate:.4,obj:new Image},enemy_g_2:{src:"images/gradius_enemy_g_2.png",rate:.4,obj:new Image},enemy_g_3:{src:"images/gradius_enemy_g_3.png",rate:.4,obj:new Image},enemy_g_4:{src:"images/gradius_enemy_g_4.png",rate:.4,obj:new Image},enemy_m_1:{src:"images/gradius_enemy_m_1.png",rate:.24,obj:new Image},enemy_m_2:{src:"images/gradius_enemy_m_2.png",rate:.24,obj:new Image},enemy_m_3:{src:"images/gradius_enemy_m_3.png",rate:.24,obj:new Image},enemy_m_4:{src:"images/gradius_enemy_m_4.png",rate:.24,obj:new Image},enemy_m_5:{src:"images/gradius_enemy_m_5.png",rate:.24,obj:new Image},enemy_m_6:{src:"images/gradius_enemy_m_6.png",rate:.24,obj:new Image},enemy_m_7:{src:"images/gradius_enemy_m_7.png",rate:.24,obj:new Image},enemy_m_8:{src:"images/gradius_enemy_m_8.png",rate:.24,obj:new Image},enemy_m_group:{src:"images/gradius_enemy_m_group.png",rate:1,obj:new Image},enemy_o_1:{src:"images/gradius_enemy_o_1.png",rate:.3,obj:new Image},enemy_o_2:{src:"images/gradius_enemy_o_2.png",rate:.3,obj:new Image},enemy_p_1:{src:"images/gradius_enemy_p_1.png",rate:1,obj:new Image},enemy_p_2:{src:"images/gradius_enemy_p_2.png",rate:.3,obj:new Image},enemy_p_3:{src:"images/gradius_enemy_p_3.png",rate:.3,obj:new Image},enemy_p_4:{src:"images/gradius_enemy_p_4.png",rate:.3,obj:new Image},enemy_p_5:{src:"images/gradius_enemy_p_5.png",rate:.3,obj:new Image},enemy_m_a_1:{src:"images/gradius_enemy_m_a_1.png",rate:.25,obj:new Image},enemy_m_a_2:{src:"images/gradius_enemy_m_a_2.png",rate:.25,obj:new Image},enemy_m_b_1:{src:"images/gradius_enemy_m_b_1.png",rate:.25,obj:new Image},enemy_m_b_2:{src:"images/gradius_enemy_m_b_2.png",rate:.25,obj:new Image},enemy_m_z:{src:"images/gradius_enemy_m_z.png",rate:.25,obj:new Image},enemy_moai_ring:{src:"images/gradius_enemy_moai_ring.png",rate:1,obj:new Image},enemy_cell_boss:{src:"images/gradius_enemy_cell_boss.png",rate:1,obj:new Image},enemy_cell_boss_eye:{src:"images/gradius_enemy_cell_boss_eye.png",rate:1,obj:new Image},enemy_cell_core:{src:"images/gradius_enemy_cell_core.png",rate:1,obj:new Image},enemy_cell_hand_1:{src:"images/gradius_enemy_cell_hand_1.png",rate:1,obj:new Image},enemy_cell_hand_2:{src:"images/gradius_enemy_cell_hand_2.png",rate:1,obj:new Image},enemy_cell_hand_3:{src:"images/gradius_enemy_cell_hand_3.png",rate:1,obj:new Image},enemy_cell_a_1:{src:"images/gradius_enemy_cell_a_1.png",rate:1,obj:new Image},enemy_cell_a_2:{src:"images/gradius_enemy_cell_a_2.png",rate:1,obj:new Image},enemy_cell_b_1:{src:"images/gradius_enemy_cell_b_1.png",rate:1,obj:new Image},enemy_cell_b_2:{src:"images/gradius_enemy_cell_b_2.png",rate:1,obj:new Image},enemy_frame_1:{src:"images/gradius_enemy_frame_1.png",rate:1,obj:new Image},enemy_frame_2:{src:"images/gradius_enemy_frame_2.png",rate:1,obj:new Image},enemy_frame_3:{src:"images/gradius_enemy_frame_3.png",rate:1,obj:new Image},enemy_frame_4:{src:"images/gradius_enemy_frame_4.png",rate:1,obj:new Image},enemy_frame_5:{src:"images/gradius_enemy_frame_5.png",rate:1,obj:new Image},enemy_frame_6:{src:"images/gradius_enemy_frame_6.png",rate:1,obj:new Image},enemy_frame_head1:{src:"images/gradius_enemy_frame_head_1.png",rate:1,obj:new Image},enemy_frame_head2:{src:"images/gradius_enemy_frame_head_2.png",rate:1,obj:new Image},enemy_frame_head3:{src:"images/gradius_enemy_frame_head_3.png",rate:1,obj:new Image},enemy_frame_head4:{src:"images/gradius_enemy_frame_head_4.png",rate:1,obj:new Image},enemy_frame_body1:{src:"images/gradius_enemy_frame_body_1.png",rate:1,obj:new Image},enemy_bigcore:{src:"images/gradius_enemy_bigcore.png",rate:.6,obj:new Image},enemy_bigcore_1:{src:"images/gradius_enemy_bigcore_1.png",rate:.6,obj:new Image},enemy_bigcore_2:{src:"images/gradius_enemy_bigcore_2.png",rate:.6,obj:new Image},enemy_bigcore_3:{src:"images/gradius_enemy_bigcore_3.png",rate:.6,obj:new Image},enemy_bigcore_4_1:{src:"images/gradius_enemy_bigcore_4_1.png",rate:.6,obj:new Image},enemy_bigcore_4_2:{src:"images/gradius_enemy_bigcore_4_2.png",rate:.6,obj:new Image},enemy_bigcore_4_3:{src:"images/gradius_enemy_bigcore_4_3.png",rate:.6,obj:new Image},enemy_bigcore_4_4:{src:"images/gradius_enemy_bigcore_4_4.png",rate:.6,obj:new Image},enemy_bigcore_4_5:{src:"images/gradius_enemy_bigcore_4_5.png",rate:.6,obj:new Image},enemy_cristalcore:{src:"images/gradius_enemy_cristalcore.png",rate:1,obj:new Image},enemy_cristalcore_hand1:{src:"images/gradius_enemy_cristalcore_hand1.png",rate:.3,obj:new Image},enemy_cristalcore_hand2:{src:"images/gradius_enemy_cristalcore_hand2.png",rate:.4,obj:new Image},enemy_cristalcore_wall1:{src:"images/gradius_enemy_cristalcore_wall1.png",rate:1,obj:new Image},enemy_cristalcore_wall2:{src:"images/gradius_enemy_cristalcore_wall2.png",rate:1,obj:new Image},enemy_cristalcore_shot:{src:"images/gradius_enemy_cristalcore_shot.png",rate:1,obj:new Image},enemy_cube:{src:"images/gradius_enemy_cube.png",rate:1,obj:new Image},enemy_bigcore2:{src:"images/gradius_enemy_bigcore2.png",rate:1,obj:new Image},enemy_bigcore2_hand:{src:"images/gradius_enemy_bigcore2_hand.png",rate:1,obj:new Image},enemy_bigcore2_wall:{src:"images/gradius_enemy_bigcore2_wall.png",rate:1,obj:new Image},enemy_bigcore2_core:{src:"images/gradius_enemy_bigcore2_core.png",rate:1,obj:new Image},enemy_bigcore2_back:{src:"images/gradius_enemy_bigcore2_back.png",rate:1,obj:new Image},enemy_death:{src:"images/gradius_enemy_death.png",rate:1,obj:new Image},enemy_death_front:{src:"images/gradius_enemy_death_front.png",rate:1,obj:new Image},enemy_death_shot:{src:"images/gradius_enemy_death_shot.png",rate:1,obj:new Image},enemy_death_shot2:{src:"images/gradius_enemy_death_shot2.png",rate:1,obj:new Image},enemy_collapes0:{src:"images/gradius_enemy_collapes0.png",rate:1,obj:new Image},enemy_collapes1:{src:"images/gradius_enemy_collapes1.png",rate:1,obj:new Image},enemy_collapes2:{src:"images/gradius_enemy_collapes2.png",rate:1,obj:new Image},enemy_collapes8:{src:"images/gradius_enemy_collapes8.png",rate:1,obj:new Image},enemy_collapes9:{src:"images/gradius_enemy_collapes9.png",rate:1,obj:new Image},enemy_bullet:{src:"images/gradius_enemy_bullet.png",rate:1,obj:new Image},enemy_bullet_cell:{src:"images/gradius_enemy_bullet_cell.png",rate:1,obj:new Image},enemy_bullet_z:{src:"images/gradius_enemy_bullet_z.png",rate:1,obj:new Image},enemy_bullet_laser:{src:"images/gradius_enemy_bullet_laser.png",rate:1,obj:new Image},pc_red:{src:"images/gradius_pc_red.png",rate:1,obj:new Image},pc_blue:{src:"images/gradius_pc_blue.png",rate:1,obj:new Image},map_cube_A:{src:"images/gradius_map_cube_A.png",rate:1,obj:new Image},map_moai_A:{src:"images/gradius_map_moai_A.png",rate:1,obj:new Image},map_moai_B:{src:"images/gradius_map_moai_B.png",rate:1,obj:new Image},map_volcano_A:{src:"images/gradius_map_volcano_A.png",rate:1,obj:new Image},map_volcano_B:{src:"images/gradius_map_volcano_B.png",rate:1,obj:new Image},map_volcano_C:{src:"images/gradius_map_volcano_C.png",rate:1,obj:new Image},map_volcano_D:{src:"images/gradius_map_volcano_D.png",rate:1,obj:new Image},map_volcano_E:{src:"images/gradius_map_volcano_E.png",rate:1,obj:new Image},map_volcano_F:{src:"images/gradius_map_volcano_F.png",rate:1,obj:new Image},map_volcano_G:{src:"images/gradius_map_volcano_G.png",rate:1,obj:new Image},map_volcano_H:{src:"images/gradius_map_volcano_H.png",rate:1,obj:new Image},map_volcano_I:{src:"images/gradius_map_volcano_I.png",rate:1,obj:new Image},map_volcano_J:{src:"images/gradius_map_volcano_J.png",rate:1,obj:new Image},map_volcano_K:{src:"images/gradius_map_volcano_K.png",rate:1,obj:new Image},map_volcano_L:{src:"images/gradius_map_volcano_L.png",rate:1,obj:new Image},map_volcano_M:{src:"images/gradius_map_volcano_M.png",rate:1,obj:new Image},map_volcano_N:{src:"images/gradius_map_volcano_N.png",rate:1,obj:new Image},map_volcano_O:{src:"images/gradius_map_volcano_O.png",rate:1,obj:new Image},map_volcano_P:{src:"images/gradius_map_volcano_P.png",rate:1,obj:new Image},map_frame_A:{src:"images/gradius_map_frame_A.png",rate:1,obj:new Image},map_frame_B:{src:"images/gradius_map_frame_B.png",rate:1,obj:new Image},map_frame_C:{src:"images/gradius_map_frame_C.png",rate:1,obj:new Image},map_frame_D:{src:"images/gradius_map_frame_D.png",rate:1,obj:new Image},map_frame_E:{src:"images/gradius_map_frame_E.png",rate:1,obj:new Image},map_frame_F:{src:"images/gradius_map_frame_F.png",rate:1,obj:new Image},map_cell_A:{src:"images/gradius_map_cell_A.png",rate:1,obj:new Image},map_cell_B:{src:"images/gradius_map_cell_B.png",rate:1,obj:new Image},map_cell_C:{src:"images/gradius_map_cell_C.png",rate:1,obj:new Image},map_cell_D:{src:"images/gradius_map_cell_D.png",rate:1,obj:new Image},map_cell_V:{src:"images/gradius_map_cell_V.png",rate:1,obj:new Image},map_cell_W:{src:"images/gradius_map_cell_W.png",rate:1,obj:new Image},map_cell_Y:{src:"images/gradius_map_cell_Y.png",rate:1,obj:new Image},map_cell_Z:{src:"images/gradius_map_cell_Z.png",rate:1,obj:new Image},map_cell_wall:{src:"images/gradius_map_cell_wall.png",rate:1,obj:new Image}},t={font:{src:"images/gradius_font.png",rate:1,obj:new Image},gradius_powermeterselect:{src:"images/gradius_powermeterselect.png",rate:.28,obj:new Image},gradius_powermeterselect_shield:{src:"images/gradius_powermeterselect_shield.png",rate:.28,obj:new Image},gradius_powermeterselect_0:{src:"images/gradius_powermeterselect_0.png",rate:.28,obj:new Image},gradius_powermeterselect_1:{src:"images/gradius_powermeterselect_1.png",rate:.28,obj:new Image},gradius_powermeterselect_2:{src:"images/gradius_powermeterselect_2.png",rate:.28,obj:new Image},gradius_powermeterselect_3:{src:"images/gradius_powermeterselect_3.png",rate:.28,obj:new Image},gradius_powermeterselect_shield_0:{src:"images/gradius_powermeterselect_shield_0.png",rate:.28,obj:new Image},gradius_powermeterselect_shield_1:{src:"images/gradius_powermeterselect_shield_1.png",rate:.28,obj:new Image}},s={shot_laser:{src:"audios/shot_laser.mp3",volume:1,obj:null,buf:new Object},missile:{src:"audios/missile.mp3",volume:1,obj:null,buf:new Object},shot_normal:{src:"audios/shot_normal.mp3",volume:1,obj:null,buf:new Object},shot_ripple:{src:"audios/shot_ripple.mp3",volume:1,obj:null,buf:new Object},vicviper_bomb:{src:"audios/vicviper_bomb.mp3",volume:1,obj:null,buf:new Object},vicviper_shield_reduce:{src:"audios/vicviper_shield_reduce.mp3",volume:1,obj:null,buf:new Object},pc:{src:"audios/pc.mp3",volume:1,obj:null,buf:new Object},playerset:{src:"audios/playerset.mp3",volume:1,obj:null,buf:new Object},pms_select:{src:"audios/pms_select.mp3",volume:1,obj:null,buf:new Object},enemy_bullet_laser:{src:"audios/enemy_bullet_laser.mp3",volume:1,obj:null,buf:new Object},enemy_bullet_laser_long:{src:"audios/enemy_bullet_laser_long.mp3",volume:1,obj:null,buf:new Object},enemy_collision1:{src:"audios/enemy_collision1.mp3",volume:1,obj:null,buf:new Object},enemy_collision2:{src:"audios/enemy_collision2.mp3",volume:1,obj:null,buf:new Object},enemy_collision3:{src:"audios/enemy_collision3.mp3",volume:1,obj:null,buf:new Object},enemy_collision4:{src:"audios/enemy_collision4.mp3",volume:1,obj:null,buf:new Object},enemy_collision5:{src:"audios/enemy_collision5.mp3",volume:1,obj:null,buf:new Object},enemy_collision6:{src:"audios/enemy_collision6.mp3",volume:1,obj:null,buf:new Object},enemy_collision7:{src:"audios/enemy_collision7.mp3",volume:1,obj:null,buf:new Object},enemy_all_out:{src:"audios/enemy_all_out.mp3",volume:1,obj:null,buf:new Object},enemy_cube:{src:"audios/enemy_cube.mp3",volume:1,obj:null,buf:new Object},map_cell_wall:{src:"audios/map_cell_wall.mp3",volume:1,obj:null,buf:new Object},bg_powermeterselect:{src:"audios/bg_powermeterselect.mp3",volume:1,obj:null,buf:new Object},bg_boss:{src:"audios/bg_boss.mp3",volume:1,obj:null,buf:new Object},bg_type1:{src:"audios/bg_moai.mp3",volume:1,obj:null,buf:new Object},bg_type2:{src:"audios/bg_volcano.mp3",volume:1,obj:null,buf:new Object},bg_type3:{src:"audios/bg_crystal.mp3",volume:1,obj:null,buf:new Object},bg_type4:{src:"audios/bg_frame.mp3",volume:1,obj:null,buf:new Object},bg_type5:{src:"audios/bg_thunderbolt.mp3",volume:1,obj:null,buf:new Object},bg_type6:{src:"audios/bg_cell.mp3",volume:1,obj:null,buf:new Object}};let i=!1,_=0,n=0,o=null,a=null,r=null,l=!1,h=!1,m=!1,c=0;const g=null===window.ontouchstart,d=null===window.ontouchstart?"touchstart":"keydown",p=null===window.ontouchstart?"touchend":"keyup",u=60;let y,w,b=!1;const f="_SHOTTYPE_MISSILE",v="_SHOTTYPE_NORMAL",x="_SHOTTYPE_DOUBLE",I="_SHOTTYPE_LASER",j="_SHOTTYPE_RIPPLE_LASER";let D=v,M="",P="",E="",C=new Array,S=0;const k=4,R=100;let T=!1,O=new Array,F=new Array;const A=5,L=2;let Y={_SHOTTYPE_NORMAL:new Array,_SHOTTYPE_DOUBLE:new Array,_SHOTTYPE_LASER:new Array},U=new Array,q=!1,z=new Array,B=new Array,H=new Array,X=4,G=new Array,K="",N="",W="",Z=new Array;const J=70;let V=new Array,Q="38,38,40,40,37,39,37,39,66,65";const $=[{_ENEMY_SHOT_RATE:1e-4,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:5e-4,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.002,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.005,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.01,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:2}],ee=0,te=1,se=2,ie=new(window.AudioContext||window.webkitAudioContext);class _e{constructor(e,t,i,_,n,o,a){this.id=z.length,this.gid=0,this.img=e,this.imgPos=_||[0],this.aniItv=n||10,this.width=o||this.img.width,this.height=a||this.img.height,this.x=t||0,this.y=i||0,this.audio_collision=s.enemy_collision1,this.audio_alive=s.enemy_collision3,this.isshot=!1,this._DEF_DIR={_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},this._DEF_SHOTSTATUS={_SHOTTYPE_NORMAL:1,_SHOTTYPE_MISSILE:2,_SHOTTYPE_DOUBLE:1,_SHOTTYPE_RIPPLE_LASER:1.5,_SHOTTYPE_LASER:1},this.alpha=1,this._c=0,this.speed=1,this.getscore=200,this.direct=this._DEF_DIR._U,this._standby=!0,this._isshow=!0,this._status=1,this.haspc=!1,this._collision_type="t0",this.is_ignore=!1,this.is_able_collision=!0,this.is_ignore_collision=!1,this.shotColMap=["0,0,"+this.width+","+this.height],this.col_date=null,this.col_canint=150,this._s="0"}init(){this._status=0,this._isshow=!1}collision(e,t){return!!this.isCollision()&&(!this.is_able_collision||(this.setStatus(e,t),!0))}isAbleCollision(){return this.is_able_collision}isIgnore(){return this.is_ignore}isIgnoreCollision(){return this.is_ignore_collision}isCollision(){let e=this;return null===e.col_date?(e.col_date=new Date,!0):new Date-e.col_date>e.col_canint&&(e.col_date=new Date,!0)}setAlive(){let e=this;e.isalive()?ni._setPlay(e.audio_alive):(M.set(e.getscore),ni._setPlay(e.audio_collision))}setStatus(e){this._status-=this._DEF_SHOTSTATUS[e]||1,this.setAlive()}getEnemyCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}isalive(){return this._status>0}isshow(){return this._isshow}shot(){ni.isEnemyCanvasOut(this)||Math.random()>=$[X]._ENEMY_SHOT_RATE||B.push(new Je({x:this.getEnemyCenterPosition()._x,y:this.getEnemyCenterPosition()._y}))}get_move_bound_val(){return parseInt(2*Math.random()+1)*(Math.random()>.5?1:-1)}set_imgPos(){this._c=this._c>=this.imgPos.length*this.aniItv-1?0:this._c+1}get_imgPos(){return this.imgPos[parseInt(this._c/this.aniItv)]}setDrawImage(e,t,s,i){let _=this,n=i||0,o=(s||_.img.width,e||_.img.width),a=t||_.img.height;w.save(),_.setDrawImageDirect(),void 0===i||void 0===s||void 0===e||void 0===t?w.drawImage(_.img,_.x,_.y,_.img.width,_.img.height):w.drawImage(_.img,n,0,o,a,_.x,_.y,o,a),w.restore()}setDrawImageDirect(){let e=this;e.direct===e._DEF_DIR._U&&w.setTransform(1,0,0,-1,0,2*e.y+e.img.height),e.direct===e._DEF_DIR._LU&&w.setTransform(-1,0,0,-1,2*e.x+e.img.width,2*e.y+e.img.height),e.direct===e._DEF_DIR._LD&&w.setTransform(-1,0,0,1,2*e.x+e.img.width,0)}isStandBy(){return this._standby}isCanvasOut(){return ni.isEnemyCanvasOut(this,{up:!1,down:!1,left:!0,right:!1})}showCollapes(e,t){let s=this;s._isshow=!1,s.haspc?G.push(new Os(s.x,s.y)):H.push(new ps(e||s.x+s.width/2,t||s.y+s.height/2,s._collision_type))}isMove(){let e=this;return e.isStandBy()?(e.move_standby(),!1):e.isCanvasOut()?(e._status=0,e._isshow=!1,!1):!!e.isshow()&&(!!e.isalive()||(e.showCollapes(),!1))}moveDraw(){this.setDrawImage(),this.shot()}move_standby(){let e=this;e.x<y.width-20&&(e._standby=!1)}move(){this.x=W.getX(this.x),this.y=W.getY(this.y),this.isMove()&&this.moveDraw()}}class ne extends _e{constructor(t,s,i){super(e.enemy_fan.obj,t,s,[0,25,50,75,100,125,150,175],5,25,25);this.haspc=!0,this.parts=[],this.is_ignore=!0}move_standby(){let e=this;if(!(e.x>y.width)){e._standby=!1,e.parts=[new oe({x:e.x+e.width,y:e.y}),new oe({x:e.x+.5*e.width,y:e.y}),new oe({x:e.x+e.width,y:e.y}),new oe({x:e.x+1.5*e.width,y:e.y}),new oe({x:e.x+2*e.width,y:e.y}),new oe({x:e.x+2.5*e.width,y:e.y})];for(let t=0;t<e.parts.length;t++)z.push(e.parts[t])}}moveDraw(){let e=this;for(let t=e.parts.length-1;t>=0;t--){let s=e.parts[t];s.moveDraw(),s.isalive()||e.parts.splice(t,1)}if(0===e.parts.length)return e.x<y.width&&e.showCollapes(),void e.init();e.x=e.parts[e.parts.length-1].x,e.y=e.parts[e.parts.length-1].y}}class oe extends _e{constructor(t){super(e.enemy_fan.obj,t.x,t.y,[0,25,50,75,100,125,150,175],5,25,25);this._status=1,this.speed=2,this.pos_y=t.y>250,this.change_x=!1,this.change_y=!1}isCanvasOut(){return ni.isEnemyCanvasOut(this,{up:!1,down:!1,left:!0,right:this.change_x})}moveDraw(){let e=this;if(e.x=W.getX(e.x),e.y=W.getY(e.y),!e.isMove())return;const t=e.pos_y?275:200;e.change_x=e.change_x||e.x<500,e.x+=e.change_x?e.speed+W.getBackGroundSpeed():-1*e.speed,e.change_y=e.change_y||e.pos_y&&e.y<t||!e.pos_y&&e.y>t,e.y+=(()=>e.change_x?e.change_y?0:e.pos_y?-1*e.speed:e.speed:0)(),e.set_imgPos(),ni._setDrawImage({img:e.img,x:e.x,y:e.y,imgPosx:e.get_imgPos(),width:e.width,basePoint:1}),e.shot()}move(){}}class ae extends _e{constructor(t,s,i){super(e.enemy_a_1.obj,t,s);this._status=1,this.direct=i||this._DEF_DIR._U,this.defimg=[e.enemy_a_1.obj,e.enemy_a_2.obj]}setDrawImageDirect(){let e=this;e.direct===e._DEF_DIR._U&&(P.x<e.x?w.setTransform(1,0,0,-1,0,2*e.y+e.img.height):w.setTransform(-1,0,0,-1,2*e.x+e.img.width,2*e.y+e.img.height)),e.direct===e._DEF_DIR._D&&(P.x<e.x?w.setTransform(1,0,0,1,0,0):w.setTransform(-1,0,0,1,2*e.x+e.img.width,0))}moveDraw(){this.img=Math.abs(P.y-this.y)>100?this.defimg[0]:this.defimg[1],this.setDrawImage(),this.shot()}}class re extends ae{constructor(t,s,i){super(t,s,i);this.direct=i||this._DEF_DIR._U,this.haspc=!0,this.defimg=[e.enemy_b_1.obj,e.enemy_b_2.obj]}}class le extends _e{constructor(t,s,i){super(e.enemy_c_1.obj,t,s);let _=this;_.x=t,_.y=i===_._DEF_DIR._D?s-(e.enemy_c_1.obj.height-W.t):s,_._st="_st1",_._shot=!1,_._status=1,_.direct=i||_._DEF_DIR._U,_._collision_type="t1",_.speed=$[X]._ENEMY_SPEED,_._c_shotstep=0,_.shotstep=[{img:e.enemy_c_3.obj,scale:1},{img:e.enemy_c_4.obj,scale:1}],_._c_walkstep=0,_.walkstep=[{img:e.enemy_c_1.obj,scale:1},{img:e.enemy_c_2.obj,scale:1}],_._c_walk=0;_.shotColMap=i===_._DEF_DIR._D?["10,10,43,42"]:["0,0,43,32"],_._ene_status={_st1:{_f:function(){!0!==_._shot&&(_._c_walkstep=19===_._c_walkstep?0:_._c_walkstep+1,_.img=_.walkstep[parseInt(_._c_walkstep/10)].img,_._c_walk++)},_setX:function(){return _.x+2*_.speed}},_st2:{_f:function(){if(!(_.x>=y.width)){if(_._shot=!0,_._c_shotstep>=19)return _.shot(),_._c_shotstep=0,_._shot=!1,void(_._st="_st1");_._c_shotstep+=1,_.img=_.img=_.shotstep[parseInt(_._c_shotstep/10)].img}},_setX:function(){return _.x}}}}map_collition(){let e=this,t=e.getEnemyCenterPosition(),s=W.getMapX(t._x),i=W.getMapY(t._y);W.isMapBefore(s,i)&&(e.speed=Math.abs(e.speed)),W.isMapLastSide(s,i)&&(e.speed=-1*e.speed);let _=W.t;_=2*Math.abs(e.speed);let n=W.isMapCollision(s+1,i)||W.isMapCollision(s-1,i);var o;e.y=(o=e).direct===e._DEF_DIR._U?n?o.y+_:o.y:o.direct===e._DEF_DIR._D?n?o.y-_:o.y:void 0,e.y=function(t){return t.direct===e._DEF_DIR._U?W.isMapCollision(s,i-1)?t.y:t.y-_:t.direct===e._DEF_DIR._D?W.isMapCollision(s,i+1)?t.y:t.y+_:void 0}(e)}setDrawImageDirect(){let e=this;e.direct===e._DEF_DIR._U&&(P.x<e.x?w.setTransform(1,0,0,-1,0,2*e.y+e.img.height):w.setTransform(-1,0,0,-1,2*e.x+e.img.width,2*e.y+e.img.height)),e.direct===e._DEF_DIR._D&&(P.x<e.x?w.setTransform(1,0,0,1,0,0):w.setTransform(-1,0,0,1,2*e.x+e.img.width,0))}set_speed(){let e=P.getPlayerCenterPosition();this._c_walk>5e3*Math.random()&&(this._c_walk=0,this.speed=e._x<this.x?-1*this.speed:Math.abs(this.speed))}shot(){if(ni.isEnemyCanvasOut(this))return;let e=P.getPlayerCenterPosition(),t=this.getEnemyCenterPosition(),s=ni.getDeg({x:e._x,y:e._y},{x:t._x,y:t._y});B.push(new Je({x:t._x,y:t._y,deg:s-10})),B.push(new Je({x:t._x,y:t._y,deg:s+10}))}moveDraw(){this.map_collition(),this.set_speed(),this._st=Math.random()<$[X]._ENEMY_SHOT_RATE||this._shot?"_st2":"_st1",this._ene_status[this._st]._f(),this.x=this._ene_status[this._st]._setX(),this.setDrawImage()}}class he extends _e{constructor(t,s,i){super(e.enemy_d_1.obj,t,s);this._status=1,this.speed=2,this._col_c=0,this.col=[{img:e.enemy_d_1.obj,scale:1},{img:e.enemy_d_2.obj,scale:1},{img:e.enemy_d_3.obj,scale:1},{img:e.enemy_d_4.obj,scale:1},{img:e.enemy_d_3.obj,scale:1},{img:e.enemy_d_2.obj,scale:1}]}moveDraw(){this.x+=-1*this.speed;let e=this.x,t=Math.cos(e*Math.PI/180);var s;this.y+=t,this.img=((s=this)._col_c=s._col_c>=5*s.col.length-1?0:s._col_c+1,s.col[parseInt(s._col_c/5)].img),this.setDrawImage(),this.shot()}}class me extends he{constructor(t,s,i){super(t,s,i);this.haspc=!0,this._col_c=0,this.col=[{img:e.enemy_e_1.obj,scale:1},{img:e.enemy_e_2.obj,scale:1},{img:e.enemy_e_3.obj,scale:1},{img:e.enemy_e_4.obj,scale:1},{img:e.enemy_e_3.obj,scale:1},{img:e.enemy_e_2.obj,scale:1}],this.defimg=this.col}}class ce extends _e{constructor(t,s,i){super(e.enemy_f_1.obj,t,s);this._status=1,this.haspc=!1,this._v=0,this.direct=i||this._DEF_DIR._U,this.speed=i===this._DEF_DIR._U?-.05:.05,this._col_c=0,this.col=[{img:e.enemy_f_1.obj,scale:1},{img:e.enemy_f_2.obj,scale:1},{img:e.enemy_f_3.obj,scale:1},{img:e.enemy_f_4.obj,scale:1}]}getDir(){return this.x>y.width/2?-1:.5}isCanvasOut(){return ni.isEnemyCanvasOut(this,{up:!0,down:!0,left:!1,right:!1})}shot(){let e=this.getEnemyCenterPosition();for(let t=30;t<=360;t+=30)B.push(new Je({x:e._x,y:e._y,deg:t}))}move_standby(){let e=this;e.x+e.img.width<0&&(e._standby=!1)}moveDraw(){let e=this;e.x+=4*e.getDir(),e.y+=e._v,e._v+=e.speed;let t=e.getEnemyCenterPosition(),s=W.getMapX(t._x),i=W.getMapY(t._y);var _;W.isMapCollision(s,i)&&(e._v+=e.speed,e._v*=-1),e.img=((_=e)._col_c=_._col_c>=5*_.col.length-1?0:_._col_c+1,_.col[parseInt(_._col_c/5)].img),e.setDrawImage(),e._v>0&&e._v<.05&&e.shot()}}class ge extends ce{constructor(t,s,i){super(t,s,i);this._status=1,this.haspc=!0,this.col=[{img:e.enemy_g_1.obj,scale:1},{img:e.enemy_g_2.obj,scale:1},{img:e.enemy_g_3.obj,scale:1},{img:e.enemy_g_4.obj,scale:1}]}}class de extends _e{constructor(t,s,i){super(e.enemy_m_1.obj,t,s);this._status=4,this._collision_type="t1",this.direct=i||this._DEF_DIR._U,this.getscore=200,this._col_c=0,this._isopen=!1,this._open_count=0,this.col=[{img:e.enemy_m_1.obj,scale:1},{img:e.enemy_m_2.obj,scale:1},{img:e.enemy_m_3.obj,scale:1},{img:e.enemy_m_4.obj,scale:1},{img:e.enemy_m_3.obj,scale:1},{img:e.enemy_m_2.obj,scale:1},{img:e.enemy_m_1.obj,scale:1}],this.col2=[{img:e.enemy_m_5.obj,scale:1},{img:e.enemy_m_6.obj,scale:1},{img:e.enemy_m_7.obj,scale:1},{img:e.enemy_m_8.obj,scale:1},{img:e.enemy_m_7.obj,scale:1},{img:e.enemy_m_6.obj,scale:1},{img:e.enemy_m_5.obj,scale:1}]}moveDraw(){let e=this;e.isalive()?(e.img=function(t){let s=t._status<=1?t.col2:t.col;return t._isopen?(t._open_count++,3===parseInt(t._col_c/5)&&t._open_count<=200?s[parseInt(t._col_c/5)].img:(t._open_count>200&&t._col_c>=5*s.length-1&&(t._col_c=0,t._open_count=0,t._isopen=!1),t._col_c=t._col_c>=5*s.length-1?0:t._col_c+1,s[parseInt(t._col_c/5)].img)):(e.x>=690&&e.x<700&&(e._isopen=!0),e.x>=380&&e.x<400&&(e._isopen=!0),s[0].img)}(e),function(t){if(!t._isopen)return;if(t._open_count%15!=0)return;let s=new pe({x:e.x+15,y:e.y,direct:e.direct});z.push(s)}(e),e.setDrawImage()):e.showCollapes(0,e.direct===e._DEF_DIR._U?0:-W.t)}}class pe extends _e{constructor(t){super(e.enemy_m_group.obj,t.x,t.y,[0,25,50,75,100,125,150],5,25,25);this._status=1,this.direct=t.direct||this._DEF_DIR._U,this.speed=2,this.getscore=100,this._change=!1,this._moveX=0,this._moveY=0}isCanvasOut(){return ni.isEnemyCanvasOut(this)}moveDraw(){let e=this,t=P.getPlayerCenterPosition();e._change=!!e._change||(e.direct===e._DEF_DIR._U&&t._y<e.y?(e._moveX=t._x<e.x?-1*e.speed:e.speed,!0):e.direct===e._DEF_DIR._D&&t._y>e.y&&(e._moveX=t._x<e.x?-1*e.speed:e.speed,!0)),e._moveY=e._change?0:e.direct===e._DEF_DIR._U?e.speed:e.direct===e._DEF_DIR._D?-1*e.speed:void 0,e.x+=e._moveX,e.y+=e._moveY,e.set_imgPos(),ni._setDrawImage({img:e.img,x:e.x,y:e.y,imgPosx:e.get_imgPos(),width:e.width,basePoint:1}),e.shot()}}class ue extends _e{constructor(t,s){super(e.enemy_o_1.obj,t,s)}isCanvasOut(){return this.x<200}isalive(){return!0}moveDraw(){if(Math.random()>.2)return;let t=new be(e[["enemy_o_1","enemy_o_2"][Math.random()>.5?1:0]].obj,this.x,this.y);z.push(t)}}class ye extends ue{constructor(e,t,s){super(e,t,s)}moveDraw(){if(Math.random()>.1)return;let t=new we(e[["enemy_o_1","enemy_o_2"][Math.random()>.5?1:0]].obj,this.x,this.y);z.push(t)}}class we extends _e{constructor(e,t,s){super(e,t,s);this._status=1,this.getscore=100,this.speedX=4*Math.random()+1,this.flagX=Math.random()>.5?1:-1,this.speedY=.2,this._v=-10,this._collision_type="t2"}map_collition(){let e=this,t=e.getEnemyCenterPosition(),s=W.getMapX(t._x),i=W.getMapY(t._y);W.isMapCollision(s,i-1)&&(e._status=0)}moveDraw(){this.map_collition(),this.x-=this.speedX*this.flagX,this.y+=this._v,this._v+=this.speedY,w.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}}class be extends we{constructor(e,t,s){super(e,t,s);this.speedY=-.2,this._v=10}map_collition(){let e=this,t=e.getEnemyCenterPosition(),s=W.getMapX(t._x),i=W.getMapY(t._y);W.isMapCollision(s,i+1)&&(e._status=0)}}class fe extends _e{constructor(t,s,i){super(e.enemy_p_1.obj,t,s);this._status=4,this.getscore=100,this.speedx=bs,this.speedy=(Math.random()+1)*(Math.random()>.5?1:-1),this._isbroken=!1,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,this._s="000,000,000"}setAlive(){this.isalive()||M.set(this.getscore)}map_collition(){let e=this,t=e.getEnemyCenterPosition(),s=W.getMapX(t._x),i=W.getMapY(t._y);(W.isMapCollision(s,i-1)||W.isMapCollision(s,i+1))&&(e.speedx=Math.random()>.4?Math.abs(e.speedx):-1*e.speedx,e.speedy=Math.random()>.4?Math.abs(e.speedy):-1*e.speedy)}move_bounds(){let e=this,t=z;if(e.isalive())for(let s=0;s<t.length;s++){if(!fe.prototype.isPrototypeOf(t[s]))continue;if(!t[s].isalive())continue;if(t[s].x>y.width)continue;if(e.id===t[s].id)continue;ni.isSqCollision(e.shotColMap[0],e.x+","+e.y,t[s].shotColMap,t[s].x+","+t[s].y)!==se&&(e.speedx=e.get_move_bound_val(),e.speedy=e.get_move_bound_val(),t[s].speedx=e.get_move_bound_val(),t[s].speedy=e.get_move_bound_val())}}showCollapes(){let t=this,i=t.getEnemyCenterPosition();if(t._status<=0&&!t._isbroken){for(let t=0;t<6;t++){let s=new ve(e[["enemy_p_2","enemy_p_2","enemy_p_3","enemy_p_4","enemy_p_5","enemy_p_5"][t]].obj,i._x+[-30,0,30,-30,0,30][t],i._y+[-30,-30,-30,30,30,30][t]);z.push(s)}return t._isbroken=!0,ni._setPlay(s.enemy_collision4),void t.init()}}moveDraw(){var e;this.map_collition(),this.move_bounds(),this.x-=((e=this).x+e.img.width>y.width&&(e.speedx=Math.abs(e.speedx)),e.speedx),this.y+=function(e){return e.y<0?e.speedy=Math.abs(e.speedy):e.y+e.img.height>y.height&&(e.speedy=-1),e.speedy}(this),w.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}}class ve extends _e{constructor(e,t,i){super(e,t,i);this.audio_collision=s.enemy_collision5,this._status=5,this.getscore=500,this.speedx=this.get_move_bound_val(),this.speedy=this.get_move_bound_val(),this.col_date=new Date,this._collision_type="t1"}setAlive(){this.isalive()||(M.set(this.getscore),ni._setPlay(s.enemy_collision5))}move_bounds(){let e=this;if(new Date-e.col_date<1e3)return;let t=z;if(e.isalive())for(let s=0;s<t.length;s++){if(!ve.prototype.isPrototypeOf(t[s]))continue;if(!t[s].isalive())continue;if(t[s].x>y.width)continue;if(e.id===t[s].id)continue;ni.isSqCollision(e.shotColMap[0],e.x+","+e.y,t[s].shotColMap,t[s].x+","+t[s].y)!==se&&(e.speedx=e.get_move_bound_val(),e.speedy=e.get_move_bound_val(),t[s].speedx=e.get_move_bound_val(),t[s].speedy=e.get_move_bound_val())}}map_collition(){let e=this,t=e.getEnemyCenterPosition(),s=W.getMapX(t._x),i=W.getMapY(t._y);(W.isMapCollision(s,i-1)||W.isMapCollision(s,i+1))&&(e.speedx=e.speedx<=0?Math.abs(e.speedx):-1*e.speedx,e.speedy=e.speedy<=0?Math.abs(e.speedy):-1*e.speedy)}moveDraw(){var e;this.map_collition(),this.move_bounds(),this.x-=((e=this).x+e.img.width>y.width&&(e.speedx=1.5),e.speedx),this.y+=function(e){return e.y<0?e.speedy=Math.abs(e.speedy):e.y+e.img.height>y.height&&(e.speedy=-1.5),e.speedy}(this),w.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}}class xe extends _e{constructor(t,i,_){super(e.enemy_m_a_1.obj,t,i);let n=this;n._status=2,n.direct=_||n._DEF_DIR._U,n.getscore=500,n._isSetMapDefCol=!1,n._isopen=!1,n._open_count=0,n.imgs=[e.enemy_m_a_1.obj,e.enemy_m_a_2.obj],n.audio_collision=s.enemy_collision5,n._collision_type="t8",n._collision_posy=n.direct===n._DEF_DIR._D?25:0,n._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,n.shotColMap=[n.direct===n._DEF_DIR._D?"0,50,35,85":n.direct===n._DEF_DIR._U?"0,25,35,50":n.direct===n._DEF_DIR._LD?"75,55,100,70":n.direct===n._DEF_DIR._LU?"75,35,100,50":void 0],n._s=(()=>n.direct===n._DEF_DIR._D?"0000,0011,0110,1111":n.direct===n._DEF_DIR._U?"1111,0110,0011,0000":n.direct===n._DEF_DIR._LD?"0000,1100,1110,1111":n.direct===n._DEF_DIR._LU?"1111,1110,1100,0000":void 0)()}collision(e,t){this._isopen&&this.isCollision()&&this.setStatus(e,t)}isShot(){let e=this;return!(e._status<=0)&&(!ni.isEnemyCanvasOut(e)&&(!(Math.abs(P.y-e.y)>100)&&(e.direct!==e._DEF_DIR._LU&&e.direct!==e._DEF_DIR._LD||!(P.x<e.x))))}shot(){let e=this;!e._open_count>0&&!e.isShot()||e._open_count++,e._open_count>0&&(e.img=e.imgs[1],e._isopen=!0),e._open_count>200&&(e.img=e.imgs[0],e._isopen=!1,e._open_count=-100),e._open_count<=0||e._open_count%10==0&&z.push(new je({x:e.x+parseInt(e.shotColMap[0].split(",")[0]),y:e.y+parseInt(e.shotColMap[0].split(",")[1]),direct:e.direct}))}showCollapes(){let t=this;t.img=e.enemy_m_z.obj,t.setDrawImage(),t._isSetMapDefCol||(W.set_mapdef_col(W.getMapX(t.x),W.getMapY(t.y),t.direct===t._DEF_DIR._D?"0000,0000,0000,1111":t.direct===t._DEF_DIR._U?"1111,0000,0000,0000":t.direct===t._DEF_DIR._LD?"0000,0000,0000,1111":t.direct===t._DEF_DIR._LU?"1111,0000,0000,0000":void 0),H.push(new ps(t.x+t.img.width/2,t.y+t.img.height/2+t._collision_posy,t._collision_type)),t._isSetMapDefCol=!0)}moveDraw(){this.setDrawImage(),this.shot()}}class Ie extends xe{constructor(t,s,i){super(t,s,i);let _=this;_._status=2,_.direct=i||_._DEF_DIR._U,_.imgs=[e.enemy_m_b_1.obj,e.enemy_m_b_2.obj],_.img=_.imgs[0],_._collision_posy=_.direct===_._DEF_DIR._D?-10:0,_.shotColMap=[_.direct===_._DEF_DIR._D?"20,40,50,85":_.direct===_._DEF_DIR._U?"20,25,50,70":void 0],_._s=(()=>_.direct===_._DEF_DIR._D?"0000,0000,0010,1111":_.direct===_._DEF_DIR._U?"1111,0010,0000,0000":void 0)()}}class je extends _e{constructor(t){super(e.enemy_moai_ring.obj,t.x,t.y,[0,25],5,25,25);this._status=1,this.direct=t.direct||this._DEF_DIR._U,this.audio_collision=s.enemy_collision2,this.rad=ni.getRad(P,{x:t.x,y:t.y}),this.sx=Math.cos(this.rad),this.sy=Math.sin(this.rad),this.speed=1.5*us[ws]._speed,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,this._collision_type="t2",this.direct,this._DEF_DIR._D}isCanvasOut(){return ni.isEnemyCanvasOut(this,{up:!1,down:!1,left:!0,right:!0})}map_collition(){let e=this,t=e.getEnemyCenterPosition(),s=W.getMapX(t._x),i=W.getMapY(t._y);W.isMapCollision(s,i)&&(H.push(new ps(t._x,t._y,e._collision_type)),e.init())}moveDraw(){this.map_collition(),this.x+=this.sx*this.speed,this.y+=this.sy*this.speed,this.set_imgPos(),ni._setDrawImage({img:this.img,x:this.x,y:this.y,imgPosx:this.get_imgPos(),width:this.width,basePoint:1})}}class De extends _e{constructor(t,s,i){super(e.enemy_frame_1.obj,t,s);this._status=1,this.getscore=200,this.speed=-1*(3*Math.random()+3),this.rad=0,this.speedx=0,this.speedy=0,this._isbroken=!1,this._c=0,this.imgs=[e.enemy_frame_1.obj,e.enemy_frame_2.obj],this.shotColMap=["5,5,"+(this.img.width-5)+","+(this.img.height-5)]}setAlive(){this.isalive()||M.set(this.getscore)}map_collition(){let e=this,t=e.getEnemyCenterPosition(),s=W.getMapX(t._x),i=W.getMapY(t._y);W.isMapCollision(s,i)&&e.init()}showCollapes(){let e=this,t=e.getEnemyCenterPosition();if(e._status>0)return;if(e._isbroken)return;let i=0,_=z;for(let e=0;e<_.length;e++)Me.prototype.isPrototypeOf(_[e])&&i++;let n=i>20?1:2;for(let s=0;s<n;s++){let s=new Me(t._x,t._y,e.direct);z.push(s)}e._isbroken=!0,ni._setPlay(s.enemy_collision1),e.init()}move_standby(){this.x>=y.width||(this.rad=Math.atan2(700*Math.random()-100-this.y,0-this.x),this.deg=this.rad/Math.PI*180,this.speedx=Math.cos(this.rad),this.speedy=Math.sin(this.rad),this._standby=!1)}moveDraw(){this.map_collition(),this.x-=this.speedx*this.speed,this.y-=this.speedy*this.speed,this._c=this._c>=5*this.imgs.length-1?0:this._c+1,this.img=this.imgs[parseInt(this._c/5)],ni._setDrawImage({img:this.img,x:this.x,y:this.y,deg:this.deg+180})}}class Me extends De{constructor(t,s,i){super(t,s,i);this._status=1,this.speed=-1*(4*Math.random()+4),this.deg=110*Math.random()+125,this.speedx=Math.cos(this.deg*Math.PI/180),this.speedy=Math.sin(this.deg*Math.PI/180),this._isbroken=!1,this.img=e.enemy_frame_3.obj,this.shotColMap=["5,5,"+(this.img.width-5)+","+(this.img.height-5)],this.imgs=[e.enemy_frame_3.obj,e.enemy_frame_4.obj],this._standby=!1}showCollapes(){let e=this,t=e.getEnemyCenterPosition();if(e._status>0)return;if(e._isbroken)return;let i=0,_=z;for(let e=0;e<_.length;e++)Pe.prototype.isPrototypeOf(_[e])&&i++;let n=i>20?0:1;for(let s=0;s<n;s++){let s=new Pe(t._x,t._y,e.direct);z.push(s)}e._isbroken=!0,ni._setPlay(s.enemy_collision1),e.init()}}class Pe extends De{constructor(t,s,i){super(t,s,i);this._status=1,this.speed=-1*(4*Math.random()+4),this.deg=110*Math.random()+125,this.speedx=Math.cos(this.deg*Math.PI/180),this.speedy=Math.sin(this.deg*Math.PI/180),this._isbroken=!1,this.img=e.enemy_frame_5.obj,this.shotColMap=["5,5,"+(this.img.width-5)+","+(this.img.height-5)],this.is_able_collision=!1,this.is_ignore_collision=Math.random()>.05,this._standby=!1,this.imgs=[e.enemy_frame_5.obj,e.enemy_frame_6.obj]}}class Ee extends _e{constructor(t,i,_){super(e.enemy_cell_core.obj,t,i);this._status=10,this.getscore=500,this.audio_alive=s.enemy_collision7,this._collision_type="t9",this.rad=0,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5,this.ani=[{scale:1},{scale:.95},{scale:.9},{scale:.85},{scale:.9},{scale:.95}],this.hands_up_rad=[],this.hands_up=[],this.hands_down_rad=[],this.hands_down=[],this.hands_distance=12}set_hands_rad(e,t,s){let i=P.getPlayerCenterPosition(),_=s.getEnemyCenterPosition(),n=parseInt(100*Math.random())-50,o=i._x+n-_._x,a=i._y+n-_._y,r=(e=>{let t=Math.random()/50;return(e=(e=s.flag?Math.cos(e)>0?s.rad+t:s.rad-t:Math.cos(e)>0?s.rad-t:s.rad+t)<0?2*Math.PI+e:e)>=s.rad_min&&e<=s.rad_max?e:s.rad})(Math.atan2(a,o));s.rad=r,e.unshift(r)}set_hands_pos(e,t,s,i,_){t.x=(i||0)+s.x+Math.cos(e)*this.hands_distance,t.y=(_||0)+s.y+Math.sin(e)*this.hands_distance}is_hands_up_status(){let e=this;for(let t=0;t<e.hands_up.length;t++)if(Se.prototype.isPrototypeOf(e.hands_up[t]))return e.hands_up[t].isalive()}is_hands_down_status(){let e=this;for(let t=0;t<e.hands_down.length;t++)if(Se.prototype.isPrototypeOf(e.hands_down[t]))return e.hands_down[t].isalive()}showCollapes(){let e=this,t=e.getEnemyCenterPosition();e._isshow=!1;for(let t=0;t<e.hands_up.length;t++)e.hands_up[t].showCollapes();for(let t=0;t<e.hands_down.length;t++)e.hands_down[t].showCollapes();H.push(new ps(t._x,t._y,e._collision_type)),ni._setPlay(e.audio_collision)}move_standby(){let e=this;if(e.x<y.width-20){e._standby=!1,e.hands_up=[new Ce({x:e.x,y:e.y,rad:3*Math.PI/2,rad_min:Math.PI+1.5,rad_max:Math.PI+2,flag:!0,ignore_collision:!1}),new Ce({x:e.x,y:e.y,rad:3*Math.PI/2-.2,rad_min:Math.PI+1,rad_max:Math.PI+2.2,flag:!0,ignore_collision:!1}),new Ce({x:e.x,y:e.y,rad:3*Math.PI/2-.4,rad_min:Math.PI+.7,rad_max:Math.PI+2.4,flag:!0,ignore_collision:!1}),new Ce({x:e.x,y:e.y,rad:3*Math.PI/2-.4,rad_min:Math.PI+.7,rad_max:Math.PI+2.4,flag:!0,ignore_collision:!1}),new Se({x:e.x,y:e.y,rad:3*Math.PI/2-.6,rad_min:Math.PI+.5,rad_max:Math.PI+2.6,flag:!0}),new Ce({x:e.x,y:e.y,rad:3*Math.PI/2-.8,rad_min:Math.PI+.5,rad_max:Math.PI+2.8,flag:!0}),new Ce({x:e.x,y:e.y,rad:3*Math.PI/2-1,rad_min:Math.PI+.3,rad_max:Math.PI+2.8,flag:!0}),new Ce({x:e.x,y:e.y,rad:3*Math.PI/2-1.2,rad_min:Math.PI+.3,rad_max:Math.PI+2.8,flag:!0}),new ke({x:e.x,y:e.y,rad:3*Math.PI/2-1.4,rad_min:Math.PI+.3,rad_max:Math.PI+2.6,flag:!0})];for(let t=0;t<e.hands_up.length;t++)z.push(e.hands_up[t]);e.hands_down=[new Ce({x:e.x,y:e.y,rad:Math.PI-1,rad_min:Math.PI-2,rad_max:Math.PI-1,flag:!1,ignore_collision:!1}),new Ce({x:e.x,y:e.y,rad:Math.PI-1,rad_min:Math.PI-2.1,rad_max:Math.PI-.9,flag:!1,ignore_collision:!1}),new Ce({x:e.x,y:e.y,rad:Math.PI-.9,rad_min:Math.PI-2.2,rad_max:Math.PI-.9,flag:!1,ignore_collision:!1}),new Ce({x:e.x,y:e.y,rad:Math.PI-.9,rad_min:Math.PI-2.3,rad_max:Math.PI-.6,flag:!1,ignore_collision:!1}),new Se({x:e.x,y:e.y,rad:Math.PI-.9,rad_min:Math.PI-2.7,rad_max:Math.PI-.6,flag:!1}),new Ce({x:e.x,y:e.y,rad:Math.PI-.8,rad_min:Math.PI-2.7,rad_max:Math.PI-.6,flag:!1}),new Ce({x:e.x,y:e.y,rad:Math.PI-.8,rad_min:Math.PI-2.8,rad_max:Math.PI-.1,flag:!1}),new Ce({x:e.x,y:e.y,rad:Math.PI-.7,rad_min:Math.PI-2.8,rad_max:Math.PI-.1,flag:!1}),new ke({x:e.x,y:e.y,rad:Math.PI-.7,rad_min:Math.PI-2.8,rad_max:Math.PI-.1,flag:!1})];for(let t=0;t<e.hands_down.length;t++)z.push(e.hands_down[t])}}moveDraw(){let e=this;e._c=e._c>=20*e.ani.length-1?0:e._c+1;let t=parseInt(e._c/20);const s=e.getEnemyCenterPosition(),i=P.getPlayerCenterPosition();let _=ni.getRad({x:i._x,y:i._y},{x:s._x,y:s._y});if(e.y+=Math.sin(_)*e.speed,!e.is_hands_up_status()&&0!==e.hands_up.length){for(let t=0;t<e.hands_up.length;t++)e.hands_up[t].showCollapes();e.hands_up=[]}if(!e.is_hands_down_status()&&0!==e.hands_down.length){for(let t=0;t<e.hands_down.length;t++)e.hands_down[t].showCollapes();e.hands_down=[]}e.hands_up_rad=[];for(let t=e.hands_up.length-1;t>=0;t--){if(void 0===e.hands_up[t-1]){e.set_hands_rad(e.hands_up_rad,e,e.hands_up[t]);break}e.set_hands_rad(e.hands_up_rad,e.hands_up[t-1],e.hands_up[t])}for(let t=0;t<e.hands_up.length;t++)0!==t?(e.set_hands_pos(e.hands_up_rad[t],e.hands_up[t],e.hands_up[t-1]),e.hands_up[t].moveDraw()):(e.set_hands_pos(e.hands_up_rad[t],e.hands_up[t],e,e.img.width/2-e.hands_up[t].img.width/2,10),e.hands_up[t].moveDraw());e.hands_down_rad=[];for(let t=e.hands_down.length-1;t>=0;t--){if(void 0===e.hands_down[t-1]){e.set_hands_rad(e.hands_down_rad,e,e.hands_down[t]);break}e.set_hands_rad(e.hands_down_rad,e.hands_down[t-1],e.hands_down[t])}for(let t=0;t<e.hands_down.length;t++)0!==t?(e.set_hands_pos(e.hands_down_rad[t],e.hands_down[t],e.hands_down[t-1]),e.hands_down[t].moveDraw()):(e.set_hands_pos(e.hands_down_rad[t],e.hands_down[t],e,e.img.width/2-e.hands_down[t].img.width/2,e.img.height-30),e.hands_down[t].moveDraw());ni._setDrawImage({img:e.img,x:s._x,y:s._y,scale:e.ani[t].scale*(e._status/10>.7?e._status/10:.7)});let n=e.img.width/2-e.img.width*e.ani[t].scale/2+","+(e.img.height/2-e.img.height*e.ani[t].scale/2)+","+e.img.width*e.ani[t].scale+","+e.img.height*e.ani[t].scale;e.shotColMap=[n]}}class Ce extends _e{constructor(t){super(e.enemy_cell_hand_1.obj,t.x,t.y);this._initx=t.x||0,this._inity=t.y||0,this.rad=t.rad,this.rad_min=t.rad_min||-1,this.rad_max=t.rad_max||-2,this.flag=t.flag||!1,this.is_able_collision=!1,this._collision_type="t2",this.is_ignore_collision=t.ignore_collision||!0,this.ani=[{scale:1},{scale:.95},{scale:.9},{scale:.85},{scale:.9},{scale:.95}],this._c=0}showCollapes(){let e=this.getEnemyCenterPosition();H.push(new ps(e._x,e._y,this._collision_type)),this.init()}shot(){}moveDraw(){this._c=this._c>=20*this.ani.length-1?0:this._c+1;let e=parseInt(this._c/20);const t=this.getEnemyCenterPosition();ni._setDrawImage({img:this.img,x:t._x,y:t._y,scale:this.ani[e].scale}),this.shot()}move(){this.x=W.getX(this.x),this.y=W.getY(this.y),this.isMove()}}class Se extends Ce{constructor(t){super(t);this.img=e.enemy_cell_hand_2.obj,this.is_able_collision=!0,this.audio_alive=s.enemy_collision7,this._status=10,this.is_ignore_collision=!1,this.shotColMap=["-10,-10,"+(this.img.width+10)+","+(this.img.height+10)]}shot(){}}class ke extends Ce{constructor(t){super(t);this.img=e.enemy_cell_hand_3.obj}shot(){ni.isEnemyCanvasOut(this)||Math.random()>=$[X]._ENEMY_SHOT_RATE||B.push(new Je({x:this.getEnemyCenterPosition()._x,y:this.getEnemyCenterPosition()._y,img:e.enemy_bullet_cell.obj,imgPos:[0,15]}))}moveDraw(){let e=P.getPlayerCenterPosition(),t=this.getEnemyCenterPosition(),s=Math.atan2(t._y-e._y,t._x-e._x);ni._setDrawImage({img:this.img,x:t._x,y:t._y,deg:s/Math.PI*180}),this.shot()}}class Re extends ae{constructor(t,s,i){super(t,s,i);this.direct=i||this._DEF_DIR._U,this.haspc=!1,this.defimg=[e.enemy_cell_a_1.obj,e.enemy_cell_a_2.obj]}}class Te extends ae{constructor(t,s,i){super(t,s,i);this.direct=i||this._DEF_DIR._U,this.haspc=!0,this.defimg=[e.enemy_cell_b_1.obj,e.enemy_cell_b_2.obj]}}class Oe extends _e{constructor(e,t,i){super(e,t,i);this.speed=0,this.getscore=1e4,this._c=0,this._c_self_collision=4e3,this.audio_collision=s.enemy_collision6,this.is_able_collision=!1,this.is_all_set=!1}init(){this._isshow=!1,this._status=0}shot(){}move_init(){}setSelfCollision(){if(!(this._c<this._c_self_collision)){for(let e=0;e<z.length;e++)z[e]._status=0;ni._setPlay(this.audio_collision)}}setWallCollision(){let e=this;if(void 0!==e.wall)for(let t=0;t<e.wall.length;t++){let i=e.wall[t];if(!i.isalive)continue;e.getEnemyCenterPosition();w.drawImage(i.img,e.x+i.x,e.y+i.y,i.img.width,i.img.height),i.cs>=e._status&&(H.push(new ps(e.x+i.x,e.y+i.y)),M.set(500),ni._setPlay(s.enemy_collision5),i.isalive=!1)}}moveDraw(){w.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}move_Allset(){}isAllset(){let e=this;return e.is_all_set?(e.set_wall_standBy(),!0):(e.move_Allset(),!1)}isMove(){let e=this;return e.isStandBy()?(e.move_standby(),!1):!!e.isshow()&&(!!e.isalive()||(e.showCollapes(),!1))}move_before(){return!1}move(){}}class Fe extends _e{constructor(e,t,i,_){super(e,i,_);this._initx=i||0,this._inity=_||0,this._boss=t,this.x=this._boss.x+this._initx,this.y=this._boss.y+this._inity,this._status=10,this.getscore=500,this._standby=!0,this.is_able_collision=!1,this.audio_collision=s.enemy_collision5,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.5}setStandByDone(){this._standby=!1}moveDraw(){if(!this.isalive())return;let e=void 0===this._boss?0:this._boss.x,t=void 0===this._boss?0:this._boss.y;this.x=e+parseInt(this._initx),this.y=t+parseInt(this._inity),this.setDrawImage()}move(){}}class Ae extends Oe{constructor(t,s){super(e.enemy_bigcore.obj,t,s);let i=this;i._status=1,i.speed=3,i.is_able_collision=!1,i.wall=[new Fe(e.enemy_bigcore_1.obj,i,15,50),new Fe(e.enemy_bigcore_1.obj,i,25,50),new Fe(e.enemy_bigcore_1.obj,i,35,50),new Fe(e.enemy_bigcore_2.obj,i,45,53),new Fe(e.enemy_bigcore_3.obj,i,70,43)],i._wall_statuses="";for(let e=0;e<i.wall.length;e++)z.push(i.wall[e]);i.c_z4_ani=30,i.z4_ani=[{img:e.enemy_bigcore_4_1.obj,al:1},{img:e.enemy_bigcore_4_2.obj,al:.8},{img:e.enemy_bigcore_4_3.obj,al:.6},{img:e.enemy_bigcore_4_4.obj,al:.4},{img:e.enemy_bigcore_4_5.obj,al:.2}],i.tid=null,i._moveYStop=!1,i.shotColMap=["120,0,169,40,false","120,70,169,114,false"],i._collision_type="t9"}set_wall_standBy(){let e=this;for(let t=0;t<e.wall.length;t++)e.wall[t].setStandByDone()}set_wall_status(){let e=this;e._wall_statuses="";for(let t=0;t<e.wall.length;t++)e._wall_statuses+=e.wall[t].isalive()?1:0}show_walls(e){let t=this;for(let s=0;s<e.length;s++)(void 0===e[s-1]||e[s-1]._status<=0)&&(e[s].is_able_collision=!0),e[s].moveDraw(t)}shot(){let t=this;Math.random()>.02||(t._moveYStop=!0,B.push(new Ve({x:t.x,y:t.y,img:e.enemy_bullet_z.obj})),B.push(new Ve({x:t.x,y:t.y+35,img:e.enemy_bullet_z.obj})),B.push(new Ve({x:t.x,y:t.y+70,img:e.enemy_bullet_z.obj})),B.push(new Ve({x:t.x,y:t.y+105,img:e.enemy_bullet_z.obj})),ni._setPlay(s.enemy_bullet_laser),t.tid=setTimeout(function(){t._moveYStop=!1,clearTimeout(t.tid)},100))}move_Allset(){let e=this;e.x-=4,e.moveDraw(),e.set_wall_status(),e.show_walls(e.wall),e.x<y.width-e.img.width-80&&(e.is_all_set=!0)}move_before(){return!1}move_standby(){let e=this;e.move_before()||(e.x-=4,e.x<y.width&&(e._standby=!1))}move(){let e=this;if(e.isMove()&&e.isAllset()){if(e.y+=e._moveYStop?0:e.speed,e.speed=e.y<50||e.y+e.img.height>450?-1*e.speed:e.speed,e.shot(),e.moveDraw(),e.set_wall_status(),e.show_walls(e.wall),-1===e._wall_statuses.indexOf("1")&&(e._status=0,e.setAlive()),e._c>=3e3){let t=e.getEnemyCenterPosition();e.is_able_collision=!1,e.c_z4_ani=e.c_z4_ani>0?e.c_z4_ani-1:0;let s=e.z4_ani[parseInt(e.c_z4_ani/6)].img;w.drawImage(s,t._x-s.width/2,t._y-s.height/2,s.width,s.height)}e.setSelfCollision(),e._c++}}}class Le extends Oe{constructor(t,s){super(e.enemy_bigcore2.obj,t,s);let i=this;i._status=1,i.speed=2,i.is_able_collision=!1,i.img=e.enemy_bigcore2.obj,i.wall_up=[new Fe(e.enemy_bigcore2_wall.obj,i,90,38),new Fe(e.enemy_bigcore2_wall.obj,i,95,38),new Fe(e.enemy_bigcore2_wall.obj,i,100,38),new Fe(e.enemy_bigcore2_wall.obj,i,105,38),new Fe(e.enemy_bigcore2_core.obj,i,110,36)],i.wall_down=[new Fe(e.enemy_bigcore2_wall.obj,i,90,95),new Fe(e.enemy_bigcore2_wall.obj,i,95,95),new Fe(e.enemy_bigcore2_wall.obj,i,100,95),new Fe(e.enemy_bigcore2_wall.obj,i,105,95),new Fe(e.enemy_bigcore2_core.obj,i,110,93)],i._wall_up_statuses="",i._wall_down_statuses="",i.back=[0,85,170,255,340,425],i.back_img_up={x:200,y:-50,st:0,flag:!0,s1:function(){this.st>=15&&(this.flag=!1),this.st<=6&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},s2:function(){this.st>=6&&(this.flag=!1),this.st<=0&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},f:function(){let t=e.enemy_bigcore2_back.obj,s=(t.height,t.height);w.drawImage(t,85*parseInt(this.st/3),0,85,s,i.x+this.x,i.y+this.y,85,s)}},i.back_img_down={x:200,y:-120,st:0,flag:!0,s1:function(){this.st>=15&&(this.flag=!1),this.st<=6&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},s2:function(){this.st>=6&&(this.flag=!1),this.st<=0&&(this.flag=!0),this.st=this.flag?this.st+1:this.st-1},f:function(){let t=e.enemy_bigcore2_back.obj,s=(t.height,t.height);w.save(),w.setTransform(1,0,0,-1,0,2*i.y+t.height),w.drawImage(t,85*parseInt(this.st/3),0,85,s,i.x+this.x,i.y+this.y,85,s),w.restore()}},i.c_z4_ani=30,i.z4_ani=[{img:e.enemy_bigcore_4_1.obj,al:1},{img:e.enemy_bigcore_4_2.obj,al:.8},{img:e.enemy_bigcore_4_3.obj,al:.6},{img:e.enemy_bigcore_4_4.obj,al:.4},{img:e.enemy_bigcore_4_5.obj,al:.2}],i.tid=null,i._moveYStop=!1,i.shotColMap=["130,0,240,156,false"],i._collision_type="t9";for(let e=0;e<i.wall_up.length;e++)z.push(i.wall_up[e]);for(let e=0;e<i.wall_down.length;e++)z.push(i.wall_down[e]);i.hands_up=[new Ye({_initx:-52,_inity:-30,_dir:i._DEF_DIR._U,_boss:i})],z.push(i.hands_up[0]),i.hands_down=[new Ye({_initx:-52,_inity:75,_dir:i._DEF_DIR._D,_boss:i})],z.push(i.hands_down[0]),i._hands_open_flag=!1}init(){this._isshow=!1,this._status=0}set_wall_standBy(){let e=this;for(let t=0;t<e.wall_up.length;t++)e.wall_up[t].setStandByDone();for(let t=0;t<e.wall_down.length;t++)e.wall_down[t].setStandByDone()}set_wall_status(){let e=this;e._wall_up_statuses="",e._wall_down_statuses="";for(let t=0;t<e.wall_up.length;t++)e._wall_up_statuses+=e.wall_up[t].isalive()?1:0;for(let t=0;t<e.wall_down.length;t++)e._wall_down_statuses+=e.wall_down[t].isalive()?1:0}shot(){let e=this,t=e.getEnemyCenterPosition(),i=P.getPlayerCenterPosition();if(e._c%150==0&&(e._moveYStop=!1),e._c%150>50&&e._c%150<99&&(e._moveYStop=!0),e._c%150==51&&(e._hands_open_flag=Math.abs(i._y-t._y)<100,e._hands_open_flag)){for(let t=e.hands_up.length-1;t>=0;t--)e.hands_up[t].isHandsOpen=!0;for(let t=e.hands_down.length-1;t>=0;t--)e.hands_down[t].isHandsOpen=!0}if(e._c%150==70&&(e._hands_open_flag?(-1!==e._wall_up_statuses.indexOf("1")&&(B.push(new Ve({x:e.x+85,y:e.y-75})),B.push(new Ve({x:e.x+70,y:e.y-45})),B.push(new Ve({x:e.x+120,y:e.y-20})),B.push(new Ve({x:e.x+100,y:e.y+0})),B.push(new Ve({x:e.x+80,y:e.y+25})),B.push(new Ve({x:e.x+60,y:e.y+45})),B.push(new Ve({x:e.x,y:e.y+55}))),-1!==e._wall_down_statuses.indexOf("1")&&(B.push(new Ve({x:e.x,y:e.y+85})),B.push(new Ve({x:e.x+60,y:e.y+95})),B.push(new Ve({x:e.x+80,y:e.y+115})),B.push(new Ve({x:e.x+100,y:e.y+135})),B.push(new Ve({x:e.x+120,y:e.y+160})),B.push(new Ve({x:e.x+70,y:e.y+170})),B.push(new Ve({x:e.x+85,y:e.y+200})))):(-1!==e._wall_up_statuses.indexOf("1")&&(B.push(new Ve({x:e.x+60,y:e.y+20})),B.push(new Ve({x:e.x,y:e.y+55}))),-1!==e._wall_down_statuses.indexOf("1")&&(B.push(new Ve({x:e.x,y:e.y+95})),B.push(new Ve({x:e.x+60,y:e.y+130})))),ni._setPlay(s.enemy_bullet_laser)),e._c%150==110){for(let t=e.hands_up.length-1;t>=0;t--)e.hands_up[t].isHandsClose=!0;for(let t=e.hands_down.length-1;t>=0;t--)e.hands_down[t].isHandsClose=!0}}move_Allset(){let e=this;e.x-=4,e.moveDraw(),e.back_img_up.s2(),e.back_img_up.f(),e.back_img_down.s2(),e.back_img_down.f();for(let t=0;t<e.wall_up.length;t++)e.wall_up[t].moveDraw(e);for(let t=0;t<e.wall_down.length;t++)e.wall_down[t].moveDraw(e);for(let t=e.hands_up.length-1;t>=0;t--)e.hands_up[t].moveDraw(e);for(let t=e.hands_down.length-1;t>=0;t--)e.hands_down[t].moveDraw(e);e.x<y.width-e.img.width-80&&(e.is_all_set=!0)}move_standby(){let e=this;e.move_before()||(e.x-=4,e.x<y.width&&(e._standby=!1))}move(){let e=this;if(e.isMove()&&e.isAllset()){e.y+=e._moveYStop?0:e.speed,e.speed=e.y<50||e.y+e.img.height>450?-1*e.speed:e.speed,e.shot(),e.moveDraw(),e.speed>0&&!e._moveYStop?e.back_img_up.s1():e.back_img_up.s2(),e.back_img_up.f(),e.speed<0&&!e._moveYStop?e.back_img_down.s1():e.back_img_down.s2(),e.back_img_down.f(),e.set_wall_status();for(let t=0;t<e.wall_up.length;t++)(void 0===e.wall_up[t-1]||e.wall_up[t-1]._status<=0)&&(e.wall_up[t].is_able_collision=!0),e.wall_up[t].moveDraw(e);for(let t=0;t<e.wall_down.length;t++)(void 0===e.wall_down[t-1]||e.wall_down[t-1]._status<=0)&&(e.wall_down[t].is_able_collision=!0),e.wall_down[t].moveDraw(e);for(let t=e.hands_up.length-1;t>=0;t--)-1!==e._wall_up_statuses.indexOf("1")||e.hands_up[t].is_hand_stop()||(ni._setPlay(e.audio_collision),e.hands_up[t].set_hand_stop()),e.hands_up[t].moveDraw(e);for(let t=e.hands_down.length-1;t>=0;t--)-1!==e._wall_down_statuses.indexOf("1")||e.hands_down[t].is_hand_stop()||(ni._setPlay(e.audio_collision),e.hands_down[t].set_hand_stop()),e.hands_down[t].moveDraw(e);if(-1===e._wall_up_statuses.indexOf("1")&&-1===e._wall_down_statuses.indexOf("1")){for(let t=e.hands_up.length-1;t>=0;t--)e.hands_up[t]._status=0;for(let t=e.hands_down.length-1;t>=0;t--)e.hands_down[t]._status=0;e._status=0,e.setAlive()}e.setSelfCollision(),e._c++}}}class Ye extends _e{constructor(t){super(e.enemy_bigcore2_hand.obj,t._initx,t._inity);let s=this;s._initx=t._initx||0,s._inity=t._inity||0,s.x=s._initx+t._boss.x,s.y=s._inity+t._boss.y,s._standby=!1,s.is_able_collision=!1,s.isshot=void 0!==t._img,s.isHandsOpen=!1,s.isHandsClose=!1,s.isstop=!1,s._boss=new Object,s.direct=t._dir||s._DEF_DIR._U,s.shotColMap=[s.direct===s._DEF_DIR._U?"0,30,250,100,false":s.direct===s._DEF_DIR._D?"0,30,250,100,false":void 0],s.shotColMapTmp=s.direct===s._DEF_DIR._U?[["90,30,250,70,false","25,70,250,100,false"],["180,30,250,90,false"],["50,10,225,20,false"]]:s.direct===s._DEF_DIR._D?[["25,30,250,70,false","90,70,250,100,false"],["180,20,250,60,false"],["50,90,225,100,false"]]:void 0,s.imgs=[0,250,500],s.imgsPos=[{x:0,y:(s.direct,s._DEF_DIR._U,0)},{x:0,y:s.direct===s._DEF_DIR._U?-40:40},{x:-5,y:s.direct===s._DEF_DIR._U?-30:30}],s.imgs_x=0,s.imgs_y=0,s._c=0}init(){this._isshow=!1,this._status=0}collision(e,t){}setStatus(){this._status=0}is_hand_stop(){return this.isstop}set_hand_stop(){this.isstop=!0}move_hands_open(){let e=this;if(!e.isHandsOpen)return;if(e.isstop)return;let t=e.imgsPos[parseInt(e._c/6)];e.imgs_x=parseInt(t.x),e.imgs_y=parseInt(t.y),e.shotColMap=[];let s=e.shotColMapTmp[parseInt(e._c/6)];for(let t=0;t<s.length;t++)e.shotColMap.push(s[t]);if(e._c>=6*e.imgs.length-1)return e._c=6*e.imgs.length-1,void(e.isHandsOpen=!1);e._c++}move_hands_close(){let e=this;if(!e.isHandsClose)return;if(e.isstop)return;let t=e.imgsPos[parseInt(e._c/6)];e.imgs_x=parseInt(t.x),e.imgs_y=parseInt(t.y),e.shotColMap=[];let s=e.shotColMapTmp[parseInt(e._c/6)];for(let t=0;t<s.length;t++)e.shotColMap.push(s[t]);if(e._c<=0)return e._c=0,void(e.isHandsClose=!1);e._c--}moveDraw(e){this._boss=e,this.move_hands_open(),this.move_hands_close(),this.x=this._boss.x+parseInt(this._initx)+this.imgs_x,this.y=this._boss.y+parseInt(this._inity)+this.imgs_y,this.setDrawImage(250,110,250,this.imgs[parseInt(this._c/6)])}move(){}}class Ue extends Oe{constructor(t,s){super(e.enemy_cristalcore.obj,t,s);let i=this;i._status=70,i.speed=3,i.wall=[new Fe(e.enemy_cristalcore_wall1.obj,i,47,116),new Fe(e.enemy_cristalcore_wall2.obj,i,62,116),new Fe(e.enemy_cristalcore_wall2.obj,i,77,116),new Fe(e.enemy_cristalcore_wall2.obj,i,92,116),new Fe(e.enemy_bigcore_3.obj,i,102,115)],i._wall_statuses="",i.c_z4_ani=30,i.z4_ani=[{img:e.enemy_bigcore_4_1.obj,al:1},{img:e.enemy_bigcore_4_2.obj,al:.8},{img:e.enemy_bigcore_4_3.obj,al:.6},{img:e.enemy_bigcore_4_4.obj,al:.4},{img:e.enemy_bigcore_4_5.obj,al:.2}],i._collision_type="t9",i.is_able_collision=!1,i._shot_count=0,i.shotColMap=["25,0,227,10,false","25,242,227,250,false","160,0,227,250,false"];for(let e=0;e<i.wall.length;e++)z.push(i.wall[e]);i.hands_up=[new qe({_boss:i,_ignore_collision:!0,_initx:50,_inity:80,_cmr:60,_cmsr:70,_initRad:40,_data:"0,0,180,10",_change:!0}),new qe({_boss:i,_ignore_collision:!0,_initx:50,_inity:80,_cmr:70,_cmsr:80,_initRad:70,_data:"0,0,185,5",_change:!0}),new qe({_boss:i,_initx:50,_inity:80,_cmr:80,_cmsr:100,_initRad:100,_data:"0,0,180,-10",_change:!0}),new qe({_boss:i,_initx:50,_inity:80,_cmr:89,_cmsr:125,_initRad:130,_data:"0,0,175,-25",_change:!0}),new qe({_boss:i,_initx:50,_inity:80,_cmr:97,_cmsr:145,_initRad:160,_data:"0,0,170,-40",_change:!0}),new qe({_boss:i,_initx:50,_inity:80,_cmr:106,_cmsr:160,_initRad:190,_data:"0,0,165,-55",_change:!0}),new qe({_boss:i,_img:e.enemy_cristalcore_hand2.obj,_initx:50,_inity:80,_cmr:115,_cmsr:170,_initRad:215,_data:"0,0,160,-70",_change:!0})];for(let e=0;e<i.hands_up.length;e++)z.push(i.hands_up[e]);i.hands_down=[new qe({_boss:i,_ignore_collision:!0,_initx:50,_inity:155,_cmr:60,_cmsr:70,_initRad:40,_data:"0,0,180,-10",_change:!1}),new qe({_boss:i,_ignore_collision:!0,_initx:50,_inity:155,_cmr:70,_cmsr:80,_initRad:70,_data:"0,0,175,-5",_change:!1}),new qe({_boss:i,_initx:50,_inity:155,_cmr:80,_cmsr:100,_initRad:100,_data:"0,0,180,10",_change:!1}),new qe({_boss:i,_initx:50,_inity:155,_cmr:89,_cmsr:125,_initRad:130,_data:"0,0,185,25",_change:!1}),new qe({_boss:i,_initx:50,_inity:155,_cmr:97,_cmsr:145,_initRad:160,_data:"0,0,190,40",_change:!1}),new qe({_boss:i,_initx:50,_inity:155,_cmr:106,_cmsr:160,_initRad:190,_data:"0,0,195,55",_change:!1}),new qe({_boss:i,_img:e.enemy_cristalcore_hand2.obj,_initx:50,_inity:155,_cmr:115,_cmsr:170,_initRad:215,_data:"0,0,200,70",_change:!1})];for(let e=0;e<i.hands_down.length;e++)z.push(i.hands_down[e])}init(){}setDrawImageDirect(){}set_wall_standBy(){let e=this;for(let t=0;t<e.wall.length;t++)e.wall[t].setStandByDone()}set_wall_status(){let e=this;e._wall_statuses="";for(let t=0;t<e.wall.length;t++)e._wall_statuses+=e.wall[t].isalive()?1:0}show_walls(e){let t=this;for(let s=0;s<e.length;s++)(void 0===e[s-1]||e[s-1]._status<=0)&&(e[s].is_able_collision=!0),e[s].moveDraw(t)}shot(){let e=this;if(e._shot_count++,e._c%1200>800){if(e._shot_count<10)return}else if(e._c%1200<=800&&e._shot_count<50)return;e._shot_count=0,B.push(new Ve({x:e.x,y:e.y+111})),B.push(new Ve({x:e.x,y:e.y+140})),ni._setPlay(s.enemy_bullet_laser)}showCollapes(){let e=this;e._isshow=!1;for(let t=e.hands_up.length-1;t>=0;t--)e.hands_up[t].showCollapes(e.hands_up[t].x,e.hands_up[t].y),e.hands_up[t].init();for(let t=e.hands_down.length-1;t>=0;t--)e.hands_down[t].showCollapes(e.hands_down[t].x,e.hands_down[t].y),e.hands_down[t].init();H.push(new ps(e.x+e.img.width/2,e.y+e.img.height/2,e._collision_type))}isAllset(){let e=this;return e.is_all_set?(e.set_wall_standBy(),!0):(e.move_Allset(),!1)}move_Allset(){let e=this;e.y-=4;for(let t=e.hands_up.length-1;t>=0;t--)e.hands_up[t].moveDraw(e);for(let t=e.hands_down.length-1;t>=0;t--)e.hands_down[t].moveDraw(e);e.moveDraw(),e.set_wall_status(),e.show_walls(e.wall),e.y<200&&(e.is_all_set=!0)}move_standby(){let e=this;e.move_before()||(e.y-=4,e.y<y.height&&(e._standby=!1))}move(){let e=this;if(e.isMove()&&e.isAllset()){e.y+=e.speed,e._c%1200>800&&e._c%45==0&&(e.speed*=-1),(e.y+e.img.height>y.height||e.y<0)&&(e.speed*=-1);for(let t=e.hands_up.length-1;t>=0;t--)e.hands_up[t].moveDraw(e);for(let t=e.hands_down.length-1;t>=0;t--)e.hands_down[t].moveDraw(e);if(e.shot(),e.moveDraw(),e.set_wall_status(),e.show_walls(e.wall),-1===e._wall_statuses.indexOf("1")){for(let t=e.hands_up.length-1;t>=0;t--)e.hands_up[t]._status=0;for(let t=e.hands_down.length-1;t>=0;t--)e.hands_down[t]._status=0;e._status=0,e.setAlive()}e.setSelfCollision(),e._c++}}}class qe extends _e{constructor(t){super(e.enemy_cristalcore_hand1.obj,t._initx,t._inity);this._initx=t._initx||0,this._inity=t._inity||0,this._boss=t._boss,this._c_move_round=t._cmr||0,this._c_move_self_round=t._cmsr||0,this._initRad=t._initRad||0,this._data=t._data||"0,0,0,0",this.img=t._img||e.enemy_cristalcore_hand1.obj,this._count_turn=0,this._change=t._change,this._standby=!0,this._standby_tmp=t._standby||!1,this.is_able_collision=!1,this.is_ignore_collision=t._ignore_collision||!1,this.isshot=void 0!==t._img,this._shot_count=0,this._collision_type="t1",this._c=0;let s=this._data.split(","),i=parseInt(s[2])+(this._change?1:-1),_=this._initRad*Math.cos(i*(Math.PI/180)),n=this._initRad*Math.sin(i*(Math.PI/180)),o=parseInt(s[3])+(this._change?1:-1);this._data=_+","+n+","+i+","+o}collision(e,t){}setStatus(){this._status=0}shot(){if(!1===this.isshot)return;if(this._shot_count++,this._shot_count<20)return;this._shot_count=0;let e=this._data.split(",");B.push(new Qe({x:this.x,y:this.y,deg:parseInt(e[3])}))}move_hands(){let e=this;if(e._count_turn>=4)return void(e._c>400&&(e._c=0,e._count_turn=0));e._c>200&&(e._c=0,e._count_turn++,e._change=!e._change);let t=e._data.split(","),s=e._c_move_round,i=e._c_move_self_round;if(e._c>i)return;if(e._c<=i&&e._c>s){let s=parseInt(t[3])+(e._change?1:-1);return void(e._data=t[0]+","+t[1]+","+t[2]+","+s)}let _=parseInt(t[2])+(e._change?1:-1),n=e._initRad*Math.cos(_*(Math.PI/180)),o=e._initRad*Math.sin(_*(Math.PI/180)),a=parseInt(t[3])+(e._change?1:-1);e._data=n+","+o+","+_+","+a}moveDraw(e){let t=this._data.split(","),s=this._initx,i=this._inity,_=parseInt(t[3])*Math.PI/180,n=this._boss.x+parseInt(t[0])+s+this.img.width,o=this._boss.y+parseInt(t[1])+i+parseInt(this.img.height/1.5);w.save(),w.setTransform(Math.cos(_),Math.sin(_),-Math.sin(_),Math.cos(_),n-n*Math.cos(_)+o*Math.sin(_),o-n*Math.sin(_)-o*Math.cos(_)),w.drawImage(this.img,this._boss.x+parseInt(t[0])+s,this._boss.y+parseInt(t[1])+i,this.img.width,this.img.height),w.restore(),this.x=this._boss.x+parseInt(t[0])+s,this.y=this._boss.y+parseInt(t[1])+i,e.is_all_set&&(this.shot(),this.move_hands(),this._standby=!1,this._c++)}move(){}}class ze extends Ue{constructor(e,t){super(e,t);this._c=0,this._showout_cube=0,this._standby_count=0,this._complete_cube_count=0,this._map_col_reset=!1,this._cube_shot_max=100}move_before(){let e=this,t="";if(function(){let s=z;for(let i=0;i<s.length;i++)Be.prototype.isPrototypeOf(s[i])&&(s[i].alpha=e.alpha,t+=!0===s[i]._stop?"1":"0")}(e.alpha),-1!==t.indexOf("0")&&(e._complete_cube_count=e._standby_count),e._standby_count%40==0&&e._showout_cube<e._cube_shot_max){let t=new Be({x:1e3,y:400*Math.random()+50});z.push(t),e._showout_cube++}let s=e._standby_count-e._complete_cube_count;return 50===s&&(e.alpha=.7),100===s&&(e.alpha=.3),150===s&&(e.alpha=0),0===e.alpha?(W.set_mapdef_col_clear(),!1):(e._standby_count++,!0)}}class Be extends _e{constructor(t){super(e.enemy_cube.obj,t.x,t.y,[0,45,90,135],10,45,45);this._standby=!1,this._status=1,this.speed=5,this.change_speed_c=parseInt(150*Math.random())+10,this._stop=!1,this.is_able_collision=!1,this.audio_collision=s.enemy_cube,this._col_c=0,this.tx=0,this.ty=0,this.rad=0,this.deg=0,this.sx=0,this.sy=0}isCanvasOut(){return ni.isEnemyCanvasOut(this,{up:!0,down:!0,left:!0,right:!0})}isMove(){let e=this;return e.isStandBy()?(e.move_standby(),!1):e.isCanvasOut()?(e._status=0,e._isshow=!1,!1):!!e.isshow()}move_bounds(){let e=this,t=z;for(let s=0;s<t.length;s++){if(!Be.prototype.isPrototypeOf(t[s]))continue;if(e.id===t[s].id)continue;if(!t[s]._stop)continue;if(ni.isSqCollision("10,10,35,35",e.x+","+e.y,["10,10,35,35"],t[s].x+","+t[s].y)!==se)return!0}return!1}moveDraw(){let e=this;if(ni._setDrawImage({img:e.img,x:e.x,y:e.y,imgPosx:e.imgPos[parseInt(e._col_c/e.aniItv)],width:e.width,alpha:e.alpha,basePoint:1}),!0!==e._stop){if(e.x<0||e.y<0||e.y+50>y.height||e.move_bounds()){let t=e.getEnemyCenterPosition();return W.set_mapdef_col(W.getMapX(t._x),W.getMapY(t._y),"1"),e._status=0,e._stop=!0,void ni._setPlay(e.audio_collision)}e._c<e.change_speed_c&&(e.x-=e.speed),e._c===e.change_speed_c&&(e.tx=P.getPlayerCenterPosition()._x,e.ty=P.getPlayerCenterPosition()._y,e.rad=Math.atan2(e.ty-e.y,e.tx-e.x),e.deg=180*e.rad/Math.PI,e.sx=Math.cos(e.rad),e.sy=Math.sin(e.rad),e.speed=10),e._c>e.change_speed_c&&(e.x+=e.sx*e.speed,e.y+=e.sy*e.speed),e._col_c=e._col_c>=8*e.imgPos.length-1?0:e._col_c+1,e._c++}}move(){let e=this;e.isMove()&&(0!==e.alpha?e.moveDraw():e.init())}}class He extends Oe{constructor(t,s){super(e.enemy_frame_body1.obj,t,s);let i=this;i._status=1,i.x=y.width+100,i.y=250,i.speed=3,i.moves_interval=15,i.shotColMap=[parseInt(i.img.width/2)+","+parseInt(i.img.height/2)+","+parseInt(i.img.width/2+1)+","+parseInt(i.img.height/2+1)],i._radX=0,i._radY=0,i._rad=100,i._deg=16,i._f=!1,i._mpt=0,i._collision_type="t9",i.movePos={_pos:0,_pos_same_count:0,_getPos:function(){return this._pos},_setPos:function(){let e=i.getEnemyCenterPosition();e._x<200?e._y<150?this._pos=1:e._y>y.height-150?this._pos=7:this._pos=4:e._x>y.width-200?e._y<150?this._pos=3:e._y>y.height-150?this._pos=9:this._pos=6:e._y<150?this._pos=2:e._y>y.height-150?this._pos=8:this._pos=5},move:function(){let e=this._getPos();if(this._setPos(),e===this._pos){if(this._pos_same_count++,this._pos_same_count<100)return;let e=5===(t=this)._pos?Math.random()>.4?2:1:3===t._pos&&1===i._mpt&&i._deg<190&&i._deg>=180?0:3===t._pos&&2===i._mpt&&i._deg<90&&i._deg>=80?0:6===t._pos&&1===i._mpt&&i._deg<270&&i._deg>=260?0:6===t._pos&&2===i._mpt&&i._deg<100&&i._deg>=90?0:9===t._pos&&1===i._mpt&&i._deg<280&&i._deg>=270?0:9===t._pos&&2===i._mpt&&i._deg<190&&i._deg>=180?0:2===t._pos&&1===i._mpt&&i._deg<180&&i._deg>=170?0:2===t._pos&&2===i._mpt&&i._deg<10&&i._deg>=0?0:8===t._pos&&1===i._mpt&&i._deg<360&&i._deg>=350?0:8===t._pos&&2===i._mpt&&i._deg<190&&i._deg>=180?0:1===t._pos&&1===i._mpt&&i._deg<180&&i._deg>=170?0:1===t._pos&&2===i._mpt&&i._deg<280&&i._deg>=270?0:4===t._pos&&1===i._mpt&&i._deg<90&&i._deg>=80?0:4===t._pos&&2===i._mpt&&i._deg<280&&i._deg>=270?0:7===t._pos&&1===i._mpt&&i._deg<360&&i._deg>=350?0:7===t._pos&&2===i._mpt&&i._deg<90&&i._deg>=80?0:i._mpt;return i.x<-i._rad||i.x>y.width+i._rad||i.y<-i._rad||i.y>y.height+i._rad?(i.deg=i.setDegAdd(180),i.moves_pt[i._mpt].switch(0),void(i._mpt=0)):(e!==i._mpt&&(this._pos_same_count=0),i.moves_pt[i._mpt].switch(e),void(i._mpt=e))}var t;let s=function(t){return 5===t._pos?0:1===e&&2===t._pos?2:1===e&&4===t._pos?1:4===e&&1===t._pos?2:4===e&&7===t._pos?1:7===e&&4===t._pos?2:7===e&&8===t._pos?1:2===e&&1===t._pos?1:2===e&&3===t._pos?2:8===e&&7===t._pos?2:8===e&&9===t._pos?1:3===e&&2===t._pos?1:3===e&&6===t._pos?2:6===e&&3===t._pos?1:6===e&&9===t._pos?2:9===e&&6===t._pos?1:9===e&&8===t._pos?2:parseInt(2*Math.random()+1)}(this);i.moves_pt[i._mpt].switch(s),i._mpt=s}},i.parts=[new Xe({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Ge({o:null,x:1500,y:250}),new Xe({o:null,x:1500,y:250,d:i._DEF_DIR._L})],i.moves=[];for(let e=0;e<i.parts.length;e++)z.push(i.parts[e]);i.moves_pt=[{switch:function(e){1===e?i._deg=i.setDegAdd(90):2===e&&(i._deg=i.setDegAdd(-90)),0!==e&&(i._radX=i.x+Math.cos(i._deg*Math.PI/180)*i._rad*-1,i._radY=i.y+Math.sin(i._deg*Math.PI/180)*i._rad*-1),i._mpt=e},move:function(){i.x+=i.speed*Math.cos(i._deg*Math.PI/180),i.y+=i.speed*Math.sin(i._deg*Math.PI/180)},setDeg:0},{switch:function(e){0===e?i._deg=i.setDegAdd(-90):2===e&&(i._deg=i.setDegAdd(-180)),1!==e&&(i._radX=i.x+Math.cos(i._deg*Math.PI/180)*i._rad*-1,i._radY=i.y+Math.sin(i._deg*Math.PI/180)*i._rad*-1),i._mpt=e},move:function(){i._deg=i.setDegAdd(-1*i.speed/2),i.x=i._radX+Math.cos(i._deg*Math.PI/180)*i._rad,i.y=i._radY+Math.sin(i._deg*Math.PI/180)*i._rad},setDeg:-90},{switch:function(e){0===e?i._deg=i.setDegAdd(90):1===e&&(i._deg=i.setDegAdd(-180)),2!==e&&(i._radX=i.x+Math.cos(i._deg*Math.PI/180)*i._rad*-1,i._radY=i.y+Math.sin(i._deg*Math.PI/180)*i._rad*-1),i._mpt=e},move:function(){i._deg=i.setDegAdd(i.speed/2),i.x=i._radX+Math.cos(i._deg*Math.PI/180)*i._rad,i.y=i._radY+Math.sin(i._deg*Math.PI/180)*i._rad},setDeg:90}],i.is_able_collision=!1,i._standby=!0,i._heads_statuses="",i._bodies_statuses=""}setSelfCollision(){let e=this;if(e._c>e._c_self_collision&&(e._heads_statuses="00"),-1===e._heads_statuses.indexOf("1")){for(let t=0;t<e.parts.length;t++)Xe.prototype.isPrototypeOf(e.parts[t])?e.parts[t]._status=0:e.parts[t].is_frame_heads_collision=!0;-1===e._bodies_statuses.indexOf("1")&&e.init()}}set_heads_bodies_status(){let e=this;e._heads_statuses="",e._bodies_statuses="";for(let t=0;t<e.parts.length;t++)Xe.prototype.isPrototypeOf(e.parts[t])?e._heads_statuses+=e.parts[t].isalive()?1:0:e._bodies_statuses+=e.parts[t].isalive()?1:0}setDegAdd(e){let t=(this._deg+e)%360;return t<0?360+t:t}move_standby(){let e=this;e._deg=190,e.x+=e.speed*Math.cos(e._deg*Math.PI/180),e.y+=e.speed*Math.sin(e._deg*Math.PI/180),e.moves.unshift({x:e.x,y:e.y,deg:e._deg}),e.moves.length>e.parts.length*e.moves_interval&&e.moves.pop();for(let t=0;t<e.parts.length;t++){let s=e.moves[t*e.moves_interval];if(void 0===s)break;e.parts[t].moveDraw({x:s.x,y:s.y,deg:s.deg})}e.x<y.width-300&&(e.movePos._setPos(),e._standby=!1)}move(){let e=this;if(e.isMove()){e.set_heads_bodies_status(),e.moves.unshift({x:e.x,y:e.y,deg:e.setDegAdd(e.moves_pt[e._mpt].setDeg)}),e.moves.length>e.parts.length*e.moves_interval&&e.moves.pop(),e.movePos.move(),e.moves_pt[e._mpt].move();for(let t=0;t<e.parts.length&&void 0!==e.moves[t*e.moves_interval];t++){let s=e.moves[t*e.moves_interval];e.parts[t].moveDraw({x:s.x,y:s.y,deg:s.deg})}e._f||e.parts[0].isalive()||(e._f=!0,e.parts.reverse(),e.moves.reverse(),e.x=e.moves[0].x,e.y=e.moves[0].y,e.parts[0].setDirect(e._DEF_DIR._R),e._deg=e.moves[0].deg+180,e.moves_pt[e._mpt].switch(0),e._mpt=0),e.setSelfCollision(),e._c++}}}class Xe extends _e{constructor(t){super(e.enemy_frame_head1.obj,t.x,t.y);this.direct=t.d||this._DEF_DIR._R,this.img=this.direct===this._DEF_DIR._L?e.enemy_frame_head3.obj:e.enemy_frame_head1.obj,this._standby=!1,this._status=75,this.getscore=5e3,this._deg=0,this.shotColMap=["30,30,"+(this.img.width-60)+","+(this.img.height-60)],this._collision_type="t9",this.audio_collision=s.enemy_collision6,this.num_col=6}showCollapes(){let e=this,t=e.getEnemyCenterPosition();e._isshow=!1;for(let s=0;s<(e.num_col||1);s++)H.push(new ps(t._x+Math.random()*(Math.random()>.5?100:-100),t._y+Math.random()*(Math.random()>.5?100:-100),e._collision_type));ni._setPlay(e.audio_collision)}setDirect(e){this.direct=e}shot(){let t=this;t.img=t._c%200<150&&t._c%200>0?t.direct===t._DEF_DIR._L?e.enemy_frame_head3.obj:e.enemy_frame_head1.obj:t.direct===t._DEF_DIR._L?e.enemy_frame_head4.obj:e.enemy_frame_head2.obj,t._c%200==150&&B.push(new $e({x:t.x,y:t.y,deg:t._deg+90}))}moveDraw(e){let t=this;t.isshow()&&(t.isalive()?(t.shot(),t.x=e.x,t.y=e.y,t._deg=e.deg,ni._setDrawImage({img:t.img,x:t.x+t.img.width/4,y:t.y+t.img.height/4,deg:t._deg}),t._c=t._c>200?0:t._c+1):t.showCollapes())}move(){}}class Ge extends _e{constructor(t){super(e.enemy_frame_body1.obj,t.x,t.y);this.img=e.enemy_frame_body1.obj,this._standby=!1,this.is_able_collision=!1,this.shotColMap=["5,5,"+(this.img.width-10)+","+(this.img.height-10)],this._deg=0,this.speed=Math.random>.4?-10:10,this.is_frame_heads_collision=!1,this.ani=[{scale:1},{scale:.95},{scale:.9},{scale:.85},{scale:.9},{scale:.95}]}showCollapes(){let e=this;if(ni.isEnemyCanvasOut(e))return e._status=0,void(e._isshow=!1);e.x+=Math.cos(e._deg*Math.PI/180)*e.speed,e.y+=Math.sin(e._deg*Math.PI/180)*e.speed,ni._setDrawImage({img:e.img,x:e.getEnemyCenterPosition()._x,y:e.getEnemyCenterPosition()._y,deg:e._deg})}moveDraw(e){let t=this;t._c=t._c>=20*t.ani.length-1?0:t._c+1;let s=parseInt(t._c/20);if(t.isshow()){if(t.is_frame_heads_collision)return t._standby=!0,void t.showCollapes();t.x=e.x,t.y=e.y,t._deg=e.deg,ni._setDrawImage({img:t.img,x:t.getEnemyCenterPosition()._x,y:t.getEnemyCenterPosition()._y,deg:t._deg,scale:t.ani[s].scale})}}move(){}}class Ke extends Oe{constructor(t,s){super(e.enemy_cell_boss.obj,t,s);this._status=1,this.x=t||y.width+200,this.y=s||250,this.rad=Math.random()*Math.PI-Math.PI/2,this._standby=!1,this.is_all_set=!1,this.ani=[0,180,360],this.ani_c=0,this.ani_c_intv=20,this.moves=[],this.speed=1,this.moves_interval=50,this.parts=[new Ne({x:this.x,y:this.y,dark:!1}),new Ne({x:this.x,y:this.y,dark:!0}),new Ne({x:this.x,y:this.y,dark:!0}),new Ne({x:this.x,y:this.y,dark:!0}),new Ne({x:this.x,y:this.y,dark:!0}),new Ne({x:this.x,y:this.y,dark:!0}),new Ne({x:this.x,y:this.y,dark:!0})],this.parts_eye=new We({x:this.x,y:this.y}),this.width=200,this.height=this.img.height,this.shotColMap=["50,0,"+this.width+","+this.height],this.is_able_collision=!1,this.is_ignore_collision=!0,this._collision_type="t9",this._col_c=0}is_parts_eye_status(){return this.parts_eye.isalive()}setSelfCollision(){this._c<this._c_self_collision||(this.parts_eye._status=0,this.setCollapes())}setCollapes(){let e=this;if(0===e.parts.length)return e._status=0,void M.set(e.getscore);for(let t=e.parts.length-1;t>=0;t--)e.parts[t].moveDraw();let t=e.parts[e.parts.length-1];0===e._col_c?(t.showCollapes(),e.parts.pop()):e._col_c%8==0&&(H.push(new ps(t.x+100*Math.random(),t.y+100*Math.random(),e._collision_type)),ni._setPlay(e.audio_collision)),e._col_c=e._col_c>40?0:e._col_c+1}isAllset(){return!!this.is_all_set||(this.move_Allset(),!1)}move_Allset(){let e=this;e.x-=2;for(let t=0;t<e.parts.length;t++)e.parts[t].moveSet({x:e.x,y:e.y});if(e.parts[0].moveDraw(),!(e.x>=y.width-300)){e.is_all_set=!0;for(let t=0;t<e.parts.length;t++)z.push(e.parts[t]);z.push(e.parts_eye)}}showCollapes(){}move_standby(){}move(){let e=this;if(e.ani_c=e.ani_c>=e.ani.length*e.ani_c_intv-1?0:e.ani_c+1,!e.isMove())return;if(!e.isAllset())return;if(!e.is_parts_eye_status())return void e.setCollapes();(e.x<400||e.x>700||e.y<100||e.y>300)&&(e.rad+=Math.PI/2),e.x+=Math.cos(e.rad)*e.speed,e.y+=Math.sin(e.rad)*e.speed,e.moves.unshift({x:e.x,y:e.y}),e.moves.length>e.parts.length*e.moves_interval&&e.moves.pop();for(let t=0;t<e.parts.length;t++){let s=e.moves[t*e.moves_interval];if(void 0===s)break;e.parts[t].moveSet({x:s.x,y:s.y,standby:!1})}for(let t=e.parts.length-1;t>=0;t--)e.parts[t].moveDraw();let t=e.moves[0];e._c%300>100&&e._c%300<200&&(e.parts_eye.move_eye_open(),e.parts_eye.moveDraw({x:t.x,y:t.y+e.height/2-e.parts_eye.height/2})),e._c%300>=200&&e._c%300<300&&(e.parts_eye.move_eye_close(),e.parts_eye.moveDraw({x:t.x,y:t.y+e.height/2-e.parts_eye.height/2})),e.setSelfCollision(),e._c++}}class Ne extends _e{constructor(t){super(e.enemy_cell_boss.obj,t.x,t.y);this._status=1,this.x=t.x||y.width+200,this.y=t.y||250,this.alpha=void 0===t.alpha?0:t.alpha,this.speed=2,this._standby=!1,this.ani=t.dark?[480,640,800]:[0,160,320],this.ani_c=0,this.ani_c_intv=20,this.width=160,this.height=this.img.height,this.shotColMap=["50,0,"+this.width+","+this.height],this.is_able_collision=!1,this.is_ignore_collision=!1,this._collision_type="t9"}showCollapes(){let e=this.getEnemyCenterPosition();H.push(new ps(this.x+this.width/2,e._y,this._collision_type)),this.init()}moveSet(e){this.x=e.x,this.y=e.y,this._standby=void 0!==e.standby&&!1!==e.standby}moveDraw(){this.ani_c=this.ani_c>=this.ani.length*this.ani_c_intv-1?0:this.ani_c+1,ni._setDrawImage({img:this.img,x:this.x,y:this.y,imgPosx:this.ani[parseInt(this.ani_c/this.ani_c_intv)],width:this.width,basePoint:1,alpha:this.alpha})}move(){}}class We extends _e{constructor(t){super(e.enemy_cell_boss_eye.obj,t.x,t.y);this._status=100,this.x=t.x||y.width+200,this.y=t.y||250,this._standby=!1,this.audio_alive=s.enemy_collision7,this.is_able_collision=!1,this.ani=[0,48,96,144],this.ani_c=0,this.ani_c_intv=20,this.setAliveHit=!1,this.width=48,this.height=this.img.height,this.shotColMap=["0,0,"+this.width+","+this.height],this._collision_type="t1"}showCollapes(){this.init()}shot(){let t=this,s=ni.getDeg(P,t);for(let i=-30;i<=30;i+=30)B.push(new Je({x:t.x+20,y:this.getEnemyCenterPosition()._y,img:e.enemy_bullet_cell.obj,imgPos:[0,15],width:15,speed:3,aniItv:10,deg:s+i}))}move_eye_open(){let e=this;e.ani_c>=e.ani.length*e.ani_c_intv-1||(e.ani_c%10==0&&e.shot(),e.ani_c++)}move_eye_close(){let e=this;e.ani_c<0||(e.ani_c%10==0&&e.shot(),e.ani_c--)}setAlive(){ni._setDrawImage({img:this.img,x:this.x+20,y:this.y,imgPosx:this.ani[parseInt(this.ani_c/this.ani_c_intv)],width:this.width,basePoint:1}),ni._setPlay(this.audio_alive)}moveDraw(e){this.x=e.x,this.y=e.y,this.is_able_collision=this.ani_c>0,ni._setDrawImage({img:this.img,x:this.x,y:this.y,imgPosx:this.ani[parseInt(this.ani_c/this.ani_c_intv)],width:this.width,basePoint:1})}move(){this.x=W.getX(this.x),this.y=W.getY(this.y),this.isMove()}}class Ze extends Oe{constructor(t,s){super(e.enemy_death.obj,t,s);this._status=100,this.width=202,this.height=140,this.c_z4_ani=30,this.z4_ani=[{img:e.enemy_bigcore_4_1.obj,al:1},{img:e.enemy_bigcore_4_2.obj,al:.8},{img:e.enemy_bigcore_4_3.obj,al:.6},{img:e.enemy_bigcore_4_4.obj,al:.4},{img:e.enemy_bigcore_4_5.obj,al:.2}],this.tid=null,this.shotColMap=["0,0,40,100","40,0,230,140,false"],this._collision_type="t9",this.defSpeed=3,this._front_imgPosx=0,this._isfirstbreak=!1}shot(){let e=this;if(0!==e._c){if(e._isfirstbreak)return e._front_imgPosx=126,void(e._c%250==210&&(B.push(new st({x:e.x+50,y:e.y+35})),ni._setPlay(s.enemy_bullet_laser_long)));if(e._c%250>200&&e._c%250<210&&(e._front_imgPosx=42),e._c%250>210&&e._c%250<230&&(e._front_imgPosx=84),e._c%250>230&&e._c%250<240&&(e._front_imgPosx=42),e._c%250>240&&e._c%250<250&&(e._front_imgPosx=0),e._c%250==210)for(let t=0;t<5;t++)B.push(new tt({x:e.x+50,y:e.y+45+10*t,deg:[40,20,1,-20,-40][t]}))}}move_Allset(){let e=this;e.x-=4,e.moveDraw(),e.x<y.width-e.img.width-80&&(e.is_all_set=!0,e.is_able_collision=!0)}isAllset(){return!!this.is_all_set||(this.move_Allset(),!1)}move_before(){return!1}move_standby(){let e=this;e.move_before()||(e.x-=4,e.x<y.width&&(e._standby=!1))}move(){let t=this;if(ni._setDrawImage({img:e.enemy_death_front.obj,x:t.x,y:t.y+34,imgPosx:t._front_imgPosx,basePoint:1,width:42}),!t.isMove())return;if(!t.isAllset())return;!1===t._isfirstbreak&&(t._c>=2e3||t._status<=50)&&(t._isfirstbreak=!0,H.push(new ps(t.x,t.y+65,"t1")),ni._setPlay(t.audio_collision));let s=P.getPlayerCenterPosition();t.speed=(()=>t._c%250>=200&&t._c%250<249?0:t._c%50>=40&&t._c%50<49?0:t._c%50==0?s._y<t.y+t.height?-1*t.defSpeed:t.defSpeed:t.y<0&&t.speed<0?t.defSpeed:t.y+t.height>y.height&&t.speed>0?-1*t.defSpeed:t.speed)(),t.y+=t.speed,t.shot(),t.moveDraw(),t.setSelfCollision(),t._c++}}class Je{constructor(t){let s=this;s.x=t.x||500,s.y=t.y||300,s.tx=P.getPlayerCenterPosition()._x,s.ty=P.getPlayerCenterPosition()._y,s.img=t.img||e.enemy_bullet.obj,s.imgPos=t.imgPos||[0,18],s._c=0,s.aniItv=t.aniItv||5,s.width=t.width||18,s.height=t.height||s.img.height,s.speed=t.speed||$[X]._ENEMY_SHOT_SPEED,s.rad=void 0===t.deg?ni.getRad({x:s.tx,y:s.ty},{x:s.x,y:s.y}):t.deg*Math.PI/180,s.deg=t.deg||ni.getDeg({x:s.tx,y:s.ty},{x:s.x,y:s.y}),s.sx=Math.cos(s.rad),s.sy=Math.sin(s.rad),s._shot_alive=!0,s._isshow=!0,s.is_ignore_collision=!1,s.shotColMap=["1,1,"+(s.width-1)+","+(s.height-1)]}init(){this._shot_alive=!1,this._isshow=!1}map_collition(){let e=this,t=W.getMapX(e.x),s=W.getMapY(e.y);W.isMapCollision(t,s)&&e.init()}getEnemyCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}isalive(){return this._shot_alive}isshow(){return this._isshow}move(){let e=this;e.map_collition(),e.y=W.getY(e.y),ni.isEnemyCanvasOut(e)?e.init():e._shot_alive&&(e._c=e._c>=7?0:e._c+1,e.x+=e.sx*e.speed,e.y+=e.sy*e.speed,ni._setDrawImage({img:e.img,x:e.x,y:e.y,width:e.width,imgPosx:e.imgPos[parseInt(e._c/e.aniItv)]}),e._shot_alive=!0)}}class Ve extends Je{constructor(t){super({x:t.x,y:t.y}),this.img=t.img||e.enemy_bullet_laser.obj,this.speed=10}move(){let e=this;ni.isEnemyCanvasOut(e)?e.init():e._shot_alive&&(e.map_collition(),e.x-=e.speed,ni._setDrawImage({img:e.img,x:e.x,y:e.y}))}}class Qe extends Je{constructor(t){super({x:t.x,y:t.y,deg:t.deg});this.img=e.enemy_cristalcore_shot.obj,this.speed=10}move(){let e=this;ni.isEnemyCanvasOut(e)?e.init():e._shot_alive&&(e.map_collition(),e.x-=e.sx*e.speed,e.y-=e.sy*e.speed,ni._setDrawImage({img:e.img,x:e.x,y:e.y,deg:e.deg}))}}class $e extends Je{constructor(t){super({x:t.x,y:t.y,deg:t.deg});this.img=e.enemy_frame_3.obj,this.speed=1,this._c=0}shot(){let e=this;if(e._c>100){let t=e.getEnemyCenterPosition();for(let e=30;e<=360;e+=30)B.push(new et({x:t._x,y:t._y,deg:e}));e.init()}}move(){let e=this;ni.isEnemyCanvasOut(e)?e.init():e._shot_alive&&(e.shot(),e.map_collition(),e.x-=e.sx*e.speed,e.y-=e.sy*e.speed,ni._setDrawImage({img:e.img,x:e.x,y:e.y,deg:e.deg}),e._c++)}}class et extends $e{constructor(t){super({x:t.x,y:t.y,deg:t.deg});this.img=e.enemy_frame_5.obj,this.speed=5}shot(){}}class tt extends Je{constructor(t){super({x:t.x,y:t.y,width:25,height:10,deg:t.deg});this.img=e.enemy_death_shot.obj,this.speed=1,this._c=0}shot(){}move(){let e=this;if(ni.isEnemyCanvasOut(e))return void e.init();if(!e._shot_alive)return;e.shot(),e.map_collition(),e.speed+=.2;let t=P.getPlayerCenterPosition();t._y<e.y&&e.deg++,t._y>e.y&&e.deg--,e.rad=e.deg*Math.PI/180,e.sx=Math.cos(e.rad),e.sy=Math.sin(e.rad),e.x-=parseInt(e.sx*e.speed),e.y-=parseInt(e.sy*e.speed),ni._setDrawImage({img:e.img,x:e.x,y:e.y,deg:e.deg}),e._c++}}class st extends Je{constructor(t){super({x:t.x,y:t.y,width:140,height:70,rad:Math.PI});this.img=e.enemy_death_shot2.obj,this.speed=1,this.bossx=t.x,this.is_ignore_collision=!0}init(){this.is_ignore_collision||(this._shot_alive=!1,this._isshow=!1)}move(){let e=this;if(e.bossx<=-150)return e._shot_alive=!1,void(e._isshow=!1);e.x=e.x<=-150?-150:e.x-30,e.bossx=e.x>-150?e.bossx:e.bossx-30,e.shotColMap=["0,0,"+(e.bossx+25)+","+e.height],w.drawImage(e.img,0,0,40,e.height,e.x,e.y,40,e.height),w.drawImage(e.img,40,0,10,e.height,e.x+40,e.y,e.bossx-e.x-25,e.height),w.drawImage(e.img,70,0,70,e.height,e.bossx,e.y,70,e.height)}}class it{constructor(e){void 0!==e&&(this.img=e.img,this.imgPos=e.imgPos||[0],this.aniItv=e.aniItv||1,this.width=e.width||this.img.obj.width,this.height=e.height||this.img.obj.height,this.dir=e.dir||1,this.x=e.x||0,this.y=e.y||0,this._s="1",this._c=0,this._DEF_DIR={_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},this.is_able_collision=!1,this._DEF_SHOTSTATUS={_SHOTTYPE_NORMAL:1,_SHOTTYPE_MISSILE:2,_SHOTTYPE_DOUBLE:1,_SHOTTYPE_RIPPLE_LASER:1.5,_SHOTTYPE_LASER:1},this._c=0)}getImg(){return this.img.obj}collision(){}moveDraw(e,t){this._c=this._c>=this.imgPos.length*this.aniItv-1?0:this._c+1,ni._setDrawImage({img:this.img,imgPosx:this.imgPos[parseInt(this._c/this.aniItv)],x:e,y:t,width:this.width,height:this.height,basePoint:1})}}class _t extends it{constructor(){super({img:e.map_cube_A.obj,width:25,height:25});this._s="1"}}class nt extends it{constructor(){super({img:e.enemy_p_1.obj,width:84,height:83});this._s="011,111,110"}}class ot extends it{constructor(){super({img:e.map_moai_A.obj,width:250,height:100});this._s="0000000000,1111111111,1111111111,0000000000"}}class at extends it{constructor(){super({img:e.map_moai_B.obj,width:250,height:100});this._s="0000000000,1111111111,1111111111,0000000000"}}class rt extends it{constructor(){super({img:e.map_volcano_A.obj,width:225,height:75});this._s="111111111,111111111,000000000"}}class lt extends it{constructor(){super({img:e.map_volcano_B.obj,width:225,height:75});this._s="111111111,111111111,000000000"}}class ht extends it{constructor(){super({img:e.map_volcano_C.obj,width:225,height:75});this._s="000000000,111111111,111111111"}}class mt extends it{constructor(){super({img:e.map_volcano_D.obj,width:225,height:75});this._s="000000000,111111111,111111111"}}class ct extends it{constructor(){super({img:e.map_volcano_F.obj,width:225,height:150});this._s="000110000,000110000,001111000,011111100,011111110,111111111"}}class gt extends it{constructor(){super({img:e.map_volcano_G.obj,width:225,height:150});this._s="111111110,011111110,011111100,001111000,000110000,000110000"}}class dt extends it{constructor(){super({img:e.map_volcano_H.obj,width:500,height:325});this._s="00000000000000000000,00000111111111111110,00000111111110000000,00000000011110000000,00000000001100000000,00000000001100000000,00000000001100000000,11111111111111111100,01111111111111111100,00000000011000000000,00000000011000000000,00000000111000000000,00000001111110000000"}}class pt extends it{constructor(){super({img:e.map_volcano_I.obj,width:375,height:250});this._s="000000010000000,000000010000000,000000111000000,000001111100000,000011111110000,000111111111000,001111111111100,001111111111100,011111111111110,111111111111111"}}class ut extends it{constructor(){super({img:e.map_volcano_J.obj,width:375,height:250});this._s="111111111111111,011111111111110,001111111111100,001111111111100,000111111111000,000011111110000,000001111100000,000000111000000,000000010000000,000000010000000"}}class yt extends it{constructor(){super({img:e.map_volcano_K.obj,width:75,height:25});this._s="010"}}class wt extends it{constructor(){super({img:e.map_volcano_L.obj,width:75,height:25});this._s="010"}}class bt extends it{constructor(){super({img:e.map_volcano_M.obj,width:100,height:50});this._s="0111,1111"}}class ft extends it{constructor(){super({img:e.map_volcano_N.obj,width:100,height:50});this._s="1111,0111"}}class vt extends it{constructor(){super({img:e.map_volcano_O.obj,width:100,height:50});this._s="1111,1110"}}class xt extends it{constructor(){super({img:e.map_volcano_P.obj,width:100,height:50});this._s="1110,1111"}}class It extends it{constructor(){super({img:e.map_frame_A.obj,imgPos:[0,200,400,600,800],aniItv:10,width:200,height:75});this._s="000000000,11111111,11111111"}}class jt extends it{constructor(){super({img:e.map_frame_B.obj,imgPos:[0,200,400,600,800],aniItv:10,width:200,height:75});this._s="11111111,11111111,00000000"}}class Dt extends it{constructor(){super({img:e.map_frame_C.obj,imgPos:[0,50,100,150],aniItv:10,width:50,height:75});this._s="00,01,11",this.direct=this._DEF_DIR._LD}}class Mt extends it{constructor(){super({img:e.map_frame_D.obj,imgPos:[0,50,100,150],aniItv:10,width:50,height:75});this._s="11,01,00",this.direct=this._DEF_DIR._LU}}class Pt extends it{constructor(){super({img:e.map_frame_E.obj,imgPos:[0,50,100,150],aniItv:10,width:50,height:75});this._s="00,10,11",this.direct=this._DEF_DIR._LU}}class Et extends it{constructor(){super({img:e.map_frame_F.obj,imgPos:[0,50,100,150],aniItv:10,width:50,height:75});this._s="11,10,00",this.direct=this._DEF_DIR._LU}}class Ct extends it{constructor(){super({img:e.map_cell_A.obj,imgPos:[0,475,950],aniItv:20,width:475,height:100});this._s="0000000000000000000,0011111111111111100,0111111111111111110,1111111111111111111"}}class St extends it{constructor(){super({img:e.map_cell_B.obj,imgPos:[0,475,950],aniItv:20,width:475,height:100});this._s="1111111111111111111,0111111111111111110,0011111111111111100,0000000000000000000"}}class kt extends it{constructor(){super({img:e.map_cell_C.obj,imgPos:[0,125,250],aniItv:20,width:125,height:100});this._s="00100,01110,01110,11111"}}class Rt extends it{constructor(){super({img:e.map_cell_D.obj,imgPos:[0,125,250],aniItv:20,width:125,height:100});this._s="11111,01110,01110,00100"}}class Tt extends it{constructor(e){super({img:e.img,imgPos:[0,300,600],aniItv:20,width:300,height:50});this._s=e._s}}class Ot extends Tt{constructor(){super({img:e.map_cell_V.obj,_s:"001111111100,111111111111"})}}class Ft extends Tt{constructor(){super({img:e.map_cell_W.obj,_s:"111111111111,001111111100"})}}class At extends Tt{constructor(){super({img:e.map_cell_Y.obj,_s:"111111111111,111111111111"})}}class Lt extends Tt{constructor(){super({img:e.map_cell_Z.obj,_s:"111111111111,111111111111"})}}class Yt extends it{constructor(t){super({img:e.map_cell_wall.obj,imgPos:t.imgPos||[0],width:25,height:25});this._s="1",this.is_able_collision=!0,this._status=1,this._status_count=0,this.audio_collision=s.map_cell_wall,this._DEF_SHOTSTATUS._SHOTTYPE_LASER=.1}collision(e){this._status-=this._DEF_SHOTSTATUS[e]||1}moveDraw(e,t){let s=this;if(s._status_count>=200&&(s._status_count=0,s._status=1,W.set_mapdef_col(W.getMapX(e),W.getMapY(t),"1")),s._status<=0)return 0===s._status_count&&ni._setPlay(s.audio_collision),W.set_mapdef_col(W.getMapX(e),W.getMapY(t),"0"),void s._status_count++;ni._setDrawImage({img:s.img,x:e,y:t,width:s.width,imgPosx:s.imgPos[0],basePoint:1})}}class Ut extends Yt{constructor(){super({imgPos:[0]})}}class qt extends Yt{constructor(){super({imgPos:[25]})}}class zt extends Yt{constructor(){super({imgPos:[50]})}}class Bt extends Yt{constructor(){super({imgPos:[75]})}}class Ht extends Yt{constructor(){super({imgPos:[100]})}}class Xt extends Yt{constructor(){super({imgPos:[125]})}}class Gt extends Yt{constructor(){super({imgPos:[150]})}}class Kt extends Yt{constructor(){super({imgPos:[175]})}}class Nt extends Yt{constructor(){super({imgPos:[200]})}}class Wt{constructor(t,s,i,_){this.img=e[t].obj,this.x=s||100,this.y=i||100,this._x=0,this._y=0,this._isalive=_||!1,this._scalechange=!0,this.width=0,this.height=0,this._c=0,this.accel=3,this.shotflag=!1}isalive(){return this._isalive}isshotflag(){return this.shotflag}enemy_collision(){}getPlayerCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}setfalsealive(){this._isalive=!1}settruealive(){this._isalive=!0}}class Zt extends Wt{constructor(){super("vicviper",100,200,!0),this._isequipped=!1,this._isequipped_count=0,this.img=e.vicviper.obj,this.imgsize=this.img.height,this.width=this.imgsize,this.height=this.imgsize,this.img_vb=e.vicviper_back.obj,this.imgsize_vb=this.img_vb.height,this.width_vb=this.imgsize_vb,this.height_vb=this.imgsize_vb,this.c_vv_ani=20,this.vv_ani=[120,60,0,180,240],this.vv_e_ani=[420,360,300,480,540],this.c_vb_ani=0,this.vb_ani=[0,14,28],this.vb_e_ani=[42,42,42],this._col_ani_c=0,this.col_ani=[{img:e.vicviper_bomb.obj,scale:.5},{img:e.vicviper_bomb.obj,scale:.7},{img:e.vicviper_bomb.obj,scale:.5},{img:e.vicviper_bomb.obj,scale:.3},{img:e.vicviper_bomb.obj,scale:.1}],this.shotflag=!0}collapes(){null!==o&&(ni._setStopOnBG(),Hs(),zs())}enemy_collision(e){1===n&&E.isalive()||ni.isSqCollision("25,26,35,32",this.x+","+this.y,e.shotColMap,e.x+","+e.y)!==se&&(e.collision(),this.setfalsealive())}enemy_shot_collision(e){1===n&&E.isalive()||ni.isSqCollision("25,26,35,32",this.x+","+this.y,e.shotColMap,e.x+","+e.y)!==se&&(e.init(),this.setfalsealive())}set_equipped(){this._isequipped_count=20}map_collition(){if(1===n&&E.isalive())return;let e=this.getPlayerCenterPosition(),t=W.getMapX(e._x),s=W.getMapY(e._y);W.isMapCollision(t,s)&&this.setfalsealive()}set_vv_ani(e){"ArrowUp"!==e&&"Up"!==e||(this.c_vv_ani-=2),"ArrowDown"!==e&&"Down"!==e||(this.c_vv_ani+=2)}set_moveamount_reset(){W.setBackGroundSpeedY(0),this._x=0,this._y=0}set_moveamount(){let e=this;T?(e.x=function(t){let s=e.x+e._x;return s<=50?(e._x=0,50):s>=y.width-100?(e._x=0,y.width-100):s}(),e.y=function(t){let s=e.y+e._y;return W.map_infinite?s<100?(W.setBackGroundSpeedY(e._y),100):(s>=100&&s<=300&&W.setBackGroundSpeedY(0),s>300?(W.setBackGroundSpeedY(e._y),300):s):s<=50-e.img.height/4?(e._y=0,50-e.img.height/4):s>=y.height-75-e.img.height/4?(e._y=0,y.height-75-e.img.height/4):s}(),ni._setPlayerMoveDraw()):e.set_moveamount_reset()}move(){let e=this;if(!e.isalive())return void e.collapes();e.map_collition(),e.set_moveamount(),T?e.c_vv_ani>46?e.c_vv_ani=46:e.c_vv_ani<4&&(e.c_vv_ani=4):e.c_vv_ani>25?e.c_vv_ani-=1:e.c_vv_ani<25?e.c_vv_ani+=1:e.c_vv_ani=25;let t=function(){let t=parseInt(e.c_vv_ani/10);return e._isequipped_count<=0?e.vv_ani[t]:(e._isequipped_count--,e._isequipped_count>0&&e._isequipped_count%2==0?e.vv_e_ani[t]:e.vv_ani[t])}();w.drawImage(e.img,t,0,e.imgsize,e.imgsize,e.x,e.y,e.imgsize,e.imgsize);let s=function(){let t=parseInt(e.c_vb_ani/3);return e._isequipped_count>0&&e._isequipped_count%2==0?e.vb_e_ani[t]:e.vb_ani[t]}();e.c_vb_ani=ni._ac._get(e.c_vb_ani,e.vb_ani,3),w.drawImage(e.img_vb,s,0,e.imgsize_vb,e.imgsize_vb,e.x,e.y+22,e.imgsize_vb,e.imgsize_vb)}}class Jt extends Zt{constructor(){super("vicviper1",100,200,!0),this.col_ani=[{img:e.vicviper_bomb_red.obj,scale:.5},{img:e.vicviper_bomb_red.obj,scale:.7},{img:e.vicviper_bomb_red.obj,scale:.5},{img:e.vicviper_bomb_red.obj,scale:.3},{img:e.vicviper_bomb_red.obj,scale:.1}]}}class Vt extends Wt{constructor(e,t,s,i){super(e,t,s,i),this._ani_c=0,this.ani=[{scale:1},{scale:.9},{scale:.8},{scale:.7},{scale:.8},{scale:.9}],this.imgsize=this.img.height,this.width=this.imgsize,this.height=this.imgsize}move(e){if(this.x=ni._getPlayerMoveDrawX(e),this.y=ni._getPlayerMoveDrawY(e),!this._isalive)return;if(null===this.x||null===this.y||void 0===this.x||void 0===this.y)return;this.shotflag=!0;let t=this.getPlayerCenterPosition();this._ani_c=this._ani_c>=3*this.ani.length-1?0:this._ani_c+1;let s=parseInt(this._ani_c/3);ni._setDrawImage({img:this.img,x:t._x,y:t._y,scale:this.ani[s].scale})}}class Qt{constructor(){this.img=e.forcefield.obj,this.x=0,this.y=0,this.width=0,this.height=0,this._c=0,this._scale=0,this.reduce_scale_rate=.09,this.reduce_scale_min=.55,this.ani=[0,106],this.col_date=null,this.col_canint=50}init(){this._scale=1,this.width=this.img.width/4,this.height=this.img.height}reset(){this._scale=0,K._set_meter_on("000001")}isalive(){return 0!==this._scale}enemy_collision(e){this.isalive()&&ni.isSqCollision(parseInt(this._scale*this.width/8)+","+parseInt(this._scale*this.height/8)+","+parseInt(this._scale*this.width*6/8)+","+parseInt(this._scale*this.height*6/8),this.x+","+this.y,e.shotColMap,e.x+","+e.y)!==se&&(e.collision(),this.reduce())}enemy_shot_collision(e){let t=this;t.isalive()&&ni.isSqCollision(parseInt(t._scale*t.width/8)+","+parseInt(t._scale*t.height/8)+","+parseInt(t._scale*t.width*6/8)+","+parseInt(t._scale*t.height*6/8),t.x+","+t.y,e.shotColMap,e.x+","+e.y)!==se&&(e.is_ignore_collision?t.reset():(e.init(),t.reduce()))}getPlayerCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}map_collition(){let e=this.getPlayerCenterPosition(),t=W.getMapX(e._x),s=W.getMapY(e._y);W.isMapCollision(t,s)&&this.reduce()}isCollision(){let e=this;return null===e.col_date?(e.col_date=new Date,!0):new Date-e.col_date>e.col_canint&&(e.col_date=new Date,!0)}reduce(){let e=this;e.isalive()&&e.isCollision()&&(e._scale-=e.reduce_scale_rate,e._scale<=e.reduce_scale_min&&e.reset(),ni._setPlay(s.vicviper_shield_reduce))}move(e){this.isalive()&&(this.map_collition(),this.x=e.x,this.y=e.y,this._c=this._c>=5*this.ani.length-1?0:this._c+1,ni._setDrawImage({img:this.img,x:e.getPlayerCenterPosition()._x-6,y:e.getPlayerCenterPosition()._y-2,imgPosx:this.ani[parseInt(this._c/5)],width:this.width,height:this.height,scale:this._scale}))}}class $t extends Qt{constructor(){super(),this.ani=[210,315]}}class es extends Qt{constructor(){super();this.ani=[0,40],this.reduce_scale_rate=.04,this.reduce_scale_min=.35}getPlayerCenterPosition(){return{_x:this.x+this.width/2*this._scale,_y:this.y+this.height*this._scale}}init(){this._scale=1,this.img=e.shield.obj,this.width=this.img.width/4,this.height=this.img.height}isalive(){return 0!==this._scale}enemy_collision(e){this.isalive()&&ni.isSqCollision("0,0,"+parseInt(this._scale*this.width)+","+parseInt(this._scale*this.height*2),this.x+","+this.y,e.shotColMap,e.x+","+e.y)!==se&&(e.collision(),this.reduce())}enemy_shot_collision(e){let t=this;t.isalive()&&ni.isSqCollision("0,0,"+parseInt(t._scale*t.width)+","+parseInt(t._scale*t.height*2),t.x+","+t.y,e.shotColMap,e.x+","+e.y)!==se&&(e.is_ignore_collision?t.reset():(e.init(),t.reduce()))}map_collition(e){let t=this,s=t.getPlayerCenterPosition(),i=W.getMapX(s._x),_=W.getMapY(s._y);W.isMapCollision(i,_)?t.reduce():(_=W.getMapY(t.y+10),W.isMapCollision(i,_)?t.reduce():(_=W.getMapY(s._y-15+t.height*t._scale),W.isMapCollision(i,_)&&t.reduce()))}move(e){if(!this.isalive())return;let t=e.getPlayerCenterPosition();this.map_collition(e),this.x=t.x,this.y=t.y,this._c=this._c>=5*this.ani.length-1?0:this._c+1;let s=e.x+e.width,i=t._y,_=t._y-this.height*this._scale;ni._setDrawImage({img:this.img,x:s,y:i,imgPosx:this.ani[parseInt(this._c/5)],width:this.width,height:this.height,scale:this._scale,basePoint:7}),ni._setDrawImage({img:this.img,x:s,y:i,imgPosx:this.ani[parseInt(this._c/5)],width:this.width,height:this.height,scale:this._scale,basePoint:1}),this.x=s,this.y=_}}class ts extends es{constructor(){super(),this.ani=[80,120]}}class ss{constructor(e){this.shots=new Array,this.player=e,this._sq=0}enemy_collision(e){if(this.player.isalive())for(let t=0;t<this.shots.length;t++){let s=this.shots[t];if(!s._shot_alive)continue;if(e.x<this.player.x)continue;let i=ni.isSqCollision("-12,-12,12,12",s.x+","+s.y,e.shotColMap,e.x+","+e.y);i!==se&&(i===ee&&e.collision(v),s._init())}}map_collition(){}getshottype(){}move(){}}class is extends ss{constructor(t){super(t),this.shots=new Array,this.col_mis=[{fs:"rgba(255,246,72,1)",scale:8},{fs:"rgba(255,131,62,1)",scale:10},{fs:"rgba(255,131,72,1)",scale:12},{fs:"rgba(255,131,62,1)",scale:14},{fs:"rgba(133,0,4,1)",scale:12},{fs:"rgba(133,0,4,1)",scale:14},{fs:"rgba(100,0,4,1)",scale:16}],this.st={_st1:0,_st2:24,_st3:48,_st4:72,_st5:96,_st6:0,_st7:96,_st8:72},this.imgsize=e.gradius_missile.obj.height;for(let t=0;t<L;t++)this.shots.push({sid:f,id:t,x:0,y:0,_t:0,_st:"_st1",_img:e.gradius_missile.obj,_audio:s.missile,_c_mc:0,_c:0,_c_area:25,_enemyid:null,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._t=0,this._c=0,this._c_mc=0,this._c_area=25,this._st="_st1",this._enemyid=null,this._shot=!1,this._shot_alive=!1}});let i=this;this.mis_status={_st1:function(e){let t=i.player.getPlayerCenterPosition();var s;e.x=(s=e.x,e._shot_alive?s+4:t._x),e.y=function(s){return e._shot_alive?s+8:t._y}(e.y)},_st2:function(e){e.x+=0,e.y+=8},_st3:function(e){e.x+=8,e.y+=0},_st4:function(e){e.x+=2,e.y+=1},_st5:function(e){e.x+=2,e.y+=2},_st6:function(e){e.x+=2,e.y+=2},_st7:function(e){e.x+=6,e.y+=1},_st8:function(e){e.x+=6,e.y+=1}}}enemy_collision(e,t){if(!this.player.isalive())return;if(!t._shot_alive)return;let s=ni.isSqCollision(0-t._img.height/4+","+(0-t._img.height/4)+","+5*t._img.height/4+","+5*t._img.height/4,t.x+","+t.y,e.shotColMap,e.x+","+e.y);s!==se&&(t._c>0||(0===t._c&&(t._c=1),s!==te&&e.collision(f)))}get_missile_status(e){return e._st}set_missile_status(e,t){"_st1"!==this._st&&"_st2"!==this._st&&"_st3"!==this._st&&(e._c_mc++,e._c_mc>1?e._c_mc=0:e._st=t)}map_collition(e){let t=this,s=W.getMapX(e.x+t.imgsize),i=W.getMapY(e.y);if(!W.isMapBefore(s,i)){if(W.isMapOver(s,i)){if("_st3"===t.get_missile_status(e))return void t.set_missile_status(e,"_st4");if("_st2"===t.get_missile_status(e))return}if("_st4"===t.get_missile_status(e)&&t.set_missile_status(e,"_st5"),"_st6"===t.get_missile_status(e)&&t.set_missile_status(e,"_st7"),"_st7"===t.get_missile_status(e)&&t.set_missile_status(e,"_st8"),"_st8"===t.get_missile_status(e)&&t.set_missile_status(e,"_st3"),"_st5"===t.get_missile_status(e)){if(s=W.getMapX(e.x+t.imgsize),W.isMapCollision(s,i+1))return void t.set_missile_status(e,"_st6");t.set_missile_status(e,"_st2")}if("_st3"===t.get_missile_status(e)){if(function(){if(i=W.getMapY(e.y+t.imgsize),!W.isMapCollision(s,i))return!1;if(!1===W.map_infinite){var _=parseInt(e.y/W.t),n=e.y%W.t<W.t/2?_:_+1;e.y=n*W.t}}(),s=W.getMapX(e.x+t.imgsize/2),i=W.getMapY(e.y+t.imgsize/2),W.isMapCollision(s,i))return void e._init();if(!W.isMapCollision(s+1,i+1))return void t.set_missile_status(e,"_st4");if(W.isMapOver(s,i))return void t.set_missile_status(e,"_st4")}if("_st2"===t.get_missile_status(e)&&(i=W.getMapY(e.y+t.imgsize+14),W.isMapCollision(s,i)))t.set_missile_status(e,"_st6");else if("_st1"===t.get_missile_status(e)){if(i=W.getMapY(e.y+t.imgsize+14),W.isMapCollision(s+1,i))return void t.set_missile_status(e,"_st6");if(W.isMapCollision(s,i))return void t.set_missile_status(e,"_st6")}}}collapse_missile(e,t){let s=this;if(e.x=W.getX(e.x),t=t||-5,e._c>=5*s.col_mis.length)return void e._init();let i=parseInt(e._c/5);e._c_area=s.col_mis[i].scale,w.fillStyle=s.col_mis[i].fs,w.beginPath(),w.arc(e.x,e.y+t,s.col_mis[i].scale,0,2*Math.PI,!1),w.fill(),void 0!==this.col_mis[i-1]&&(w.fillStyle=s.col_mis[i-1].fs,w.beginPath(),w.arc(e.x,e.y+t,s.col_mis[i-1].scale,0,2*Math.PI,!1),w.fill()),e._c++}move(){let e=this,t=e.player;if(t.isalive()&&t.isshotflag()&&void 0!==t.x)for(let t=0;t<e.shots.length;t++){let s=e.shots[t];(s._shot||s._shot_alive)&&(s.y=W.getShotY(s.y),s._c>0?e.collapse_missile(s,10):ni.isShotCanvasOut(s)?s._init():(e.mis_status[s._st](s),"_st1"===e.get_missile_status(s)&&W.isMapCollision(W.getMapX(s.x),W.getMapY(s.y))?s._init():(w.drawImage(s._img,e.st[e.get_missile_status(s)],0,e.imgsize,e.imgsize,s.x,s.y,e.imgsize,e.imgsize),s._shot_alive=!0)))}}}class _s extends is{constructor(e){super(e);let t=this;this.st._st1=48,t.mis_status._st1=function(e){let s=t.player.getPlayerCenterPosition();var i;e.x=(i=e.x,e._shot_alive?i+4:s._x),e.y=function(t){return e._shot_alive?t+8:s._y}(e.y)}}enemy_collision(e,t){if(!this.player.isalive())return;if(!t._shot_alive)return;let s=ni.isSqCollision(this.imgsize/4+","+this.imgsize/4+","+3*this.imgsize/4+","+3*this.imgsize/4,t.x+","+t.y,e.shotColMap,e.x+","+e.y);s!==se&&(t._c>0||(s!==te?(e.collision(f),e.isalive()&&0===t._c&&(t._c=1)):0===t._c&&(t._c=1)))}}class ns extends is{constructor(e){super(e),this.col_mis=[{fs:"rgba(198,231,247,1)",scale:30},{fs:"rgba(54,115,255,1)",scale:40},{fs:"rgba(54,115,255,1)",scale:50},{fs:"rgba(54,115,255,1)",scale:60},{fs:"rgba(0,27,145,1)",scale:60},{fs:"rgba(0,27,145,1)",scale:60},{fs:"rgba(0,27,100,1)",scale:70}],this.st={_st1:72,_st2:96,_st3:0}}enemy_collision(e,t){let s=this;if(!s.player.isalive())return;if(!t._shot_alive)return;e.getEnemyCenterPosition();let i=function(){if(t._c>0){if(t._c%20!=0)return se;let s=2*t._c_area;Math.sqrt(2);return ni.isSqCollision("0,0,"+s+","+s,parseInt(t.x-s/2)+","+parseInt(t.y-s/2),e.shotColMap,e.x+","+e.y)}return ni.isSqCollision(s.imgsize/4+","+s.imgsize/4+","+3*s.imgsize/4+","+3*s.imgsize/4,t.x+","+t.y,e.shotColMap,e.x+","+e.y)}();i!==se&&(0===t._c&&(t._c=1),i!==te&&e.collision(f))}map_collition(e){let t=W.getMapX(e.x),s=W.getMapY(e.y);(W.isMapCollision(t,s)||W.isMapCollision(t+1,s))&&this.collapse_missile(e,-25)}move(){let e=this,t=e.player;if(!t.isalive())return;if(!t.isshotflag())return;if(void 0===t.x)return;let s=t.getPlayerCenterPosition();for(let t=0;t<e.shots.length;t++){let _=e.shots[t];(_._shot||_._shot_alive)&&(_.y=W.getShotY(_.y),_._c>0?e.collapse_missile(_):(_._t++,_.x=(i=_.x,_._shot_alive?i+4:s._x),_.y=function(e){return _._shot_alive?e+_._t*_._t/200:s._y-8}(_.y),_._st=_._t>20&&_._t<30?"_st2":_._t>30?"_st3":"_st1",ni.isShotCanvasOut(_)?_._init():(w.drawImage(_._img,e.st[e.get_missile_status(_)],0,e.imgsize,e.imgsize,_.x,_.y,e.imgsize,e.imgsize),_._shot_alive=!0)))}var i}}class os extends is{constructor(e){super(e),this.st={_st1:72,_st2:96,_st3:0,_st4:120,_st5:144,_st6:168}}enemy_collision(e,t){if(!this.player.isalive())return;if(!t._shot_alive)return;let s=ni.isSqCollision("-10,-10,"+(this.imgsize+10)+","+(this.imgsize+10),t.x+","+t.y,e.shotColMap,e.x+","+e.y);s!==se&&(t._c>0||(0===t._c&&(t._c=1),s!==te&&e.collision(f)))}map_collition(e){let t=W.getMapX(e.x),s=W.getMapY(0===e.id?e.y:e.y+this.imgsize);W.isMapCollision(t,s)&&0===e._c&&(e._c=1)}move(){let e=this,t=e.player;if(!t.isalive())return;if(!t.isshotflag())return;if(void 0===t.x)return;let s=t.getPlayerCenterPosition(),i=this.shots[0]._shot|this.shots[1]._shot,_=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(i||_){i&&!_&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let t=0;t<this.shots.length;t++){let i=this.shots[t];i._shot_alive&&(i.y=W.getShotY(i.y),i._c>0?e.collapse_missile(i,10):(i._t+=1,i.x=(n=i.x,_?n+1:s._x),i.y=function(e){return 0===t?_?e+i._t*i._t/100*-1:s._y-20:_?e+i._t*i._t/100:s._y}(i.y),ni.isShotCanvasOut(i)?i._init():(i._st=0===t?i._t>20&&i._t<30?"_st5":i._t>30?"_st6":"_st4":i._t>20&&i._t<30?"_st2":i._t>30?"_st3":"_st1",w.drawImage(i._img,e.st[e.get_missile_status(i)],0,e.imgsize,e.imgsize,i.x,i.y,e.imgsize,e.imgsize),i._shot_alive=!0)))}var n}}}class as extends ss{constructor(t){super(t),this.shots=new Array,this.speed=20;for(let t=0;t<L;t++)this.shots.push({sid:v,x:0,y:0,_img:e.shot1.obj,_audio:s.shot_normal,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._shot=!1,this._shot_alive=!1}})}map_collition(e){let t=W.getMapX(e.x),s=W.getMapY(e.y);if(W.isMapCollision(t,s))return e._init(),void W.setPlayersShotAbleCollision(t,s);W.isMapCollision(t+1,s)&&(e._init(),W.setPlayersShotAbleCollision(t+1,s))}move(){let t=this.player;if(!t.isalive())return;if(!t.isshotflag())return;let s=t.getPlayerCenterPosition();for(let t=0;t<this.shots.length;t++){let _=this.shots[t];if(!_._shot&&!_._shot_alive)continue;let n=this.speed;if(_.x=(i=_.x,_._shot_alive?i+n:s._x),_.y=function(e){return _._shot_alive?e:s._y}(_.y),_.y=W.getShotY(_.y),ni.isShotCanvasOut(_)){_._init();continue}let o=e.shot1.obj;w.drawImage(o,_.x,_.y,o.width,o.height),_._shot_alive=!0}var i}}class rs extends ss{constructor(t){super(t),this.shots=new Array,this.speed=30;for(let t=0;t<L;t++)this.shots.push({sid:x,x:0,y:0,_img:0===t?e.shot1.obj:e.shot2.obj,_audio:s.shot_normal,_enemyid:null,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._enemyid=null,this._shot=!1,this._shot_alive=!1}})}enemy_collision(e){let t=this;if(!t.player.isalive())return;for(let s=0;s<t.shots.length;s++){let i=t.shots[s],_=ni.isSqCollision("-10,-10,10,10",i.x+","+i.y,e.shotColMap,e.x+","+e.y);_!==se&&(_!==te?e.isalive()&&(e.collision(x),i._init()):i._init())}}map_collition(e){let t=W.getMapX(e.x),s=W.getMapY(e.y);if(W.isMapCollision(t,s))return e._init(),void W.setPlayersShotAbleCollision(t,s);W.isMapCollision(t+1,s)&&(e._init(),W.setPlayersShotAbleCollision(t+1,s))}move(){let e=this.player;if(!e.isalive())return;if(!e.isshotflag())return;let t=e.getPlayerCenterPosition(),s=this.shots[0]._shot|this.shots[1]._shot,i=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(s||i){s&&!i&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let e=0;e<this.shots.length;e++){let s=this.shots[e];s._shot_alive&&(s.x=(_=s.x,i?_+30:t._x),s.y=function(s){return 0===e?i?s:t._y:i?s-23:t._y-23}(s.y),s.y=W.getShotY(s.y),ni.isShotCanvasOut(s)?s._init():(w.drawImage(s._img,s.x,s.y,s._img.width,s._img.height),s._shot_alive=!0))}var _}}}class ls extends rs{constructor(e){super(e)}map_collition(e){let t=W.getMapX(e.x),s=W.getMapY(e.y);if(W.isMapCollision(t,s))return e._init(),void W.setPlayersShotAbleCollision(t,s);W.isMapCollision(t-1,s)&&(e._init(),W.setPlayersShotAbleCollision(t-1,s))}move(){let t=this.player;if(!t.isalive())return;if(!t.isshotflag())return;let s=t.getPlayerCenterPosition(),i=this.shots[0]._shot|this.shots[1]._shot,_=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(i||_){i&&!_&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let t=0;t<this.shots.length;t++){let i=this.shots[t];if(!i._shot_alive)continue;if(i.x=(n=i.x,0===t?_?n+30:s._x:_?n-30:s._x),i.y=function(e){return _?e:s._y}(i.y),i.y=W.getShotY(i.y),ni.isShotCanvasOut(i)){i._init();continue}let o=0===t?e.shot1.obj:e.shot3.obj;w.drawImage(o,i.x,i.y,o.width,o.height),i._shot_alive=!0}var n}}}class hs extends ss{constructor(e){super(e),this.shots=new Array,this.speed=30,this.lineWidth_1=3,this.strokeStyle_1="rgba(40,70,255,1)",this.lineWidth_2=4,this.strokeStyle_2="rgba(100,180,255,0.7)";for(let e=0;e<L;e++)this.shots.push({sid:I,x:0,y:0,_t:0,_shot:!1,_shot_alive:!1,_width:0,_height:0,_audio:s.shot_ripple,_init:function(){this.x=0,this.y=0,this._t=0,this._shot=!1,this._shot_alive=!1,this._width=0,this._height=0}})}enemy_collision(e){if(this.player.isalive())for(let t=0;t<this.shots.length;t++){let s=this.shots[t];if(!s._shot_alive)continue;if(e.isIgnore())continue;if(e.isIgnoreCollision())continue;let i=ni.isSqCollision("0,-20,"+s._width+","+(2*s._height+20),s.x+","+(s.y-s._height),e.shotColMap,e.x+","+e.y);i!==se&&(i===ee&&(e.collision(j),function(){let e=z;for(let t=0;t<e.length;t++){let i=e[t];i.isIgnore()||i.isalive()&&i.isshow()&&(i.isIgnoreCollision()||ni.isSqCollision("0,0,"+s._width+","+2*s._height,s.x+","+(s.y-s._height),i.shotColMap,i.x+","+i.y)===ee&&i.collision(j))}}()),s._init())}}map_collition(e){let t=W.getMapX(e.x),s=W.getMapY(e.y);if(W.isMapCollision(t,s)||W.isMapCollision(t+1,s)){let i=parseInt(e._height/W.t/2);for(let e=s-i;e<=s+i;e++)W.isMapCollision(t+1,e)&&W.setPlayersShotAbleCollision(t+1,e);e._init()}}move(){let e=this,t=e.player;if(!t.isalive())return;if(!t.isshotflag())return;let s=t.getPlayerCenterPosition();for(let t=0;t<e.shots.length;t++){let _=e.shots[t];if(!_._shot&&!_._shot_alive)continue;let n=e.speed;_.x=(i=_.x,_._shot_alive?i+n:s._x),_.y=function(e){return _._shot_alive?e:s._y}(_.y),_.y=W.getShotY(_.y),ni.isShotCanvasOut(_)?_._init():(_._t=_._t<20?_._t+1:_._t,_._width=.4+_._t,_._height=8+_._t*_._t/6,w.beginPath(),w.lineWidth=e.lineWidth_2,w.strokeStyle=e.strokeStyle_2,w.ellipse(_.x+1,_.y+1,_._width,_._height,0,0,2*Math.PI),w.stroke(),w.beginPath(),w.lineWidth=e.lineWidth_1,w.strokeStyle=e.strokeStyle_1,w.ellipse(_.x,_.y,_._width,_._height,0,0,2*Math.PI),w.stroke(),_._shot_alive=!0)}var i}}class ms extends hs{constructor(e){super(e),this.strokeStyle_1="rgba(255,80,50,1)",this.strokeStyle_2="rgba(255,180,100,0.7)"}}class cs extends ss{constructor(t){super(t);let i=this;i.shots=new Array,i.speed=50,i.lineWidth=3,i.strokeStyle="rgba(50,80,255,1)",i.strokeStyle_u="rgba(120,150,255,1)",i.img_col=e.shot_laser_col.obj,i.imgsize_col=i.img_col.height,i.width_col=i.imgsize_col,i.height_col=i.imgsize_col,i.img_col_ani=[0,25];for(let e=0;e<1;e++)i.shots.push({sid:I,x:0,y:0,_c_col:0,laser_time:500,_sx:0,_enemy:null,_laser_t:0,_laser_ts:0,_laser_MaxX:y.width,_l_x:0,_l_sx:0,_shot:!1,_shot_alive:!1,_audio:s.shot_laser,_init:function(){this.x=0,this.y=0,this._c_col=0,this._laser_t=0,this._laser_ts=0,this._sx=0,this._enemy=null,this._l_x=0,this._l_sx=0,this._laser_MaxX=y.width,this._shot=!1,this._shot_alive=!1}})}laser_collision(e,t){e._laser_MaxX>=y.width||(e._c_col=e._c_col>=this.img_col_ani.length-1?0:e._c_col+1,w.drawImage(this.img_col,this.img_col_ani[e._c_col],0,this.imgsize_col,this.imgsize_col,(t||e._l_x)-this.width_col,e.y-this.img_col.height/2,this.imgsize_col,this.imgsize_col))}enemy_collision(e){if(this.player.isalive())for(let t=0;t<this.shots.length;t++){if(e.x<this.player.x)continue;let s=this.shots[t];if(!s._shot_alive)continue;let i=ni.isSqCollision_laser("0,-6,"+parseInt(s._l_x-s._l_sx)+",6",s._l_sx+","+s.y,e.shotColMap,e.x+","+e.y);return i.ret===se?i.val:i.ret===te?i.val:(e.collision(I),e.isalive()?i.val:y.width)}}map_collition(e){let t=this;if(!e._shot_alive)return;t.player.getPlayerCenterPosition();let s=W.getMapX(e._l_x),i=W.getMapY(e.y);(W.isMapCollision(s,i)||W.isMapCollision(s-1,i))&&t.setLaserMaxX(e,W.getMapXToPx(s));for(let t=W.getMapX(e._l_sx)+1;t<=s;t++)W.isMapCollision(t,i)&&W.setPlayersShotAbleCollision(t,i,I)}setLaserLine(e,t,s){e._l_x=t,e._l_sx=s}setLaserMaxX(e,t){e._laser_MaxX=t}move(){let e=this,t=e.player;if(!t.isalive())return;if(!t.isshotflag())return;let s=t.getPlayerCenterPosition();w.beginPath(),w.lineWidth=e.lineWidth,w.strokeStyle=e.strokeStyle,w.lineCap="round";for(let t=0;t<e.shots.length;t++){let _=e.shots[t];if(!_._shot&&!_._shot_alive)continue;if(_.x=(i=_.x)>=_._laser_MaxX-s._x?(_._laser_t+=1e3/u,_._laser_MaxX-s._x):i+e.speed,_._sx=function(t){return _._shot?_._laser_t<=_.laser_time-200?t:(_._laser_ts+=1e3/u,_._laser_ts>_.laser_time-200?(_._init(),0):t>=_.x?_.x:t+e.speed):t>=_.x?(_._init(),0):t+e.speed}(_._sx),_.y=s._y,_.x<_._sx||Math.abs(_.x-_._sx)<50)continue;let n=s._x;w.beginPath(),w.strokeStyle=e.strokeStyle_u,w.moveTo(n+_._sx,s._y+1),w.lineTo(n+_.x,s._y+1),w.stroke(),w.beginPath(),w.strokeStyle=e.strokeStyle,w.moveTo(n+_._sx,s._y),w.lineTo(n+_.x,s._y),w.stroke(),e.setLaserLine(_,n+_.x,n+_._sx),e.laser_collision(_,n+_.x),_.x>0&&(_._shot_alive=!0)}var i}}class gs extends cs{constructor(e){super(e);this.lineWidth=5,this.strokeStyle="rgba(255,80,50,1)",this.strokeStyle_u="rgba(255,200,150,1)",this.img_col_ani=[50,75]}}const ds={t0:{intv:5,img:e.enemy_collapes0.obj},t1:{intv:5,img:e.enemy_collapes1.obj},t2:{intv:5,img:e.enemy_collapes2.obj},t8:{intv:5,img:e.enemy_collapes8.obj},t9:{intv:5,img:e.enemy_collapes9.obj}};class ps{constructor(e,t,s){this._c_anime_collosion=0,this.x=e||0,this.y=t||0,this.type=s||"t0",this._status=!0}isalive(){return this._status}move(){let e=this,t=ds[e.type].img,s=ds[e.type].intv,i=parseInt(t.width/t.height);if(e._c_anime_collosion>=i*s-1)e._status=!1;else{var _=t.height;e.x=W.getX(e.x),e.y=W.getY(e.y),w.drawImage(t,_*parseInt(e._c_anime_collosion/s),0,_,_,e.x-_/2,e.y-_/2,_,_),e._c_anime_collosion++}}}let us="",ys="",ws=3,bs=0,fs=0,vs=0;const xs={_DEF_DIR:{_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},_setDir:function(e,t){let s=W.isMapCollision(e,t-1)?this._DEF_DIR._U:this._DEF_DIR._D;return s=W.isMapCollision(e,t+1)?this._DEF_DIR._D:this._DEF_DIR._U},_ENEMIES:{a:{_gamestart:function(e,t,s){z.push(new ae(e,t,s))},_st:"",_o:e.enemy_a_1,_obj:new ae},b:{_gamestart:function(e,t,s){z.push(new re(e,t,s))},_st:"",_o:e.enemy_b_1,_obj:new re},c:{_gamestart:function(e,t,s){z.push(new le(e,t,s))},_st:"",_o:e.enemy_c_1,_obj:new le},d:{_gamestart:function(e,t,s){z.push(new he(e,t,s))},_st:"",_o:e.enemy_d_1,_obj:new he},e:{_gamestart:function(e,t,s){z.push(new me(e,t,s))},_st:"",_o:e.enemy_e_1,_obj:new me},f:{_gamestart:function(e,t,s){s=t<y.height/2?xs._DEF_DIR._U:xs._DEF_DIR._D,z.push(new ce(e,t,s))},_st:"",_o:e.enemy_f_1,_obj:new ce},g:{_gamestart:function(e,t,s){s=t<y.height/2?xs._DEF_DIR._U:xs._DEF_DIR._D,z.push(new ge(e,t,s))},_st:"",_o:e.enemy_g_1,_obj:new ge},m:{_gamestart:function(e,t,s){z.push(new de(e,t,s))},_st:"",_o:e.enemy_m_1,_obj:new de},n:{_gamestart:function(e,t,s){z.push(new ue(e,t))},_st:"",_o:e.enemy_o_1,_obj:new ue},o:{_gamestart:function(e,t,s){z.push(new ye(e,t))},_st:"",_o:e.enemy_o_1,_obj:new ye},p:{_gamestart:function(e,t,s){let i=new fe(e,t);z.push(i)},_st:"",_o:e.enemy_p_1,_obj:new fe},z:{_gamestart:function(e,t,s){z.push(new ne(e,t,s))},_st:"",_o:e.enemy_fan,_obj:new ne}}},Is={enemy_cristalcore:{_f:function(){return new Ue(700,800)}},enemy_bigcore:{_f:function(){return new Ae(y.width+200,200)}},enemy_cristalcore_pt2:{_f:function(){return new ze(700,800)}},enemy_bigcore2:{_f:function(){return new Le(y.width+200,200)}},enemy_frame:{_f:function(){return new He(1e3,200)}},enemy_cell:{_f:function(){return new Ke(y.width+200,200)}},enemy_death:{_f:function(){return new Ze(y.width+200,200)}}},js={_THEME1:{_map:{A:{_o:(new nt).img,_gamestart:function(e){this.objs[e]=new nt},objs:{},_obj:new nt}},_enemies:xs._ENEMIES},_THEME2:{_map:{A:{_o:(new rt).img,_gamestart:function(e){this.objs[e]=new rt},objs:{},_obj:new rt},B:{_o:(new lt).img,_gamestart:function(e){this.objs[e]=new lt},objs:{},_obj:new lt},C:{_o:(new ht).img,_gamestart:function(e){this.objs[e]=new ht},objs:{},_obj:new ht},D:{_o:(new mt).img,_gamestart:function(e){this.objs[e]=new mt},objs:{},_obj:new mt},F:{_o:(new ct).img,_gamestart:function(e){this.objs[e]=new ct},objs:{},_obj:new ct},G:{_o:(new gt).img,_gamestart:function(e){this.objs[e]=new gt},objs:{},_obj:new gt},H:{_o:(new dt).img,_gamestart:function(e){this.objs[e]=new dt},objs:{},_obj:new dt},I:{_o:(new pt).img,_gamestart:function(e){this.objs[e]=new pt},objs:{},_obj:new pt},J:{_o:(new ut).img,_gamestart:function(e){this.objs[e]=new ut},objs:{},_obj:new ut},K:{_o:(new yt).img,_gamestart:function(e){this.objs[e]=new yt},objs:{},_obj:new yt},L:{_o:(new wt).img,_gamestart:function(e){this.objs[e]=new wt},objs:{},_obj:new wt},M:{_o:(new bt).img,_gamestart:function(e){this.objs[e]=new bt},objs:{},_obj:new bt},N:{_o:(new ft).img,_gamestart:function(e){this.objs[e]=new ft},objs:{},_obj:new ft},O:{_o:(new vt).img,_gamestart:function(e){this.objs[e]=new vt},objs:{},_obj:new vt},P:{_o:(new xt).img,_gamestart:function(e){this.objs[e]=new xt},objs:{},_obj:new xt}},_enemies:xs._ENEMIES},_THEME3:{_map:{A:{_o:(new _t).img,_gamestart:function(e){this.objs[e]=new _t},objs:{},_obj:new _t}},_enemies:xs._ENEMIES},_THEME5:{_map:{B:{_o:(new ot).img,_gamestart:function(e){this.objs[e]=new ot},objs:{},_obj:new ot},C:{_o:(new at).img,_gamestart:function(e){this.objs[e]=new at},objs:{},_obj:new at}},_enemies:{a:{_gamestart:function(e,t,s){z.push(new ae(e,t,s))},_st:"",_o:e.enemy_a_1,_obj:new ae},b:{_gamestart:function(e,t,s){z.push(new re(e,t,s))},_st:"",_o:e.enemy_b_1,_obj:new re},c:{_gamestart:function(e,t,s){z.push(new le(e,t,s))},_st:"",_o:e.enemy_c_1,_obj:new le},d:{_gamestart:function(e,t,s){z.push(new he(e,t,s))},_st:"",_o:e.enemy_d_1,_obj:new he},e:{_gamestart:function(e,t,s){z.push(new me(e,t,s))},_st:"",_o:e.enemy_e_1,_obj:new me},f:{_gamestart:function(e,t,s){s=t<y.height/2?xs._DEF_DIR._U:xs._DEF_DIR._D,z.push(new ce(e,t,s))},_st:"",_o:e.enemy_f_1,_obj:new ce},g:{_gamestart:function(e,t,s){s=t<y.height/2?xs._DEF_DIR._U:xs._DEF_DIR._D,z.push(new ge(e,t,s))},_st:"",_o:e.enemy_g_1,_obj:new ge},m:{_gamestart:function(e,t,s){z.push(new de(e,t,s))},_st:"",_o:e.enemy_m_1,_obj:new de},l:{_gamestart:function(e,t,s){let i=new xe(e,t,xs._DEF_DIR._U);z.push(i)},_st:"transform:scale(1,-1);",_o:e.enemy_m_a_1,_obj:new xe(0,0,xs._DEF_DIR._U)},n:{_gamestart:function(e,t,s){let i=new xe(e,t,xs._DEF_DIR._D);z.push(i)},_st:"",_o:e.enemy_m_a_1,_obj:new xe(0,0,xs._DEF_DIR._D)},o:{_gamestart:function(e,t,s){let i=new Ie(e,t,xs._DEF_DIR._U);z.push(i)},_st:"transform:scale(1,-1);",_o:e.enemy_m_b_1,_obj:new Ie(0,0,xs._DEF_DIR._U)},p:{_gamestart:function(e,t,s){let i=new Ie(e,t,xs._DEF_DIR._D);z.push(i)},_st:"",_o:e.enemy_m_b_2,_obj:new Ie(0,0,xs._DEF_DIR._D)},q:{_gamestart:function(e,t,s){let i=new xe(e,t,xs._DEF_DIR._LD);z.push(i)},_st:"transform:scale(-1,1);",_o:e.enemy_m_a_1,_obj:new xe(0,0,xs._DEF_DIR._LD)},r:{_gamestart:function(e,t,s){let i=new xe(e,t,xs._DEF_DIR._LU);z.push(i)},_st:"transform:scale(-1,-1);",_o:e.enemy_m_a_1,_obj:new xe(0,0,xs._DEF_DIR._ENEMY_DIFFICULT)},z:{_gamestart:function(e,t,s){z.push(new ne(e,t,s))},_st:"",_o:e.enemy_fan,_obj:new ne}}},_THEME6:{_map:{A:{_o:(new It).img,_gamestart:function(e){this.objs[e]=new It},objs:{},_obj:new It},B:{_o:(new jt).img,_gamestart:function(e){this.objs[e]=new jt},objs:{},_obj:new jt},C:{_o:(new Dt).img,_gamestart:function(e){this.objs[e]=new Dt},objs:{},_obj:new Dt},D:{_o:(new Mt).img,_gamestart:function(e){this.objs[e]=new Mt},objs:{},_obj:new Mt},E:{_o:(new Pt).img,_gamestart:function(e){this.objs[e]=new Pt},objs:{},_obj:new Pt},F:{_o:(new Et).img,_gamestart:function(e){this.objs[e]=new Et},objs:{},_obj:new Et}},_enemies:{a:{_gamestart:function(e,t,s){z.push(new De(e,t,s))},_st:"",_o:e.enemy_frame_1,_obj:new De},d:{_gamestart:function(e,t,s){z.push(new he(e,t,s))},_st:"",_o:e.enemy_d_1,_obj:new he},e:{_gamestart:function(e,t,s){z.push(new me(e,t,s))},_st:"",_o:e.enemy_e_1,_obj:new me},z:{_gamestart:function(e,t,s){z.push(new ne(e,t,s))},_st:"",_o:e.enemy_fan,_obj:new ne}}},_THEME7:{_map:{A:{_o:(new Ct).img,_gamestart:function(e){this.objs[e]=new Ct},objs:{},_obj:new Ct},B:{_o:(new St).img,_gamestart:function(e){this.objs[e]=new St},objs:{},_obj:new St},C:{_o:(new kt).img,_gamestart:function(e){this.objs[e]=new kt},objs:{},_obj:new kt},D:{_o:(new Rt).img,_gamestart:function(e){this.objs[e]=new Rt},objs:{},_obj:new Rt},G:{_o:(new Ut).img,_gamestart:function(e){this.objs[e]=new Ut},objs:{},_obj:new Ut},H:{_o:(new qt).img,_gamestart:function(e){this.objs[e]=new qt},objs:{},_obj:new qt},I:{_o:(new zt).img,_gamestart:function(e){this.objs[e]=new zt},objs:{},_obj:new zt},J:{_o:(new Bt).img,_gamestart:function(e){this.objs[e]=new Bt},objs:{},_obj:new Bt},K:{_o:(new Ht).img,_gamestart:function(e){this.objs[e]=new Ht},objs:{},_obj:new Ht},L:{_o:(new Xt).img,_gamestart:function(e){this.objs[e]=new Xt},objs:{},_obj:new Xt},M:{_o:(new Gt).img,_gamestart:function(e){this.objs[e]=new Gt},objs:{},_obj:new Gt},N:{_o:(new Kt).img,_gamestart:function(e){this.objs[e]=new Kt},objs:{},_obj:new Kt},O:{_o:(new Nt).img,_gamestart:function(e){this.objs[e]=new Nt},objs:{},_obj:new Nt},V:{_o:(new Ot).img,_gamestart:function(e){this.objs[e]=new Ot},objs:{},_obj:new Ot},W:{_o:(new Ft).img,_gamestart:function(e){this.objs[e]=new Ft},objs:{},_obj:new Ft},Y:{_o:(new At).img,_gamestart:function(e){this.objs[e]=new At},objs:{},_obj:new At},Z:{_o:(new Lt).img,_gamestart:function(e){this.objs[e]=new Lt},objs:{},_obj:new Lt}},_enemies:{a:{_gamestart:function(e,t,s){z.push(new Ee(e,t,s))},_st:"",_o:e.enemy_cell_core,_obj:new Ee},b:{_gamestart:function(e,t,s){z.push(new Re(e,t,s))},_st:"",_o:e.enemy_cell_a_1,_obj:new Re},c:{_gamestart:function(e,t,s){z.push(new Te(e,t,s))},_st:"",_o:e.enemy_cell_b_1,_obj:new Te},d:{_gamestart:function(e,t,s){z.push(new he(e,t,s))},_st:"",_o:e.enemy_d_1,_obj:new he},e:{_gamestart:function(e,t,s){z.push(new me(e,t,s))},_st:"",_o:e.enemy_e_1,_obj:new me},z:{_gamestart:function(e,t,s){z.push(new ne(e,t,s))},_st:"",_o:e.enemy_fan,_obj:new ne}}}};class Ds{constructor(e){this.pt=e||0,this.initx=0,this.inity=0,this.x=this.initx,this.y=this.inity,this.collision=new RegExp("[1A-Z]"),this.collision_enemies=new RegExp("[a-z]","g"),this.collision_map=new RegExp("[A-Z]"),this.collision_map_d=new RegExp("[BD]"),this.t=25,this.mapdef=new Array,this.mapdef_col=new Array,this.map_theme=0,this.map_pettern=0,this.map_difficult=0,this.map_background_speed=0,this.map_backgroundY_speed=0,this.map_infinite=!1,this.map_bgmusic="",this.map_boss="",this.isboss=!1}init(e){Ms("./gradius_map.json","json",function(t){us=t,e()})}setInifinite(e){this.map_infinite=e}set_stage_map_pattern(e){this.map_pettern=e}set_gamestart(){this.map_backgroundY_speed=0,this.x=parseInt(us[this.map_pettern]._initx),this.y=this.inity,this.initx=parseInt(us[this.map_pettern]._initx),this.mapdef=us[this.map_pettern]._map,this.map_difficult=parseInt(us[this.map_pettern]._difficult)-1,X=i?X:parseInt(us[this.map_pettern]._difficult)-1,this.map_background_speed=parseInt(us[this.map_pettern]._speed),bs=parseInt(us[this.map_pettern]._speed),ws=this.map_pettern,this.map_theme=us[this.map_pettern]._theme,this.map_infinite="true"===us[this.map_pettern]._map_infinite,this.map_bgmusic=us[this.map_pettern]._bgmusic,this.map_boss=us[this.map_pettern]._boss,this.isboss=!1,this.set_gamestart_mapdef_col(),this.set_gamestart_map_theme_objs()}set_gamestart_map_theme_objs(){let e=this;for(let t=0;t<e.mapdef.length;t++){let s=e.mapdef[t];for(let i=0;i<s.length;i++)if(e.isEnemiesBit(s[i])){let _=xs._setDir(i,t);js[e.map_theme]._enemies[s[i]]._gamestart(e.x+i*e.t,t*e.t,_)}else e.isCollisionBit(s[i])&&js[e.map_theme]._map[s[i]]._gamestart(i+","+t)}}set_gamestart_mapdef_col(){let e=this;Object.assign(e.mapdef_col,e.mapdef);for(let t=0;t<e.mapdef_col.length;t++)e.mapdef_col[t]=e.mapdef_col[t].replace(/[a-zA-Z]/gi,"0");for(let i=0;i<e.mapdef.length;i++){let _=e.mapdef[i];for(let n=0;n<_.length;n++){if(null===_[n].match(/[A-Za-z]/))continue;let o=e.isEnemiesBit(_[n])?js[e.map_theme]._enemies[_[n]]._obj:js[e.map_theme]._map[_[n]]._obj;void 0===o&&console.log("テーマ:"+e.map_theme+"に対して "+_[n]+"の定義がありません。");let a=o._s.split(",");for(let o=0;o<a.length;o++){let r=e.mapdef_col[i+o],l=e.mapdef[i+o];e.mapdef_col[i+o]=r.substr(0,n)+(l.substr(n,a[o].length),t=r.substr(n,a[o].length),s=a[o],e.setCollisionBit(s,t))+r.substr(n+a[o].length,_.length)}}}var t,s}set_mapdef_col(e,t,s){let i=this;if(void 0===e||void 0===t||void 0===s)return;let _=s.split(",");for(let s=0;s<_.length;s++){let n=i.mapdef_col[t+s];i.mapdef_col[t+s]=n.substr(0,e)+_[s]+n.substr(e+_[s].length)}}getX(e){return e+-1*bs}getY(e){return this.map_infinite?e-W.map_backgroundY_speed<-250?750+(250+e-W.map_backgroundY_speed):e-W.map_backgroundY_speed>750?-250-(750-e+W.map_backgroundY_speed):(e-W.map_backgroundY_speed)%1e3:e}getShotY(e){return e-W.map_backgroundY_speed}setCollisionBit(e,t){let s="";for(let i=0;i<e.length;i++)"0"!==e[i]?s+="1":s+=t[i];return s}getCollisionFlag(){return this.collision}setBackGroundSpeedY(e){this.map_backgroundY_speed=e}getBackGroundSpeed(){return this.map_background_speed}getBackGroundSpeedY(){return this.map_backgroundY_speed}get_stage_map_pattern(e){return this.map_pettern}getMapXToPx(e){return e*this.t+this.initx-fs}getMapYToPx(e){return e}getMapX(e){return Math.floor((e+fs-this.initx)/this.t)}getMapY(e,t){return!0===t&&(console.log("_y:"+e),console.log("_MAP_SCROLL_POSITION_Y:"+vs)),Math.floor((e+vs)%1e3/this.t)}isCollisionBit(e){return null!==e.match(this.collision)}isEnemiesBit(e){return null!==e.match(this.collision_enemies)}isMapDouble(e){return null!==e.match(this.collision_map_d)}isMapBefore(e,t){return e<0}isMapLastSide(e,t){return void 0!==this.mapdef[t]&&(void 0===this.mapdef[t][e]||e===this.mapdef[t].length-1)}isMapOver(e,t){return void 0!==this.mapdef[t]&&(void 0===this.mapdef[t][e]||e>this.mapdef[t].length-1)}isMapCollision(e,t){return void 0!==this.mapdef_col[t]&&(void 0!==this.mapdef_col[t][e]&&!!this.isCollisionBit(this.mapdef_col[t][e]))}setPlayersShotAbleCollision(e,t,s){let i=js[this.map_theme]._map;if(void 0===i)return;let _=this.mapdef[t][e];if(void 0===i[_])return;let n=i[_].objs[e+","+t];void 0!==n&&n.is_able_collision&&n.collision(s)}isPlayersShotCollision(){for(let e=0;e<Y[D].length;e++){let t=Y[D][e];for(let e=0;e<t.shots.length;e++){let s=t.shots[e];s._shot_alive&&t.map_collition(s)}}for(let e=0;e<U.length;e++){let t=U[e];if(t.player.isalive())for(let e=0;e<t.shots.length;e++){let s=t.shots[e];s._shot_alive&&(s._c>0||t.map_collition(s))}}}show(){}showMapForStageselect(e){let t=this;if(null==e)return;let s=e._map.length;for(let i=0;i<(s>20?20:s);i++){let s=e._map[i].length;for(let _=0;_<(s>30?30:s);_++){let s=e._map[i][_+20];if(void 0!==s&&"0"!==s)if(null!==s.match(t.collision_enemies)){let t=js[e._theme]._enemies[s]._o.obj;w.drawImage(t,50+10*_,130+10*i,t.width/2.5,t.height/2.5)}else{let t=js[e._theme]._map[s];t._o.obj;w.save(),w.translate(50+10*_,130+10*i),w.scale(.25,.25),w.drawImage(t._obj.img,t._obj.imgPos[0],0,t._obj.width,t._obj.height,0,0,1.6*t._obj.width,1.6*t._obj.height),w.restore()}}}w.fillStyle="rgba(0,0,0,1)",w.fillRect(350,130,500,500),w.fillRect(50,330,500,500)}map_draw(){let e=this;for(let t=0;t<e.mapdef.length;t++)for(let s=0;s<e.mapdef[t].length;s++){let i=e.mapdef[t][s];if(!e.isCollisionBit(i))continue;if(e.x+s*e.t<-500||e.x+s*e.t>y.width+100)continue;let _=js[e.map_theme]._map[i];_.objs[s+","+t].moveDraw(e.x+s*e.t,e.y+t*e.t),e.map_infinite&&_.objs[s+","+t].moveDraw(e.x+s*e.t,e.y+t*e.t+(e.y>0?-1e3:1e3))}}set_mapdef_col_clear(){let e=this;for(let t=0;t<e.mapdef_col.length;t++){let s=e.mapdef_col[t];e.mapdef_col[t]=s.replace(/1/gi,"0")}}set_scroll_on_x(){bs=this.map_background_speed}set_scroll_off_x(){bs=0}move(){let e=this;fs+y.width>e.mapdef[0].length*e.t+e.initx&&(e.isboss=!0),fs-100>e.mapdef[0].length*e.t+e.initx&&(bs=0),e.x+=-1*bs,fs+=bs,e.y=e.getY(e.y),vs=function(){let t=vs+e.map_backgroundY_speed;return t<0?(1e3+t)%1e3:t%1e3}()}}const Ms=function(e,t,s,i){let _=new XMLHttpRequest;_.onreadystatechange=function(){4===_.readyState&&(200===_.status?(console.log("OK"),s(_.response,i)):console.log("NG"))},_.open("GET",e+"?date="+(new Date).getTime()),_.responseType=t||"json",_.send(null)},Ps={addKeydownStart:function(){g?Ss._sp_bt_s.addEventListener(d,Cs.keydown_start):document.addEventListener(d,Es.keydown_start)},removeKeydownStart:function(){g?Ss._sp_bt_s.removeEventListener(d,Cs.keydown_start):document.removeEventListener(d,Es.keydown_start)},addKeydownSelectStage:function(){g?(Ss._sp_main_center.addEventListener("touchmove",Cs.keymove_select_stage),Ss._sp_main_center.addEventListener(p,Cs.keyend_select_stage),Ss._sp_bt_a.addEventListener(d,Cs.keydown_select_stage_a)):document.addEventListener(d,Es.keydown_select_stage)},removeKeydownSelectStage:function(){g?(Ss._sp_main_center.removeEventListener("touchmove",Cs.keymove_select_stage),Ss._sp_main_center.removeEventListener(p,Cs.keyend_select_stage),Ss._sp_bt_a.removeEventListener(d,Cs.keydown_select_stage_a),Ss._set_reset()):document.removeEventListener(d,Es.keydown_select_stage)},addKeydownSelectPowermeter:function(){g?(Ss._sp_main_center.addEventListener("touchmove",Cs.keymove_select_powermeter),Ss._sp_main_center.addEventListener(p,Cs.keyend_select_powermeter),Ss._sp_bt_a.addEventListener(d,Cs.keydown_select_powermeter_a)):document.addEventListener(d,Es.keydown_select_powermeter)},removeKeydownSelectPowermeter:function(){g?(Ss._sp_main_center.removeEventListener("touchmove",Cs.keymove_select_powermeter),Ss._sp_main_center.removeEventListener(p,Cs.keyend_select_powermeter),Ss._sp_bt_a.removeEventListener(d,Cs.keydown_select_powermeter_a),Ss._set_reset()):document.removeEventListener(d,Es.keydown_select_powermeter)},addKeydownGame:function(){g?(Ss._sp_bt_hide.addEventListener(d,Cs.keydown_game_hide),Ss._sp_bt_r.addEventListener(d,Cs.keydown_game_r),Ss._sp_bt_p.addEventListener(d,Cs.keydown_game_p),Ss._sp_bt_s.addEventListener(d,Cs.keydown_game_s),Ss._sp_bt_b.addEventListener(d,Cs.keydown_game_b),Ss._sp_bt_a.addEventListener(d,Cs.keydown_game_a),Ss._sp_main_center.addEventListener("touchstart",Cs.keymove_game_controller),Ss._sp_main_center.addEventListener("touchmove",Cs.keymove_game_controller)):document.addEventListener(d,Es.keydown_game)},addKeyupGame:function(){g?(Ss._sp_bt_a.addEventListener(p,Cs.keyup_game_a),Ss._sp_main_center.addEventListener("touchend",Cs.keyend_game_controller),Ss._set_reset()):document.addEventListener(p,Es.keyup_game)},removeKeydownGame:function(){g?(Ss._sp_bt_hide.removeEventListener(d,Cs.keydown_game_hide),Ss._sp_bt_r.removeEventListener(d,Cs.keydown_game_r),Ss._sp_bt_p.removeEventListener(d,Cs.keydown_game_p),Ss._sp_bt_s.removeEventListener(d,Cs.keydown_game_s),Ss._sp_bt_b.removeEventListener(d,Cs.keydown_game_b),Ss._sp_bt_a.removeEventListener(d,Cs.keydown_game_a),Ss._sp_main_center.removeEventListener("touchstart",Cs.keymove_game_controller),Ss._sp_main_center.removeEventListener("touchmove",Cs.keymove_game_controller)):document.removeEventListener(d,Es.keydown_game)},removeKeyupGame:function(){g?(Ss._sp_bt_a.removeEventListener(p,Cs.keyup_game_a),Ss._sp_main_center.removeEventListener("touchend",Cs.keyend_game_controller),Ss._set_reset()):document.removeEventListener(p,Es.keyup_game)},addKeydownGameclear:function(){g?(Ss._sp_bt_r.addEventListener(d,Cs.keydown_gameclear_r),Ss._sp_bt_s.addEventListener(d,Cs.keydown_gameclear_s),Ss._sp_bt_p.addEventListener(d,Cs.keydown_gameclear_p)):document.addEventListener(d,Es.keydown_gameclear)},removeKeydownGameclear:function(){g?(Ss._sp_bt_r.removeEventListener(d,Cs.keydown_gameclear_r),Ss._sp_bt_s.removeEventListener(d,Cs.keydown_gameclear_s),Ss._sp_bt_p.removeEventListener(d,Cs.keydown_gameclear_p)):document.removeEventListener(d,Es.keydown_gameclear)},addKeydownGameover:function(){g?(Ss._sp_bt_r.addEventListener(d,Cs.keydown_gameover_r),Ss._sp_bt_s.addEventListener(d,Cs.keydown_gameover_s)):document.addEventListener(d,Es.keydown_gameover)},removeKeydownGameover:function(){g?(Ss._sp_bt_r.removeEventListener(d,Cs.keydown_gameover_r),Ss._sp_bt_s.removeEventListener(d,Cs.keydown_gameover_s)):document.removeEventListener(d,Es.keydown_gameover)}},Es={keydown_start:function(t){"S"!==t.key&&"s"!==t.key||(document.querySelector("#game_start_wrapper .text").classList.add("on"),document.querySelector("#game_start_wrapper .text_loading").classList.add("on"),_i(e,si),ni._setPlay(s.playerset))},keydown_select_powermeter:function(e){if(clearInterval(r),r=null,"Enter"===e.key||"enter"===e.key)return Ks(),ni._setPlay(s.playerset),!1;"ArrowUp"!==e.key&&"Up"!==e.key||(K._c_pms=K._c_pms<=0?0:K._c_pms-1),"ArrowDown"!==e.key&&"Down"!==e.key||(K._c_pms=K._c_pms>=K.pms_selected.length-1?K._c_pms:K._c_pms+1),"ArrowLeft"!==e.key&&"Left"!==e.key||(K._c_pmss=K._c_pmss<=0?0:K._c_pmss-1),"ArrowRight"!==e.key&&"Right"!==e.key||(K._c_pmss=K._c_pmss>=K.pmss_selected.length-1?K._c_pmss:K._c_pmss+1),K.pms_disp(),K.pms_select(),ni._setPlay(s.pms_select)},keydown_select_stage:function(e){if("Enter"===e.key||"enter"===e.key)return W.set_stage_map_pattern(N.mapdef_status),ti(),ni._setPlay(s.playerset),!1;"ArrowLeft"!==e.key&&"Left"!==e.key||(N.mapdef_status=N.mapdef_status<=0?0:N.mapdef_status-1),"ArrowRight"!==e.key&&"Right"!==e.key||(N.mapdef_status=N.mapdef_status>=us.length-1?N.mapdef_status:N.mapdef_status+1),N.set_map_status(),N.disp_thumb_map(),ni._setPlay(s.pms_select)},keydown_gameclear:function(e){if("R"===e.key||"r"===e.key)return Gs(),$s(),ei(),!1;if("S"===e.key||"s"===e.key)return Gs(),$s(),si(),!1;if("P"===e.key||"p"===e.key)return null!==o?Hs():(V=[],Us()),!1;if(" "===e.key||"Spacebar"===e.key){if(null!==r)return;Bs()}"ArrowLeft"!==e.key&&"Left"!==e.key||(T=!0,P._x=-1*P.accel),"ArrowRight"!==e.key&&"Right"!==e.key||(T=!0,P._x=P.accel),"ArrowUp"!==e.key&&"Up"!==e.key||(T=!0,P._y=-1*P.accel),"ArrowDown"!==e.key&&"Down"!==e.key||(T=!0,P._y=P.accel),"B"!==e.key&&"b"!==e.key||K.playerset()},keydown_gameover:function(e){return"R"===e.key||"r"===e.key?(Gs(),$s(),ei(),!1):"S"===e.key||"s"===e.key?(Gs(),$s(),si(),!1):void 0},keydown_game:function(e){if(!P.isalive())return!1;if("R"===e.key||"r"===e.key)return Gs(),$s(),ei(),!1;if("S"===e.key||"s"===e.key)return Gs(),$s(),si(),!1;if("P"===e.key||"p"===e.key)return null!==o?(Hs(),ni._setStopOnBG()):(V=[],Us(),ni._setPlayOnBG(ni._audio_now_obj_bg)),!1;if(null===o){if(V.push(e.keyCode),Q===V.toString()){D=v,q=!0;for(let e=0;e<k;e++)C[e].settruealive();E.init(),V=[],K._set_current_reset(),K.meterdef_status="101100"}return!1}if(" "===e.key||"Spacebar"===e.key){if(null!==r)return;Bs()}if("ArrowLeft"!==e.key&&"Left"!==e.key||(T=!0,P._x=-1*P.accel),"ArrowRight"!==e.key&&"Right"!==e.key||(T=!0,P._x=P.accel),"ArrowUp"!==e.key&&"Up"!==e.key||(T=!0,P._y=-1*P.accel,P.set_vv_ani(e.key)),"ArrowDown"!==e.key&&"Down"!==e.key||(T=!0,P._y=P.accel,P.set_vv_ani(e.key)),"B"!==e.key&&"b"!==e.key||K.playerset(),!i)return!1;"M"!==e.key&&"m"!==e.key||Vs(),"N"!==e.key&&"n"!==e.key||Qs(),"V"!==e.key&&"v"!==e.key||K.move()},keyup_game:function(e){if(!P.isalive())return!1;"ArrowLeft"!==e.key&&"Left"!==e.key||(T=!1),"ArrowRight"!==e.key&&"Right"!==e.key||(T=!1),"ArrowUp"!==e.key&&"Up"!==e.key||(T=!1),"ArrowDown"!==e.key&&"Down"!==e.key||(T=!1)," "!==e.key&&"Spacebar"!==e.key||Gs()}},Cs={keydown_start:function(t){document.querySelector("#game_start_wrapper .text").classList.add("on"),document.querySelector("#game_start_wrapper .text_loading").classList.add("on"),_i(e,si),ni._setPlay(s.playerset)},keydown_select_powermeter_a:function(e){return Ks(),ni._setPlay(s.playerset),!1},keymove_select_powermeter:function(e){clearInterval(r),r=null,e.preventDefault();let t=Ss._get_st(e);return!0!==l&&(l=!0,t===Ss._DEF_DIR._L?(K._c_pmss=K._c_pmss<=0?0:K._c_pmss-1,K.pms_disp(),K.pms_select(),ni._setPlay(s.pms_select),!1):t===Ss._DEF_DIR._U?(K._c_pms=K._c_pms<=0?0:K._c_pms-1,K.pms_disp(),K.pms_select(),ni._setPlay(s.pms_select),!1):t===Ss._DEF_DIR._R?(K._c_pmss=K._c_pmss>=K.pmss_selected.length-1?K._c_pmss:K._c_pmss+1,K.pms_disp(),K.pms_select(),ni._setPlay(s.pms_select),!1):t===Ss._DEF_DIR._D?(K._c_pms=K._c_pms>=K.pms_selected.length-1?K._c_pms:K._c_pms+1,K.pms_disp(),K.pms_select(),ni._setPlay(s.pms_select),!1):void 0)},keyend_select_powermeter:function(e){Ss._set_reset(),l=!1},keymove_select_stage:function(e){if(e.preventDefault(),h)return;h=!0;let t=Ss._get_st(e);return t?(t===Ss._DEF_DIR._L&&(N.mapdef_status=N.mapdef_status<=0?0:N.mapdef_status-1,ni._setPlay(s.pms_select)),Ss._DEF_DIR._U,t===Ss._DEF_DIR._R&&(N.mapdef_status=N.mapdef_status>=us.length-1?N.mapdef_status:N.mapdef_status+1,ni._setPlay(s.pms_select)),Ss._DEF_DIR._U,N.set_map_status(),N.disp_thumb_map(),!1):void 0},keyend_select_stage:function(e){let t=Ss._sp_main_center;t.style.top="",t.style.left="",h=!1},keydown_select_stage_a:function(e){return W.set_stage_map_pattern(N.mapdef_status),ti(),ni._setPlay(s.playerset),!1},keydown_gameclear_r:function(e){return Gs(),$s(),ei(),!1},keydown_gameclear_s:function(e){return Gs(),$s(),ei(),!1},keydown_gameclear_p:function(e){return null!==o?Hs():(V=[],Us()),!1},keydown_gameover_r:function(e){return Gs(),$s(),ei(),!1},keydown_gameover_s:function(e){return Gs(),$s(),si(),!1},keymove_game_controller:function(e){e.preventDefault(),T=!0;let t=Ss._get_st(e);if(!1!==t)return P._x=0,P._y=0,t===Ss._DEF_DIR._L&&(P._x=-1*P.accel),t===Ss._DEF_DIR._LU&&(P._x=-1*P.accel,P._y=-1*P.accel,P.set_vv_ani("Up")),t===Ss._DEF_DIR._U&&(P._y=-1*P.accel,P.set_vv_ani("Up")),t===Ss._DEF_DIR._RU&&(P._x=1*P.accel,P._y=-1*P.accel,P.set_vv_ani("Up")),t===Ss._DEF_DIR._R&&(P._x=P.accel),t===Ss._DEF_DIR._RD&&(P._x=1*P.accel,P._y=1*P.accel,P.set_vv_ani("Down")),t===Ss._DEF_DIR._D&&(P._y=P.accel,P.set_vv_ani("Down")),t===Ss._DEF_DIR._LD&&(P._x=-1*P.accel,P._y=1*P.accel,P.set_vv_ani("Down")),!1},keyend_game_controller:function(e){Ss._set_reset(),P.set_moveamount_reset(),T=!1},keydown_game_hide:function(e){D=v,q=!0;for(let e=0;e<k;e++)C[e].settruealive();return E.init(),V=[],K._set_current_reset(),K.meterdef_status="101100",!1},keydown_game_r:function(e){return $s(),ei(),!1},keydown_game_s:function(e){return $s(),si(),!1},keydown_game_p:function(e){return null!==o?(Hs(),ni._setStopOnBG()):(V=[],Us(),ni._setPlayOnBG(ni._audio_now_obj_bg)),!1},keydown_game_a:function(e){if(null!==o&&null===r)return Bs(),!1},keydown_game_b:function(e){if(null!==o)return K.playerset(),!1},keyup_game_a:function(e){return Gs(),!1}},Ss={_x:0,_y:0,_sp_main_center:new Object,_sp_main:new Object,_sp_bt_hide:new Object,_sp_bt_r:new Object,_sp_bt_p:new Object,_sp_bt_s:new Object,_sp_bt_b:new Object,_sp_bt_a:new Object,_DEF_DIR:{_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},_get_st:function(e){let t=this._sp_main_center,s=this._sp_main,i=s.getBoundingClientRect();for(var _=0;_<e.touches.length;_++)t===e.touches[_].target&&(this._x=e.touches[_].clientX-i.left,this._y=e.touches[_].clientY-i.top);let n=this._x-parseInt(window.getComputedStyle(t).width)/2,o=this._y-parseInt(window.getComputedStyle(t).height)/2;t.style.left=parseInt(n)+"px",t.style.top=parseInt(o)+"px";let a=parseInt(window.getComputedStyle(s).width),r=parseInt(window.getComputedStyle(s).height),l=a/2-this._x,h=r/2-this._y;if(Math.sqrt(Math.pow(l,2)+Math.pow(h,2))<10)return!1;let m=parseInt(180*Math.atan2(h,l)/Math.PI);return m>-40&&m<=40?this._DEF_DIR._L:m>40&&m<=50?this._DEF_DIR._LU:m>50&&m<=130?this._DEF_DIR._U:m>130&&m<=140?this._DEF_DIR._RU:m>140&&m<=180||m<-140&&m>=-180?this._DEF_DIR._R:m<-130&&m>=-140?this._DEF_DIR._RD:m<-50&&m>=-130?this._DEF_DIR._D:m<-40&&m>=-50?this._DEF_DIR._LD:void 0},_set_reset(){let e=document.querySelector(".sp_controller_main_center");e.style.left="",e.style.top=""},_set_obj(){this._sp_main_center=document.querySelector(".sp_controller_main_center"),this._sp_main=document.querySelector(".sp_controller_main"),this._sp_bt_hide=document.querySelector(".sp_controller_bt.hide"),this._sp_bt_r=document.querySelector(".sp_controller_bt.r"),this._sp_bt_p=document.querySelector(".sp_controller_bt.p"),this._sp_bt_s=document.querySelector(".sp_controller_bt.s"),this._sp_bt_b=document.querySelector(".sp_controller_bt.b"),this._sp_bt_a=document.querySelector(".sp_controller_bt.a")}};class ks{constructor(){let s=this;s.img=e.meter.obj,s.x=y.width/2-s.img.width/2,s.y=y.height-30,s.meterdef_status="111111",s.meterdef_current="000000",s.meterdef={n_32:{imgobj:new Image,name:"meter_c_speedup",func:function(){P.accel>=18?s._set_meter_status():P.accel+=2}},n_16:{imgobj:new Image,name:"meter_c_missile",func:function(){q=!0,s._set_meter_status()}},n_8:{imgobj:new Image,name:"meter_c_double",func:function(){D=x,s._set_meter_status()}},n_4:{imgobj:new Image,name:"meter_c_laser",func:function(){D=I,s._set_meter_status()}},n_2:{imgobj:new Image,name:"meter_c_option",func:function(){C[S].settruealive(),++S<k||s._set_meter_status()}},n_1:{imgobj:new Image,name:"meter_c_shield",func:function(){E.init(),s._set_meter_status()}}},s._c_pms=0,s.pms_img=t.gradius_powermeterselect.obj,s.pms_selected=[{_y:89,_img:t.gradius_powermeterselect_0.obj},{_y:162,_img:t.gradius_powermeterselect_1.obj},{_y:233,_img:t.gradius_powermeterselect_2.obj},{_y:306,_img:t.gradius_powermeterselect_3.obj}],s._c_pmss=0,s.pmss_selected=[{_x:470,_img:t.gradius_powermeterselect_shield_0.obj},{_x:570,_img:t.gradius_powermeterselect_shield_1.obj}]}_set_current_reset(){this.meterdef_current="000000"}_set_meter_status(){let e=this.meterdef_status,t=(~parseInt(this.meterdef_current,2)>>>0).toString(2).slice(-6);this.meterdef_status=this._get_bit((parseInt(e,2)&parseInt(t,2)).toString(2));let s=parseInt(this.meterdef_current,2);8!==s&&4!==s||(this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(8===s?"000100":"001000",2)).toString(2)))}_set_meter_on(e){this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(e,2)).toString(2))}_get_bit(e){return("000000"+e).slice(-6)}_get_meter_current(e){return 0===parseInt(e,2)||1===parseInt(e,2)?"100000":("000000"+(parseInt(e,2)>>1).toString(2)).slice(-6)}move(){this.meterdef_current=this._get_meter_current(this.meterdef_current)}playerset(){let e=parseInt(this.meterdef_current,2),t=parseInt(this.meterdef_status,2);0!==e&&0!=(e&t)&&(P.set_equipped(),ni._setPlay(s.playerset),this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(this.meterdef_current,2)).toString(2)),this.meterdef["n_"+e].func(),this._set_current_reset())}show(){let t=this;w.drawImage(t.img,0,0,t.img.width-71,t.img.height,t.x+36,t.y,t.img.width-71,t.img.height);for(let e=0;e<this.meterdef_status.length;e++)"0"===this.meterdef_status[e]&&w.drawImage(t.img,t.img.width-72,0,72,t.img.height,t.x+36+72*e,t.y,72,t.img.height);let s=parseInt(this.meterdef_current,2);if(0===s)return;let i=parseInt(this.meterdef_status,2),_=e.meter_c.obj,n=0!=(s&i)?72*t.meterdef_current.indexOf("1"):_.width-72;w.drawImage(_,n,0,72,_.height,t.x+36+72*t.meterdef_current.indexOf("1"),t.y,72,_.height)}pms_disp(){w.clearRect(0,0,y.width,y.height),ni._setDrawTextToFont("power meter select",y.width/2-36*"power meter select".length/2,20,.6),ni._setDrawTextToFont("shield select",200,400,.3),w.drawImage(this.pms_img,y.width/2-this.pms_img.width/2,70,this.pms_img.width,this.pms_img.height);let s=e.meter.obj;w.drawImage(s,360,0,72,19,290,430,72,19);let i=t.gradius_powermeterselect_shield.obj;w.drawImage(i,470,390,i.width,i.height)}pms_select(){let e=this.pms_selected[this._c_pms]._img;w.drawImage(e,y.width/2-this.pms_img.width/2,this.pms_selected[this._c_pms]._y,e.width,e.height),e=this.pmss_selected[this._c_pmss]._img,w.drawImage(e,this.pmss_selected[this._c_pmss]._x,390,e.width,e.height)}}class Rs{constructor(){this.x=0,this.y=0,this.speed=100,this.mapdef_status=0,this.mapdef=us[this.mapdef_status]}get_ajaxdata(e,t){t.mapdef=e[t.mapdef_status],i||t.disp_thumb_map()}init(){this.mapdef=us[0],i?this.mapdef=us[ws]:this.disp_thumb_map()}set_map_status(){this.mapdef=us[this.mapdef_status]}disp_thumb_map(){w.clearRect(0,0,y.width,y.height),ni._setDrawTextToFont("stage select",y.width/2-35*"stage select".length/2,20,.6);let e=500-(us.length/2*20+10);for(let t=0;t<us.length;t++)w.beginPath(),w.lineWidth=1,w.strokeStyle="rgba(255,255,255,1)",w.fillStyle="rgba(255,255,255,1)",t===this.mapdef_status?w.fillRect(e+20*t,85,10,10):w.strokeRect(e+20*t,85,10,10);let t=this.mapdef;W.showMapForStageselect(t),w.beginPath(),w.lineWidth=1,w.strokeStyle="rgba(255,255,255,1)",w.fillStyle="rgba(255,255,255,1)",w.strokeRect(50,130,300,200),ni._setDrawTextToFont("stage title",400,130,.3),w.moveTo(400,160),w.lineTo(950,160),w.stroke(),w.font="20px sans-serif";let s=ni._multilineText(w,this.mapdef._title,550);for(let e=0;e<(s.length>2?2:s.length);e++)w.fillText(s[e],400,190+26*e);ni._setDrawTextToFont("difficult:"+this.mapdef._difficult,400,230,.3),w.moveTo(400,260),w.lineTo(950,260),w.stroke(),ni._setDrawTextToFont("detail",400,300,.3),w.moveTo(400,330),w.lineTo(950,330),w.stroke(),s=ni._multilineText(w,this.mapdef._body,520);for(let e=0;e<(s.length>4?4:s.length);e++)w.fillText(s[e],400,360+30*e)}}class Ts{constructor(){this.score1p=0,this.score2p=0,this.def_scorehi=57300,this.scorehi=this.def_scorehi}init(){this.score1p=0,this.score2p=0}set(e){this.score1p+=e,this.scorehi>=this.score1p||(this.scorehi=this.score1p)}show(){t.font.obj;let e="1p"+("        "+this.score1p).slice(-8);ni._setDrawTextToFont(e,180,10,.3),e="hi"+("        "+this.scorehi).slice(-8),ni._setDrawTextToFont(e,400,10,.3),e="2p"+("        "+this.score2p).slice(-8),ni._setDrawTextToFont(e,620,10,.3)}}class Os{constructor(t,s){this.x=t||0,this.y=s||0,this.getscore=200,this.gotpc=!1,this.type=Math.random()>.1?"red":"blue",this._c_pc_ani=0,this.img="red"===this.type?e.pc_red.obj:e.pc_blue.obj}getPCCenterPosition(){return{_x:this.x+this.img.height/2,_y:this.y+this.img.height/2}}getPowerCapcell(){this.gotpc=!0}move(){if(this.gotpc)return;this.x=W.getX(this.x),this.y=W.getY(this.y);let e=parseInt(this.img.width/this.img.height),t=this.img.height;this._c_pc_ani=this._c_pc_ani>=5*e-1?0:this._c_pc_ani+1,w.drawImage(this.img,t*parseInt(this._c_pc_ani/5),0,t,t,this.x,this.y,t,t)}}class Fs{constructor(){this.x=y.width*Math.random(),this.y=y.height*Math.random(),this.rgba="rgba("+parseInt(255*Math.random())+","+parseInt(255*Math.random())+","+parseInt(255*Math.random())+","+Math.random()+")",this.speed=5*Math.random(),this.move_flash_count=0,this._r=Math.random()+1}move(){this.x=this.x<0?y.width:this.x,this.x-=0===bs?0:this.speed,w.beginPath(),w.arc(this.x,this.y,this._r,0,2*Math.PI,!0),w.fillStyle=this.rgba,w.fill()}}const As=()=>{for(let e=0;e<G.length;e++)G[e].gotpc&&G.splice(e,1);for(let t=0;t<G.length;t++){let i=G[t];if(i.gotpc)continue;let _=P.getPlayerCenterPosition(),n=i.getPCCenterPosition();if(Math.sqrt(Math.pow(n._x-_._x,2)+Math.pow(n._y-_._y,2))<Math.sqrt(Math.pow(P.width,2)+Math.pow(P.height,2))/2)if(i.getPowerCapcell(),"red"!==i.type)if("blue"!==i.type);else{var e=z.concat();for(let t=0;t<e.length;t++){let s=e[t];ni.isEnemyCanvasOut(s)||(s.isStandBy()||s.isAbleCollision()&&(s._status-=1,s.isalive()||(M.set(s.getscore),s.showCollapes())))}e=B.concat();for(let t=0;t<e.length;t++){let s=e[t];ni.isEnemyCanvasOut(s)||s.init()}ni._setPlay(s.enemy_all_out)}else K.move(),ni._setPlay(s.pc),M.set(i.getscore)}},Ls=()=>{if(!P.isalive())return;for(let e=0;e<z.length;e++)z[e].isshow()||z[e].isalive()||z.splice(e,1);let e=z;if(D===I)for(let t=0;t<Y[D].length;t++){let s=Y[D][t],i=y.width;s.shots[0]._laser_MaxX;for(let t=0;t<e.length;t++){if(e[t].isIgnore())continue;if(e[t].isStandBy())continue;if(!e[t].isalive())continue;let _=e[t],n=s.enemy_collision(_);i=i>n?n:i}s.shots[0]._laser_MaxX=s.shots[0].x<i?i:s.shots[0]._laser_MaxX}else if(D!==I)for(let t=0;t<Y[D].length;t++){let s=Y[D][t];for(let t=0;t<e.length;t++){if(e[t].isIgnore())continue;if(e[t].isStandBy())continue;if(!e[t].isalive())continue;let i=e[t];s.enemy_collision(i)}}for(let t=0;t<e.length;t++){let s=e[t];if(!s.isIgnore()&&(!s.isStandBy()&&s.isalive()&&(P.enemy_collision(s),E.enemy_collision(s),q)))for(let e=0;e<U.length;e++){let t=U[e];if(t.player.isalive())for(let e=0;e<t.shots.length;e++){let i=t.shots[e];t.enemy_collision(s,i)}}}},Ys=()=>{if(P.isalive()){for(let e=0;e<B.length;e++)B[e].isshow()||B[e].isalive()||B.splice(e,1);for(let e=0;e<B.length;e++){let t=B[e];t._shot_alive&&(P.enemy_shot_collision(t),E.enemy_shot_collision(t))}}},Us=()=>{Ps.addKeydownGame(),Ps.addKeyupGame();const e=function(){o=window.requestAnimationFrame(e),w.clearRect(0,0,y.width,y.height);for(let e=0;e<70;e++)Z[e].move();for(let e=0;e<B.length;e++)B[e].move();W.move();for(let e=0;e<z.length;e++)void 0!==z[e]&&z[e].move();As(),Ys(),Ls(),W.isPlayersShotCollision(),Js();for(let e=0;e<G.length;e++)G[e].move();for(let e=0;e<5;e++)q&&U[e].move(),Y[D][e].move();for(let e=0;e<k;e++)C[e].move(10*(e+1));E.move(P),P.move(),W.map_draw(),K.show(),M.show(),W.isboss&&qs()};o=window.requestAnimationFrame(e)},qs=()=>{if(W.setBackGroundSpeedY(0),W.setInifinite(!1),!m)return""!==W.map_boss&&void 0!==W.map_boss&&void 0!==Is[W.map_boss]||Ws(),Vs(),B=[],(z=[]).push(Is[W.map_boss]._f()),m=!0,void ni._setPlayOnBG(s.bg_boss);let e="";for(let t=0;t<z.length;t++)e+=z[t].isalive()?"0":"1";-1===e.indexOf("0")&&(c>100?(Ws(),Qs()):c++)},zs=()=>{Ps.removeKeydownGame(),Ps.removeKeyupGame();const e=P;if(void 0===e)return;let t=null,i=e.getPlayerCenterPosition();ni._setPlay(s.vicviper_bomb);const _=function(){if(t=window.requestAnimationFrame(_),e._col_ani_c>=10*e.col_ani.length-1)return cancelAnimationFrame(t),void Zs();let s=parseInt(e._col_ani_c/10),n=e.col_ani[s].img.width,o=e.col_ani[s].img.height,a=n*e.col_ani[s].scale,r=o*e.col_ani[s].scale;w.drawImage(e.col_ani[s].img,i._x-a/2,i._y-r/2,a,r),e._col_ani_c++};t=window.requestAnimationFrame(_)},Bs=()=>{let e=new Date;const t=function(){if(r=window.requestAnimationFrame(t),!(new Date-e<50)){e=new Date;for(var s=0;s<Y[D].length;s++){let e=Y[D][s];if(e.player._isalive)if(D!==x){e._sq=e._sq===e.shots.length-1?0:e._sq+1;var i=e.shots[e._sq];i._shot_alive||(i._shot=!0,0===s&&ni._setPlay(i._audio))}else{if(e.shots[0]._shot_alive||e.shots[1]._shot_alive)continue;if(e.shots[0]._shot=!0,e.shots[1]._shot=!0,0!==s)continue;ni._setPlay(e.shots[0]._audio)}}if(q)for(s=0;s<U.length;s++){let e=U[s];if(e.player._isalive)if(3!==_){e._sq=e._sq===e.shots.length-1?0:e._sq+1;var n=e.shots[e._sq];n._shot_alive||(n._shot=!0,0===s&&ni._setPlay(n._audio))}else{if(e.shots[0]._shot_alive||e.shots[1]._shot_alive)continue;if(e.shots[0]._shot=!0,e.shots[1]._shot=!0,0!==s)continue;ni._setPlay(e.shots[0]._audio)}}}};r=window.requestAnimationFrame(t)},Hs=()=>{cancelAnimationFrame(o),o=null},Xs=()=>{cancelAnimationFrame(a),a=null},Gs=()=>{cancelAnimationFrame(r),r=null;for(var e=0;e<Y[D].length;e++){let t=Y[D][e];for(let e=0;e<t.shots.length;e++)t.shots[e]._shot=!1}for(e=0;e<U.length;e++){let t=U[e];for(let e=0;e<t.shots.length;e++)t.shots[e]._shot=!1}},Ks=()=>{Gs(),Ps.removeKeydownSelectPowermeter();let e=0,t=null;const s=function(){t=window.requestAnimationFrame(s),w.clearRect(0,0,y.width,y.height),K.pms_disp(),e%5==0&&K.pms_select(),e>40&&(_=K._c_pms,n=K._c_pmss,cancelAnimationFrame(t),ei()),e++};t=window.requestAnimationFrame(s)},Ns=()=>{if(Ps.removeKeydownGame(),Ps.removeKeyupGame(),i)return void Us();let e=0;const t=function(){if(a=window.requestAnimationFrame(t),e>250)return cancelAnimationFrame(a),a=null,ni._setPlayOnBG(s["bg_"+W.map_bgmusic]),void Us();w.clearRect(0,0,y.width,y.height);for(let e=0;e<70;e++)Z[e].move();if(K.show(),M.show(),parseInt(e/50)%2!=0);else{let e="start";ni._setDrawTextToFont(e,y.width/2-60*e.length/2,y.height/2-30-20,1)}e++};a=window.requestAnimationFrame(t),ni._setStopOnBG()},Ws=()=>{t.font.obj;let e="gameclear";ni._setDrawTextToFont(e,y.width/2-60*e.length/2,y.height/2-30-40,1),e="press r to restart",ni._setDrawTextToFont(e,y.width/2-18*e.length/2,y.height/2+30,.3),e="press s to change to another stage",ni._setDrawTextToFont(e,y.width/2-18*e.length/2,y.height/2+60,.3),b=!0},Zs=()=>{Ps.removeKeydownGame(),Ps.removeKeyupGame(),Gs(),Ps.addKeydownGameover(),w.clearRect(0,0,y.width,y.height);for(let e=0;e<70;e++)Z[e].move();M.show();t.font.obj;let e="gameover";ni._setDrawTextToFont(e,y.width/2-60*e.length/2,y.height/2-30-40,1),e="press r to restart",ni._setDrawTextToFont(e,y.width/2-18*e.length/2,y.height/2+30,.3),e="press s to change to another stage",ni._setDrawTextToFont(e,y.width/2-18*e.length/2,y.height/2+60,.3)},Js=()=>{for(let e=0;e<H.length;e++)H[e].isalive()||H.splice(e,1);for(let e=0;e<H.length;e++)H[e].move()},Vs=()=>{W.set_scroll_off_x()},Qs=()=>{W.set_scroll_on_x()},$s=()=>{Ps.removeKeydownGame(),Ps.removeKeyupGame(),Ps.removeKeydownGameover(),clearInterval(r),r=null,Hs(),w.clearRect(0,0,y.width,y.height),P="",E="",T=!1,C=[],S=0,Y={_SHOTTYPE_NORMAL:[],_SHOTTYPE_DOUBLE:[],_SHOTTYPE_LASER:[]},U=[],q=!1,O=[],F=[],z=[],B=[],H=[],K="",D=v,G=[],fs=0,vs=0,m=!1,c=0},ei=()=>{Ps.removeKeydownSelectPowermeter(),P=0===_||2===_?new Zt:new Jt,Y._SHOTTYPE_NORMAL.push(new as(P)),Y._SHOTTYPE_DOUBLE.push(function(e){return 0===_||2===_?new rs(e):new ls(e)}(P)),Y._SHOTTYPE_LASER.push(function(e){return 0===_?new cs(e):1===_?new gs(e):2===_?new hs(e):3===_?new ms(e):void 0}(P)),U.push(function(e){return 0===_?new is(e):1===_?new ns(e):2===_?new _s(e):3===_?new os(e):void 0}(P)),E=0===_||2===_?1===n?new Qt:new es:1===n?new $t:new ts;for(let e=0;e<k;e++)C.push(new Vt("option",110,70*(e+1),!1)),Y._SHOTTYPE_NORMAL.push(new as(C[e])),Y._SHOTTYPE_DOUBLE.push(function(e){return 0===_||2===_?new rs(e):new ls(e)}(C[e])),Y._SHOTTYPE_LASER.push(function(e){return 0===_?new cs(e):1===_?new gs(e):2===_?new hs(e):3===_?new ms(e):void 0}(C[e])),U.push(function(e){return 0===_?new is(e):1===_?new ns(e):2===_?new _s(e):3===_?new os(e):void 0}(C[e]));K=new ks,b||M.init(),b=!1;for(let e=0;e<70;e++)Z[e]=new Fs;W.set_gamestart(),Ns()},ti=()=>{clearInterval(r),r=null,w.clearRect(0,0,y.width,y.height),Ps.removeKeydownSelectStage(),Ps.addKeydownSelectPowermeter(),(K=new ks).pms_disp(),K.pms_select()},si=()=>{clearInterval(r),r=null,w.clearRect(0,0,y.width,y.height);let e=document.querySelector("#game_start_wrapper"),t=document.querySelector("#game_wrapper");e.classList.remove("on"),t.classList.add("on"),Ps.removeKeydownStart(),Ps.removeKeydownGame(),Ps.removeKeyupGame(),Ps.removeKeydownGameover(),Ps.addKeydownSelectStage(),W.init(function(){(N=new Rs).init()}),ni._setPlayOnBG(s.bg_powermeterselect)},ii=(e,s)=>{let i=0,_=document.querySelector("#game_start_loading .rate");for(let s in e){let n=new XMLHttpRequest;n.open("GET",e[s].src,!0),n.responseType="arraybuffer",n.onload=function(){ie.decodeAudioData(n.response,function(n){e[s].buf=n,++i>=Object.keys(e).length&&_i(t,ni._init),_.innerHTML=parseInt(i/Object.keys(e).length*100)+"%"},function(e){alert("一部音声読み込みに失敗しました。再度立ち上げなおしてください:"+e)})},n.send()}},_i=(e,t)=>{let s=0,i=!1;for(let _ in e){let n=e[_];n.obj.src=e[_].src,n.obj.onload=function(){n.obj.width*=n.rate,n.obj.height*=n.rate,++s>=Object.keys(e).length&&t();let i=parseInt(s/Object.keys(e).length*100);ni._setTextToFont(document.querySelector("#game_start>.text_loading"),"now loading "+i+" per",30)},n.obj.onabort=function(){},n.obj.onerror=function(){i||(i=!0,alert("一部画像読み込みに失敗しました。再度立ち上げなおしてください"))}}},ni={_url_params:new Array,_init(){M=new Ts,(W=new Ds).init(ni._showGameStart)},_txt:{0:"0",1:"60",2:"120",3:"180",4:"240",5:"300",6:"360",7:"420",8:"480",9:"540",a:"600",b:"660",c:"720",d:"780",e:"840",f:"900",g:"960",h:"1020",i:"1080",j:"1140",k:"1200",l:"1260",m:"1320",n:"1380",o:"1440",p:"1500",q:"1560",r:"1620",s:"1680",t:"1740",u:"1800",v:"1860",w:"1920",x:"1980",y:"2040",z:"2100",":":"2160"},_audio_buffer_loader:null,_audio_now_obj_bg:null,_audio_context_source_bg:null,_is_audio_context_source_bg:!1,_ac:{_get:function(e,t,s){return e>=t.length*s-1?0:e+1}},getRad(e,t){if(void 0!==e&&void 0!==t)return Math.atan2(e.y-t.y,e.x-t.x)},getDeg(e,t){if(void 0===e||void 0===t)return;return Math.atan2(e.y-t.y,e.x-t.x)/Math.PI*180},getRadToDeg:e=>void 0===e||""===e?null:e/Math.PI*180,getBit:(e,t)=>("0".repeat(t)+e).slice(-1*t),getOrBit(e,t,s){let i=(parseInt(e,2)|parseInt(t,2)).toString(2);return this.getBit(i,s)},setUrlParams(){for(var e=location.search.slice(1).split(/(&|&amp;)/),t=0;t<e.length;t++){var s=e[t].replace("amp;","").split("=");""!==s[0]&&void 0!==s[0]&&("&"!==s[0]&&(this._url_params[s[0]]=s[1]))}},isShotCanvasOut:e=>e.x<-W.t||e.x>y.width+W.t||e.y<-W.t||e.y>y.height+W.t,isEnemyCanvasOut(e,t){let s=e.getEnemyCenterPosition(),i=t||{up:!0,down:!0,left:!0,right:!0},_=e.width,n=e.height;return s._x<0-_&&!0===i.left||s._x>y.width+_&&!0===i.right||s._y<0-n&&!0===i.up||s._y>y.height+n&&!0===i.down},isSqCollision(e,t,s,i,_){return this.isSqCollision_laser(e,t,s,i,_).ret},isSqCollision_laser(e,t,s,i,_){let n=parseInt(void 0===t?0:t.split(",")[0]),o=parseInt(void 0===t?0:t.split(",")[1]),a=parseInt(void 0===i?0:i.split(",")[0]),r=parseInt(void 0===i?0:i.split(",")[1]),l=e.split(","),h=parseInt(l[2])-parseInt(l[0]),m=parseInt(l[3])-parseInt(l[1]),c=(Math.sqrt(Math.pow(h,2)+Math.pow(m,2)),h/2+n+parseInt(l[0])),g=m/2+o+parseInt(l[1]);_&&console.log(c+":"+g);for(let e=0;e<s.length;e++){let t=s[e].split(","),i=parseInt(t[2])-parseInt(t[0]),_=parseInt(t[3])-parseInt(t[1]),n=void 0===t[4],o=(Math.sqrt(Math.pow(i,2)+Math.pow(_,2)),i/2+a+parseInt(t[0])),l=_/2+r+parseInt(t[1]),d=Math.abs(o-c),p=Math.abs(l-g),u=(Math.sqrt(Math.pow(d,2)+Math.pow(p,2)),a+parseInt(t[0]));if(h/2+i/2>d&&m/2+_/2>p)return n?{ret:ee,val:u+10}:{ret:te,val:u+10}}return{ret:se,val:y.width}},_showGameStart(){if(document.querySelector("#game_start_loading").classList.remove("on"),g){document.querySelector("#sp_controller").classList.add("on"),Ss._set_obj()}if(i){return document.querySelector("#game_wrapper").classList.add("on"),(N=new Rs).init(),W.set_stage_map_pattern(ws),void _i(e,ti)}Ps.addKeydownStart(),document.querySelector("#game_start_wrapper").classList.add("on"),ni._setTextToFont(document.querySelector("#game_start>.title"),"no pakuri",50),ni._setTextToFont(document.querySelector("#game_start>.text"),"press s to start",30),ni._setTextToFont(document.querySelector("#game_start>.text_loading"),"now loading",30)},_setDrawTextToFont(e,s,i,_){let n=this;const o=t.font.obj,a=o.height;_=_||1;for(let t=0;t<e.length;t++)" "!==e[t]&&ni._setDrawImage({img:o,x:s+a*_*t,y:i,imgPosx:parseInt(n._txt[e[t]]),width:a,height:a,scale:_,basePoint:1})},_setTextToFont(e,t,s){if(null==e)return;let i=this;s=s||30;let _="";for(let e=0;e<t.length;e++){if(" "===t[e]){_+='<img src="./images/gradius_spacer.png" width="'+s+'">';continue}_+='<div style="background:url(./images/gradius_font.png) no-repeat;width:'+s+"px;height:"+s+"px;background-position:"+parseInt(i._txt[t[e]])*(s/60)*-1+'px 0px;background-size:cover;display:inline-block;"></div>'}e.innerHTML=_},_getPlayerMoveDrawX:e=>void 0===O[e]?null:O[e],_getPlayerMoveDrawY:e=>void 0===F[e]?null:F[e],_setPlayerMoveDraw(){let e=P.width,t=P.height,s=P.x+parseInt(e/4),i=P.y+parseInt(t/4),_=-1*W.getBackGroundSpeedY(),n=F;if(100===O.length&&O.pop(),100===F.length&&F.pop(),O.unshift(s),W.map_infinite)if(0!==_)for(let e=0;e<100;e++)void 0!==n[e]?_>0?n[e]=n[e]>=i+_*e?i+_*e:n[e]+_:_<0&&(n[e]=n[e]<=i+_*e?i+_*e:n[e]+_):n.push(i+_*e);else n.unshift(i);else n.unshift(i)},_setPlay(e){if(null!=e){var t=ie.createBufferSource();t.buffer=e.buf,t.loop=!1,t.connect(ie.destination),t.start(0)}},_setPlayOnBG(e){if(null==e)return;!0===this._is_audio_context_source_bg&&(this._audio_context_source_bg.stop(),this._is_audio_context_source_bg=!1);let t=ie.createBufferSource();t.buffer=e.buf,this._audio_now_obj_bg=e,t.loop=!0,t.loopStart=0,t.connect(ie.destination),t.start(0),this._audio_context_source_bg=t,this._is_audio_context_source_bg=!0},_setStopOnBG(){this._is_audio_context_source_bg&&(this._audio_context_source_bg.stop(),this._is_audio_context_source_bg=!1)},_setDrawImage(e){if(void 0===e||void 0===e.img||0===e.scale)return;let t=e.width||e.img.width,s=e.height||e.img.height,i=e.deg||0,_=e.imgPosx||0,n=e.imgPosy||0,o=e.scale||1,a=e.x||0,r=e.y||0,l=e.basePoint||5,h=e.alpha||1;if(1===e.basePoint&&void 0===e.imgPosx&&void 0===e.alpha&&void 0===e.scale&&void 0===e.deg)return void w.drawImage(e.img,e.x,e.y,t,s);const m=[{x:0,y:0},{x:0,y:0},{x:-t/2,y:0},{x:-t,y:0},{x:0,y:-s/2},{x:-t/2,y:-s/2},{x:-t,y:-s/2},{x:0,y:-s},{x:-t/2,y:-s},{x:-t,y:-s}];w.save(),w.globalAlpha=h,w.translate(a,r),w.rotate(i*Math.PI/180),w.scale(o,o),w.drawImage(e.img,_,n,t,s,m[l].x,m[l].y,t,s),w.restore()},_multilineText(e,t,s){let i=t.length,_=[],n="";if(i<1)return _;for(let o=0;o<i;o++){let i=t.charAt(o);"\n"!==i?e.measureText(n+i).width<=s?n+=i:(_.push(n),n=i):(_.push(n),n="")}return n.length>0&&_.push(n),_}};window.addEventListener("load",function(){y=document.getElementById("game"),w=y.getContext("2d"),ni.setUrlParams(),i="true"===ni._url_params.debug,ws=ni._url_params.mp||0,X=ni._url_params.ed||0,g&&document.querySelector("body").classList.add("sp"),ii(s)}),window.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1});