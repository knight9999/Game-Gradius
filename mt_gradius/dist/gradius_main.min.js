"use strict";const _CANVAS_IMGS={vicviper1:{src:"images/gradius_vicviper1.png",rate:.26,obj:new Image},vicviper2:{src:"images/gradius_vicviper2.png",rate:.26,obj:new Image},vicviper3:{src:"images/gradius_vicviper3.png",rate:.26,obj:new Image},vicviper4:{src:"images/gradius_vicviper4.png",rate:.26,obj:new Image},vicviper5:{src:"images/gradius_vicviper5.png",rate:.26,obj:new Image},vicviper1_e:{src:"images/gradius_vicviper1_e.png",rate:.26,obj:new Image},vicviper2_e:{src:"images/gradius_vicviper2_e.png",rate:.26,obj:new Image},vicviper3_e:{src:"images/gradius_vicviper3_e.png",rate:.26,obj:new Image},vicviper4_e:{src:"images/gradius_vicviper4_e.png",rate:.26,obj:new Image},vicviper5_e:{src:"images/gradius_vicviper5_e.png",rate:.26,obj:new Image},vicviper_back1:{src:"images/gradius_vicviper_back1.png",rate:.26,obj:new Image},vicviper_back2:{src:"images/gradius_vicviper_back2.png",rate:.26,obj:new Image},vicviper_back3:{src:"images/gradius_vicviper_back3.png",rate:.26,obj:new Image},vicviper_back1_e:{src:"images/gradius_vicviper_back1_e.png",rate:.26,obj:new Image},vicviper_bomb:{src:"images/gradius_vicviper_bomb.png",rate:1,obj:new Image},vicviper_bomb_red:{src:"images/gradius_vicviper_bomb_red.png",rate:1,obj:new Image},option:{src:"images/option.png",rate:.3,obj:new Image},missile1:{src:"images/missile1.png",rate:.48,obj:new Image},missile2:{src:"images/missile2.png",rate:.48,obj:new Image},missile3:{src:"images/missile3.png",rate:.48,obj:new Image},missile4:{src:"images/missile4.png",rate:.48,obj:new Image},missile5:{src:"images/missile5.png",rate:.48,obj:new Image},missile6:{src:"images/missile6.png",rate:.48,obj:new Image},missile7:{src:"images/missile7.png",rate:.48,obj:new Image},missile8:{src:"images/missile8.png",rate:.48,obj:new Image},shot1:{src:"images/gradius_shot1.png",rate:.4,obj:new Image},shot2:{src:"images/gradius_shot2.png",rate:.4,obj:new Image},shot3:{src:"images/gradius_shot3.png",rate:.3,obj:new Image},meter:{src:"images/gradius_meter.png",rate:.5,obj:new Image},meter_c_speedup:{src:"images/gradius_meter_c_speedup.png",rate:.5,obj:new Image},meter_c_missile:{src:"images/gradius_meter_c_missile.png",rate:.5,obj:new Image},meter_c_double:{src:"images/gradius_meter_c_double.png",rate:.5,obj:new Image},meter_c_laser:{src:"images/gradius_meter_c_laser.png",rate:.5,obj:new Image},meter_c_option:{src:"images/gradius_meter_c_option.png",rate:.5,obj:new Image},meter_c_shield:{src:"images/gradius_meter_c_shield.png",rate:.5,obj:new Image},meter_blank:{src:"images/gradius_meter_blank.png",rate:.5,obj:new Image},meter_c_blank:{src:"images/gradius_meter_c_blank.png",rate:.5,obj:new Image},forcefield1:{src:"images/gradius_forcefield1.png",rate:1,obj:new Image},forcefield2:{src:"images/gradius_forcefield2.png",rate:1,obj:new Image},forcefield_red1:{src:"images/gradius_forcefield_red1.png",rate:1,obj:new Image},forcefield_red2:{src:"images/gradius_forcefield_red2.png",rate:1,obj:new Image},shield1:{src:"images/gradius_shield1.png",rate:.4,obj:new Image},shield2:{src:"images/gradius_shield2.png",rate:.4,obj:new Image},shield_red1:{src:"images/gradius_shield_red1.png",rate:.4,obj:new Image},shield_red2:{src:"images/gradius_shield_red2.png",rate:.4,obj:new Image},enemy_a_1:{src:"images/gradius_enemy_a_1.png",rate:.52,obj:new Image},enemy_a_2:{src:"images/gradius_enemy_a_2.png",rate:.52,obj:new Image},enemy_a_3:{src:"images/gradius_enemy_a_3.png",rate:.52,obj:new Image},enemy_a_4:{src:"images/gradius_enemy_a_4.png",rate:.52,obj:new Image},enemy_a_5:{src:"images/gradius_enemy_a_5.png",rate:.52,obj:new Image},enemy_a_6:{src:"images/gradius_enemy_a_6.png",rate:.52,obj:new Image},enemy_a_7:{src:"images/gradius_enemy_a_7.png",rate:.52,obj:new Image},enemy_a_8:{src:"images/gradius_enemy_a_8.png",rate:.52,obj:new Image},enemy_b_1:{src:"images/gradius_enemy_b_1.png",rate:.52,obj:new Image},enemy_b_2:{src:"images/gradius_enemy_b_2.png",rate:.52,obj:new Image},enemy_b_3:{src:"images/gradius_enemy_b_3.png",rate:.52,obj:new Image},enemy_b_4:{src:"images/gradius_enemy_b_4.png",rate:.52,obj:new Image},enemy_b_5:{src:"images/gradius_enemy_b_5.png",rate:.52,obj:new Image},enemy_b_6:{src:"images/gradius_enemy_b_6.png",rate:.52,obj:new Image},enemy_b_7:{src:"images/gradius_enemy_b_7.png",rate:.52,obj:new Image},enemy_b_8:{src:"images/gradius_enemy_b_8.png",rate:.52,obj:new Image},enemy_c_1:{src:"images/gradius_enemy_c_1.png",rate:.4,obj:new Image},enemy_c_2:{src:"images/gradius_enemy_c_2.png",rate:.4,obj:new Image},enemy_c_3:{src:"images/gradius_enemy_c_3.png",rate:.4,obj:new Image},enemy_c_4:{src:"images/gradius_enemy_c_4.png",rate:.4,obj:new Image},enemy_c_5:{src:"images/gradius_enemy_c_5.png",rate:.4,obj:new Image},enemy_c_6:{src:"images/gradius_enemy_c_6.png",rate:.4,obj:new Image},enemy_c_7:{src:"images/gradius_enemy_c_7.png",rate:.4,obj:new Image},enemy_c_8:{src:"images/gradius_enemy_c_8.png",rate:.4,obj:new Image},enemy_c_11:{src:"images/gradius_enemy_c_11.png",rate:.4,obj:new Image},enemy_c_12:{src:"images/gradius_enemy_c_12.png",rate:.4,obj:new Image},enemy_c_13:{src:"images/gradius_enemy_c_13.png",rate:.4,obj:new Image},enemy_c_14:{src:"images/gradius_enemy_c_14.png",rate:.4,obj:new Image},enemy_c_15:{src:"images/gradius_enemy_c_15.png",rate:.4,obj:new Image},enemy_c_16:{src:"images/gradius_enemy_c_16.png",rate:.4,obj:new Image},enemy_c_17:{src:"images/gradius_enemy_c_17.png",rate:.4,obj:new Image},enemy_c_18:{src:"images/gradius_enemy_c_18.png",rate:.4,obj:new Image},enemy_d_1:{src:"images/gradius_enemy_d_1.png",rate:.2,obj:new Image},enemy_d_2:{src:"images/gradius_enemy_d_2.png",rate:.2,obj:new Image},enemy_d_3:{src:"images/gradius_enemy_d_3.png",rate:.2,obj:new Image},enemy_d_4:{src:"images/gradius_enemy_d_4.png",rate:.2,obj:new Image},enemy_e_1:{src:"images/gradius_enemy_e_1.png",rate:.2,obj:new Image},enemy_e_2:{src:"images/gradius_enemy_e_2.png",rate:.2,obj:new Image},enemy_e_3:{src:"images/gradius_enemy_e_3.png",rate:.2,obj:new Image},enemy_e_4:{src:"images/gradius_enemy_e_4.png",rate:.2,obj:new Image},enemy_f_1:{src:"images/gradius_enemy_f_1.png",rate:.4,obj:new Image},enemy_f_2:{src:"images/gradius_enemy_f_2.png",rate:.4,obj:new Image},enemy_f_3:{src:"images/gradius_enemy_f_3.png",rate:.4,obj:new Image},enemy_f_4:{src:"images/gradius_enemy_f_4.png",rate:.4,obj:new Image},enemy_f_5:{src:"images/gradius_enemy_f_5.png",rate:.4,obj:new Image},enemy_f_6:{src:"images/gradius_enemy_f_6.png",rate:.4,obj:new Image},enemy_f_7:{src:"images/gradius_enemy_f_7.png",rate:.4,obj:new Image},enemy_f_8:{src:"images/gradius_enemy_f_8.png",rate:.4,obj:new Image},enemy_g_1:{src:"images/gradius_enemy_g_1.png",rate:.4,obj:new Image},enemy_g_2:{src:"images/gradius_enemy_g_2.png",rate:.4,obj:new Image},enemy_g_3:{src:"images/gradius_enemy_g_3.png",rate:.4,obj:new Image},enemy_g_4:{src:"images/gradius_enemy_g_4.png",rate:.4,obj:new Image},enemy_g_5:{src:"images/gradius_enemy_g_5.png",rate:.4,obj:new Image},enemy_g_6:{src:"images/gradius_enemy_g_6.png",rate:.4,obj:new Image},enemy_g_7:{src:"images/gradius_enemy_g_7.png",rate:.4,obj:new Image},enemy_g_8:{src:"images/gradius_enemy_g_8.png",rate:.4,obj:new Image},enemy_o_1:{src:"images/gradius_enemy_o_1.png",rate:.3,obj:new Image},enemy_o_2:{src:"images/gradius_enemy_o_2.png",rate:.3,obj:new Image},enemy_p_1:{src:"images/gradius_enemy_p_1.png",rate:.26,obj:new Image},enemy_p_2:{src:"images/gradius_enemy_p_2.png",rate:.3,obj:new Image},enemy_p_3:{src:"images/gradius_enemy_p_3.png",rate:.3,obj:new Image},enemy_p_4:{src:"images/gradius_enemy_p_4.png",rate:.3,obj:new Image},enemy_p_5:{src:"images/gradius_enemy_p_5.png",rate:.3,obj:new Image},enemy_z:{src:"images/gradius_enemy_z_core.png",rate:.6,obj:new Image},enemy_z_1:{src:"images/gradius_enemy_z_core_1.png",rate:.6,obj:new Image},enemy_z_2:{src:"images/gradius_enemy_z_core_2.png",rate:.6,obj:new Image},enemy_z_3:{src:"images/gradius_enemy_z_core_3.png",rate:.6,obj:new Image},enemy_z_4_1:{src:"images/gradius_enemy_z_core_4_1.png",rate:.6,obj:new Image},enemy_z_4_2:{src:"images/gradius_enemy_z_core_4_2.png",rate:.6,obj:new Image},enemy_z_4_3:{src:"images/gradius_enemy_z_core_4_3.png",rate:.6,obj:new Image},enemy_z_4_4:{src:"images/gradius_enemy_z_core_4_4.png",rate:.6,obj:new Image},enemy_z_4_5:{src:"images/gradius_enemy_z_core_4_5.png",rate:.6,obj:new Image},enemy_collapes1:{src:"images/gradius_enemy_collapes1.png",rate:1,obj:new Image},enemy_collapes2:{src:"images/gradius_enemy_collapes2.png",rate:1,obj:new Image},enemy_collapes11:{src:"images/gradius_enemy_collapes11.png",rate:.2,obj:new Image},enemy_collapes12:{src:"images/gradius_enemy_collapes12.png",rate:.2,obj:new Image},enemy_collapes13:{src:"images/gradius_enemy_collapes13.png",rate:.2,obj:new Image},enemy_collapes91:{src:"images/gradius_enemy_collapes91.png",rate:.2,obj:new Image},enemy_collapes92:{src:"images/gradius_enemy_collapes92.png",rate:.2,obj:new Image},enemy_collapes93:{src:"images/gradius_enemy_collapes93.png",rate:.2,obj:new Image},enemy_collapes94:{src:"images/gradius_enemy_collapes94.png",rate:.2,obj:new Image},enemy_collapes95:{src:"images/gradius_enemy_collapes95.png",rate:.2,obj:new Image},enemy_collapes96:{src:"images/gradius_enemy_collapes96.png",rate:.2,obj:new Image},enemy_bullet1:{src:"images/gradius_enemy_bullet1.png",rate:.8,obj:new Image},enemy_bullet2:{src:"images/gradius_enemy_bullet2.png",rate:.8,obj:new Image},enemy_bullet_z:{src:"images/gradius_enemy_bullet_z.png",rate:.2,obj:new Image},pc1:{src:"images/gradius_pc1.png",rate:.5,obj:new Image},pc2:{src:"images/gradius_pc2.png",rate:.5,obj:new Image},pc3:{src:"images/gradius_pc3.png",rate:.5,obj:new Image},pc4:{src:"images/gradius_pc4.png",rate:.5,obj:new Image},pc5:{src:"images/gradius_pc5.png",rate:.5,obj:new Image},map_c_A:{src:"images/gradius_map_c_A.png",rate:1,obj:new Image},map_f_A:{src:"images/gradius_map_f_A.png",rate:1,obj:new Image},map_f_B:{src:"images/gradius_map_f_B.png",rate:1,obj:new Image},map_f_C:{src:"images/gradius_map_f_C.png",rate:1,obj:new Image},map_f_D:{src:"images/gradius_map_f_D.png",rate:1,obj:new Image},map_f_E:{src:"images/gradius_map_f_E.png",rate:1,obj:new Image},map_f_F:{src:"images/gradius_map_f_F.png",rate:1,obj:new Image},map_f_G:{src:"images/gradius_map_f_G.png",rate:1,obj:new Image},map_f_H:{src:"images/gradius_map_f_H.png",rate:1,obj:new Image},map_f_I:{src:"images/gradius_map_f_I.png",rate:1,obj:new Image},map_f_J:{src:"images/gradius_map_f_J.png",rate:1,obj:new Image},map_f_K:{src:"images/gradius_map_f_K.png",rate:1,obj:new Image},map_f_L:{src:"images/gradius_map_f_L.png",rate:1,obj:new Image},map_f_M:{src:"images/gradius_map_f_M.png",rate:1,obj:new Image},map_f_N:{src:"images/gradius_map_f_N.png",rate:1,obj:new Image},map_f_O:{src:"images/gradius_map_f_O.png",rate:1,obj:new Image},map_f_P:{src:"images/gradius_map_f_P.png",rate:1,obj:new Image}},_CANVAS_IMGS_INIT={font_0:{src:"images/gradius_font_0.png",rate:1,obj:new Image},font_1:{src:"images/gradius_font_1.png",rate:1,obj:new Image},font_2:{src:"images/gradius_font_2.png",rate:1,obj:new Image},font_3:{src:"images/gradius_font_3.png",rate:1,obj:new Image},font_4:{src:"images/gradius_font_4.png",rate:1,obj:new Image},font_5:{src:"images/gradius_font_5.png",rate:1,obj:new Image},font_6:{src:"images/gradius_font_6.png",rate:1,obj:new Image},font_7:{src:"images/gradius_font_7.png",rate:1,obj:new Image},font_8:{src:"images/gradius_font_8.png",rate:1,obj:new Image},font_9:{src:"images/gradius_font_9.png",rate:1,obj:new Image},font_a:{src:"images/gradius_font_a.png",rate:1,obj:new Image},font_b:{src:"images/gradius_font_b.png",rate:1,obj:new Image},font_c:{src:"images/gradius_font_c.png",rate:1,obj:new Image},font_d:{src:"images/gradius_font_d.png",rate:1,obj:new Image},font_e:{src:"images/gradius_font_e.png",rate:1,obj:new Image},font_f:{src:"images/gradius_font_f.png",rate:1,obj:new Image},font_g:{src:"images/gradius_font_g.png",rate:1,obj:new Image},font_h:{src:"images/gradius_font_h.png",rate:1,obj:new Image},font_i:{src:"images/gradius_font_i.png",rate:1,obj:new Image},font_j:{src:"images/gradius_font_j.png",rate:1,obj:new Image},font_k:{src:"images/gradius_font_k.png",rate:1,obj:new Image},font_l:{src:"images/gradius_font_l.png",rate:1,obj:new Image},font_m:{src:"images/gradius_font_m.png",rate:1,obj:new Image},font_n:{src:"images/gradius_font_n.png",rate:1,obj:new Image},font_o:{src:"images/gradius_font_o.png",rate:1,obj:new Image},font_p:{src:"images/gradius_font_p.png",rate:1,obj:new Image},font_q:{src:"images/gradius_font_q.png",rate:1,obj:new Image},font_r:{src:"images/gradius_font_r.png",rate:1,obj:new Image},font_s:{src:"images/gradius_font_s.png",rate:1,obj:new Image},font_t:{src:"images/gradius_font_t.png",rate:1,obj:new Image},font_u:{src:"images/gradius_font_u.png",rate:1,obj:new Image},font_v:{src:"images/gradius_font_v.png",rate:1,obj:new Image},font_w:{src:"images/gradius_font_w.png",rate:1,obj:new Image},font_x:{src:"images/gradius_font_x.png",rate:1,obj:new Image},font_y:{src:"images/gradius_font_y.png",rate:1,obj:new Image},font_z:{src:"images/gradius_font_z.png",rate:1,obj:new Image},"font_:":{src:"images/gradius_font_27.png",rate:1,obj:new Image},gradius_powermeterselect:{src:"images/gradius_powermeterselect.png",rate:.28,obj:new Image},gradius_powermeterselect_shield:{src:"images/gradius_powermeterselect_shield.png",rate:.28,obj:new Image},gradius_powermeterselect_shield_:{src:"images/gradius_powermeterselect_shield_.png",rate:.28,obj:new Image},gradius_powermeterselect_0:{src:"images/gradius_powermeterselect_0.png",rate:.28,obj:new Image},gradius_powermeterselect_1:{src:"images/gradius_powermeterselect_1.png",rate:.28,obj:new Image},gradius_powermeterselect_2:{src:"images/gradius_powermeterselect_2.png",rate:.28,obj:new Image},gradius_powermeterselect_3:{src:"images/gradius_powermeterselect_3.png",rate:.28,obj:new Image},gradius_powermeterselect_shield_0:{src:"images/gradius_powermeterselect_shield_0.png",rate:.28,obj:new Image},gradius_powermeterselect_shield_1:{src:"images/gradius_powermeterselect_shield_1.png",rate:.28,obj:new Image}},_DEF_DIFFICULT=[{_ENEMY_SHOT_RATE:1e-4,_ENEMY_SHOT_SPEED:1,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:5e-4,_ENEMY_SHOT_SPEED:2,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.001,_ENEMY_SHOT_SPEED:2,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.004,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.1,_ENEMY_SHOT_SPEED:4,_ENEMY_SPEED:2}];let _ENEMY_DIFFICULT=2;class GameObject_ENEMY{constructor(e,_,t){this.id=_ENEMIES.length,this.bid=_ENEMIES_BOUNDS.length,this.gid=0,this.img=e,this.x=_||0,this.y=t||0,this.isshot=!1,this.speed=1,this.getscore=200,this._status=2,this._isshow=!0,this.direct="up",this.haspc=!1,this.showedpc=!1,this._col_ani_c=0,this.col_ani=[{img:_CANVAS_IMGS.enemy_collapes1.obj,scale:.3},{img:_CANVAS_IMGS.enemy_collapes2.obj,scale:.3},{img:_CANVAS_IMGS.enemy_collapes2.obj,scale:.3},{img:_CANVAS_IMGS.enemy_collapes2.obj,scale:.2},{img:_CANVAS_IMGS.enemy_collapes2.obj,scale:.2}],this._col_ani2_c=0,this.col_ani2=[{img:_CANVAS_IMGS.enemy_collapes12.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes13.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes13.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes12.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes11.obj,scale:1}],this._col_ani2_c=0,this.col_ani2=[{img:_CANVAS_IMGS.enemy_collapes12.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes13.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes13.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes12.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes11.obj,scale:1}],this._col_ani9_c=0,this.col_ani9=[{img:_CANVAS_IMGS.enemy_collapes91.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes92.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes93.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes94.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes95.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes96.obj,scale:1}],this._col_pc_c=0,this.col_pc=[{img:_CANVAS_IMGS.pc1.obj,scale:.6},{img:_CANVAS_IMGS.pc2.obj,scale:.6},{img:_CANVAS_IMGS.pc3.obj,scale:.5},{img:_CANVAS_IMGS.pc4.obj,scale:.3},{img:_CANVAS_IMGS.pc5.obj,scale:.1}],this.col_type=this.col_ani}init(){_ENEMIES=new Array}ani_col(){let e=this;if(e.x-=_BACKGROUND_SPEED,e._col_ani_c>=5*e.col_type.length-1)return;let _=parseInt(e._col_ani_c/5),t=e.col_type[_];_CONTEXT.drawImage(t.img,e.x,e.y,t.img.width*t.scale,t.img.height*t.scale),e._col_ani_c++}collision(){this._status-=1,this.isalive()||_SCORE.set(this.getscore)}getEnemyCenterPosition(){return{_x:this.x+this.img.width/2,_y:this.y+this.img.height/2}}getstatus(){return this._status}isalive(){return this._status>0}isshow(){return this._isshow}shot(){_GAME.isEnemyCanvasOut(this)||Math.random()>=_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SHOT_RATE||_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(this.getEnemyCenterPosition()._x,this.getEnemyCenterPosition()._y))}move_bounds(e){let _=this,t=_ENEMIES_BOUNDS;if(_.isalive()&&!(_.x>_CANVAS.width))for(let e=0;e<t.length;e++)t[e].isalive()&&(t[e].x>_CANVAS.width||_.bid!==t[e].bid&&Math.sqrt(Math.pow(_.getEnemyCenterPosition()._x-t[e].getEnemyCenterPosition()._x,2)+Math.pow(_.getEnemyCenterPosition()._y-t[e].getEnemyCenterPosition()._y,2))<_.img.width/2&&(_.speedx=Math.random()*(Math.random()>.05)?1:-1,_.speedy=Math.random()*(Math.random()>.5)?1:-1,t[e].speedx=Math.random()*(Math.random()>.05)?1:-1,t[e].speedy=Math.random()*(Math.random()>.5)?1:-1))}showCollapes(){let e=this;if(e.haspc&&!e.showedpc)return _POWERCAPSELLS.push(new GameObject_POWERCAPSELL(e.x,e.y)),void(e.showedpc=!0);e.ani_col()}move(){this.x+this.img.width<0?this.init():_this._status<=0?_this.showCollapes():(this.x-=_BACKGROUND_SPEED,_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height),this.shot())}}class ENEMY_a extends GameObject_ENEMY{constructor(e,_,t){super(_CANVAS_IMGS.enemy_a_1.obj,e,_),this._status=1,this.direct=t;let s=this;this.defimg={up:function(){return _PLAYERS_MAIN.x<s.x?Math.abs(_PLAYERS_MAIN.y-s.y)>100?_CANVAS_IMGS.enemy_a_5.obj:_CANVAS_IMGS.enemy_a_6.obj:Math.abs(_PLAYERS_MAIN.y-s.y)>100?_CANVAS_IMGS.enemy_a_7.obj:_CANVAS_IMGS.enemy_a_8.obj},down:function(){return _PLAYERS_MAIN.x<s.x?Math.abs(_PLAYERS_MAIN.y-s.y)>100?_CANVAS_IMGS.enemy_a_1.obj:_CANVAS_IMGS.enemy_a_2.obj:Math.abs(_PLAYERS_MAIN.y-s.y)>100?_CANVAS_IMGS.enemy_a_3.obj:_CANVAS_IMGS.enemy_a_4.obj}}}move(){let e=this;e.x+e.img.width<0?e._status=0:e._status<=0?e.showCollapes():(e.x-=_BACKGROUND_SPEED,e.img=e.defimg[this.direct](),_CONTEXT.drawImage(e.img,e.x,e.y,e.img.width,e.img.height),e.shot())}}class ENEMY_b extends GameObject_ENEMY{constructor(e,_,t){super(_CANVAS_IMGS.enemy_b_1.obj,e,_),this._status=1,this.haspc=!0,this.direct=t;let s=this;this.defimg={up:function(){return _PLAYERS_MAIN.x<s.x?Math.abs(_PLAYERS_MAIN.y-s.y)>100?_CANVAS_IMGS.enemy_b_5.obj:_CANVAS_IMGS.enemy_b_6.obj:Math.abs(_PLAYERS_MAIN.y-s.y)>100?_CANVAS_IMGS.enemy_b_7.obj:_CANVAS_IMGS.enemy_b_8.obj},down:function(){return _PLAYERS_MAIN.x<s.x?Math.abs(_PLAYERS_MAIN.y-s.y)>100?_CANVAS_IMGS.enemy_b_1.obj:_CANVAS_IMGS.enemy_b_2.obj:Math.abs(_PLAYERS_MAIN.y-s.y)>100?_CANVAS_IMGS.enemy_b_3.obj:_CANVAS_IMGS.enemy_b_4.obj}}}move(){let e=this;e.x+e.img.width<0?e._status=0:e._status<=0?e.showCollapes():(e.x-=_BACKGROUND_SPEED,e.img=e.defimg[this.direct](),_CONTEXT.drawImage(e.img,e.x,e.y,e.img.width,e.img.height),e.shot())}}class ENEMY_c extends GameObject_ENEMY{constructor(e,_,t){super(_CANVAS_IMGS.enemy_c_1.obj,e,_),this.x=e,this.y="down"===t?_-_CANVAS_IMGS.enemy_c_1.obj.height-_MAP.t:_,this._st="_st1",this._shot=!1,this._status=2,this.direct=t,this.col_type=this.col_ani2,this.speed=_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SPEED,this._c_shotstep=0,this.shotstep={_d_img1:[{img:_CANVAS_IMGS.enemy_c_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_4.obj,scale:1}],_d_img2:[{img:_CANVAS_IMGS.enemy_c_7.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_8.obj,scale:1}],_d_img3:[{img:_CANVAS_IMGS.enemy_c_13.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_14.obj,scale:1}],_d_img4:[{img:_CANVAS_IMGS.enemy_c_17.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_18.obj,scale:1}]},this._c_walkstep=0,this.walkstep={_d_img1:[{img:_CANVAS_IMGS.enemy_c_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_2.obj,scale:1}],_d_img2:[{img:_CANVAS_IMGS.enemy_c_5.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_6.obj,scale:1}],_d_img3:[{img:_CANVAS_IMGS.enemy_c_11.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_12.obj,scale:1}],_d_img4:[{img:_CANVAS_IMGS.enemy_c_15.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_16.obj,scale:1}]},this._c_walk=0;let s=this,i=_PLAYERS_MAIN;this.ene_status={up:{_st1:function(){if(!0===s._shot)return;s._c_walkstep=19===s._c_walkstep?0:s._c_walkstep+1;let e=s.x>i.getPlayerCenterPosition()._x?"_d_img3":"_d_img4";s.img=s.walkstep[e][parseInt(s._c_walkstep/10)].img,s._c_walk++},_st2:function(){if(s.x>=_CANVAS.width)return;if(s._shot=!0,s._c_shotstep>=19)return s.shot(),s._c_shotstep=0,s._shot=!1,void(s._st="_st1");s._c_shotstep+=1;let e=s.x>i.getPlayerCenterPosition()._x?"_d_img3":"_d_img4";s.img=s.img=s.shotstep[e][parseInt(s._c_shotstep/10)].img}},down:{_st1:function(){if(!0===s._shot)return;s._c_walkstep=19===s._c_walkstep?0:s._c_walkstep+1;let e=s.x>i.getPlayerCenterPosition()._x?"_d_img1":"_d_img2";s.img=s.walkstep[e][parseInt(s._c_walkstep/10)].img,s._c_walk++},_st2:function(){if(s.x>=_CANVAS.width)return;if(s._shot=!0,s._c_shotstep>=19)return s.shot(),s._c_shotstep=0,s._shot=!1,void(s._st="_st1");s._c_shotstep+=1;let e=s.x>i.getPlayerCenterPosition()._x?"_d_img1":"_d_img2";s.img=s.img=s.shotstep[e][parseInt(s._c_shotstep/10)].img}}}}map_collition(){let e=this,_=e.getEnemyCenterPosition(),t=_MAP.getMapX(_._x),s=_MAP.getMapY(_._y);_MAP.isMapBefore(t,s)&&(e.speed=Math.abs(e.speed)),_MAP.isMapLastSide(t,s)&&(e.speed=-1*e.speed);let i=_MAP.t;i=2*Math.abs(e.speed);let n=_MAP.isMapCollision(t+1,s)||_MAP.isMapCollision(t-1,s);e.y=function(e){return"up"===e.direct?n?e.y+i:e.y:"down"===e.direct?n?e.y-i:e.y:void 0}(e),e.y=function(e){return"up"===e.direct?_MAP.isMapCollision(t,s-1)?e.y:e.y-i:"down"===e.direct?_MAP.isMapCollision(t,s+1)?e.y:e.y+i:void 0}(e)}set_speed(){let e=_PLAYERS_MAIN.getPlayerCenterPosition();this._c_walk>5e3*Math.random()&&(this._c_walk=0,this.speed=e._x<this.x?-1*(this.speed+_BACKGROUND_SPEED):Math.abs(this.speed))}shot(){if(this.x>-100&&this.x>_CANVAS.width+100||this.y>0&&this.y>_CANVAS.height)return;let e=_PLAYERS_MAIN.getPlayerCenterPosition(),_=function(_){return e._x>_.x?1:-1}(this),t=function(e){return"up"===e.direct?1:-1}(this);_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT2(this.x,this.y,_,t)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT2(this.x,this.y,_,t/2))}move(){let e=this;e.x>_CANVAS.width?e.x-=_MAPDEFS[_MAP_PETTERN]._speed:e.x<-200?e._status=0:e._status<=0?e.showCollapes():(e.map_collition(),e.set_speed(),e._st=Math.random()<_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SHOT_RATE||e._shot?"_st2":"_st1",e.ene_status[e.direct][e._st](),e.x=function(_){return"_st1"===_._st?_.x+e.speed-_BACKGROUND_SPEED:"_st2"===_._st?_.x-_BACKGROUND_SPEED:void 0}(e),_CONTEXT.drawImage(e.img,e.x,e.y,e.img.width,e.img.height))}}class ENEMY_d extends GameObject_ENEMY{constructor(e,_,t){super(_CANVAS_IMGS.enemy_d_1.obj,e,_),this._status=1;this._col_c=0,this.col=[{img:_CANVAS_IMGS.enemy_d_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_4.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_2.obj,scale:1}],this.col_type=this.col_ani}move(){let e=this;if(e.x+e.img.width<0)return void(e._status=0);if(e._status<=0)return void e.showCollapes();e.x-=e.x>_CANVAS.width?_MAPDEFS[_MAP_PETTERN]._speed:5*_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SPEED;let _=.5*_SCROLL_POSITION,t=2*Math.cos(_*Math.PI/180);e.y+=t,e.img=function(e){return e._col_c=e._col_c>=5*e.col.length-1?0:e._col_c+1,e.col[parseInt(e._col_c/5)].img}(e),_CONTEXT.drawImage(e.img,e.x,e.y,e.img.width,e.img.height),e.shot()}}class ENEMY_e extends GameObject_ENEMY{constructor(e,_,t){super(_CANVAS_IMGS.enemy_e_1.obj,e,_),this._status=1,this.haspc=!0;this._col_c=0,this.col=[{img:_CANVAS_IMGS.enemy_e_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_4.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_2.obj,scale:1}],this.col_type=this.col_ani}move(){let e=this;if(e.x+e.img.width<0)return void(e._status=0);if(e._status<=0)return void e.showCollapes();if(e.x-=e.x>_CANVAS.width?_MAPDEFS[_MAP_PETTERN]._speed:5*_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SPEED,e.x+e.img.width<0)return void(e._status=0);let _=.5*_SCROLL_POSITION,t=2*Math.cos(_*Math.PI/180);e.y+=t,e.img=function(e){return e._col_c=e._col_c>=5*e.col.length-1?0:e._col_c+1,e.col[parseInt(e._col_c/5)].img}(e),_CONTEXT.drawImage(e.img,e.x,e.y,e.img.width,e.img.height),e.shot()}}class ENEMY_f extends GameObject_ENEMY{constructor(e,_,t){super(_CANVAS_IMGS.enemy_f_1.obj,e,_),this._status=1,this.haspc=!1,this._v=0,this._isshow=!1,this.direct=_<_CANVAS.height/2?_MAP_ENEMIES._D._D:_MAP_ENEMIES._D._U,this.speed=this.direct===_MAP_ENEMIES._D._D?-.05:.05,this._col_c=0,this.col=function(e){return e===_MAP_ENEMIES._D._D?[{img:_CANVAS_IMGS.enemy_f_5.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_6.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_7.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_8.obj,scale:1}]:[{img:_CANVAS_IMGS.enemy_f_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_4.obj,scale:1}]}(this.direct),this.col_type=this.col_ani}getDir(){return this.x>_CANVAS.width/2?-1:.5}shot(){let e=this;if(_GAME.isEnemyCanvasOut(e))return;let _=e.getEnemyCenterPosition();_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_._x,_._y,1,_._y)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_._x,_._y,_._x-_CANVAS.width/4,1)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_._x,_._y,_._x,1)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_._x,_._y,_._x+_CANVAS.width/4,1)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_._x,_._y,_CANVAS.width,_._y)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_._x,_._y,_._x+_CANVAS.width/4,_CANVAS.height)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_._x,_._y,_._x,_CANVAS.height)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(_._x,_._y,_._x-_CANVAS.width/4,_CANVAS.height))}move(){let e=this;if(e._status<=0)return void e.showCollapes();if(e.x<0-e.img.width&&(e._isshow=!0),!e._isshow)return void(e.x-=_BACKGROUND_SPEED);_GAME.isEnemyCanvasOut(e)&&(e._status=0),e.x+=2*_BACKGROUND_SPEED*e.getDir(),e.y+=e._v,e._v+=e.speed;let _=e.getEnemyCenterPosition(),t=_MAP.getMapX(_._x),s=_MAP.getMapY(_._y);_MAP.isMapCollision(t,s)&&(e._v+=e.speed,e._v*=-1),e.img=function(e){return e._col_c=e._col_c>=5*e.col.length-1?0:e._col_c+1,e.col[parseInt(e._col_c/5)].img}(e),_CONTEXT.drawImage(e.img,e.x,e.y,e.img.width,e.img.height),e._v>0&&e._v<.05&&e.shot()}}class ENEMY_g extends ENEMY_f{constructor(e,_,t){super(e,_,t),this._status=1,this.haspc=!0,this.col=function(e){return e===_MAP_ENEMIES._D._D?[{img:_CANVAS_IMGS.enemy_g_5.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_6.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_7.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_8.obj,scale:1}]:[{img:_CANVAS_IMGS.enemy_g_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_4.obj,scale:1}]}(this.direct)}}class ENEMY_o extends GameObject_ENEMY{constructor(e,_){super(_CANVAS_IMGS.enemy_o_1.obj,e,_)}move(){let e=this;if(e.x+e.img.width<0)return void(e._status=0);if(e.x-=_BACKGROUND_SPEED,Math.random()>.1)return;let _=new ENEMY_o_small(_CANVAS_IMGS[["enemy_o_1","enemy_o_2"][Math.random()>.5?1:0]].obj,e.x,e.y);_ENEMIES.push(_)}}class ENEMY_o_small extends GameObject_ENEMY{constructor(e,_,t){super(e,_,t),this._status=1,this.getscore=100,this.speedX=8*Math.random()+2,this.flagX=Math.random()>.5?1:-1,this.speedY=Math.random()/1e3,this._v=parseInt(5*Math.random())-10}map_collition(){let e=this,_=e.getEnemyCenterPosition(),t=_MAP.getMapX(_._x),s=_MAP.getMapY(_._y);_MAP.isMapCollision(t,s-1)&&(e._status=0)}move(){let e=this;_GAME.isEnemyCanvasOut(e)?e._status=0:e.isalive()?(e.map_collition(),e.x-=_BACKGROUND_SPEED+e.speedX*e.flagX,e.y+=e._v,e._v+=e.speedY,_CONTEXT.drawImage(e.img,e.x,e.y,e.img.width,e.img.height)):e.showCollapes()}}class ENEMY_n extends GameObject_ENEMY{constructor(e,_){super(_CANVAS_IMGS.enemy_o_1.obj,e,_)}move(){let e=this;if(e.x+e.img.width<0)return void(e._status=0);if(e.x-=_BACKGROUND_SPEED,Math.random()>.1)return;let _=new ENEMY_n_small(_CANVAS_IMGS[["enemy_o_1","enemy_o_2"][Math.random()>.5?1:0]].obj,e.x,e.y);_ENEMIES.push(_)}}class ENEMY_n_small extends ENEMY_o_small{constructor(e,_,t){super(e,_,t),this._v=parseInt(5*Math.random())+10}map_collition(){let e=this,_=e.getEnemyCenterPosition(),t=_MAP.getMapX(_._x),s=_MAP.getMapY(_._y);_MAP.isMapCollision(t,s+1)&&(e._status=0)}move(){let e=this;_GAME.isEnemyCanvasOut(e)?e._status=0:e.isalive()?(e.map_collition(),e.x-=_BACKGROUND_SPEED+e.speedX*e.flagX,e.y+=e._v,e._v-=e.speedY,_CONTEXT.drawImage(e.img,e.x,e.y,e.img.width,e.img.height)):e.showCollapes()}}class ENEMY_p extends GameObject_ENEMY{constructor(e,_,t){super(_CANVAS_IMGS.enemy_p_1.obj,e,_),this._status=15,this.getscore=100,this.speedx=_BACKGROUND_SPEED,this.speedy=(Math.random()+1)*(Math.random()>.5?1:-1),this._isbroken=!1,this.isshot=!1}collision(){this._status=function(e){return _SHOTTYPE===_SHOTTYPE_LASER?0===_PLAYERS_POWER_METER||1===_PLAYERS_POWER_METER?e-.4:e-1.5:e-1}(this._status),this.isalive()||_SCORE.set(this.getscore)}map_collition(){let e=this,_=e.getEnemyCenterPosition(),t=parseInt((_._x+_SCROLL_POSITION-_MAP.initx)/_MAP.t),s=parseInt(_._y/_MAP.t);(_MAP.isMapCollision(t,s-1)||_MAP.isMapCollision(t,s+1))&&(e.speedx=Math.random()>.4?Math.abs(e.speedx):-1*e.speedx,e.speedy=Math.random()>.4?Math.abs(e.speedy):-1*e.speedy)}move(){let e=this;if(e.map_collition(),e.move_bounds(),e.x-=function(e){return e.x+e.img.width>_CANVAS.width&&(e.speedx=Math.abs(e.speedx)),e.speedx}(e),e.y+=function(e){return e.y<0?e.speedy=Math.abs(e.speedy):e.y+e.img.height>_CANVAS.height&&(e.speedy*=-1),e.speedy}(e),e.x+e.img.width<0)return void(e._status=0);let _=e.getEnemyCenterPosition();if(this._status<=0&&!this._isbroken){for(let e=0;e<6;e++){let t=new ENEMY_p_small(_CANVAS_IMGS[["enemy_p_2","enemy_p_2","enemy_p_3","enemy_p_4","enemy_p_5","enemy_p_5"][e]].obj,_._x+[-60,-30,-10,10,30,60][e],_._y+[-60,-30,-10,10,30,60][e]);_ENEMIES.push(t),_ENEMIES_BOUNDS.push(t)}this._isbroken=!0}else this._status>0&&_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}}class ENEMY_p_small extends GameObject_ENEMY{constructor(e,_,t){super(e,_,t),this._status=10,this.getscore=500,this.speedx=_MAPDEFS[_MAP_PETTERN]._speed*(Math.random()>.5?1:-1),this.speedy=_MAPDEFS[_MAP_PETTERN]._speed*(Math.random()>.5?1:-1),this.col_type=this.col_ani2}collision(){this._status=function(e){return _SHOTTYPE===_SHOTTYPE_LASER?0===_PLAYERS_POWER_METER||1===_PLAYERS_POWER_METER?e-.15:e-2:e-1}(this._status),this.isalive()||_SCORE.set(this.getscore)}map_collition(){let e=this,_=e.getEnemyCenterPosition(),t=_MAP.getMapX(_._x),s=_MAP.getMapY(_._y);(_MAP.isMapCollision(t,s-1)||_MAP.isMapCollision(t,s+4))&&(e.speedx=e.speedx<=0?Math.abs(e.speedx):-1*e.speedx,e.speedy=e.speedy<=0?Math.abs(e.speedy):-1*e.speedy)}move(){let e=this;if(e.x+e.img.width<0)return void(e._status=0);if(e._status<=0)return void e.showCollapes();e.map_collition(),e.move_bounds();e.getEnemyCenterPosition();e.x-=function(e){return e.x+e.img.width>_CANVAS.width&&(e.speedx=1.5),e.speedx}(e),e.y+=function(e){return e.y<0?e.speedy=Math.abs(e.speedy):e.y+e.img.height>_CANVAS.height&&(e.speedy*=-1),e.speedy}(e),_CONTEXT.drawImage(e.img,e.x,e.y,e.img.width,e.img.height)}}class GameObject_ENEMY_BOSS extends GameObject_ENEMY{constructor(e,_,t){super(e,_,t),this.speed=0,this.starttime=0,this._c=0}ani_col(){}init(){let e=this;e.starttime=(new Date).getTime(),e.move()}shot(){}move_init(){}move(){}}class ENEMY_BOSS_BOGCORE extends GameObject_ENEMY_BOSS{constructor(e,_){super(_CANVAS_IMGS.enemy_z.obj,e,_),this._status=50,this.speed=3,this.getscore=1e4,this.img=_CANVAS_IMGS.enemy_z.obj,this.wall_col={_x:0,_y:0},this.wall=[{img:_CANVAS_IMGS.enemy_z_1.obj,cs:40,isalive:!0,x:65,y:7},{img:_CANVAS_IMGS.enemy_z_1.obj,cs:30,isalive:!0,x:55,y:7},{img:_CANVAS_IMGS.enemy_z_1.obj,cs:20,isalive:!0,x:45,y:7},{img:_CANVAS_IMGS.enemy_z_2.obj,cs:10,isalive:!0,x:35,y:5},{img:_CANVAS_IMGS.enemy_z_3.obj,cs:0,isalive:!0,x:15,y:14}],this.c_z4_ani=30,this.z4_ani=[{img:_CANVAS_IMGS.enemy_z_4_1.obj,al:1},{img:_CANVAS_IMGS.enemy_z_4_2.obj,al:.8},{img:_CANVAS_IMGS.enemy_z_4_3.obj,al:.6},{img:_CANVAS_IMGS.enemy_z_4_4.obj,al:.4},{img:_CANVAS_IMGS.enemy_z_4_5.obj,al:.2}],this.is_ani_col=!1,this.tid=null,this.is_done_move_init=!1,this.is_able_collision=!1,this.init()}ani_col(){let e=this;if(!e.is_ani_col)return;if(e._col_ani_c>=3*e.col_ani.length-1)return e._col_ani_c=0,void(e.is_ani_col=!1);let _=e.col_ani[parseInt(e._col_ani_c/3)];e.getEnemyCenterPosition();_CONTEXT.drawImage(_.img,e.wall_col.x,e.wall_col.y,_.img.width*_.scale,_.img.height*_.scale),e._col_ani_c++}ani_col2(){let e=this,_=e._col_ani9_c;if(_>=4*e.col_ani9.length-1)return;let t=e.col_ani9[parseInt(_/4)],s=e.getEnemyCenterPosition();_CONTEXT.drawImage(t.img,s._x-parseInt(t.img.width*t.scale/2),s._y-parseInt(t.img.height*t.scale/2),t.img.width*t.scale,t.img.height*t.scale),this._col_ani9_c++}collision(e){let _=this;if(!_.is_able_collision)return;let t=_.getEnemyCenterPosition();void 0!==e&&(_._status=function(_){if(e.sid===_SHOTTYPE_MISSILE){return Math.sqrt(Math.pow(t._x-60-e.x,2)+Math.pow(t._y-e.y,2))<80?_-1:_}return e.y<t._y+10&&e.y>t._y-10?_SHOTTYPE===_SHOTTYPE_LASER&&(0===_PLAYERS_POWER_METER||1===_PLAYERS_POWER_METER)?_-.1:_-1:_}(_._status),this.isalive()||_SCORE.set(this.getscore))}showCollapes(){this.ani_col2()}shot(){let e=this,_=e.speed;_ENEMIES_SHOTS.push(new ENEMY_SHOT_Z(e.x,e.y)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_Z(e.x,e.y+35)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_Z(e.x,e.y+70)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_Z(e.x,e.y+105)),e.speed=0,e.tid=setTimeout(function(){e.speed=_,clearTimeout(e.tid),e.tid=null},100)}move_init(){let e=this;e.x-=4,_CONTEXT.drawImage(e.img,e.x,e.y,e.img.width,e.img.height);for(let _=0;_<e.wall.length;_++){let t=e.wall[_],s=e.getEnemyCenterPosition();_CONTEXT.drawImage(t.img,s._x-t.x,s._y-t.y,t.img.width,t.img.height)}e.x<750&&(e.is_done_move_init=!0,e.is_able_collision=!0)}move(){let e=this;if(e.is_done_move_init)if(e._status<=0)e.showCollapes();else{Math.random()>.02||null===e.tid&&e.shot(),e.speed=e.y<50||e.y+e.img.height>450?-1*e.speed:e.speed,e.y+=e.speed,_CONTEXT.drawImage(e.img,e.x,e.y,e.img.width,e.img.height);for(let _=0;_<e.wall.length;_++){let t=e.wall[_];if(!t.isalive)continue;let s=e.getEnemyCenterPosition();_CONTEXT.drawImage(t.img,s._x-t.x,s._y-t.y,t.img.width,t.img.height),t.cs>=e._status&&(e.wall_col.x=s._x-t.x,e.wall_col.y=s._y-t.y,e.is_ani_col=!0,_SCORE.set(500),t.isalive=!1)}if(e.ani_col(),e.is_done_move_init){if(e._c>=3e3){let _=e.getEnemyCenterPosition();e.is_able_collision=!1,e.c_z4_ani=e.c_z4_ani>0?e.c_z4_ani-1:0;let t=e.z4_ani[parseInt(e.c_z4_ani/6)].img;_CONTEXT.drawImage(t,_._x-t.width/2,_._y-t.height/2,t.width,t.height)}e._c>=4e3?e._status=0:e._c++}}else e.move_init()}}class GameObject_ENEMY_SHOT{constructor(e,_,t,s){this.img=new Image,this.x=e||500,this.y=_||300,this._c=0,this.speed=_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SHOT_SPEED,this.tx=t||_PLAYERS_MAIN.getPlayerCenterPosition()._x,this.ty=s||_PLAYERS_MAIN.getPlayerCenterPosition()._y,this.deg=180*Math.atan2(this.ty-this.y,this.tx-this.x)/Math.PI,this.rad=Math.atan2(this.ty-this.y,this.tx-this.x),this.sx=Math.cos(this.rad),this.sy=Math.sin(this.rad),this._shot_alive=!0}init(){this._shot_alive=!1}ani_enemy_bullet(){this.img=_CANVAS_IMGS["enemy_bullet"+parseInt(this._c/4+1)].obj,this._c=this._c>=7?0:this._c+1}map_collition(){let e=this,_=_MAP.getMapX(e.x),t=_MAP.getMapY(e.y);_MAP.isMapCollision(_,t)&&this.init()}getEnemyCenterPosition(){return{_x:this.x+this.img.width/2,_y:this.y+this.img.height/2}}isalive(){return this._shot_alive}move(){let e=this;e.map_collition(),_GAME.isEnemyCanvasOut(e)?e.init():e._shot_alive&&(e.ani_enemy_bullet(),e.x+=e.sx*e.speed,e.y+=e.sy*e.speed,_CONTEXT.drawImage(e.img,e.x-e.img.width/2,e.y-e.img.height/2,e.img.width,e.img.height),e._shot_alive=!0)}}class GameObject_ENEMY_SHOT2 extends GameObject_ENEMY_SHOT{constructor(e,_,t,s){super(e,_),this.sx=t||1,this.sy=s||1}move(){let e=this;_GAME.isEnemyCanvasOut(e)?e._shot_alive=!1:this._shot_alive&&(this.map_collition(),this.ani_enemy_bullet(),this.x+=this.sx*this.speed,this.y+=this.sy*this.speed,_CONTEXT.drawImage(this.img,this.x-this.img.width/2,this.y-this.img.height/2,this.img.width,this.img.height),this._shot_alive=!0)}}class ENEMY_SHOT_Z extends GameObject_ENEMY_SHOT{constructor(e,_){super(e,_),this.img=_CANVAS_IMGS.enemy_bullet_z.obj,this.speed=10}move(){let e=this;_GAME.isEnemyCanvasOut(e)?e._shot_alive=!1:e._shot_alive&&(e.map_collition(),e.x-=e.speed,_CONTEXT.drawImage(e.img,e.x,e.y,e.img.width,e.img.height))}}let _MAPDEFS="",_MAPDEF="",_MAP_PETTERN=1,_BACKGROUND_SPEED=0;const _MAP_ENEMIES={_D:{_U:0,_D:1,_R:2,_L:3}},_MAP_THEME={_THEME1:{_p:{},_enemies:{}},_THEME3:{_p:{A:{_o:_CANVAS_IMGS.map_c_A,_s:"1",_mx:function(e){return e},_my:function(e){return e}},M:{_o:_CANVAS_IMGS.map_f_M,_s:"0111,1111",_mx:function(e){return e},_my:function(e){return e}},N:{_o:_CANVAS_IMGS.map_f_N,_s:"1111,0111",_mx:function(e){return e},_my:function(e){return e}},O:{_o:_CANVAS_IMGS.map_f_O,_s:"1111,1110",_mx:function(e){return e},_my:function(e){return e}},P:{_o:_CANVAS_IMGS.map_f_P,_s:"1110,1111",_mx:function(e){return e},_my:function(e){return e}}},_enemies:{}},_THEME2:{_p:{A:{_o:_CANVAS_IMGS.map_f_A,_s:"1",_mx:function(e){return e},_my:function(e){return e}},B:{_o:_CANVAS_IMGS.map_f_B,_s:"1",_mx:function(e){return e},_my:function(e){return e-1}},C:{_o:_CANVAS_IMGS.map_f_C,_s:"1",_mx:function(e){return e},_my:function(e){return e}},D:{_o:_CANVAS_IMGS.map_f_D,_s:"1",_mx:function(e){return e},_my:function(e){return e-1}},E:{_o:_CANVAS_IMGS.map_f_E,_s:"1",_mx:function(e){return e},_my:function(e){return e}},F:{_o:_CANVAS_IMGS.map_f_F,_s:"000110000,000110000,001111000,011111100,011111110,111111111",_mx:function(e){return e},_my:function(e){return e}},G:{_o:_CANVAS_IMGS.map_f_G,_s:"111111110,011111110,011111100,001111000,000110000,000110000",_mx:function(e){return e},_my:function(e){return e}},H:{_o:_CANVAS_IMGS.map_f_H,_s:"00000000000000000000,00000111111111111110,00000111111110000000,00000000011110000000,00000000001100000000,00000000001100000000,00000000001100000000,11111111111111111100,01111111111111111100,00000000011000000000,00000000011000000000,00000000111000000000,00000001111110000000",_mx:function(e){return e},_my:function(e){return e}},I:{_o:_CANVAS_IMGS.map_f_I,_s:"000000010000000,000000010000000,000000111000000,000001111100000,000011111110000,000111111111000,001111111111100,001111111111100,011111111111110,111111111111111",_mx:function(e){return e},_my:function(e){return e}},J:{_o:_CANVAS_IMGS.map_f_J,_s:"111111111111111,011111111111110,001111111111100,001111111111100,000111111111000,000011111110000,000001111100000,000000111000000,000000010000000,000000010000000",_mx:function(e){return e},_my:function(e){return e}},K:{_o:_CANVAS_IMGS.map_f_K,_s:"010",_mx:function(e){return e},_my:function(e){return e}},L:{_o:_CANVAS_IMGS.map_f_L,_s:"010",_mx:function(e){return e},_my:function(e){return e}},M:{_o:_CANVAS_IMGS.map_f_M,_s:"0111,1111",_mx:function(e){return e},_my:function(e){return e}},N:{_o:_CANVAS_IMGS.map_f_N,_s:"1111,0111",_mx:function(e){return e},_my:function(e){return e}},O:{_o:_CANVAS_IMGS.map_f_O,_s:"1111,1110",_mx:function(e){return e},_my:function(e){return e}},P:{_o:_CANVAS_IMGS.map_f_P,_s:"1110,1111",_mx:function(e){return e},_my:function(e){return e}}},_enemies:{}}};class GameObject_MAP{constructor(e){this.pt=e||0,this.initx=0,this.x=this.initx,this.collision=new RegExp("[1A-Z]"),this.collision_enemies=new RegExp("[a-z]","g"),this.collision_map=new RegExp("[A-Z]"),this.collision_map_d=new RegExp("[BD]"),this.t=25,this.mapdef=new Array,this.mapdef_col=new Array,this.map_theme=0,this.map_pettern=0,this.map_difficult=0,this.map_background_speed=0}init(e){_AJAX("./gradius_map.json","json",function(_){_MAPDEFS=_,e()})}set_stage_map_pattern(e){this.map_pettern=e}init_stage_map(){this.x=parseInt(_MAPDEFS[this.map_pettern]._initx),this.initx=parseInt(_MAPDEFS[this.map_pettern]._initx),this.mapdef=_MAPDEFS[this.map_pettern]._map,this.map_difficult=parseInt(_MAPDEFS[this.map_pettern]._difficult)-1,_ENEMY_DIFFICULT=_ISDEBUG?_ENEMY_DIFFICULT:parseInt(_MAPDEFS[this.map_pettern]._difficult)-1,this.map_background_speed=parseInt(_MAPDEFS[this.map_pettern]._speed),_BACKGROUND_SPEED=parseInt(_MAPDEFS[this.map_pettern]._speed),_MAP_PETTERN=this.map_pettern,this.map_theme=_MAPDEFS[this.map_pettern]._theme,this.init_mapdef_col()}init_enemies_location(){for(let e=0;e<this.mapdef.length;e++)for(let _=0;_<this.mapdef[e].length;_++){if(this.isCollisionBit(this.mapdef[e][_]))continue;let t=this.isMapCollision(_,e-1)?"up":"down";if(t=this.isMapCollision(_,e+1)?"down":"up","a"===this.mapdef[e][_]&&_ENEMIES.push(new ENEMY_a(this.x+_*this.t,e*this.t,t)),"b"===this.mapdef[e][_]&&_ENEMIES.push(new ENEMY_b(this.x+_*this.t,e*this.t,t)),"c"===this.mapdef[e][_]&&_ENEMIES.push(new ENEMY_c(this.x+_*this.t,e*this.t,t)),"d"===this.mapdef[e][_]&&_ENEMIES.push(new ENEMY_d(this.x+_*this.t,e*this.t,t)),"e"===this.mapdef[e][_]&&_ENEMIES.push(new ENEMY_e(this.x+_*this.t,e*this.t,t)),"f"===this.mapdef[e][_]&&_ENEMIES.push(new ENEMY_f(this.x+_*this.t,e*this.t,t)),"g"===this.mapdef[e][_]&&_ENEMIES.push(new ENEMY_g(this.x+_*this.t,e*this.t,t)),"p"===this.mapdef[e][_]){let t=new ENEMY_p(this.x+_*this.t,e*this.t);_ENEMIES.push(t),_ENEMIES_BOUNDS.push(t)}if("n"===this.mapdef[e][_]&&_ENEMIES.push(new ENEMY_n(this.x+_*this.t,e*this.t)),"o"===this.mapdef[e][_]&&_ENEMIES.push(new ENEMY_o(this.x+_*this.t,e*this.t)),"z"===this.mapdef[e][_]){let t=new ENEMY_BOSS_BOGCORE(this.x+_*this.t,e*this.t);_ENEMIES.push(t)}}}init_mapdef_col(){let e=this;Object.assign(e.mapdef_col,e.mapdef);for(let _=0;_<e.mapdef_col.length;_++)e.mapdef_col[_]=e.mapdef_col[_].replace(e.collision_enemies,"0");for(let _=0;_<e.mapdef_col.length;_++){let t=e.mapdef_col[_];for(let s=0;s<t.length;s++){if(!e.isCollisionBit(t[s]))continue;if("1"===t[s])continue;let i=_MAP_THEME[e.map_theme]._p[t[s]]._s.split(",");for(let n=0;n<i.length;n++){let a=e.mapdef_col[_+n],o=a.substr(0,s),r=_GAME.getOrBit(a.substr(s,i[n].length),i[n],i[n].length),E=a.substr(s+i[n].length,t.length);e.mapdef_col[_+n]=o+r+E}}}}getCollisionFlag(){return this.collision}getBackGroundSpeed(){return this.map_background_speed}get_stage_map_pattern(e){return this.map_pettern}getMapXToPx(e){return e*this.t}getMapYToPx(e){return e*this.t}getMapX(e){return parseInt((e+_SCROLL_POSITION-this.initx)/this.t)}getMapY(e){return parseInt(e/this.t)}isCollisionBit(e){return null!==e.match(this.collision)}isMapDouble(e){return null!==e.match(this.collision_map_d)}isMapBefore(e,_){return e<0}isMapLastSide(e,_){let t=this;return void 0!==t.mapdef[_]&&(void 0===t.mapdef[_][e]||e===t.mapdef[_].length-1)}isMapOver(e,_){let t=this;return void 0!==t.mapdef[_]&&(void 0===t.mapdef[_][e]||e>t.mapdef[_].length-1)}isMapCollision(e,_){let t=this;return void 0!==t.mapdef_col[_]&&(void 0!==t.mapdef_col[_][e]&&!!t.isCollisionBit(t.mapdef_col[_][e]))}isPlayersShotCollision(){for(let e=0;e<_PLAYERS_SHOTS[_SHOTTYPE].length;e++){let _=_PLAYERS_SHOTS[_SHOTTYPE][e];for(let e=0;e<_.shots.length;e++){let t=_.shots[e];t._shot_alive&&(t.x<this.initx-_SCROLL_POSITION||t.x>this.mapdef[0].length*this.t+this.initx-_SCROLL_POSITION||_.map_collition(t))}}for(let e=0;e<_PLAYERS_MISSILE.length;e++){let _=_PLAYERS_MISSILE[e];if(_.player.isalive())for(let e=0;e<_.shots.length;e++){let t=_.shots[e];t._shot_alive&&_.map_collition(t)}}}show(){}showMapForStageselect(e){let _=this;if(null!==e&&void 0!==e){for(let t=0;t<e._map.length;t++){let s=e._map[t].length;for(let i=0;i<(s>30?30:s);i++){let s=e._map[t][i];if("0"!==s)if(null!==s.match(_.collision_enemies)){let e=_CANVAS_IMGS["enemy_"+s+"_1"].obj;_CONTEXT.drawImage(e,50+10*i,130+10*t,e.width/2.5,e.height/2.5)}else{let _=_MAP_THEME[e._theme]._p[s],n=_._o.obj;_CONTEXT.drawImage(n,50+10*i,130+10*_._my(t),n.width/2.5,n.height/2.5)}}}_CONTEXT.fillStyle="rgba(0,0,0,1)",_CONTEXT.fillRect(351,130,_CANVAS.width,200)}}move(){let e=this;e.x-=e.map_background_speed;for(let _=0;_<e.mapdef.length;_++)for(let t=0;t<e.mapdef[_].length;t++){let s=e.mapdef[_][t];if(!e.isCollisionBit(s))continue;if(e.x+t*e.t<-500||e.x+t*e.t>_CANVAS.width+100)continue;let i=_MAP_THEME[e.map_theme]._p[s],n=i._o.obj;_CONTEXT.drawImage(n,e.x+i._mx(t)*e.t,i._my(_)*e.t,n.width,n.height)}}}const _ISDEBUG=!1;let _PLAYERS_POWER_METER=0,_PLAYERS_POWER_METER_SHIELD=0,_PLAYERS_SHOTS_SETINTERVAL=null,_DRAW_SETINTERVAL=null,_DRAW_GAMESTART_SETINTERVAL=null,_EVENT_POWERMETER_FLAG=!1,_EVENT_SELECT_STAGE_FLAG=!1,_DRAW_IS_MATCH_BOSS=!1,_DRAW_IS_MATCH_BOSS_COUNT=0;const _ISSP=null===window.ontouchstart,_EVENT_KEYDOWN=null===window.ontouchstart?"touchstart":"keydown",_EVENT_KEYUP=null===window.ontouchstart?"touchend":"keyup",_FPS=60;let _CANVAS,_CONTEXT,_DRAW_IS_GAMECLEAR=!1,_SCROLL_POSITION=0;const _SHOTTYPE_MISSILE="_SHOTTYPE_MISSILE",_SHOTTYPE_NORMAL="_SHOTTYPE_NORMAL",_SHOTTYPE_DOUBLE="_SHOTTYPE_DOUBLE",_SHOTTYPE_LASER="_SHOTTYPE_LASER";let _SHOTTYPE=_SHOTTYPE_NORMAL,_SCORE="",_PLAYERS_MAIN="",_PLAYERS_MAIN_FORCE="",_PLAYERS_OPTION=new Array,_PLAYERS_OPTION_ISALIVE=0;const _PLAYERS_OPTION_MAX=4;let _PLAYERS_MOVE_FLAG=!1,_PLAYERS_MOVE_DRAW=new Array;const _PLAYERS_MAX=5,_PLAYERS_SHOTS_MAX=2,_PLAYERS_MOVE_DRAW_MAX=500;let _PLAYERS_SHOTS={_SHOTTYPE_NORMAL:new Array,_SHOTTYPE_DOUBLE:new Array,_SHOTTYPE_LASER:new Array},_PLAYERS_MISSILE=new Array,_PLAYERS_MISSILE_ISALIVE=!1,_ENEMIES=new Array,_ENEMIES_SHOTS=new Array,_ENEMIES_BOUNDS=new Array,_POWERCAPSELLS=new Array,_POWERMETER="",_STAGESELECT="",_MAP="",_BACKGROUND=new Array;const _BACKGROUND_STAR_MAX=70;let _KEYSAFTERPAUSE=new Array,_DEF_KEYSAFTERPAUSE="38,38,40,40,37,39,37,39,66,65";const _AJAX=function(e,_,t,s){let i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&(200===i.status?(console.log("OK"),t(i.response,s)):console.log("NG"))},i.open("GET",e),i.responseType=_||"json",i.send(null)},_KEYEVENT_MASTER={addKeydownStart:function(){_ISSP?_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_start):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_start)},removeKeydownStart:function(){_ISSP?_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_start):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_start)},addKeydownSelectStage:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.addEventListener("touchmove",_KEYEVENT_SP.keymove_select_stage),_SP_CONTROLLER._sp_main_center.addEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_stage),_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_stage_a)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_stage)},removeKeydownSelectStage:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.removeEventListener("touchmove",_KEYEVENT_SP.keymove_select_stage),_SP_CONTROLLER._sp_main_center.removeEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_stage),_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_stage_a),_SP_CONTROLLER._set_reset()):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_stage)},addKeydownSelectPowermeter:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.addEventListener("touchmove",_KEYEVENT_SP.keymove_select_powermeter),_SP_CONTROLLER._sp_main_center.addEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_powermeter),_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_powermeter_a)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_powermeter)},removeKeydownSelectPowermeter:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.removeEventListener("touchmove",_KEYEVENT_SP.keymove_select_powermeter),_SP_CONTROLLER._sp_main_center.removeEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_powermeter),_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_powermeter_a),_SP_CONTROLLER._set_reset()):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_powermeter)},addKeydownGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_hide.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_hide),_SP_CONTROLLER._sp_bt_r.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_r),_SP_CONTROLLER._sp_bt_p.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_p),_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_s),_SP_CONTROLLER._sp_bt_b.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_b),_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_a),_SP_CONTROLLER._sp_main_center.addEventListener("touchstart",_KEYEVENT_SP.keymove_game_controller),_SP_CONTROLLER._sp_main_center.addEventListener("touchmove",_KEYEVENT_SP.keymove_game_controller)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_game)},addKeyupGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyup_game_a),_SP_CONTROLLER._sp_main_center.addEventListener("touchend",_KEYEVENT_SP.keyend_game_controller),_SP_CONTROLLER._set_reset()):document.addEventListener(_EVENT_KEYUP,_KEYEVENT.keyup_game)},removeKeydownGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_hide.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_hide),_SP_CONTROLLER._sp_bt_r.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_r),_SP_CONTROLLER._sp_bt_p.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_p),_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_s),_SP_CONTROLLER._sp_bt_b.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_b),_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_a),_SP_CONTROLLER._sp_main_center.removeEventListener("touchstart",_KEYEVENT_SP.keymove_game_controller),_SP_CONTROLLER._sp_main_center.removeEventListener("touchmove",_KEYEVENT_SP.keymove_game_controller)):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_game)},removeKeyupGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyup_game_a),_SP_CONTROLLER._sp_main_center.removeEventListener("touchend",_KEYEVENT_SP.keyend_game_controller),_SP_CONTROLLER._set_reset()):document.removeEventListener(_EVENT_KEYUP,_KEYEVENT.keyup_game)},addKeydownGameclear:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_r),_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_s)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameclear)},removeKeydownGameclear:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_r),_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_s)):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameclear)},addKeydownGameover:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_r),_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_s)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameover)},removeKeydownGameover:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_r),_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_s)):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameover)}},_KEYEVENT={keydown_start:function(e){"S"!==e.key&&"s"!==e.key||(document.querySelector("#game_start_wrapper .text").classList.add("on"),document.querySelector("#game_start_wrapper .text_loading").classList.add("on"),_DRAW_INIT(_CANVAS_IMGS,_DRAW_STAGE_SELECT))},keydown_select_powermeter:function(e){if(clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,"Enter"===e.key||"enter"===e.key){_KEYEVENT_MASTER.removeKeydownSelectPowermeter();let e=0,_=setInterval(function(){_POWERMETER.pms_disp(),e%5==0&&_POWERMETER.pms_select(),e>40&&(_PLAYERS_POWER_METER=_POWERMETER._c_pms,_PLAYERS_POWER_METER_SHIELD=_POWERMETER._c_pmss,clearInterval(_),_DRAW_INIT_OBJECT()),e++},1e3/60);return!1}"ArrowUp"!==e.key&&"Up"!==e.key||(_POWERMETER._c_pms=_POWERMETER._c_pms<=0?0:_POWERMETER._c_pms-1),"ArrowDown"!==e.key&&"Down"!==e.key||(_POWERMETER._c_pms=_POWERMETER._c_pms>=_POWERMETER.pms_selected.length-1?_POWERMETER._c_pms:_POWERMETER._c_pms+1),"ArrowLeft"!==e.key&&"Left"!==e.key||(_POWERMETER._c_pmss=_POWERMETER._c_pmss<=0?0:_POWERMETER._c_pmss-1),"ArrowRight"!==e.key&&"Right"!==e.key||(_POWERMETER._c_pmss=_POWERMETER._c_pmss>=_POWERMETER.pmss_selected.length-1?_POWERMETER._c_pmss:_POWERMETER._c_pmss+1),_POWERMETER.pms_disp(),_POWERMETER.pms_select()},keydown_select_stage:function(e){if(clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,"Enter"===e.key||"enter"===e.key)return _MAP.set_stage_map_pattern(_STAGESELECT.mapdef_status),_DRAW_POWER_METER_SELECT(),!1;"ArrowLeft"!==e.key&&"Left"!==e.key||(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status<=0?0:_STAGESELECT.mapdef_status-1),"ArrowRight"!==e.key&&"Right"!==e.key||(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status>=_MAPDEFS.length-1?_STAGESELECT.mapdef_status:_STAGESELECT.mapdef_status+1),_STAGESELECT.set_map_status(),_STAGESELECT.disp_thumb_map()},keydown_gameclear:function(e){if("R"===e.key||"r"===e.key)return _DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1;if("S"===e.key||"s"===e.key)return _DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1;if("P"===e.key||"p"===e.key)return null!==_DRAW_SETINTERVAL?_DRAW_STOP():(_KEYSAFTERPAUSE=[],_DRAW()),!1;if(" "===e.key||"Spacebar"===e.key){if(null!==_PLAYERS_SHOTS_SETINTERVAL)return;_PLAYERS_SHOTS_SETINTERVAL=setInterval(function(){for(_=0;_<_PLAYERS_SHOTS[_SHOTTYPE].length;_++){let t=_PLAYERS_SHOTS[_SHOTTYPE][_];if(t.player._isalive){t._sq=t._sq===t.shots.length-1?0:t._sq+1;var e=t.shots[t._sq];e._shot_alive||(e._shot=!0)}}for(var _=0;_<_PLAYERS_MISSILE.length;_++){let e=_PLAYERS_MISSILE[_];e._sq=e._sq===e.shots.length-1?0:e._sq+1;var t=e.shots[e._sq];t._shot_alive||(t._shot=!0)}},50)}"ArrowLeft"!==e.key&&"Left"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel),"ArrowRight"!==e.key&&"Right"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=_PLAYERS_MAIN.accel),"ArrowUp"!==e.key&&"Up"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel),"ArrowDown"!==e.key&&"Down"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=_PLAYERS_MAIN.accel),"B"!==e.key&&"b"!==e.key||_POWERMETER.playerset()},keydown_gameover:function(e){return"R"===e.key||"r"===e.key?(_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1):"S"===e.key||"s"===e.key?(_DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1):void 0},keydown_game:function(e){if(!_PLAYERS_MAIN.isalive())return!1;if("R"===e.key||"r"===e.key)return _DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1;if("S"===e.key||"s"===e.key)return _DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1;if("P"===e.key||"p"===e.key)return null!==_DRAW_SETINTERVAL?_DRAW_STOP():(_KEYSAFTERPAUSE=[],_DRAW()),!1;if(null===_DRAW_SETINTERVAL){if(_KEYSAFTERPAUSE.push(e.keyCode),_DEF_KEYSAFTERPAUSE===_KEYSAFTERPAUSE.toString()){_SHOTTYPE=_SHOTTYPE_NORMAL,_PLAYERS_MISSILE_ISALIVE=!0;for(let e=0;e<4;e++)_PLAYERS_OPTION[e].settruealive();_PLAYERS_MAIN_FORCE.init(),_KEYSAFTERPAUSE=[],_POWERMETER._set_current_reset(),_POWERMETER.meterdef_status="101100"}return!1}if(" "===e.key||"Spacebar"===e.key){if(null!==_PLAYERS_SHOTS_SETINTERVAL)return;_PLAYERS_SHOTS_SETINTERVAL=setInterval(function(){for(_=0;_<_PLAYERS_SHOTS[_SHOTTYPE].length;_++){let t=_PLAYERS_SHOTS[_SHOTTYPE][_];if(t.player._isalive){t._sq=t._sq===t.shots.length-1?0:t._sq+1;var e=t.shots[t._sq];e._shot_alive||(e._shot=!0)}}for(var _=0;_<_PLAYERS_MISSILE.length;_++){let e=_PLAYERS_MISSILE[_];e._sq=e._sq===e.shots.length-1?0:e._sq+1;var t=e.shots[e._sq];t._shot_alive||(t._shot=!0)}},50)}if("ArrowLeft"!==e.key&&"Left"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel),"ArrowRight"!==e.key&&"Right"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=_PLAYERS_MAIN.accel),"ArrowUp"!==e.key&&"Up"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani(e.key)),"ArrowDown"!==e.key&&"Down"!==e.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani(e.key)),"B"!==e.key&&"b"!==e.key||_POWERMETER.playerset(),!_ISDEBUG)return!1;"M"!==e.key&&"m"!==e.key||_DRAW_SCROLL_STOP(),"N"!==e.key&&"n"!==e.key||_DRAW_SCROLL_RESUME(),"V"!==e.key&&"v"!==e.key||_POWERMETER.move()},keyup_game:function(e){if(!_PLAYERS_MAIN.isalive())return!1;if("ArrowLeft"!==e.key&&"Left"!==e.key||(_PLAYERS_MOVE_FLAG=!1),"ArrowRight"!==e.key&&"Right"!==e.key||(_PLAYERS_MOVE_FLAG=!1),"ArrowUp"!==e.key&&"Up"!==e.key||(_PLAYERS_MOVE_FLAG=!1),"ArrowDown"!==e.key&&"Down"!==e.key||(_PLAYERS_MOVE_FLAG=!1)," "===e.key||"Spacebar"===e.key){clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null;for(_=0;_<_PLAYERS_SHOTS[_SHOTTYPE].length;_++){let e=_PLAYERS_SHOTS[_SHOTTYPE][_];for(let _=0;_<e.shots.length;_++)e.shots[_]._shot=!1}for(var _=0;_<_PLAYERS_MISSILE.length;_++){let e=_PLAYERS_MISSILE[_];for(let _=0;_<e.shots.length;_++)e.shots[_]._shot=!1}}}},_KEYEVENT_SP={keydown_start:function(e){document.querySelector("#game_start_wrapper .text").classList.add("on"),document.querySelector("#game_start_wrapper .text_loading").classList.add("on"),_DRAW_INIT(_CANVAS_IMGS,_DRAW_STAGE_SELECT)},keydown_select_powermeter_a:function(e){_KEYEVENT_MASTER.removeKeydownSelectPowermeter();let _=0,t=setInterval(function(){_POWERMETER.pms_disp(),_%5==0&&_POWERMETER.pms_select(),_>40&&(_PLAYERS_POWER_METER=_POWERMETER._c_pms,_PLAYERS_POWER_METER_SHIELD=_POWERMETER._c_pmss,clearInterval(t),_DRAW_INIT_OBJECT()),_++},1e3/60);return!1},keymove_select_powermeter:function(e){clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null;let _=_SP_CONTROLLER._get_st(e)._rad;return e.preventDefault(),!0!==_EVENT_POWERMETER_FLAG&&(_EVENT_POWERMETER_FLAG=!0,_>-45&&_<=45?(_POWERMETER._c_pmss=_POWERMETER._c_pmss<=0?0:_POWERMETER._c_pmss-1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),!1):_>45&&_<=135?(_POWERMETER._c_pms=_POWERMETER._c_pms<=0?0:_POWERMETER._c_pms-1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),!1):_>135&&_<=180||_<-135&&_>=-180?(_POWERMETER._c_pmss=_POWERMETER._c_pmss>=_POWERMETER.pmss_selected.length-1?_POWERMETER._c_pmss:_POWERMETER._c_pmss+1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),!1):_<-45&&_>=-135?(_POWERMETER._c_pms=_POWERMETER._c_pms>=_POWERMETER.pms_selected.length-1?_POWERMETER._c_pms:_POWERMETER._c_pms+1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),!1):void 0)},keyend_select_powermeter:function(e){_SP_CONTROLLER._set_reset(),_EVENT_POWERMETER_FLAG=!1},keymove_select_stage:function(e){e.preventDefault();let _=_SP_CONTROLLER._get_st(e)._rad;_SP_CONTROLLER._get_st(e)._dis;if(!_EVENT_SELECT_STAGE_FLAG)return _EVENT_SELECT_STAGE_FLAG=!0,_>-45&&_<=45&&(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status<=0?0:_STAGESELECT.mapdef_status-1),(_>135&&_<=180||_<-135&&_>=-180)&&(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status>=_MAPDEFS.length-1?_STAGESELECT.mapdef_status:_STAGESELECT.mapdef_status+1),_STAGESELECT.set_map_status(),_STAGESELECT.disp_thumb_map(),!1},keyend_select_stage:function(e){let _=_SP_CONTROLLER._sp_main_center;_.style.top="",_.style.left="",_EVENT_SELECT_STAGE_FLAG=!1},keydown_select_stage_a:function(e){return _MAP.set_stage_map_pattern(_STAGESELECT.mapdef_status),_DRAW_POWER_METER_SELECT(),!1},keydown_gameclear_r:function(e){return _DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_gameclear_s:function(e){return _DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_gameover_r:function(e){return _DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_gameover_s:function(e){return _DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1},keymove_game_controller:function(e){e.preventDefault(),_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=0,_PLAYERS_MAIN._y=0;let _=_SP_CONTROLLER._get_st(e)._rad;return!(_SP_CONTROLLER._get_st(e)._dis<5)&&(_>-40&&_<=40&&(_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel),_>40&&_<=50&&(_PLAYERS_MAIN._x=-.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=-.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Up")),_>50&&_<=130&&(_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Up")),_>130&&_<=140&&(_PLAYERS_MAIN._x=.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=-.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Up")),(_>140&&_<=180||_<-140&&_>=-180)&&(_PLAYERS_MAIN._x=_PLAYERS_MAIN.accel),_<-130&&_>=-140&&(_PLAYERS_MAIN._x=.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Down")),_<-50&&_>=-130&&(_PLAYERS_MAIN._y=_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Down")),_<-40&&_>=-50&&(_PLAYERS_MAIN._x=-.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Down")),!1)},keyend_game_controller:function(e){_SP_CONTROLLER._set_reset(),_PLAYERS_MOVE_FLAG=!1},keydown_game_hide:function(e){_SHOTTYPE=_SHOTTYPE_NORMAL,_PLAYERS_MISSILE_ISALIVE=!0;for(let e=0;e<4;e++)_PLAYERS_OPTION[e].settruealive();return _PLAYERS_MAIN_FORCE.init(),_KEYSAFTERPAUSE=[],_POWERMETER._set_current_reset(),_POWERMETER.meterdef_status="101100",!1},keydown_game_r:function(e){return _DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_game_s:function(e){return _DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1},keydown_game_p:function(e){return null!==_DRAW_SETINTERVAL?_DRAW_STOP():(_KEYSAFTERPAUSE=[],_DRAW()),!1},keydown_game_a:function(e){if(null===_PLAYERS_SHOTS_SETINTERVAL)return _PLAYERS_SHOTS_SETINTERVAL=setInterval(function(){for(_=0;_<_PLAYERS_SHOTS[_SHOTTYPE].length;_++){let t=_PLAYERS_SHOTS[_SHOTTYPE][_];if(t.player._isalive){t._sq=t._sq===t.shots.length-1?0:t._sq+1;var e=t.shots[t._sq];e._shot_alive||(e._shot=!0)}}for(var _=0;_<_PLAYERS_MISSILE.length;_++){let e=_PLAYERS_MISSILE[_];e._sq=e._sq===e.shots.length-1?0:e._sq+1;var t=e.shots[e._sq];t._shot_alive||(t._shot=!0)}},80),!1},keydown_game_b:function(e){return _POWERMETER.playerset(),!1},keyup_game_a:function(e){clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null;for(_=0;_<_PLAYERS_SHOTS[_SHOTTYPE].length;_++){let e=_PLAYERS_SHOTS[_SHOTTYPE][_];for(let _=0;_<e.shots.length;_++)e.shots[_]._shot=!1}for(var _=0;_<_PLAYERS_MISSILE.length;_++){let e=_PLAYERS_MISSILE[_];for(let _=0;_<e.shots.length;_++)e.shots[_]._shot=!1}return!1}},_SP_CONTROLLER={_x:0,_y:0,_sp_main_center:new Object,_sp_main:new Object,_sp_bt_hide:new Object,_sp_bt_r:new Object,_sp_bt_p:new Object,_sp_bt_s:new Object,_sp_bt_b:new Object,_sp_bt_a:new Object,_get_st:function(e){let _=this._sp_main_center,t=this._sp_main,s=t.getBoundingClientRect();for(var i=0;i<e.touches.length;i++)_===e.touches[i].target&&(this._x=e.touches[i].clientX-s.left,this._y=e.touches[i].clientY-s.top);let n=this._x-parseInt(window.getComputedStyle(_).width)/2,a=this._y-parseInt(window.getComputedStyle(_).height)/2;_.style.left=parseInt(n)+"px",_.style.top=parseInt(a)+"px";let o=parseInt(window.getComputedStyle(t).width),r=parseInt(window.getComputedStyle(t).height),E=o/2-this._x,m=r/2-this._y,l=Math.sqrt(Math.pow(E,2)+Math.pow(m,2));return{_rad:parseInt(180*Math.atan2(m,E)/Math.PI),_dis:l}},_set_reset(){let e=document.querySelector(".sp_controller_main_center");e.style.left="",e.style.top=""},_set_obj(){this._sp_main_center=document.querySelector(".sp_controller_main_center"),this._sp_main=document.querySelector(".sp_controller_main"),this._sp_bt_hide=document.querySelector(".sp_controller_bt.hide"),this._sp_bt_r=document.querySelector(".sp_controller_bt.r"),this._sp_bt_p=document.querySelector(".sp_controller_bt.p"),this._sp_bt_s=document.querySelector(".sp_controller_bt.s"),this._sp_bt_b=document.querySelector(".sp_controller_bt.b"),this._sp_bt_a=document.querySelector(".sp_controller_bt.a")}};class GameObject_PLAYER{constructor(e,_,t,s){this.img=_CANVAS_IMGS[e].obj,this.x=_||100,this.y=t||100,this._x=0,this._y=0,this._isalive=s||!1,this._scalechange=!0,this.width=0,this.height=0,this._c=0,this.accel=2,this.shotflag=!1}isalive(){return this._isalive}isshotflag(){return this.shotflag}enemy_collision(){}getPlayerCenterPosition(){return{_x:this.x+this.img.width/2,_y:this.y+this.img.height/2}}setfalsealive(){this._isalive=!1}settruealive(){this._isalive=!0}}class GameObject_PLAYER_MAIN extends GameObject_PLAYER{constructor(){super("vicviper1",100,200,!0),this._isequipped=!1,this._isequipped_count=0,this.c_vv_ani=20,this.vv_ani=[{img:_CANVAS_IMGS.vicviper3.obj,scale:1},{img:_CANVAS_IMGS.vicviper2.obj,scale:1},{img:_CANVAS_IMGS.vicviper1.obj,scale:1},{img:_CANVAS_IMGS.vicviper4.obj,scale:1},{img:_CANVAS_IMGS.vicviper5.obj,scale:1}],this.vv_e_ani=[{img:_CANVAS_IMGS.vicviper3_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper2_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper1_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper4_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper5_e.obj,scale:1}],this.c_vb_ani=0,this.vb_ani=[{img:_CANVAS_IMGS.vicviper_back1.obj,scale:1},{img:_CANVAS_IMGS.vicviper_back2.obj,scale:1},{img:_CANVAS_IMGS.vicviper_back3.obj,scale:1}],this.vb_e_ani=[{img:_CANVAS_IMGS.vicviper_back1_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper_back1_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper_back1_e.obj,scale:1}],this._eq_ani_c=0,this.eq_ani=[{img:_CANVAS_IMGS.vicviper4.obj,scale:1},{img:_CANVAS_IMGS.vicviper1.obj,scale:1}],this._col_ani_c=0,this.col_ani=[{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.7},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.3},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.1}],this.shotflag=!0}collapes(){_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame();let e=this,_=null,t=e.getPlayerCenterPosition();_DRAW_STOP(),_=setInterval(function(){if(e._col_ani_c>=10*e.col_ani.length-1)return clearInterval(_),void _DRAW_GAMEOVER();let s=parseInt(e._col_ani_c/10),i=e.col_ani[s].img.width,n=e.col_ani[s].img.height,a=i*e.col_ani[s].scale,o=n*e.col_ani[s].scale;_CONTEXT.drawImage(e.col_ani[s].img,t._x-a/2,t._y-o/2,a,o),e._col_ani_c++},1e3/60)}enemy_collision(e){1===_PLAYERS_POWER_METER_SHIELD&&_PLAYERS_MAIN_FORCE.isalive()||_GAME.isCollision(this,e)&&(e.collision(),this.setfalsealive())}enemy_shot_collision(e){1===_PLAYERS_POWER_METER_SHIELD&&_PLAYERS_MAIN_FORCE.isalive()||_GAME.isCollision(this,e)&&(e.init(),this.setfalsealive())}set_equipped(){this._isequipped_count=20}map_collition(){if(1===_PLAYERS_POWER_METER_SHIELD&&_PLAYERS_MAIN_FORCE.isalive())return;let e=this.getPlayerCenterPosition(),_=_MAP.getMapX(e._x),t=_MAP.getMapY(e._y);_MAP.isMapCollision(_,t)&&this.setfalsealive()}set_vv_ani(e){"ArrowUp"!==e&&"Up"!==e||(this.c_vv_ani-=2),"ArrowDown"!==e&&"Down"!==e||(this.c_vv_ani+=2)}move(){let e=this;if(!e.isalive())return void e.collapes();e.map_collition(),_PLAYERS_MOVE_FLAG?(e.x+=e._x,e.y+=e._y,e.x=function(_){return _<50?(e._x=0,50):_>_CANVAS.width-100?(e._x=0,_CANVAS.width-100):_+e._x}(e.x),e.y=function(_){return _<50-e.img.height/4?(e._y=0,50-e.img.height/4):_>_CANVAS.height-75-e.img.height/4?(e._y=0,_CANVAS.height-75-e.img.height/4):_+e._y}(e.y)):(e._x=0,e._y=0),_PLAYERS_MOVE_FLAG?e.c_vv_ani>46?e.c_vv_ani=46:e.c_vv_ani<4&&(e.c_vv_ani=4):e.c_vv_ani>25?e.c_vv_ani-=1:e.c_vv_ani<25?e.c_vv_ani+=1:e.c_vv_ani=25;let _=function(){let _=parseInt(e.c_vv_ani/10);return e._isequipped_count<=0?e.vv_ani[_].img:(e._isequipped_count--,e._isequipped_count>0&&e._isequipped_count%2==0?e.vv_e_ani[_].img:e.vv_ani[_].img)}();_CONTEXT.drawImage(_,e.x,e.y,_.width,_.height);let t=function(){let _=parseInt(e.c_vb_ani/3);return e._isequipped_count>0&&e._isequipped_count%2==0?e.vb_e_ani[_].img:e.vb_ani[_].img}();e.width=t.width,e.height=t.height,e.c_vb_ani=_GAME._ac._get(e.c_vb_ani,e.vb_ani,3),_CONTEXT.drawImage(t,e.x,e.y+22,t.width,t.height),500===_PLAYERS_MOVE_DRAW.length&&_PLAYERS_MOVE_DRAW.pop(),_PLAYERS_MOVE_FLAG&&_PLAYERS_MOVE_DRAW.unshift({_x:parseInt(e.x+e.img.width/10),_y:parseInt(e.y+e.img.height/4)})}}class GameObject_PLAYER_MAIN_RED extends GameObject_PLAYER_MAIN{constructor(){super("vicviper1",100,200,!0),this.col_ani=[{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.7},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.3},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.1}]}}class GameObject_PLAYER_OPTION extends GameObject_PLAYER{constructor(e,_,t,s){super(e,_,t,s),this.scalemax=1.3,this.scalemin=1,this._ani_c=0,this.ani=[{img:_CANVAS_IMGS.option.obj,scale:1},{img:_CANVAS_IMGS.option.obj,scale:.9},{img:_CANVAS_IMGS.option.obj,scale:.8},{img:_CANVAS_IMGS.option.obj,scale:.7},{img:_CANVAS_IMGS.option.obj,scale:.8},{img:_CANVAS_IMGS.option.obj,scale:.9}]}move(e){let _=this;if(void 0===_PLAYERS_MOVE_DRAW[e])return;if(_.x=_PLAYERS_MOVE_DRAW[e]._x,_.y=_PLAYERS_MOVE_DRAW[e]._y,!_._isalive)return;if(void 0===_.x||void 0===_.y)return;_.shotflag=!0;let t=_.getPlayerCenterPosition();_.img=(_._ani_c=_._ani_c>=3*_.ani.length-1?0:_._ani_c+1,_.ani[parseInt(_._ani_c/3)].img);let s=parseInt(_._ani_c/3),i=_.img.width,n=_.img.height,a=i*_.ani[s].scale,o=n*_.ani[s].scale;_CONTEXT.drawImage(_.img,t._x-a/2,t._y-o/2,a,o)}}class GameObject_FORCEFIELD{constructor(){this.img="",this.STATUS_MAX=4,this.x=0,this.y=0,this.width=0,this.height=0,this.type="forcefield",this._c=0,this._scale=0,this._eid=0,this.ani=[{img:_CANVAS_IMGS.forcefield1.obj,scale:1},{img:_CANVAS_IMGS.forcefield2.obj,scale:1}]}init(){this._scale=1,this.img=this.ani[0].img,this.width=this.img.width,this.height=this.img.height}isalive(){return 0!==this._scale}enemy_collision(e){_GAME.isCollision(this,e)&&(e.collision(),this.reduce())}enemy_shot_collision(e){_GAME.isCollision(this,e)&&(e.init(),this.reduce())}getPlayerCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}map_collition(){let e=this.getPlayerCenterPosition(),_=_MAP.getMapX(e._x),t=_MAP.getMapY(e._y);_MAP.isMapCollision(_,t)&&this.reduce()}reduce(){this._scale-=.06,this._scale<.7&&(this._scale=0,_POWERMETER._set_meter_on("000001")),this.width*=this._scale,this.height*=this._scale}move(e){let _=this;if(_.map_collition(),0===_._scale)return;_.x=e.getPlayerCenterPosition()._x-_.width/2-6,_.y=e.getPlayerCenterPosition()._y-_.height/2-2;let t=(_._c=_._c>=5*_.ani.length-1?0:_._c+1,_.ani[parseInt(_._c/5)].img);_CONTEXT.drawImage(t,_.x,_.y,_.width,_.height)}}class GameObject_FORCEFIELD_RED extends GameObject_FORCEFIELD{constructor(){super(),this.ani=[{img:_CANVAS_IMGS.forcefield_red1.obj,scale:1},{img:_CANVAS_IMGS.forcefield_red2.obj,scale:1}]}}class GameObject_SHIELD extends GameObject_FORCEFIELD{constructor(){super(),this.STATUS_MAX=15,this.type="shield",this.ani=[{img:_CANVAS_IMGS.shield1.obj,scale:1},{img:_CANVAS_IMGS.shield2.obj,scale:1}]}getPlayerCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height}}init(){this._scale=1,this.img=this.ani[0].img,this.width=this.img.width,this.height=this.img.height}isalive(){return 0!==this._scale}enemy_collision(e){_GAME.isShieldCollision(this,e)&&(e.collision(),this.reduce())}enemy_shot_collision(e){_GAME.isShieldCollision(this,e)&&(e.init(),this.reduce())}map_collition(e){let _=this,t=_.getPlayerCenterPosition(),s=_MAP.getMapX(t._x),i=_MAP.getMapY(t._y);_MAP.isMapCollision(s,i)?_.reduce():(i=parseInt(this.y/_MAP.t),_MAP.isMapCollision(s,i)?_.reduce():(i=parseInt((t._y-10+this.height)/_MAP.t),_MAP.isMapCollision(s,i)&&_.reduce()))}reduce(){this._scale-=.01,this._scale<.86&&(this._scale=0,_POWERMETER._set_meter_on("000001")),this.width*=this._scale,this.height*=this._scale}move(e){let _=this;if(0===_._scale)return;let t=e.getPlayerCenterPosition();_.map_collition(e);let s=(_._c=_._c>=5*_.ani.length-1?0:_._c+1,_.ani[parseInt(_._c/5)].img),i=e.x+e.img.width,n=t._y,a=t._y-_.height*_._scale;_CONTEXT.drawImage(s,i,n,_.width,_.height),_CONTEXT.drawImage(s,i,a,_.width,_.height),this.x=i,this.y=a}}class GameObject_SHIELD_RED extends GameObject_SHIELD{constructor(){super(),this.ani=[{img:_CANVAS_IMGS.shield_red1.obj,scale:.4},{img:_CANVAS_IMGS.shield_red2.obj,scale:.4}]}}class GameObject_SHOTS{constructor(e){this.shots=new Array,this.player=e,this._sq=0}enemy_collision(e){if(this.player.isalive())for(let _=0;_<this.shots.length;_++){let t=this.shots[_];if(!t._shot_alive)continue;if(e.x<this.player.x)continue;let s=e.getEnemyCenterPosition();Math.sqrt(Math.pow(s._x-t.x,2)+Math.pow(s._y-t.y,2))<e.img.height&&e.isalive()&&(e.collision(t),t._init())}}map_collition(){}getshottype(){}move(){}}class GameObject_SHOTS_MISSILE extends GameObject_SHOTS{constructor(e){super(e),this.shots=new Array,this.col_mis=[{fs:"rgba(255,246,72,1)",scale:8},{fs:"rgba(255,131,62,1)",scale:10},{fs:"rgba(255,131,62,1)",scale:12},{fs:"rgba(255,131,62,1)",scale:14},{fs:"rgba(133,0,4,1)",scale:14},{fs:"rgba(133,0,4,1)",scale:14}];for(let e=0;e<2;e++)this.shots.push({sid:_SHOTTYPE_MISSILE,id:e,x:0,y:0,_t:0,_st:"_st1",_img:new Image,_c_mc:0,_c:0,_c_area:25,_enemyid:null,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._t=0,this._c=0,this._c_mc=0,this._c_area=25,this._st="_st1",this._img=new Image,this._enemyid=null,this._shot=!1,this._shot_alive=!1}});let _=this;this.mis_status={_st1:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+4:t._x}(e.x),e.y=function(_){return e._shot_alive?_+8:t._y}(e.y),e._img=_CANVAS_IMGS.missile1.obj},_st2:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_:t._x}(e.x),e.y=function(_){return e._shot_alive?_+8:t._y}(e.y),e._img=_CANVAS_IMGS.missile2.obj},_st3:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+8:t._x}(e.x),e.y=function(_){return e._shot_alive?_:t._y}(e.y),e._img=_CANVAS_IMGS.missile3.obj},_st4:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+3:t._x}(e.x),e.y=function(_){return e._shot_alive?_+3:t._y}(e.y),e._img=_CANVAS_IMGS.missile4.obj},_st5:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+3:t._x}(e.x),e.y=function(_){return e._shot_alive?_+3:t._y}(e.y),e._img=_CANVAS_IMGS.missile5.obj},_st6:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+2:t._x}(e.x),e.y=function(_){return e._shot_alive?_+3:t._y}(e.y),e._img=_CANVAS_IMGS.missile1.obj},_st7:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+4:t._x}(e.x),e.y=function(_){return e._shot_alive?_+3:t._y}(e.y),e._img=_CANVAS_IMGS.missile5.obj},_st8:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+4:t._x}(e.x),e.y=function(_){return e._shot_alive?_+2:t._y}(e.y),e._img=_CANVAS_IMGS.missile4.obj}}}enemy_collision(e,_){if(this.player.isalive()&&_._shot_alive&&_GAME.isMisShotCollision(_,e)){if(_._enemyid===e.id)return;e.collision(_),0===_._c&&(_._c=1),_._enemyid=e.id}}get_missile_status(e){return e._st}set_missile_status(e,_){"_st1"!==this._st&&"_st2"!==this._st&&"_st3"!==this._st&&(e._c_mc++,e._c_mc>1?e._c_mc=0:e._st=_)}map_collition(e){let _=this,t=_MAP.getMapX(e.x+e._img.width),s=_MAP.getMapY(e.y);if(!_MAP.isMapBefore(t,s)){if(_MAP.isMapOver(t,s)){if("_st3"===_.get_missile_status(e))return void _.set_missile_status(e,"_st4");if("_st2"===_.get_missile_status(e))return}if("_st4"===_.get_missile_status(e)&&_.set_missile_status(e,"_st5"),"_st6"===_.get_missile_status(e)){if(t=_MAP.getMapX(e.x+e._img.width),_MAP.isMapCollision(t,s))return void e._init();_.set_missile_status(e,"_st7")}if("_st7"===_.get_missile_status(e)){if(t=_MAP.getMapX(e.x+e._img.width),_MAP.isMapCollision(t,s))return void e._init();e.x+=2,_.set_missile_status(e,"_st8")}if("_st8"===_.get_missile_status(e)){if(t=_MAP.getMapX(e.x+e._img.width),_MAP.isMapCollision(t,s))return void e._init();e.x+=2,e.y=s*_MAP.t+8,_.set_missile_status(e,"_st3")}if("_st5"===_.get_missile_status(e)){if(t=_MAP.getMapX(e.x+e._img.width),_MAP.isMapCollision(t,s+1))return e.y=s*_MAP.t-5,void _.set_missile_status(e,"_st6");if(!_MAP.isMapCollision(t,s+1))return _.set_missile_status(e,"_st2"),e.x+=2,void(e.y+=5);if(_MAP.isMapCollision(t+1,s))return void e._init()}if("_st3"===_.get_missile_status(e)){if(t=_MAP.getMapX(e.x+e._img.width),_MAP.isMapCollision(t,s))return void e._init();if(!_MAP.isMapCollision(t,s+1))return void _.set_missile_status(e,"_st4");if(t=_MAP.getMapX(e.x+e._img.width/2),_MAP.isMapCollision(t,s))return void e._init();if(_MAP.isMapOver(t,s))return void _.set_missile_status(e,"_st4")}return"_st2"===_.get_missile_status(e)&&(s=_MAP.getMapY(e.y+e._img.height/2),_MAP.isMapCollision(t,s)||_MAP.isMapCollision(t,s+1))?(e.y=s*_MAP.t-8,void _.set_missile_status(e,"_st6")):"_st1"===_.get_missile_status(e)&&(s=_MAP.getMapY(e.y+e._img.height/2),_MAP.isMapCollision(t,s)||_MAP.isMapCollision(t,s+1)||_MAP.isMapCollision(t+1,s+1))?(e.y=s*_MAP.t-5,void _.set_missile_status(e,"_st7")):void 0}}collapse_missile(e,_){let t=this;if(_=_||-5,e._c>=5*t.col_mis.length)e._init();else{var s=parseInt(e._c/5);e._c_area=t.col_mis[s].scale,_CONTEXT.fillStyle=t.col_mis[s].fs,_CONTEXT.beginPath(),_CONTEXT.arc(e.x,e.y+_,t.col_mis[s].scale,0,2*Math.PI,!1),_CONTEXT.fill(),void 0!==this.col_mis[s-1]&&(_CONTEXT.fillStyle=t.col_mis[s-1].fs,_CONTEXT.beginPath(),_CONTEXT.arc(e.x,e.y+_,t.col_mis[s-1].scale,0,2*Math.PI,!1),_CONTEXT.fill()),e._c++}}move(){let e=this,_=e.player;if(_.isalive()&&_.isshotflag()&&void 0!==_.x)for(let _=0;_<e.shots.length;_++){let t=e.shots[_];(t._shot||t._shot_alive)&&(t._c>0?e.collapse_missile(t,10):t.y>_CANVAS.height||t.x>_CANVAS.width?t._init():(e.mis_status[t._st](t),_CONTEXT.drawImage(t._img,t.x,t.y,t._img.width,t._img.height),t._shot_alive=!0))}}}class GameObject_SHOTS_MISSILE_PHOTOM extends GameObject_SHOTS_MISSILE{constructor(e){super(e);let _=this;this.mis_status={_st1:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+4:t._x}(e.x),e.y=function(_){return e._shot_alive?_+8:t._y}(e.y),e._img=_CANVAS_IMGS.missile3.obj},_st2:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_:t._x}(e.x),e.y=function(_){return e._shot_alive?_+8:t._y}(e.y),e._img=_CANVAS_IMGS.missile2.obj},_st3:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+8:t._x}(e.x),e.y=function(_){return e._shot_alive?_:t._y}(e.y),e._img=_CANVAS_IMGS.missile3.obj},_st4:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+3:t._x}(e.x),e.y=function(_){return e._shot_alive?_+3:t._y}(e.y),e._img=_CANVAS_IMGS.missile4.obj},_st5:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+3:t._x}(e.x),e.y=function(_){return e._shot_alive?_+3:t._y}(e.y),e._img=_CANVAS_IMGS.missile5.obj},_st6:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+2:t._x}(e.x),e.y=function(_){return e._shot_alive?_+6:t._y}(e.y),e._img=_CANVAS_IMGS.missile1.obj},_st7:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+4:t._x}(e.x),e.y=function(_){return e._shot_alive?_+5:t._y}(e.y),e._img=_CANVAS_IMGS.missile5.obj},_st8:function(e){let t=_.player.getPlayerCenterPosition();e.x=function(_){return e._shot_alive?_+4:t._x}(e.x),e.y=function(_){return e._shot_alive?_+3:t._y}(e.y),e._img=_CANVAS_IMGS.missile4.obj}}}enemy_collision(e,_){if(this.player.isalive()&&_._shot_alive&&_GAME.isMisShotCollision(_,e)){if(_._enemyid===e.id)return;if(e.collision(_),!e.isalive())return;0===_._c&&(_._c=1),_._enemyid=e.id}}}class GameObject_SHOTS_MISSILE_SPREADBOMB extends GameObject_SHOTS_MISSILE{constructor(e){super(e),this.col_mis=[{fs:"rgba(198,231,247,1)",scale:30},{fs:"rgba(54,115,255,1)",scale:40},{fs:"rgba(54,115,255,1)",scale:50},{fs:"rgba(54,115,255,1)",scale:60},{fs:"rgba(0,27,145,1)",scale:60},{fs:"rgba(0,27,145,1)",scale:60},{fs:"rgba(0,27,145,1)",scale:70}],this.mis_status={_st1:function(e){e._img=_CANVAS_IMGS.missile4.obj},_st2:function(e){e._img=_CANVAS_IMGS.missile5.obj},_st3:function(e){e._img=_CANVAS_IMGS.missile1.obj}}}enemy_collision(e,_){if(!this.player.isalive())return;if(!_._shot_alive)return;let t=e.getEnemyCenterPosition();if(_._c>0?Math.abs(t._x-_.x)<e.img.width/2+_._c_area&&Math.abs(t._y-_.y)<e.img.height/2+_._c_area:_GAME.isMisShotCollision(_,e)){if(_._enemyid===e.id)return;e.collision(_),0===_._c&&(_._c=1),_._enemyid=e.id}}map_collition(e){let _=_MAP.getMapX(e.x),t=_MAP.getMapY(e.y);(_MAP.isMapCollision(_,t)||_MAP.isMapCollision(_+1,t))&&this.collapse_missile(e,-25)}move(){let e=this,_=e.player;if(!_.isalive())return;if(!_.isshotflag())return;if(void 0===_.x)return;let t=_.getPlayerCenterPosition();for(let _=0;_<e.shots.length;_++){let s=e.shots[_];(s._shot||s._shot_alive)&&(s._c>0?e.collapse_missile(s):(s._t++,s.x=function(e){return s._shot_alive?e+4:t._x}(s.x),s.y=function(e){return s._shot_alive?e+s._t*s._t/200:t._y-8}(s.y),s._st=s._t>20&&s._t<30?"_st2":s._t>30?"_st3":"_st1",s.y>_CANVAS.height||s.x>_CANVAS.width?s._init():(e.mis_status[s._st](s),_CONTEXT.drawImage(s._img,s.x,s.y,s._img.width,s._img.height),s._shot_alive=!0)))}}}class GameObject_SHOTS_MISSILE_2WAY extends GameObject_SHOTS_MISSILE{constructor(e){super(e),this.mis_status={_st1:function(e){e._img=_CANVAS_IMGS.missile4.obj},_st2:function(e){e._img=_CANVAS_IMGS.missile5.obj},_st3:function(e){e._img=_CANVAS_IMGS.missile1.obj},_st4:function(e){e._img=_CANVAS_IMGS.missile6.obj},_st5:function(e){e._img=_CANVAS_IMGS.missile7.obj},_st6:function(e){e._img=_CANVAS_IMGS.missile8.obj}}}enemy_collision(e,_){if(this.player.isalive()&&_._shot_alive&&_GAME.isMisShotCollision(_,e)){if(_._enemyid===e.id)return;e.collision(_),0===_._c&&(_._c=1),_._enemyid=e.id}}map_collition(e){let _=_MAP.getMapX(e.x),t=_MAP.getMapY(0===e.id?e.y:e.y+e._img.height);_MAP.isMapCollision(_,t)&&0===e._c&&(e._c=1)}move(){let e=this,_=e.player;if(!_.isalive())return;if(!_.isshotflag())return;if(void 0===_.x)return;let t=_.getPlayerCenterPosition(),s=this.shots[0]._shot|this.shots[1]._shot,i=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(s||i){s&&!i&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let _=0;_<this.shots.length;_++){let s=this.shots[_];if(s._shot_alive)if(s._c>0)e.collapse_missile(s,10);else{if(s._t+=1,s.x=function(e){return i?e+1:t._x}(s.x),s.y=function(e){return 0===_?i?e+s._t*s._t/100*-1:t._y-20:i?e+s._t*s._t/100:t._y}(s.y),0===_){if(s.x>_CANVAS.width||s.y<0){s._init();continue}s._st=s._t>20&&s._t<30?"_st5":s._t>30?"_st6":"_st4"}else{if(s.x>_CANVAS.width||s.y>_CANVAS.height){s._init();continue}s._st=s._t>20&&s._t<30?"_st2":s._t>30?"_st3":"_st1"}e.mis_status[s._st](s),_CONTEXT.drawImage(s._img,s.x,s.y,s._img.width,s._img.height),s._shot_alive=!0}}}}}class GameObject_SHOTS_NORMAL extends GameObject_SHOTS{constructor(e){super(e),this.shots=new Array,this.speed=20;for(let e=0;e<2;e++)this.shots.push({sid:_SHOTTYPE_NORMAL,x:0,y:0,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._shot=!1,this._shot_alive=!1}})}map_collition(e){let _=_MAP.getMapX(e.x),t=_MAP.getMapY(e.y);(_MAP.isMapCollision(_,t)||_MAP.isMapCollision(_+1,t))&&e._init()}move(){let e=this.player;if(!e.isalive())return;if(!e.isshotflag())return;let _=e.getPlayerCenterPosition();for(let e=0;e<this.shots.length;e++){let t=this.shots[e];if(!t._shot&&!t._shot_alive)continue;let s=this.speed;if(t.x=function(e){return t._shot_alive?e+s:_._x}(t.x),t.y=function(e){return t._shot_alive?e:_._y}(t.y),t.x>_CANVAS.width){t._init();continue}let i=_CANVAS_IMGS.shot1.obj;_CONTEXT.drawImage(i,t.x,t.y,i.width,i.height),t._shot_alive=!0}}}class GameObject_SHOTS_DOUBLE extends GameObject_SHOTS{constructor(e){super(e),this.shots=new Array,this.speed=30;for(let e=0;e<2;e++)this.shots.push({sid:_SHOTTYPE_DOUBLE,x:0,y:0,_enemyid:null,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._enemyid=null,this._shot_alive=!1}})}enemy_collision(e){let _=this;if(!_.player.isalive())return;let t=function(){let e=null;for(let t=0;t<_.shots.length;t++){let s=_.shots[t];if(0!==t){if(s[t]!==e)return!1}else e=s._enemyid}return!0}();for(let s=0;s<_.shots.length;s++){let i=_.shots[s],n=_GAME.isShotCollision(i,e);if(i._enemyid=e.id,n&&e.isalive()){if(i._init(),t)continue;e.collision(i)}}}map_collition(e){let _=_MAP.getMapX(e.x),t=_MAP.getMapY(e.y);(_MAP.isMapCollision(_,t)||_MAP.isMapCollision(_+1,t))&&e._init()}move(){let e=this.player;if(!e.isalive())return;if(!e.isshotflag())return;let _=e.getPlayerCenterPosition(),t=this.shots[0]._shot|this.shots[1]._shot,s=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(t||s){t&&!s&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let e=0;e<this.shots.length;e++){let t=this.shots[e];if(!t._shot_alive)continue;if(t.x=function(e){return s?e+30:_._x}(t.x),t.y=function(t){return 0===e?s?t:_._y:s?t-23:_._y-23}(t.y),this.shots[0].x>_CANVAS.width){this.shots[0]._init();continue}if(this.shots[1].y<0||this.shots[1].x>_CANVAS.width){this.shots[1]._init();continue}let i=0===e?_CANVAS_IMGS.shot1.obj:_CANVAS_IMGS.shot2.obj;_CONTEXT.drawImage(i,t.x,t.y,i.width,i.height),t._shot_alive=!0}}}}class GameObject_SHOTS_TAILGUN extends GameObject_SHOTS_DOUBLE{constructor(e){super(e)}move(){let e=this.player;if(!e.isalive())return;if(!e.isshotflag())return;let _=e.getPlayerCenterPosition(),t=this.shots[0]._shot|this.shots[1]._shot,s=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(t||s){t&&!s&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let e=0;e<this.shots.length;e++){let t=this.shots[e];if(!t._shot_alive)continue;if(t.x=function(t){return 0===e?s?t+30:_._x:s?t-30:_._x}(t.x),t.y=function(e){return s?e:_._y}(t.y),this.shots[0].x>_CANVAS.width){this.shots[0]._init();continue}if(this.shots[1].x<0){this.shots[1]._init();continue}let i=0===e?_CANVAS_IMGS.shot1.obj:_CANVAS_IMGS.shot3.obj;_CONTEXT.drawImage(i,t.x,t.y,i.width,i.height),t._shot_alive=!0}}}}class GameObject_SHOTS_RIPPLE_LASER extends GameObject_SHOTS{constructor(e){super(e),this.shots=new Array,this.speed=30,this.lineWidth=5,this.strokeStyle="rgba(50,80,255,1)";for(let e=0;e<2;e++)this.shots.push({sid:_SHOTTYPE_LASER,x:0,y:0,_t:0,_shot:!1,_shot_alive:!1,_width:0,_height:0,_init:function(){this.x=0,this.y=0,this._t=0,this._shot=!1,this._shot_alive=!1,this._width=0,this._height=0}})}enemy_collision(e){if(this.player.isalive())for(let _=0;_<this.shots.length;_++){let t=this.shots[_];if(!t._shot_alive)continue;let s=e.getEnemyCenterPosition();Math.abs(s._x-t.x)<e.img.width/2+t._width/2+_MAP.t&&Math.abs(s._y-t.y)<e.img.height/2+t._height/2+_MAP.t&&e.isalive()&&(e.collision(t),t._init())}}map_collition(e){let _=_MAP.getMapX(e.x),t=_MAP.getMapY(e.y);(_MAP.isMapCollision(_,t)||_MAP.isMapCollision(_+1,t))&&e._init()}move(){let e=this,_=e.player;if(!_.isalive())return;if(!_.isshotflag())return;let t=_.getPlayerCenterPosition();for(let _=0;_<e.shots.length;_++){let s=e.shots[_];if(!s._shot&&!s._shot_alive)continue;let i=e.speed;s.x=function(e){return s._shot_alive?e+i:t._x}(s.x),s.y=function(e){return s._shot_alive?e:t._y}(s.y),s.x>_CANVAS.width?s._init():(s._t=s._t<20?s._t+1:s._t,s._width=.5+s._t,s._height=8+s._t*s._t/6,_CONTEXT.beginPath(),_CONTEXT.lineWidth=e.lineWidth,_CONTEXT.strokeStyle=e.strokeStyle,_CONTEXT.ellipse(s.x,s.y,s._width,s._height,0,0,2*Math.PI),_CONTEXT.stroke(),s._shot_alive=!0)}}}class GameObject_SHOTS_RIPPLE_LASER_RED extends GameObject_SHOTS_RIPPLE_LASER{constructor(e){super(e),this.strokeStyle="rgba(255,80,50,1)"}}class GameObject_SHOTS_LASER extends GameObject_SHOTS{constructor(e){super(e),this.shots=new Array,this.speed=50,this.lineWidth=3,this.strokeStyle="rgba(50,80,255,1)",this.strokeStyle_u="rgba(120,150,255,1)";for(let e=0;e<1;e++)this.shots.push({sid:_SHOTTYPE_LASER,x:0,y:0,_c:0,laser_time:500,_sx:0,_enemy:null,_laser_t:0,_laser_ts:0,_laser_MaxX:_CANVAS.width,_l_x:0,_l_y:0,_l_sx:0,_l_sy:0,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._c=0,this._laser_t=0,this._laser_ts=0,this._sx=0,this._enemy=null,this._l_x=0,this._l_y=0,this._l_sx=0,this._l_sy=0,this._laser_MaxX=_CANVAS.width,this._shot=!1,this._shot_alive=!1}})}enemy_collision(e){if(this.player.isalive())for(let _=0;_<this.shots.length;_++){if(e.x<this.player.x)continue;let t=this.shots[_],s={x:t._l_sx,y:t._l_y},i={x:t._l_x,y:t._l_y},n={x:t._l_sx,y:t._l_y+1},a=(t._l_x,t._l_y,{x:e.x,y:e.y}),o={x:e.x+e.img.width,y:e.y},r={x:e.x,y:e.y+e.img.height};e.x,e.img.width,e.y,e.img.height;(s.y>=a.y-10&&n.y<=r.y+10)&s.x<=o.x-5&i.x>=a.x+5?(e.collision(t),e.isalive()?(this.setLaserMaxX(a.x+e.img.width/2),t._enemy=e.id):this.setLaserMaxX(_CANVAS.width)):null===t._enemy||t._enemy===e.id&&this.setLaserMaxX(_CANVAS.width)}}map_collition(e){if(!e._shot_alive)return;let _=this.player.getPlayerCenterPosition(),t=_MAP.getMapX(e.x+_._x),s=_MAP.getMapY(e.y);return _MAP.isMapCollision(t-1,s)?e.x<_MAP.t?(e.x=0,void this.setLaserMaxX(_._x)):void this.setLaserMaxX(e.x+_._x-_MAP.t):_MAP.isMapCollision(t,s)?e.x<_MAP.t?(e.x=0,void this.setLaserMaxX(_._x)):void this.setLaserMaxX(e.x+_._x-_MAP.t):void this.setLaserMaxX(_CANVAS.width)}setLaserLine(e,_,t,s,i){e._l_x=_,e._l_y=t,e._l_sx=s,e._l_sy=i}setLaserMaxX(e){for(let _=0;_<this.shots.length;_++)this.shots[_]._laser_MaxX=e}move(){let e=this,_=e.player;if(!_.isalive())return;if(!_.isshotflag())return;let t=_.getPlayerCenterPosition();_CONTEXT.beginPath(),_CONTEXT.lineWidth=this.lineWidth,_CONTEXT.strokeStyle=this.strokeStyle,_CONTEXT.lineCap="round";for(let _=0;_<this.shots.length;_++){let s=e.shots[_];(s._shot||s._shot_alive)&&(s.x=function(_){return _>=s._laser_MaxX-t._x?(s._laser_t+=1e3/60,s._laser_MaxX-t._x):_+e.speed}(s.x),s._sx=function(_){return s._shot?s._laser_t<=s.laser_time-200?_:(s._laser_ts+=1e3/60,s._laser_ts>s.laser_time-200?(s._init(),0):_>=s.x?s.x:_+=e.speed):_>=s.x?(s._init(),0):_+=e.speed}(s._sx),s.y=t._y,_CONTEXT.beginPath(),_CONTEXT.strokeStyle=this.strokeStyle_u,_CONTEXT.moveTo(t._x+s._sx,t._y+1),_CONTEXT.lineTo(t._x+s.x,t._y+1),_CONTEXT.stroke(),_CONTEXT.beginPath(),_CONTEXT.strokeStyle=this.strokeStyle,_CONTEXT.moveTo(t._x+s._sx,t._y),_CONTEXT.lineTo(t._x+s.x,t._y),_CONTEXT.stroke(),this.setLaserLine(s,t._x+s.x,t._y,t._x+s._sx,t._y),s.x>0&&(s._shot_alive=!0))}}}class GameObject_SHOTS_LASER_CYCLONE extends GameObject_SHOTS_LASER{constructor(e){super(e),this.lineWidth=5,this.strokeStyle="rgba(255,80,50,1)",this.strokeStyle_u="rgba(255,200,150,1)"}}class GameObject_PM{constructor(e,_,t){let s=this;this.img=_CANVAS_IMGS[e].obj,this.x=_CANVAS.width/2-this.img.width/2,this.y=_CANVAS.height-30,this.meterdef_status="111111",this.meterdef_current="000000",this.meterdef={n_32:{imgobj:new Image,name:"meter_c_speedup",func:function(){_PLAYERS_MAIN.accel>=6?s._set_meter_status():_PLAYERS_MAIN.accel++}},n_16:{imgobj:new Image,name:"meter_c_missile",func:function(){_PLAYERS_MISSILE_ISALIVE=!0,s._set_meter_status()}},n_8:{imgobj:new Image,name:"meter_c_double",func:function(){_SHOTTYPE=_SHOTTYPE_DOUBLE,s._set_meter_status()}},n_4:{imgobj:new Image,name:"meter_c_laser",func:function(){_SHOTTYPE=_SHOTTYPE_LASER,s._set_meter_status()}},n_2:{imgobj:new Image,name:"meter_c_option",func:function(){_PLAYERS_OPTION[_PLAYERS_OPTION_ISALIVE].settruealive(),++_PLAYERS_OPTION_ISALIVE<4||s._set_meter_status()}},n_1:{imgobj:new Image,name:"meter_c_shield",func:function(){_PLAYERS_MAIN_FORCE.init(),s._set_meter_status()}}},this._c_pms=0,this.pms_img=_CANVAS_IMGS_INIT.gradius_powermeterselect.obj,this.pms_selected=[{_y:89,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_0.obj},{_y:162,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_1.obj},{_y:233,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_2.obj},{_y:306,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_3.obj}],this._c_pmss=0,this.pmss_selected=[{_x:470,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_shield_0.obj},{_x:570,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_shield_1.obj}]}init(){for(let e in this.meterdef)this.meterdef[e].imgobj=_CANVAS_IMGS[this.meterdef[e].name].obj}_set_current_reset(){this.meterdef_current="000000"}_set_meter_status(){let e=this.meterdef_status,_=(~parseInt(this.meterdef_current,2)>>>0).toString(2).slice(-6);this.meterdef_status=this._get_bit((parseInt(e,2)&parseInt(_,2)).toString(2));let t=parseInt(this.meterdef_current,2);8!==t&&4!==t||(this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(8===t?"000100":"001000",2)).toString(2)))}_set_meter_on(e){this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(e,2)).toString(2))}_get_bit(e){return("000000"+e).slice(-6)}_get_meter_current(e){return 0===parseInt(e,2)||1===parseInt(e,2)?"100000":("000000"+(parseInt(e,2)>>1).toString(2)).slice(-6)}move(){this.meterdef_current=this._get_meter_current(this.meterdef_current)}playerset(){let e=parseInt(this.meterdef_current,2),_=parseInt(this.meterdef_status,2);0!==e&&0!=(e&_)&&(_PLAYERS_MAIN.set_equipped(),this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(this.meterdef_current,2)).toString(2)),this.meterdef["n_"+e].func(),this._set_current_reset())}show(){_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height);for(let e=0;e<this.meterdef_status.length;e++){if("0"!==this.meterdef_status[e])continue;let _=_CANVAS_IMGS.meter_blank.obj;_CONTEXT.drawImage(_,this.x+_.width*e,this.y,_.width,_.height)}let e=parseInt(this.meterdef_current,2);if(0===e)return;let _=0!=(e&parseInt(this.meterdef_status,2))?this.meterdef["n_"+e].imgobj:_CANVAS_IMGS.meter_c_blank.obj;_CONTEXT.drawImage(_,this.x+_.width*this.meterdef_current.indexOf("1"),this.y,_.width,_.height)}pms_disp(){let e="power meter select";_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_DRAW_DISP_TXT(e,_CANVAS.width/2-35*e.length/2,20,.3),_DRAW_DISP_TXT("shield select",_CANVAS.width/2-35*e.length/2,400,.15),_CONTEXT.drawImage(this.pms_img,_CANVAS.width/2-this.pms_img.width/2,70,this.pms_img.width,this.pms_img.height);let _=_CANVAS_IMGS_INIT.gradius_powermeterselect_shield_.obj;_CONTEXT.drawImage(_,_CANVAS.width/2-this.pms_img.width/2,430,_.width,_.height);let t=_CANVAS_IMGS_INIT.gradius_powermeterselect_shield.obj;_CONTEXT.drawImage(t,470,390,t.width,t.height)}pms_select(){let e=this.pms_selected[this._c_pms]._img;_CONTEXT.drawImage(e,_CANVAS.width/2-this.pms_img.width/2,this.pms_selected[this._c_pms]._y,e.width,e.height),e=this.pmss_selected[this._c_pmss]._img,_CONTEXT.drawImage(e,this.pmss_selected[this._c_pmss]._x,390,e.width,e.height)}}class GameObject_STAGESELECT{constructor(){this.x=0,this.y=0,this.speed=100,this.mapdef_status=0,this.mapdef=_MAPDEFS[this.mapdef_status]}get_ajaxdata(e,_){_.mapdef=e[_.mapdef_status],_ISDEBUG||_.disp_thumb_map()}init(){this.mapdef=_MAPDEFS[0],_ISDEBUG?this.mapdef=_MAPDEFS[_MAP_PETTERN]:this.disp_thumb_map()}set_map_status(){this.mapdef=_MAPDEFS[this.mapdef_status]}disp_thumb_map(){let e=this;_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_DRAW_DISP_TXT("stage select",_CANVAS.width/2-35*"stage select".length/2,20,.3);let _=500-20*(_MAPDEFS.length-1);for(let e=0;e<_MAPDEFS.length;e++)_CONTEXT.beginPath(),_CONTEXT.lineWidth=1,_CONTEXT.strokeStyle="rgba(255,255,255,1)",_CONTEXT.fillStyle="rgba(255,255,255,1)",e===this.mapdef_status?_CONTEXT.fillRect(_+20*e,85,10,10):_CONTEXT.strokeRect(_+20*e,85,10,10);let t=e.mapdef;_MAP.showMapForStageselect(t),_CONTEXT.beginPath(),_CONTEXT.lineWidth=1,_CONTEXT.strokeStyle="rgba(255,255,255,1)",_CONTEXT.fillStyle="rgba(255,255,255,1)",_CONTEXT.strokeRect(50,130,300,200),_DRAW_DISP_TXT("stage title",400,130,.2),_CONTEXT.moveTo(400,160),_CONTEXT.lineTo(950,160),_CONTEXT.stroke(),_CONTEXT.font="20px sans-serif";let s=_GAME._multilineText(_CONTEXT,this.mapdef._title,550);for(let e=0;e<(s.length>2?2:s.length);e++)_CONTEXT.fillText(s[e],400,190+26*e);_DRAW_DISP_TXT("difficult:"+this.mapdef._difficult,400,250,.2),_CONTEXT.moveTo(400,290),_CONTEXT.lineTo(950,290),_CONTEXT.stroke(),_DRAW_DISP_TXT("detail",400,320,.2),_CONTEXT.moveTo(400,360),_CONTEXT.lineTo(950,360),_CONTEXT.stroke(),s=_GAME._multilineText(_CONTEXT,this.mapdef._body,550);for(let e=0;e<(s.length>4?4:s.length);e++)_CONTEXT.fillText(s[e],400,390+30*e)}}class GameObject_SCORE{constructor(){this.score1p=0,this.score2p=0,this.def_scorehi=57300,this.scorehi=this.def_scorehi}init(){this.score1p=0,this.score2p=0}set(e){this.score1p+=e,this.scorehi>=this.score1p||(this.scorehi=this.score1p)}show(){let e="1p"+("        "+this.score1p).slice(-8);for(let _=0;_<e.length;_++){if(" "===e[_])continue;let t=_CANVAS_IMGS_INIT["font_"+e[_]].obj;_CONTEXT.drawImage(t,180+.15*t.width*_,10,.15*t.width,.15*t.height)}e="hi"+("        "+this.scorehi).slice(-8);for(let _=0;_<e.length;_++){if(" "===e[_])continue;let t=_CANVAS_IMGS_INIT["font_"+e[_]].obj;_CONTEXT.drawImage(t,400+.15*t.width*_,10,.15*t.width,.15*t.height)}e="2p"+("        "+this.score2p).slice(-8);for(let _=0;_<e.length;_++){if(" "===e[_])continue;let t=_CANVAS_IMGS_INIT["font_"+e[_]].obj;_CONTEXT.drawImage(t,620+.15*t.width*_,10,.15*t.width,.15*t.height)}}}class GameObject_POWERCAPSELL{constructor(e,_){this.x=e||0,this.y=_||0,this.getscore=300,this.gotpc=!1,this._c_pc_ani=0,this.pc_ani=[{img:_CANVAS_IMGS.pc1.obj,scale:.6},{img:_CANVAS_IMGS.pc2.obj,scale:.6},{img:_CANVAS_IMGS.pc3.obj,scale:.6},{img:_CANVAS_IMGS.pc4.obj,scale:.6},{img:_CANVAS_IMGS.pc5.obj,scale:.6}],this.img=this.pc_ani[0].img}getPCCenterPosition(){return{_x:this.x+this.img.width/2,_y:this.y+this.img.height/2}}getPowerCapcell(){this.gotpc=!0}move(){let e=this;if(e.gotpc)return;e.x-=_BACKGROUND_SPEED;let _=(e._c_pc_ani=e._c_pc_ani>=5*e.pc_ani.length-1?0:e._c_pc_ani+1,e.pc_ani[parseInt(e._c_pc_ani/5)].img);_CONTEXT.drawImage(_,e.x,e.y,_.width,_.height)}}class GameObject_BACKGROUND{constructor(){this.x=_CANVAS.width*Math.random(),this.y=_CANVAS.height*Math.random(),this.rgba="rgba("+parseInt(255*Math.random())+","+parseInt(255*Math.random())+","+parseInt(255*Math.random())+","+Math.random()+")",this.speed=5*Math.random()}init(){let e=Math.random()+.5;this.width=e,this.height=e}move(){let e=this;this.x=function(_){return 0===_BACKGROUND_SPEED?_:_<0?_CANVAS.width:_-e.speed}(this.x),_CONTEXT.beginPath(),_CONTEXT.arc(this.x,this.y,2,0,2*Math.PI,!0),_CONTEXT.fillStyle=this.rgba,_CONTEXT.fill()}}const _IS_GET_POWERCAPSELL=function(){for(let e=0;e<_POWERCAPSELLS.length;e++){let _=_POWERCAPSELLS[e];if(_.gotpc)continue;let t=_PLAYERS_MAIN.getPlayerCenterPosition(),s=_.getPCCenterPosition();Math.sqrt(Math.pow(s._x-t._x,2)+Math.pow(s._y-t._y,2))<Math.sqrt(Math.pow(_PLAYERS_MAIN.img.width,2)+Math.pow(_PLAYERS_MAIN.img.height,2))/2?(_POWERMETER.move(),_.getPowerCapcell(),_SCORE.set(300)):_.move()}},_IS_ENEMIES_COLLISION=function(){if(!_PLAYERS_MAIN.isalive())return;let e=_ENEMIES;e.sort(function(e,_){return e.x<_.x?-1:e.x>_.x?1:0});for(let _=0;_<e.length;_++){if(!e[_].isalive())continue;if(!e[_].isshow())continue;if(e[_].x>_CANVAS.width-50)continue;let t=e[_];for(let e=0;e<_PLAYERS_SHOTS[_SHOTTYPE].length;e++)_PLAYERS_SHOTS[_SHOTTYPE][e].enemy_collision(t);if(_PLAYERS_MAIN.enemy_collision(t),_PLAYERS_MAIN_FORCE.enemy_collision(t),_PLAYERS_MISSILE_ISALIVE)for(let e=0;e<_PLAYERS_MISSILE.length;e++){let _=_PLAYERS_MISSILE[e];if(_.player.isalive())for(let e=0;e<_.shots.length;e++){let s=_.shots[e];_.enemy_collision(t,s)}}}},_IS_ENEMIES_SHOT_COLLISION=function(){if(!_PLAYERS_MAIN.isalive())return;for(let e=0;e<_ENEMIES_SHOTS.length;e++){let _=_ENEMIES_SHOTS[e];_._shot_alive&&(_PLAYERS_MAIN.enemy_shot_collision(_),_PLAYERS_MAIN_FORCE.enemy_shot_collision(_))}},_DRAW=function(){_KEYEVENT_MASTER.addKeydownGame(),_KEYEVENT_MASTER.addKeyupGame();_DRAW_SETINTERVAL=setInterval(function(){_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);for(let e=0;e<70;e++)_BACKGROUND[e].move();for(let e=0;e<_ENEMIES_SHOTS.length;e++)_ENEMIES_SHOTS[e].move();for(let e=0;e<_ENEMIES.length;e++)void 0!==_ENEMIES[e]&&_ENEMIES[e].move();_IS_GET_POWERCAPSELL();for(let e=0;e<5;e++)_PLAYERS_MISSILE_ISALIVE&&_PLAYERS_MISSILE[e].move(),_PLAYERS_SHOTS[_SHOTTYPE][e].move();_MAP.isPlayersShotCollision();for(let e=0;e<4;e++)_PLAYERS_OPTION[e].move(10*(e+1));_PLAYERS_MAIN_FORCE.move(_PLAYERS_MAIN),_PLAYERS_MAIN.move(),_MAP.move(),_IS_ENEMIES_SHOT_COLLISION(),_IS_ENEMIES_COLLISION(),_POWERMETER.show(),_SCORE.show(),(_SCROLL_POSITION+=_BACKGROUND_SPEED)-100<=_MAP.mapdef[0].length*_MAP.t+_MAP.initx||_DRAW_MATCH_BOSS()},1e3/60)},_DRAW_MATCH_BOSS=function(){if(!_DRAW_IS_MATCH_BOSS){let e=new ENEMY_BOSS_BOGCORE(1300,200);return(_ENEMIES=[]).push(e),_ENEMIES_SHOTS=[],_ENEMIES_BOUNDS=[],_DRAW_SCROLL_STOP(),void(_DRAW_IS_MATCH_BOSS=!0)}let e="";for(let _=0;_<_ENEMIES.length;_++)e+=_ENEMIES[_].isalive()?"0":"1";-1===e.indexOf("0")&&(_DRAW_SCROLL_RESUME(),_DRAW_IS_MATCH_BOSS_COUNT>100?_DRAW_GAMECLEAR():_DRAW_IS_MATCH_BOSS_COUNT++)},_DRAW_STOP=function(){clearInterval(_DRAW_SETINTERVAL),_DRAW_SETINTERVAL=null},_DRAW_GAMESTART=function(){if(_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_ISDEBUG)return void _DRAW();let e=0;_DRAW_GAMESTART_SETINTERVAL=setInterval(function(){if(e>250)return clearInterval(_DRAW_GAMESTART_SETINTERVAL),_DRAW_GAMESTART_SETINTERVAL=null,void _DRAW();_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);for(let e=0;e<70;e++)_BACKGROUND[e].move();if(_POWERMETER.show(),_SCORE.show(),parseInt(e/50)%2!=0);else{for(let e=0;e<"start".length;e++){var _=_CANVAS_IMGS_INIT["font_"+"start"[e]].obj,t=_CANVAS.width/2-.5*_.width*"start".length/2,s=_CANVAS.height/2-_.height/2;_CONTEXT.drawImage(_,t+.5*_.width*e,s,.5*_.width,.5*_.height)}}e++},1e3/60)},_DRAW_GAMECLEAR=function(){var e=_CANVAS_IMGS_INIT.font_0.obj;let _="gameclear";_DRAW_DISP_TXT(_,_CANVAS.width/2-.5*e.width*_.length/2,_CANVAS.height/2-e.height/2,.5),_DRAW_DISP_TXT(_="press r to restart",_CANVAS.width/2-.15*e.width*_.length/2,_CANVAS.height/2+30,.15),_DRAW_DISP_TXT(_="press s to change another stage",_CANVAS.width/2-.15*e.width*_.length/2,_CANVAS.height/2+60,.15),_DRAW_IS_GAMECLEAR=!0},_DRAW_GAMEOVER=function(){_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_KEYEVENT_MASTER.addKeydownGameover(),_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);for(let e=0;e<70;e++)_BACKGROUND[e].move();_SCORE.show();var e=_CANVAS_IMGS_INIT.font_0.obj;let _="gameover";_DRAW_DISP_TXT(_,_CANVAS.width/2-.5*e.width*_.length/2,_CANVAS.height/2-e.height/2,.5),_DRAW_DISP_TXT(_="press r to restart",_CANVAS.width/2-.15*e.width*_.length/2,_CANVAS.height/2+30,.15),_DRAW_DISP_TXT(_="press s to change another stage",_CANVAS.width/2-.15*e.width*_.length/2,_CANVAS.height/2+60,.15)},_DRAW_DISP_TXT=function(e,_,t,s){s=s||1;for(let n=0;n<e.length;n++)if(" "!==e[n]){var i=_CANVAS_IMGS_INIT["font_"+e[n]].obj;_CONTEXT.drawImage(i,_+i.width*s*n,t,i.width*s,i.height*s)}},_DRAW_SCROLL_STOP=function(){_BACKGROUND_SPEED=0},_DRAW_SCROLL_RESUME=function(){_BACKGROUND_SPEED=_MAP.getBackGroundSpeed()},_DRAW_RESET_OBJECT=function(){_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_KEYEVENT_MASTER.removeKeydownGameover(),clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_DRAW_STOP(),_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_PLAYERS_MAIN="",_PLAYERS_MAIN_FORCE="",_PLAYERS_OPTION=[],_PLAYERS_OPTION_ISALIVE=0,_PLAYERS_SHOTS={_SHOTTYPE_NORMAL:[],_SHOTTYPE_DOUBLE:[],_SHOTTYPE_LASER:[]},_PLAYERS_MISSILE=[],_PLAYERS_MISSILE_ISALIVE=!1,_PLAYERS_MOVE_DRAW=[],_ENEMIES=[],_ENEMIES_BOUNDS=[],_ENEMIES_SHOTS=[],_POWERMETER="",_SHOTTYPE=_SHOTTYPE_NORMAL,_POWERCAPSELLS=[],_SCROLL_POSITION=0,_BACKGROUND_SPEED=1,_DRAW_IS_MATCH_BOSS=!1,_DRAW_IS_MATCH_BOSS_COUNT=0},_DRAW_INIT_OBJECT=function(){_KEYEVENT_MASTER.removeKeydownSelectPowermeter(),_PLAYERS_MAIN=0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?new GameObject_PLAYER_MAIN:new GameObject_PLAYER_MAIN_RED,_PLAYERS_SHOTS._SHOTTYPE_NORMAL.push(new GameObject_SHOTS_NORMAL(_PLAYERS_MAIN)),_PLAYERS_SHOTS._SHOTTYPE_DOUBLE.push(function(e){return 0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?new GameObject_SHOTS_DOUBLE(e):new GameObject_SHOTS_TAILGUN(e)}(_PLAYERS_MAIN)),_PLAYERS_SHOTS._SHOTTYPE_LASER.push(function(e){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER(e):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER_CYCLONE(e):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER(e):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER_RED(e):void 0}(_PLAYERS_MAIN)),_PLAYERS_MISSILE.push(function(e){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE(e):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_SPREADBOMB(e):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_PHOTOM(e):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_2WAY(e):void 0}(_PLAYERS_MAIN)),_PLAYERS_MAIN_FORCE=0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?1===_PLAYERS_POWER_METER_SHIELD?new GameObject_FORCEFIELD:new GameObject_SHIELD:1===_PLAYERS_POWER_METER_SHIELD?new GameObject_FORCEFIELD_RED:new GameObject_SHIELD_RED;for(let e=0;e<4;e++)_PLAYERS_OPTION.push(new GameObject_PLAYER_OPTION("option",110,70*(e+1),!1)),_PLAYERS_SHOTS._SHOTTYPE_NORMAL.push(new GameObject_SHOTS_NORMAL(_PLAYERS_OPTION[e])),_PLAYERS_SHOTS._SHOTTYPE_DOUBLE.push(function(e){return 0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?new GameObject_SHOTS_DOUBLE(e):new GameObject_SHOTS_TAILGUN(e)}(_PLAYERS_OPTION[e])),_PLAYERS_SHOTS._SHOTTYPE_LASER.push(function(e){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER(e):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER_CYCLONE(e):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER(e):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER_RED(e):void 0}(_PLAYERS_OPTION[e])),_PLAYERS_MISSILE.push(function(e){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE(e):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_SPREADBOMB(e):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_PHOTOM(e):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_2WAY(e):void 0}(_PLAYERS_OPTION[e]));(_POWERMETER=new GameObject_PM("meter")).init(),_DRAW_IS_GAMECLEAR||_SCORE.init(),_DRAW_IS_GAMECLEAR=!1;for(let e=0;e<70;e++)_BACKGROUND[e]=new GameObject_BACKGROUND,_BACKGROUND[e].init();_MAP.init_stage_map(),_MAP.init_enemies_location(),_DRAW_GAMESTART()},_DRAW_POWER_METER_SELECT=function(){clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_KEYEVENT_MASTER.removeKeydownSelectStage(),_KEYEVENT_MASTER.addKeydownSelectPowermeter(),(_POWERMETER=new GameObject_PM("meter")).pms_disp(),_POWERMETER.pms_select()},_DRAW_STAGE_SELECT=function(){clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);let e=document.querySelector("#game_start_wrapper"),_=document.querySelector("#game_wrapper");e.classList.remove("on"),_.classList.add("on"),_KEYEVENT_MASTER.removeKeydownStart(),_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_KEYEVENT_MASTER.removeKeydownGameover(),_KEYEVENT_MASTER.addKeydownSelectStage(),_MAP.init(function(){(_STAGESELECT=new GameObject_STAGESELECT).init()})},_DRAW_INIT=function(e,_){let t=0;for(let s in e){let i=e[s];i.obj.src=e[s].src,i.obj.onload=function(){i.obj.width*=i.rate,i.obj.height*=i.rate,++t>=Object.keys(e).length&&_()}}},_GAME={_init:function(){_SCORE=new GameObject_SCORE,(_MAP=new GameObject_MAP).init(_GAME._showGameStart)},_ac:{_get:function(e,_,t){return e>=_.length*t-1?0:e+1}},getBit:(e,_)=>("0".repeat(_)+e).slice(-1*_),getOrBit(e,_,t){let s=(parseInt(e,2)|parseInt(_,2)).toString(2);return this.getBit(s,t)},isEnemyCanvasOut(e){let _=e.getEnemyCenterPosition();return _._x<-100||_._x>_CANVAS.width+100||_._y<-100||_._y>_CANVAS.height+100},isCollision:function(e,_){if(!e.isalive())return!1;if(!_.isalive())return!1;let t=e.getPlayerCenterPosition(),s=_.getEnemyCenterPosition();return Math.sqrt(Math.pow(s._x-t._x,2)+Math.pow(s._y-t._y,2))<_.img.height/2+e.height/2},isShieldCollision:function(e,_){if(!e.isalive())return!1;if(!_.isalive())return!1;let t=e.getPlayerCenterPosition(),s=_.getEnemyCenterPosition();return Math.sqrt(Math.pow(s._x-t._x,2)+Math.pow(s._y-t._y,2))<_.img.height/2+e.height/2},isMisShotCollision:function(e,_){let t=_.getEnemyCenterPosition(),s={_x:e.x+e._img.width/2,_y:e.y+e._img.height/2};return Math.sqrt(Math.pow(t._x-s._x,2)+Math.pow(t._y-s._y,2))<_.img.height/2+e._img.height/2},isShotCollision:function(e,_){let t=_.getEnemyCenterPosition();return Math.sqrt(Math.pow(t._x-e.x,2)+Math.pow(t._y-e.y,2))<_.img.height},_showGameStart:function(){if(_ISSP&&_SP_CONTROLLER._set_obj(),_ISDEBUG)return document.querySelector("#game_wrapper").classList.add("on"),(_STAGESELECT=new GameObject_STAGESELECT).init(),_MAP.set_stage_map_pattern(_MAP_PETTERN),void _DRAW_INIT(_CANVAS_IMGS,_DRAW_POWER_METER_SELECT);_KEYEVENT_MASTER.addKeydownStart(),document.querySelector("#game_start_wrapper").classList.add("on"),_GAME._setTextToFont(document.querySelector("#game_start>.title"),"no pakuri",50),_GAME._setTextToFont(document.querySelector("#game_start>.text"),"press s to start",30),_GAME._setTextToFont(document.querySelector("#game_start>.text_loading"),"now loading",30)},_setTextToFont:function(e,_,t){if(void 0===e||null===e)return;t=t||30;let s="";for(let e=0;e<_.length;e++)" "!==_[e]?s+='<img src="./images/gradius_font_'+_[e]+'.png" width="'+t+'">':s+='<img src="./images/gradius_spacer.png" width="'+t+'">';e.innerHTML=s},_multilineText(e,_,t){let s=_.length,i=[],n="";if(s<1)return i;for(let a=0;a<s;a++){let s=_.charAt(a);"\n"!==s?e.measureText(n+s).width<=t?n+=s:(i.push(n),n=s):(i.push(n),n="")}return n.length>0&&i.push(n),i}};window.addEventListener("load",function(){_CANVAS=document.getElementById("game"),_CONTEXT=_CANVAS.getContext("2d"),_ISSP&&document.querySelector("body").classList.add("sp"),_DRAW_INIT(_CANVAS_IMGS_INIT,_GAME._init)}),window.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1});