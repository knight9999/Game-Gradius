"use strict";const _CANVAS_IMGS={vicviper1:{src:"images/gradius_vicviper1.png",rate:.26,obj:new Image},vicviper2:{src:"images/gradius_vicviper2.png",rate:.26,obj:new Image},vicviper3:{src:"images/gradius_vicviper3.png",rate:.26,obj:new Image},vicviper4:{src:"images/gradius_vicviper4.png",rate:.26,obj:new Image},vicviper5:{src:"images/gradius_vicviper5.png",rate:.26,obj:new Image},vicviper1_e:{src:"images/gradius_vicviper1_e.png",rate:.26,obj:new Image},vicviper2_e:{src:"images/gradius_vicviper2_e.png",rate:.26,obj:new Image},vicviper3_e:{src:"images/gradius_vicviper3_e.png",rate:.26,obj:new Image},vicviper4_e:{src:"images/gradius_vicviper4_e.png",rate:.26,obj:new Image},vicviper5_e:{src:"images/gradius_vicviper5_e.png",rate:.26,obj:new Image},vicviper_back1:{src:"images/gradius_vicviper_back1.png",rate:.26,obj:new Image},vicviper_back2:{src:"images/gradius_vicviper_back2.png",rate:.26,obj:new Image},vicviper_back3:{src:"images/gradius_vicviper_back3.png",rate:.26,obj:new Image},vicviper_back1_e:{src:"images/gradius_vicviper_back1_e.png",rate:.26,obj:new Image},vicviper_bomb:{src:"images/gradius_vicviper_bomb.png",rate:1,obj:new Image},vicviper_bomb_red:{src:"images/gradius_vicviper_bomb_red.png",rate:1,obj:new Image},option:{src:"images/option.png",rate:.3,obj:new Image},missile1:{src:"images/missile1.png",rate:.48,obj:new Image},missile2:{src:"images/missile2.png",rate:.48,obj:new Image},missile3:{src:"images/missile3.png",rate:.48,obj:new Image},missile4:{src:"images/missile4.png",rate:.48,obj:new Image},missile5:{src:"images/missile5.png",rate:.48,obj:new Image},missile6:{src:"images/missile6.png",rate:.48,obj:new Image},missile7:{src:"images/missile7.png",rate:.48,obj:new Image},missile8:{src:"images/missile8.png",rate:.48,obj:new Image},shot1:{src:"images/gradius_shot1.png",rate:.4,obj:new Image},shot2:{src:"images/gradius_shot2.png",rate:.4,obj:new Image},shot3:{src:"images/gradius_shot3.png",rate:.4,obj:new Image},shot_laser_col1:{src:"images/gradius_shot_laser_col1.png",rate:.4,obj:new Image},shot_laser_col2:{src:"images/gradius_shot_laser_col2.png",rate:.4,obj:new Image},shot_laser_col3:{src:"images/gradius_shot_laser_col3.png",rate:.4,obj:new Image},shot_laser_col4:{src:"images/gradius_shot_laser_col4.png",rate:.4,obj:new Image},meter:{src:"images/gradius_meter.png",rate:.5,obj:new Image},meter_c_speedup:{src:"images/gradius_meter_c_speedup.png",rate:.5,obj:new Image},meter_c_missile:{src:"images/gradius_meter_c_missile.png",rate:.5,obj:new Image},meter_c_double:{src:"images/gradius_meter_c_double.png",rate:.5,obj:new Image},meter_c_laser:{src:"images/gradius_meter_c_laser.png",rate:.5,obj:new Image},meter_c_option:{src:"images/gradius_meter_c_option.png",rate:.5,obj:new Image},meter_c_shield:{src:"images/gradius_meter_c_shield.png",rate:.5,obj:new Image},meter_blank:{src:"images/gradius_meter_blank.png",rate:.5,obj:new Image},meter_c_blank:{src:"images/gradius_meter_c_blank.png",rate:.5,obj:new Image},forcefield1:{src:"images/gradius_forcefield1.png",rate:1,obj:new Image},forcefield2:{src:"images/gradius_forcefield2.png",rate:1,obj:new Image},forcefield_red1:{src:"images/gradius_forcefield_red1.png",rate:1,obj:new Image},forcefield_red2:{src:"images/gradius_forcefield_red2.png",rate:1,obj:new Image},shield1:{src:"images/gradius_shield1.png",rate:.4,obj:new Image},shield2:{src:"images/gradius_shield2.png",rate:.4,obj:new Image},shield_red1:{src:"images/gradius_shield_red1.png",rate:.4,obj:new Image},shield_red2:{src:"images/gradius_shield_red2.png",rate:.4,obj:new Image},enemy_a_1:{src:"images/gradius_enemy_a_1.png",rate:.55,obj:new Image},enemy_a_2:{src:"images/gradius_enemy_a_2.png",rate:.55,obj:new Image},enemy_b_1:{src:"images/gradius_enemy_b_1.png",rate:.55,obj:new Image},enemy_b_2:{src:"images/gradius_enemy_b_2.png",rate:.55,obj:new Image},enemy_c_1:{src:"images/gradius_enemy_c_1.png",rate:.4,obj:new Image},enemy_c_2:{src:"images/gradius_enemy_c_2.png",rate:.4,obj:new Image},enemy_c_3:{src:"images/gradius_enemy_c_3.png",rate:.4,obj:new Image},enemy_c_4:{src:"images/gradius_enemy_c_4.png",rate:.4,obj:new Image},enemy_d_1:{src:"images/gradius_enemy_d_1.png",rate:.2,obj:new Image},enemy_d_2:{src:"images/gradius_enemy_d_2.png",rate:.2,obj:new Image},enemy_d_3:{src:"images/gradius_enemy_d_3.png",rate:.2,obj:new Image},enemy_d_4:{src:"images/gradius_enemy_d_4.png",rate:.2,obj:new Image},enemy_e_1:{src:"images/gradius_enemy_e_1.png",rate:.2,obj:new Image},enemy_e_2:{src:"images/gradius_enemy_e_2.png",rate:.2,obj:new Image},enemy_e_3:{src:"images/gradius_enemy_e_3.png",rate:.2,obj:new Image},enemy_e_4:{src:"images/gradius_enemy_e_4.png",rate:.2,obj:new Image},enemy_f_1:{src:"images/gradius_enemy_f_1.png",rate:.4,obj:new Image},enemy_f_2:{src:"images/gradius_enemy_f_2.png",rate:.4,obj:new Image},enemy_f_3:{src:"images/gradius_enemy_f_3.png",rate:.4,obj:new Image},enemy_f_4:{src:"images/gradius_enemy_f_4.png",rate:.4,obj:new Image},enemy_g_1:{src:"images/gradius_enemy_g_1.png",rate:.4,obj:new Image},enemy_g_2:{src:"images/gradius_enemy_g_2.png",rate:.4,obj:new Image},enemy_g_3:{src:"images/gradius_enemy_g_3.png",rate:.4,obj:new Image},enemy_g_4:{src:"images/gradius_enemy_g_4.png",rate:.4,obj:new Image},enemy_m_1:{src:"images/gradius_enemy_m_1.png",rate:.24,obj:new Image},enemy_m_2:{src:"images/gradius_enemy_m_2.png",rate:.24,obj:new Image},enemy_m_3:{src:"images/gradius_enemy_m_3.png",rate:.24,obj:new Image},enemy_m_4:{src:"images/gradius_enemy_m_4.png",rate:.24,obj:new Image},enemy_m_5:{src:"images/gradius_enemy_m_5.png",rate:.24,obj:new Image},enemy_m_6:{src:"images/gradius_enemy_m_6.png",rate:.24,obj:new Image},enemy_m_7:{src:"images/gradius_enemy_m_7.png",rate:.24,obj:new Image},enemy_m_8:{src:"images/gradius_enemy_m_8.png",rate:.24,obj:new Image},enemy_m_11:{src:"images/gradius_enemy_m_11.png",rate:.22,obj:new Image},enemy_m_12:{src:"images/gradius_enemy_m_12.png",rate:.22,obj:new Image},enemy_m_13:{src:"images/gradius_enemy_m_13.png",rate:.22,obj:new Image},enemy_m_14:{src:"images/gradius_enemy_m_14.png",rate:.22,obj:new Image},enemy_m_15:{src:"images/gradius_enemy_m_15.png",rate:.22,obj:new Image},enemy_m_16:{src:"images/gradius_enemy_m_16.png",rate:.22,obj:new Image},enemy_m_17:{src:"images/gradius_enemy_m_17.png",rate:.22,obj:new Image},enemy_o_1:{src:"images/gradius_enemy_o_1.png",rate:.3,obj:new Image},enemy_o_2:{src:"images/gradius_enemy_o_2.png",rate:.3,obj:new Image},enemy_p_1:{src:"images/gradius_enemy_p_1.png",rate:.23,obj:new Image},enemy_p_2:{src:"images/gradius_enemy_p_2.png",rate:.3,obj:new Image},enemy_p_3:{src:"images/gradius_enemy_p_3.png",rate:.3,obj:new Image},enemy_p_4:{src:"images/gradius_enemy_p_4.png",rate:.3,obj:new Image},enemy_p_5:{src:"images/gradius_enemy_p_5.png",rate:.3,obj:new Image},enemy_m_a_1:{src:"images/gradius_enemy_m_a_1.png",rate:.25,obj:new Image},enemy_m_a_2:{src:"images/gradius_enemy_m_a_2.png",rate:.25,obj:new Image},enemy_m_b_1:{src:"images/gradius_enemy_m_b_1.png",rate:.25,obj:new Image},enemy_m_b_2:{src:"images/gradius_enemy_m_b_2.png",rate:.25,obj:new Image},enemy_m_z:{src:"images/gradius_enemy_m_z.png",rate:.25,obj:new Image},enemy_m_y_1:{src:"images/gradius_enemy_m_y_1.png",rate:.5,obj:new Image},enemy_m_y_2:{src:"images/gradius_enemy_m_y_2.png",rate:.5,obj:new Image},enemy_z:{src:"images/gradius_enemy_z_core.png",rate:.6,obj:new Image},enemy_z_1:{src:"images/gradius_enemy_z_core_1.png",rate:.6,obj:new Image},enemy_z_2:{src:"images/gradius_enemy_z_core_2.png",rate:.6,obj:new Image},enemy_z_3:{src:"images/gradius_enemy_z_core_3.png",rate:.6,obj:new Image},enemy_z_4_1:{src:"images/gradius_enemy_z_core_4_1.png",rate:.6,obj:new Image},enemy_z_4_2:{src:"images/gradius_enemy_z_core_4_2.png",rate:.6,obj:new Image},enemy_z_4_3:{src:"images/gradius_enemy_z_core_4_3.png",rate:.6,obj:new Image},enemy_z_4_4:{src:"images/gradius_enemy_z_core_4_4.png",rate:.6,obj:new Image},enemy_z_4_5:{src:"images/gradius_enemy_z_core_4_5.png",rate:.6,obj:new Image},enemy_collapes1:{src:"images/gradius_enemy_collapes1.png",rate:1,obj:new Image},enemy_collapes2:{src:"images/gradius_enemy_collapes2.png",rate:1,obj:new Image},enemy_collapes11:{src:"images/gradius_enemy_collapes11.png",rate:.2,obj:new Image},enemy_collapes12:{src:"images/gradius_enemy_collapes12.png",rate:.2,obj:new Image},enemy_collapes13:{src:"images/gradius_enemy_collapes13.png",rate:.2,obj:new Image},enemy_collapes21:{src:"images/gradius_enemy_collapes21.png",rate:.22,obj:new Image},enemy_collapes22:{src:"images/gradius_enemy_collapes22.png",rate:.22,obj:new Image},enemy_collapes23:{src:"images/gradius_enemy_collapes23.png",rate:.22,obj:new Image},enemy_collapes24:{src:"images/gradius_enemy_collapes24.png",rate:.22,obj:new Image},enemy_collapes81:{src:"images/gradius_enemy_collapes81.png",rate:.2,obj:new Image},enemy_collapes82:{src:"images/gradius_enemy_collapes82.png",rate:.2,obj:new Image},enemy_collapes83:{src:"images/gradius_enemy_collapes83.png",rate:.2,obj:new Image},enemy_collapes84:{src:"images/gradius_enemy_collapes84.png",rate:.2,obj:new Image},enemy_collapes91:{src:"images/gradius_enemy_collapes91.png",rate:.2,obj:new Image},enemy_collapes92:{src:"images/gradius_enemy_collapes92.png",rate:.2,obj:new Image},enemy_collapes93:{src:"images/gradius_enemy_collapes93.png",rate:.2,obj:new Image},enemy_collapes94:{src:"images/gradius_enemy_collapes94.png",rate:.2,obj:new Image},enemy_collapes95:{src:"images/gradius_enemy_collapes95.png",rate:.2,obj:new Image},enemy_collapes96:{src:"images/gradius_enemy_collapes96.png",rate:.2,obj:new Image},enemy_bullet1:{src:"images/gradius_enemy_bullet1.png",rate:.8,obj:new Image},enemy_bullet2:{src:"images/gradius_enemy_bullet2.png",rate:.8,obj:new Image},enemy_bullet_z:{src:"images/gradius_enemy_bullet_z.png",rate:.2,obj:new Image},pc1:{src:"images/gradius_pc1.png",rate:.5,obj:new Image},pc2:{src:"images/gradius_pc2.png",rate:.5,obj:new Image},pc3:{src:"images/gradius_pc3.png",rate:.5,obj:new Image},pc4:{src:"images/gradius_pc4.png",rate:.5,obj:new Image},pc5:{src:"images/gradius_pc5.png",rate:.5,obj:new Image},map_c_A:{src:"images/gradius_map_c_A.png",rate:1,obj:new Image},map_m_A:{src:"images/gradius_map_m_A.png",rate:.5,obj:new Image},map_m_B:{src:"images/gradius_map_m_B.png",rate:.5,obj:new Image},map_f_A:{src:"images/gradius_map_f_A.png",rate:1,obj:new Image},map_f_B:{src:"images/gradius_map_f_B.png",rate:1,obj:new Image},map_f_C:{src:"images/gradius_map_f_C.png",rate:1,obj:new Image},map_f_D:{src:"images/gradius_map_f_D.png",rate:1,obj:new Image},map_f_E:{src:"images/gradius_map_f_E.png",rate:1,obj:new Image},map_f_F:{src:"images/gradius_map_f_F.png",rate:1,obj:new Image},map_f_G:{src:"images/gradius_map_f_G.png",rate:1,obj:new Image},map_f_H:{src:"images/gradius_map_f_H.png",rate:1,obj:new Image},map_f_I:{src:"images/gradius_map_f_I.png",rate:1,obj:new Image},map_f_J:{src:"images/gradius_map_f_J.png",rate:1,obj:new Image},map_f_K:{src:"images/gradius_map_f_K.png",rate:1,obj:new Image},map_f_L:{src:"images/gradius_map_f_L.png",rate:1,obj:new Image},map_f_M:{src:"images/gradius_map_f_M.png",rate:1,obj:new Image},map_f_N:{src:"images/gradius_map_f_N.png",rate:1,obj:new Image},map_f_O:{src:"images/gradius_map_f_O.png",rate:1,obj:new Image},map_f_P:{src:"images/gradius_map_f_P.png",rate:1,obj:new Image}},_CANVAS_IMGS_INIT={font_0:{src:"images/gradius_font_0.png",rate:1,obj:new Image},font_1:{src:"images/gradius_font_1.png",rate:1,obj:new Image},font_2:{src:"images/gradius_font_2.png",rate:1,obj:new Image},font_3:{src:"images/gradius_font_3.png",rate:1,obj:new Image},font_4:{src:"images/gradius_font_4.png",rate:1,obj:new Image},font_5:{src:"images/gradius_font_5.png",rate:1,obj:new Image},font_6:{src:"images/gradius_font_6.png",rate:1,obj:new Image},font_7:{src:"images/gradius_font_7.png",rate:1,obj:new Image},font_8:{src:"images/gradius_font_8.png",rate:1,obj:new Image},font_9:{src:"images/gradius_font_9.png",rate:1,obj:new Image},font_a:{src:"images/gradius_font_a.png",rate:1,obj:new Image},font_b:{src:"images/gradius_font_b.png",rate:1,obj:new Image},font_c:{src:"images/gradius_font_c.png",rate:1,obj:new Image},font_d:{src:"images/gradius_font_d.png",rate:1,obj:new Image},font_e:{src:"images/gradius_font_e.png",rate:1,obj:new Image},font_f:{src:"images/gradius_font_f.png",rate:1,obj:new Image},font_g:{src:"images/gradius_font_g.png",rate:1,obj:new Image},font_h:{src:"images/gradius_font_h.png",rate:1,obj:new Image},font_i:{src:"images/gradius_font_i.png",rate:1,obj:new Image},font_j:{src:"images/gradius_font_j.png",rate:1,obj:new Image},font_k:{src:"images/gradius_font_k.png",rate:1,obj:new Image},font_l:{src:"images/gradius_font_l.png",rate:1,obj:new Image},font_m:{src:"images/gradius_font_m.png",rate:1,obj:new Image},font_n:{src:"images/gradius_font_n.png",rate:1,obj:new Image},font_o:{src:"images/gradius_font_o.png",rate:1,obj:new Image},font_p:{src:"images/gradius_font_p.png",rate:1,obj:new Image},font_q:{src:"images/gradius_font_q.png",rate:1,obj:new Image},font_r:{src:"images/gradius_font_r.png",rate:1,obj:new Image},font_s:{src:"images/gradius_font_s.png",rate:1,obj:new Image},font_t:{src:"images/gradius_font_t.png",rate:1,obj:new Image},font_u:{src:"images/gradius_font_u.png",rate:1,obj:new Image},font_v:{src:"images/gradius_font_v.png",rate:1,obj:new Image},font_w:{src:"images/gradius_font_w.png",rate:1,obj:new Image},font_x:{src:"images/gradius_font_x.png",rate:1,obj:new Image},font_y:{src:"images/gradius_font_y.png",rate:1,obj:new Image},font_z:{src:"images/gradius_font_z.png",rate:1,obj:new Image},"font_:":{src:"images/gradius_font_27.png",rate:1,obj:new Image},gradius_powermeterselect:{src:"images/gradius_powermeterselect.png",rate:.28,obj:new Image},gradius_powermeterselect_shield:{src:"images/gradius_powermeterselect_shield.png",rate:.28,obj:new Image},gradius_powermeterselect_shield_:{src:"images/gradius_powermeterselect_shield_.png",rate:.28,obj:new Image},gradius_powermeterselect_0:{src:"images/gradius_powermeterselect_0.png",rate:.28,obj:new Image},gradius_powermeterselect_1:{src:"images/gradius_powermeterselect_1.png",rate:.28,obj:new Image},gradius_powermeterselect_2:{src:"images/gradius_powermeterselect_2.png",rate:.28,obj:new Image},gradius_powermeterselect_3:{src:"images/gradius_powermeterselect_3.png",rate:.28,obj:new Image},gradius_powermeterselect_shield_0:{src:"images/gradius_powermeterselect_shield_0.png",rate:.28,obj:new Image},gradius_powermeterselect_shield_1:{src:"images/gradius_powermeterselect_shield_1.png",rate:.28,obj:new Image}},_DEF_DIFFICULT=[{_ENEMY_SHOT_RATE:1e-4,_ENEMY_SHOT_SPEED:1,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:5e-4,_ENEMY_SHOT_SPEED:2,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.001,_ENEMY_SHOT_SPEED:2,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.004,_ENEMY_SHOT_SPEED:3,_ENEMY_SPEED:1},{_ENEMY_SHOT_RATE:.1,_ENEMY_SHOT_SPEED:4,_ENEMY_SPEED:2}];let _ENEMY_DIFFICULT=0;const _ENEMY_DEF_ANI_COL={t0:{intv:5,imgs:[{img:_CANVAS_IMGS.enemy_collapes1.obj,scale:.3},{img:_CANVAS_IMGS.enemy_collapes2.obj,scale:.3},{img:_CANVAS_IMGS.enemy_collapes2.obj,scale:.3},{img:_CANVAS_IMGS.enemy_collapes2.obj,scale:.2},{img:_CANVAS_IMGS.enemy_collapes2.obj,scale:.2}]},t1:{intv:5,imgs:[{img:_CANVAS_IMGS.enemy_collapes12.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes13.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes13.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes12.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes11.obj,scale:1}]},t2:{intv:5,imgs:[{img:_CANVAS_IMGS.enemy_collapes21.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes22.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes23.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes24.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes23.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes22.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes21.obj,scale:1}]},t8:{intv:5,imgs:[{img:_CANVAS_IMGS.enemy_collapes81.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes82.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes83.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes84.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes83.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes82.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes81.obj,scale:1}]},t9:{intv:5,imgs:[{img:_CANVAS_IMGS.enemy_collapes91.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes92.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes93.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes94.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes95.obj,scale:1},{img:_CANVAS_IMGS.enemy_collapes96.obj,scale:1}]}};class GameObject_ENEMY{constructor(_,e,t){let s=this;s.id=_ENEMIES.length,s.bid=_ENEMIES_BOUNDS.length,s.gid=0,s.img=_,s.x=e||0,s.y=t||0,s.isshot=!1,s._DEF_DIR={_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},s.speed=1,s.getscore=200,s._status=2,s._isshow=!0,s.direct="up",s.haspc=!1,s.showedpc=!1,s.col_ani_c=0,s.col_imgs=_ENEMY_DEF_ANI_COL.t0.imgs,s.col_intv=_ENEMY_DEF_ANI_COL.t0.intv,s._col_pc_c=0,s.col_pc=[{img:_CANVAS_IMGS.pc1.obj,scale:.6},{img:_CANVAS_IMGS.pc2.obj,scale:.6},{img:_CANVAS_IMGS.pc3.obj,scale:.5},{img:_CANVAS_IMGS.pc4.obj,scale:.3},{img:_CANVAS_IMGS.pc5.obj,scale:.1}],s.shotColMap=["0,0,"+s.img.width+","+s.img.height],s.col_date=new Date,s.col_canint=100}init(){_ENEMIES=new Array}ani_col(_,e){let t=this;if(t.x-=_BACKGROUND_SPEED,_=_||0,e=e||0,t.col_ani_c>=t.col_imgs.length*t.col_intv-1)return;let s=t.col_imgs[parseInt(t.col_ani_c/t.col_intv)];_CONTEXT.drawImage(s.img,t.x+_,t.y+e,s.img.width*s.scale,s.img.height*s.scale),t.col_ani_c++}collision(_){this._status-=1,this.isalive()||_SCORE.set(this.getscore)}getEnemyCenterPosition(){return{_x:this.x+this.img.width/2,_y:this.y+this.img.height/2}}getstatus(){return this._status}isCollision(){let _=this;return new Date-_.col_date>_.col_canint&&(_.col_date=new Date,!0)}isalive(){return this._status>0}isshow(){return this._isshow}shot(){_GAME.isEnemyCanvasOut(this)||Math.random()>=_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SHOT_RATE||_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(this.getEnemyCenterPosition()._x,this.getEnemyCenterPosition()._y))}move_bounds(_){let e=this,t=_ENEMIES_BOUNDS;if(e.isalive()&&!(e.x>_CANVAS.width))for(let _=0;_<t.length;_++)t[_].isalive()&&(t[_].x>_CANVAS.width||e.bid!==t[_].bid&&Math.sqrt(Math.pow(e.getEnemyCenterPosition()._x-t[_].getEnemyCenterPosition()._x,2)+Math.pow(e.getEnemyCenterPosition()._y-t[_].getEnemyCenterPosition()._y,2))<e.img.width/2&&(e.speedx=Math.random()*(Math.random()>.05)?1:-1,e.speedy=Math.random()*(Math.random()>.5)?1:-1,t[_].speedx=Math.random()*(Math.random()>.05)?1:-1,t[_].speedy=Math.random()*(Math.random()>.5)?1:-1))}setDrawImage(){let _=this;_CONTEXT.save(),_.direct===_._DEF_DIR._U&&_CONTEXT.setTransform(1,0,0,-1,0,2*_.y+_.img.height),_.direct===_._DEF_DIR._LU&&_CONTEXT.setTransform(-1,0,0,-1,2*_.x+_.img.width,2*_.y+_.img.height),_.direct===_._DEF_DIR._LD&&_CONTEXT.setTransform(-1,0,0,1,2*_.x+_.img.width,0),_CONTEXT.drawImage(_.img,_.x,_.y,_.img.width,_.img.height),_CONTEXT.restore()}showCollapes(_,e){let t=this;if(t.haspc){if(t.showedpc)return;return _POWERCAPSELLS.push(new GameObject_POWERCAPSELL(t.x,t.y)),void(t.showedpc=!0)}t.ani_col(_,e)}move(){let _=this;_.x+_.img.width<0?_.init():_._status<=0?_.showCollapes():(_.x-=_BACKGROUND_SPEED,_CONTEXT.drawImage(_.img,_.x,_.y,_.img.width,_.img.height),_.shot())}}class ENEMY_a extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_a_1.obj,_,e);let s=this;s._status=1,s.direct=t||s._DEF_DIR._U,s.defimg=[_CANVAS_IMGS.enemy_a_1.obj,_CANVAS_IMGS.enemy_a_2.obj],s.col_imgs=_ENEMY_DEF_ANI_COL.t2.imgs,s.col_intv=_ENEMY_DEF_ANI_COL.t2.intv}setDrawImage(){let _=this;_CONTEXT.save(),_.img=Math.abs(_PLAYERS_MAIN.y-_.y)>100?_.defimg[0]:_.defimg[1],_.direct===_._DEF_DIR._U&&(_PLAYERS_MAIN.x<_.x?_CONTEXT.setTransform(1,0,0,-1,0,2*_.y+_.img.height):_CONTEXT.setTransform(-1,0,0,-1,2*_.x+_.img.width,2*_.y+_.img.height)),_.direct===_._DEF_DIR._D&&(_PLAYERS_MAIN.x<_.x?_CONTEXT.setTransform(1,0,0,1,0,0):_CONTEXT.setTransform(-1,0,0,1,2*_.x+_.img.width,0)),_CONTEXT.drawImage(_.img,_.x,_.y,_.img.width,_.img.height),_CONTEXT.restore()}move(){let _=this;_.x+_.img.width<0?_._status=0:_._status<=0?_.showCollapes():(_.x-=_BACKGROUND_SPEED,_.setDrawImage(),_.shot())}}class ENEMY_b extends ENEMY_a{constructor(_,e,t){super(_,e,t);let s=this;s.direct=t||s._DEF_DIR._U,s.haspc=!0,s.defimg=[_CANVAS_IMGS.enemy_b_1.obj,_CANVAS_IMGS.enemy_b_2.obj]}}class ENEMY_c extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_c_1.obj,_,e);let s=this;s.x=_,s.y=t===s._DEF_DIR._D?e-(_CANVAS_IMGS.enemy_c_1.obj.height-_MAP.t):e,s._st="_st1",s._shot=!1,s._status=2,s.direct=t||s._DEF_DIR._U,s.col_imgs=_ENEMY_DEF_ANI_COL.t1.imgs,s.col_intv=_ENEMY_DEF_ANI_COL.t1.intv,s.speed=_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SPEED,s._c_shotstep=0,s.shotstep=[{img:_CANVAS_IMGS.enemy_c_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_4.obj,scale:1}],s._c_walkstep=0,s.walkstep=[{img:_CANVAS_IMGS.enemy_c_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_c_2.obj,scale:1}],s._c_walk=0;s._ene_status={_st1:function(){!0!==s._shot&&(s._c_walkstep=19===s._c_walkstep?0:s._c_walkstep+1,s.img=s.walkstep[parseInt(s._c_walkstep/10)].img,s._c_walk++)},_st2:function(){if(!(s.x>=_CANVAS.width)){if(s._shot=!0,s._c_shotstep>=19)return s.shot(),s._c_shotstep=0,s._shot=!1,void(s._st="_st1");s._c_shotstep+=1,s.img=s.img=s.shotstep[parseInt(s._c_shotstep/10)].img}}}}map_collition(){let _=this,e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);_MAP.isMapBefore(t,s)&&(_.speed=Math.abs(_.speed)),_MAP.isMapLastSide(t,s)&&(_.speed=-1*_.speed);let i=_MAP.t;i=2*Math.abs(_.speed);let n=_MAP.isMapCollision(t+1,s)||_MAP.isMapCollision(t-1,s);_.y=function(e){return e.direct===_._DEF_DIR._U?n?e.y+i:e.y:e.direct===_._DEF_DIR._D?n?e.y-i:e.y:void 0}(_),_.y=function(e){return e.direct===_._DEF_DIR._U?_MAP.isMapCollision(t,s-1)?e.y:e.y-i:e.direct===_._DEF_DIR._D?_MAP.isMapCollision(t,s+1)?e.y:e.y+i:void 0}(_)}setDrawImage(){let _=this;_CONTEXT.save(),_.direct===_._DEF_DIR._U&&(_PLAYERS_MAIN.x<_.x?_CONTEXT.setTransform(1,0,0,-1,0,2*_.y+_.img.height):_CONTEXT.setTransform(-1,0,0,-1,2*_.x+_.img.width,2*_.y+_.img.height)),_.direct===_._DEF_DIR._D&&(_PLAYERS_MAIN.x<_.x?_CONTEXT.setTransform(1,0,0,1,0,0):_CONTEXT.setTransform(-1,0,0,1,2*_.x+_.img.width,0)),_CONTEXT.drawImage(_.img,_.x,_.y,_.img.width,_.img.height),_CONTEXT.restore()}set_speed(){let _=_PLAYERS_MAIN.getPlayerCenterPosition();this._c_walk>5e3*Math.random()&&(this._c_walk=0,this.speed=_._x<this.x?-1*(this.speed+_BACKGROUND_SPEED):Math.abs(this.speed))}shot(){let _=this;if(_GAME.isEnemyCanvasOut(_))return;let e=_PLAYERS_MAIN.getPlayerCenterPosition(),t=_.getEnemyCenterPosition(),s=e._x>t._x?1:-1,i=_.direct===_._DEF_DIR._U?1:-1;_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT2(t._x,t._y,s,i)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT2(t._x,t._y,s,i/2))}move(){let _=this;_.x>_CANVAS.width?_.x-=_MAPDEFS[_MAP_PETTERN]._speed:_.x<-100?_._status=0:_._status<=0?_.showCollapes():(_.map_collition(),_.set_speed(),_._st=Math.random()<_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SHOT_RATE||_._shot?"_st2":"_st1",_._ene_status[_._st](),_.x=function(e){return"_st1"===e._st?e.x+_.speed-_BACKGROUND_SPEED:"_st2"===e._st?e.x-_BACKGROUND_SPEED:void 0}(_),_.setDrawImage())}}class ENEMY_d extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_d_1.obj,_,e);let s=this;s._status=1,s._col_c=0,s.col=[{img:_CANVAS_IMGS.enemy_d_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_4.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_d_2.obj,scale:1}],s.col_imgs=_ENEMY_DEF_ANI_COL.t0.imgs,s.col_intv=_ENEMY_DEF_ANI_COL.t0.intv}move(){let _=this;if(_.x+_.img.width<0)return void(_._status=0);if(_._status<=0)return void _.showCollapes();_.x-=_.x>_CANVAS.width?_MAPDEFS[_MAP_PETTERN]._speed:5*_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SPEED;let e=.5*_SCROLL_POSITION,t=2*Math.cos(e*Math.PI/180);_.y+=t,_.img=function(_){return _._col_c=_._col_c>=5*_.col.length-1?0:_._col_c+1,_.col[parseInt(_._col_c/5)].img}(_),_CONTEXT.drawImage(_.img,_.x,_.y,_.img.width,_.img.height),_.shot()}}class ENEMY_e extends ENEMY_d{constructor(_,e,t){super(_,e,t);let s=this;s.haspc=!0,s._col_c=0,s.col=[{img:_CANVAS_IMGS.enemy_e_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_4.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_e_2.obj,scale:1}],s.defimg=s.col}}class ENEMY_f extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_f_1.obj,_,e);let s=this;s._status=1,s.haspc=!1,s._v=0,s._isshow=!1,s.direct=t||s._DEF_DIR._U,s.speed=t===s._DEF_DIR._U?-.05:.05,s._col_c=0,s.col=[{img:_CANVAS_IMGS.enemy_f_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_f_4.obj,scale:1}],s.col_imgs=_ENEMY_DEF_ANI_COL.t2.imgs,s.col_intv=_ENEMY_DEF_ANI_COL.t2.intv}getDir(){return this.x>_CANVAS.width/2?-1:.5}shot(){let _=this;if(_GAME.isEnemyCanvasOut(_))return;let e=_.getEnemyCenterPosition();_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(e._x,e._y,1,e._y)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(e._x,e._y,e._x-_CANVAS.width/4,1)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(e._x,e._y,e._x,1)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(e._x,e._y,e._x+_CANVAS.width/4,1)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(e._x,e._y,_CANVAS.width,e._y)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(e._x,e._y,e._x+_CANVAS.width/4,_CANVAS.height)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(e._x,e._y,e._x,_CANVAS.height)),_ENEMIES_SHOTS.push(new GameObject_ENEMY_SHOT(e._x,e._y,e._x-_CANVAS.width/4,_CANVAS.height))}move(){let _=this;if(_._status<=0)return void _.showCollapes();if(_.x<0-_.img.width&&(_._isshow=!0),!_._isshow)return void(_.x-=_BACKGROUND_SPEED);_GAME.isEnemyCanvasOut(_)&&(_._status=0),_.x+=2*_BACKGROUND_SPEED*_.getDir(),_.y+=_._v,_._v+=_.speed;let e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);_MAP.isMapCollision(t,s)&&(_._v+=_.speed,_._v*=-1),_.img=function(_){return _._col_c=_._col_c>=5*_.col.length-1?0:_._col_c+1,_.col[parseInt(_._col_c/5)].img}(_),_.setDrawImage(),_._v>0&&_._v<.05&&_.shot()}}class ENEMY_g extends ENEMY_f{constructor(_,e,t){super(_,e,t);let s=this;s._status=1,s.haspc=!0,s.col=[{img:_CANVAS_IMGS.enemy_g_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_g_4.obj,scale:1}]}}class ENEMY_m extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_m_1.obj,_,e);let s=this;s._status=4,s.direct=t||s._DEF_DIR._U,s.getscore=200,s._col_c=0,s._isopen=!1,s._open_count=0,s.col=[{img:_CANVAS_IMGS.enemy_m_1.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_4.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_3.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_2.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_1.obj,scale:1}],s.col2=[{img:_CANVAS_IMGS.enemy_m_5.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_6.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_7.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_8.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_7.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_6.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_5.obj,scale:1}],s.col_imgs=_ENEMY_DEF_ANI_COL.t1.imgs,s.col_intv=_ENEMY_DEF_ANI_COL.t1.intv}move(){let _=this;_.x+_.img.width<0?_._status=0:_._status<=0?_.showCollapes(0,_.direct===_._DEF_DIR._U?0:-_MAP.t):(_.x-=_BACKGROUND_SPEED,_.img=function(e){let t=e._status<=1?e.col2:e.col;return e._isopen?(e._open_count++,3===parseInt(e._col_c/5)&&e._open_count<=200?t[parseInt(e._col_c/5)].img:(e._open_count>200&&e._col_c>=5*t.length-1&&(e._col_c=0,e._open_count=0,e._isopen=!1),e._col_c=e._col_c>=5*t.length-1?0:e._col_c+1,t[parseInt(e._col_c/5)].img)):(_.x>=690&&_.x<700&&(_._isopen=!0),_.x>=380&&_.x<400&&(_._isopen=!0),t[0].img)}(_),function(e){if(!e._isopen)return;if(e._open_count%15!=0)return;let t=new ENEMY_m_small(_.x+15,_.y,_.direct);_ENEMIES.push(t)}(_),_.setDrawImage())}}class ENEMY_m_small extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_m_11.obj,_,e);let s=this;s._status=1,s.direct=t||s._DEF_DIR._U,s.getscore=100,s._col_c=0,s.col=[{img:_CANVAS_IMGS.enemy_m_11.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_12.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_13.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_14.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_15.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_16.obj,scale:1},{img:_CANVAS_IMGS.enemy_m_17.obj,scale:1}],s.col_imgs=_ENEMY_DEF_ANI_COL.t2.imgs,s.col_intv=_ENEMY_DEF_ANI_COL.t2.intv,s._change=!1,s._moveX=0,s._moveY=0}move(){let _=this;if(_._status<=0)return void _.showCollapes();_GAME.isEnemyCanvasOut(_)&&(_._status=0);let e=_PLAYERS_MAIN.getPlayerCenterPosition();_._change=!!_._change||(_.direct===_._DEF_DIR._U&&e._y<_.y?(_._moveX=e._x<_.x?-3*_BACKGROUND_SPEED:3*_BACKGROUND_SPEED,!0):_.direct===_._DEF_DIR._D&&e._y>_.y?(_._moveX=e._x<_.x?-3*_BACKGROUND_SPEED:3*_BACKGROUND_SPEED,!0):(_._moveX=-1*_BACKGROUND_SPEED,!1)),_._moveY=_._change?0:_.direct===_._DEF_DIR._U?2:_.direct===_._DEF_DIR._D?-2:void 0,_.x+=_._moveX,_.y+=_._moveY,_.x+_.img.width<0?_._status=0:(_.img=function(_){return _._col_c=_._col_c>=5*_.col.length-1?0:_._col_c+1,_.col[parseInt(_._col_c/5)].img}(_),_CONTEXT.drawImage(_.img,_.x,_.y,_.img.width,_.img.height),_.shot())}}class ENEMY_n extends GameObject_ENEMY{constructor(_,e){super(_CANVAS_IMGS.enemy_o_1.obj,_,e)}move(){let _=this;if(_.x+_.img.width<200)return void(_._status=0);if(_.x-=_BACKGROUND_SPEED,Math.random()>.2)return;let e=new ENEMY_n_small(_CANVAS_IMGS[["enemy_o_1","enemy_o_2"][Math.random()>.5?1:0]].obj,_.x,_.y);_ENEMIES.push(e)}}class ENEMY_o extends GameObject_ENEMY{constructor(_,e){super(_CANVAS_IMGS.enemy_o_1.obj,_,e)}move(){let _=this;if(_.x+_.img.width<200)return void(_._status=0);if(_.x-=_BACKGROUND_SPEED,Math.random()>.2)return;let e=new ENEMY_o_small(_CANVAS_IMGS[["enemy_o_1","enemy_o_2"][Math.random()>.5?1:0]].obj,_.x,_.y);_ENEMIES.push(e)}}class ENEMY_o_small extends GameObject_ENEMY{constructor(_,e,t){super(_,e,t);let s=this;s._status=1,s.getscore=100,s.speedX=8*Math.random()+2,s.flagX=Math.random()>.5?1:-1,s.speedY=Math.random()/1e3,s._v=parseInt(5*Math.random())-10,s.col_imgs=_ENEMY_DEF_ANI_COL.t2.imgs,s.col_intv=_ENEMY_DEF_ANI_COL.t2.intv}map_collition(){let _=this,e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);_MAP.isMapCollision(t,s-1)&&(_._status=0)}move(){let _=this;_GAME.isEnemyCanvasOut(_)?_._status=0:_.isalive()?(_.map_collition(),_.x-=_BACKGROUND_SPEED+_.speedX*_.flagX,_.y+=_._v,_._v+=_.speedY,_CONTEXT.drawImage(_.img,_.x,_.y,_.img.width,_.img.height)):_.showCollapes()}}class ENEMY_n_small extends ENEMY_o_small{constructor(_,e,t){super(_,e,t),this._v=parseInt(5*Math.random())+10}map_collition(){let _=this,e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);_MAP.isMapCollision(t,s+1)&&(_._status=0)}move(){let _=this;_GAME.isEnemyCanvasOut(_)?_._status=0:_.isalive()?(_.map_collition(),_.x-=_BACKGROUND_SPEED+_.speedX*_.flagX,_.y+=_._v,_._v-=_.speedY,_CONTEXT.drawImage(_.img,_.x,_.y,_.img.width,_.img.height)):_.showCollapes()}}class ENEMY_p extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_p_1.obj,_,e),this._status=6,this.getscore=100,this.speedx=_BACKGROUND_SPEED,this.speedy=(Math.random()+1)*(Math.random()>.5?1:-1),this._isbroken=!1,this.isshot=!1}collision(_){let e=this;e.isCollision()&&(e._status--,e.isalive()||_SCORE.set(e.getscore))}map_collition(){let _=this,e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);(_MAP.isMapCollision(t,s-1)||_MAP.isMapCollision(t,s+1))&&(_.speedx=Math.random()>.4?Math.abs(_.speedx):-1*_.speedx,_.speedy=Math.random()>.4?Math.abs(_.speedy):-1*_.speedy)}move(){let _=this;if(_.map_collition(),_.move_bounds(),_.x-=function(_){return _.x+_.img.width>_CANVAS.width&&(_.speedx=Math.abs(_.speedx)),_.speedx}(_),_.y+=function(_){return _.y<0?_.speedy=Math.abs(_.speedy):_.y+_.img.height>_CANVAS.height&&(_.speedy*=-1),_.speedy}(_),_.x+_.img.width<0)return void(_._status=0);let e=_.getEnemyCenterPosition();if(this._status<=0&&!this._isbroken){for(let _=0;_<6;_++){let t=new ENEMY_p_small(_CANVAS_IMGS[["enemy_p_2","enemy_p_2","enemy_p_3","enemy_p_4","enemy_p_5","enemy_p_5"][_]].obj,e._x+[-60,-30,-10,10,30,60][_],e._y+[-60,-30,-10,10,30,60][_]);_ENEMIES.push(t),_ENEMIES_BOUNDS.push(t)}this._isbroken=!0}else this._status>0&&_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height)}}class ENEMY_p_small extends GameObject_ENEMY{constructor(_,e,t){super(_,e,t);let s=this;s._status=6,s.getscore=500,s.speedx=_MAPDEFS[_MAP_PETTERN]._speed*(Math.random()>.5?1:-1),s.speedy=_MAPDEFS[_MAP_PETTERN]._speed*(Math.random()>.5?1:-1),s.col_imgs=_ENEMY_DEF_ANI_COL.t1.imgs,s.col_intv=_ENEMY_DEF_ANI_COL.t1.intv}collision(_){let e=this;e.isCollision()&&(e._status--,e.isalive()||_SCORE.set(e.getscore))}map_collition(){let _=this,e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);(_MAP.isMapCollision(t,s-1)||_MAP.isMapCollision(t,s+4))&&(_.speedx=_.speedx<=0?Math.abs(_.speedx):-1*_.speedx,_.speedy=_.speedy<=0?Math.abs(_.speedy):-1*_.speedy)}move(){let _=this;if(_.x+_.img.width<0)return void(_._status=0);if(_._status<=0)return void _.showCollapes();_.map_collition(),_.move_bounds();_.getEnemyCenterPosition();_.x-=function(_){return _.x+_.img.width>_CANVAS.width&&(_.speedx=1.5),_.speedx}(_),_.y+=function(_){return _.y<0?_.speedy=Math.abs(_.speedy):_.y+_.img.height>_CANVAS.height&&(_.speedy*=-1),_.speedy}(_),_CONTEXT.drawImage(_.img,_.x,_.y,_.img.width,_.img.height)}}class ENEMY_q extends GameObject_ENEMY{constructor(_,e,t){super(_CANVAS_IMGS.enemy_m_a_1.obj,_,e);let s=this;s._status=4,s.direct=t||s._DEF_DIR._U,s.getscore=500,s._isSetMapDefCol=!1,s._isopen=!1,s._open_count=0,s.imgs=[_CANVAS_IMGS.enemy_m_a_1.obj,_CANVAS_IMGS.enemy_m_a_2.obj],s.col_imgs=_ENEMY_DEF_ANI_COL.t8.imgs,s.col_intv=_ENEMY_DEF_ANI_COL.t8.intv,s._shot_count=-200,s.shotColMap=[s.direct===s._DEF_DIR._D?"0,50,45,85":s.direct===s._DEF_DIR._U?"0,25,45,60":s.direct===s._DEF_DIR._LD?"65,50,100,85":s.direct===s._DEF_DIR._LU?"65,25,100,60":void 0]}collision(_){let e=this;e._isopen&&e.isCollision()&&(e._status--,e.isalive()||_SCORE.set(e.getscore))}isShot(){let _=this;return!(_._status<=0)&&(!_GAME.isEnemyCanvasOut(_)&&(!(Math.abs(_PLAYERS_MAIN.y-_.y)>200)&&(_.direct!==_._DEF_DIR._LU&&_.direct!==_._DEF_DIR._LD||!(_PLAYERS_MAIN.x<_.x))))}shot(){let _=this;!_._open_count>0&&!_.isShot()||_._open_count++,_._open_count>0&&(_.img=_.imgs[1],_._isopen=!0),_._open_count>200&&(_.img=_.imgs[0],_._isopen=!1,_._open_count=-100),_._open_count<=0||_._open_count%15==0&&_ENEMIES.push(new ENEMY_qr(_CANVAS_IMGS.enemy_m_y_1.obj,_.x+parseInt(_.shotColMap[0].split(",")[0]),_.y+parseInt(_.shotColMap[0].split(",")[1])))}showCollapes(_,e){let t=this;t.ani_col(_,e),t._isSetMapDefCol||(_MAP.set_mapdef_col(_MAP.getMapX(t.x),_MAP.getMapY(t.y),t.direct===t._DEF_DIR._D?"0000,0000,0000,1111":t.direct===t._DEF_DIR._U?"1111,0000,0000,0000":t.direct===t._DEF_DIR._LD?"0000,0000,0000,1111":t.direct===t._DEF_DIR._LU?"1111,0000,0000,0000":void 0),t._isSetMapDefCol=!0)}move(){let _=this;if(_.x+_.img.width<0)_._status=0;else{if(_._status<=0)return _.showCollapes(0,_.direct===_._DEF_DIR._D?25:0),_.img=_CANVAS_IMGS.enemy_m_z.obj,void _.setDrawImage();_.x-=_MAPDEFS[_MAP_PETTERN]._speed,_.setDrawImage(),_.shot()}}}class ENEMY_r extends ENEMY_q{constructor(_,e,t){super(_,e,t);let s=this;s._status=10,s.direct=t||s._DEF_DIR._U,s.imgs=[_CANVAS_IMGS.enemy_m_b_1.obj,_CANVAS_IMGS.enemy_m_b_2.obj],s.img=s.imgs[0],s.col_imgs=_ENEMY_DEF_ANI_COL.t8.imgs,s.col_intv=_ENEMY_DEF_ANI_COL.t8.intv,s.shotColMap=[s.direct===s._DEF_DIR._D?"20,40,50,85":s.direct===s._DEF_DIR._U?"20,25,50,70":void 0]}move(){let _=this;if(_.x+_.img.width<0)_._status=0;else{if(_._status<=0)return _.showCollapes(0,_.direct===_._DEF_DIR._D?-10:0),_.img=_CANVAS_IMGS.enemy_m_z.obj,void _.setDrawImage();_.x-=_MAPDEFS[_MAP_PETTERN]._speed,_.setDrawImage(),_.shot()}}}class ENEMY_qr extends GameObject_ENEMY{constructor(_,e,t){super(_,e,t);let s=this;s._status=1,s.direct=t||s._DEF_DIR._U,s.imgs_c=0,s.imgs=[_CANVAS_IMGS.enemy_m_y_1.obj,_CANVAS_IMGS.enemy_m_y_2.obj],s.img=s.imgs[0],s.tx=_PLAYERS_MAIN.getPlayerCenterPosition()._x,s.ty=_PLAYERS_MAIN.getPlayerCenterPosition()._y,s.rad=Math.atan2(s.ty-s.y,s.tx-s.x),s.sx=Math.cos(s.rad),s.sy=Math.sin(s.rad),s.speed=1,s.col_imgs=_ENEMY_DEF_ANI_COL.t2.imgs,s.col_intv=_ENEMY_DEF_ANI_COL.t2.intv}collision(_){let e=this;e.isCollision()&&(e._status--,e.isalive()||_SCORE.set(e.getscore))}map_collition(){let _=this,e=_.getEnemyCenterPosition(),t=_MAP.getMapX(e._x),s=_MAP.getMapY(e._y);_MAP.isMapCollision(t,s)&&(_._status=0)}move(){let _=this;_.x+_.img.width<0?_._status=0:_._status<=0?_.showCollapes():(_.map_collition(),_.x+=_.sx*_MAPDEFS[_MAP_PETTERN]._speed-_BACKGROUND_SPEED,_.y+=_.sy*_MAPDEFS[_MAP_PETTERN]._speed,_.img=function(e){return _.imgs_c=e>=10*_.imgs.length-1?0:e+1,_.imgs[parseInt(_.imgs_c/10)]}(_.imgs_c),_.setDrawImage())}}class GameObject_ENEMY_BOSS extends GameObject_ENEMY{constructor(_,e,t){super(_,e,t),this.speed=0,this.starttime=0,this._c=0}ani_col(){}init(){let _=this;_.starttime=(new Date).getTime(),_.move()}shot(){}move_init(){}move(){}}class ENEMY_BOSS_BOGCORE extends GameObject_ENEMY_BOSS{constructor(_,e){super(_CANVAS_IMGS.enemy_z.obj,_,e);let t=this;t._status=50,t.speed=3,t.getscore=1e4,t.img=_CANVAS_IMGS.enemy_z.obj,t.wall_col={_x:0,_y:0},t.wall=[{img:_CANVAS_IMGS.enemy_z_1.obj,cs:40,isalive:!0,x:65,y:7},{img:_CANVAS_IMGS.enemy_z_1.obj,cs:30,isalive:!0,x:55,y:7},{img:_CANVAS_IMGS.enemy_z_1.obj,cs:20,isalive:!0,x:45,y:7},{img:_CANVAS_IMGS.enemy_z_2.obj,cs:10,isalive:!0,x:35,y:5},{img:_CANVAS_IMGS.enemy_z_3.obj,cs:0,isalive:!0,x:15,y:14}],t.c_z4_ani=30,t.z4_ani=[{img:_CANVAS_IMGS.enemy_z_4_1.obj,al:1},{img:_CANVAS_IMGS.enemy_z_4_2.obj,al:.8},{img:_CANVAS_IMGS.enemy_z_4_3.obj,al:.6},{img:_CANVAS_IMGS.enemy_z_4_4.obj,al:.4},{img:_CANVAS_IMGS.enemy_z_4_5.obj,al:.2}],t.is_ani_col=!1,t.tid=null,t.is_done_move_init=!1,t.is_able_collision=!1,t.init(),t.col_ani_c=0,t.col_ani=_ENEMY_DEF_ANI_COL.t0.imgs,t.col_ani9_c=0,t.col_ani9=_ENEMY_DEF_ANI_COL.t9.imgs,t.shotColMap=["0,40,100,70","50,0,169,40,false","50,70,169,114,false"]}ani_col(){let _=this;if(!_.is_ani_col)return;if(_.col_ani_c>=3*_.col_ani.length-1)return _.col_ani_c=0,void(_.is_ani_col=!1);let e=_.col_ani[parseInt(_.col_ani_c/3)];_.getEnemyCenterPosition();_CONTEXT.drawImage(e.img,_.wall_col.x,_.wall_col.y,e.img.width*e.scale,e.img.height*e.scale),_.col_ani_c++}ani_col2(){let _=this,e=_.col_ani9_c;if(e>=4*_.col_ani9.length-1)return;let t=_.col_ani9[parseInt(e/4)],s=_.getEnemyCenterPosition();_CONTEXT.drawImage(t.img,s._x-parseInt(t.img.width*t.scale/2),s._y-parseInt(t.img.height*t.scale/2),t.img.width*t.scale,t.img.height*t.scale),_.col_ani9_c++}collision(_){let e=this;e.is_able_collision&&e.isCollision()&&(e._status--,this.isalive()||_SCORE.set(this.getscore))}showCollapes(){this.ani_col2()}shot(){let _=this,e=_.speed;_ENEMIES_SHOTS.push(new ENEMY_SHOT_Z(_.x,_.y)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_Z(_.x,_.y+35)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_Z(_.x,_.y+70)),_ENEMIES_SHOTS.push(new ENEMY_SHOT_Z(_.x,_.y+105)),_.speed=0,_.tid=setTimeout(function(){_.speed=e,clearTimeout(_.tid),_.tid=null},100)}move_init(){let _=this;_.x-=4,_CONTEXT.drawImage(_.img,_.x,_.y,_.img.width,_.img.height);for(let e=0;e<_.wall.length;e++){let t=_.wall[e],s=_.getEnemyCenterPosition();_CONTEXT.drawImage(t.img,s._x-t.x,s._y-t.y,t.img.width,t.img.height)}_.x<_CANVAS.width-_.img.width-80&&(_.is_done_move_init=!0,_.is_able_collision=!0)}move(){let _=this;if(_.is_done_move_init)if(_._status<=0)_.showCollapes();else{Math.random()>.02||null===_.tid&&_.shot(),_.speed=_.y<50||_.y+_.img.height>450?-1*_.speed:_.speed,_.y+=_.speed,_CONTEXT.drawImage(_.img,_.x,_.y,_.img.width,_.img.height);for(let e=0;e<_.wall.length;e++){let t=_.wall[e];if(!t.isalive)continue;let s=_.getEnemyCenterPosition();_CONTEXT.drawImage(t.img,s._x-t.x,s._y-t.y,t.img.width,t.img.height),t.cs>=_._status&&(_.wall_col.x=s._x-t.x,_.wall_col.y=s._y-t.y,_.is_ani_col=!0,_SCORE.set(500),t.isalive=!1)}if(_.ani_col(),_.is_done_move_init){if(_._c>=3e3){let e=_.getEnemyCenterPosition();_.is_able_collision=!1,_.c_z4_ani=_.c_z4_ani>0?_.c_z4_ani-1:0;let t=_.z4_ani[parseInt(_.c_z4_ani/6)].img;_CONTEXT.drawImage(t,e._x-t.width/2,e._y-t.height/2,t.width,t.height)}_._c>=4e3?_._status=0:_._c++}}else _.move_init()}}class GameObject_ENEMY_SHOT{constructor(_,e,t,s){let i=this;i.img=_CANVAS_IMGS.enemy_bullet1.obj,i.x=_||500,i.y=e||300,i._c=0,i.speed=_DEF_DIFFICULT[_ENEMY_DIFFICULT]._ENEMY_SHOT_SPEED,i.tx=t||_PLAYERS_MAIN.getPlayerCenterPosition()._x,i.ty=s||_PLAYERS_MAIN.getPlayerCenterPosition()._y,i.deg=180*Math.atan2(this.ty-this.y,this.tx-this.x)/Math.PI,i.rad=Math.atan2(this.ty-this.y,this.tx-this.x),i.sx=Math.cos(this.rad),i.sy=Math.sin(this.rad),i._shot_alive=!0,i.shotColMap=["0,0,"+i.img.width+","+i.img.height]}init(){this._shot_alive=!1}ani_enemy_bullet(){this.img=_CANVAS_IMGS["enemy_bullet"+parseInt(this._c/4+1)].obj,this._c=this._c>=7?0:this._c+1}map_collition(){let _=this,e=_MAP.getMapX(_.x),t=_MAP.getMapY(_.y);_MAP.isMapCollision(e,t)&&this.init()}getEnemyCenterPosition(){return{_x:this.x+this.img.width/2,_y:this.y+this.img.height/2}}isalive(){return this._shot_alive}move(){let _=this;_.map_collition(),_GAME.isEnemyCanvasOut(_)?_.init():_._shot_alive&&(_.ani_enemy_bullet(),_.x+=_.sx*_.speed,_.y+=_.sy*_.speed,_CONTEXT.drawImage(_.img,_.x-_.img.width/2,_.y-_.img.height/2,_.img.width,_.img.height),_._shot_alive=!0)}}class GameObject_ENEMY_SHOT2 extends GameObject_ENEMY_SHOT{constructor(_,e,t,s){super(_,e),this.sx=t||1,this.sy=s||1}}class ENEMY_SHOT_Z extends GameObject_ENEMY_SHOT{constructor(_,e){super(_,e),this.img=_CANVAS_IMGS.enemy_bullet_z.obj,this.speed=10}move(){let _=this;_GAME.isEnemyCanvasOut(_)?_._shot_alive=!1:_._shot_alive&&(_.map_collition(),_.x-=_.speed,_CONTEXT.drawImage(_.img,_.x,_.y,_.img.width,_.img.height))}}let _MAPDEFS="",_MAPDEF="",_MAP_PETTERN=3,_BACKGROUND_SPEED=0;const _MAP_ENEMIES={_DEF_DIR:{_U:0,_D:1,_R:2,_L:3,_LU:4,_LD:5,_RU:6,_RD:7},_setDir:function(_,e){let t=this,s=_MAP.isMapCollision(_,e-1)?t._DEF_DIR._U:t._DEF_DIR._D;return s=_MAP.isMapCollision(_,e+1)?t._DEF_DIR._D:t._DEF_DIR._U},_ENEMIES:{a:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_a(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_a_1},b:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_b(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_b_1},c:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_c(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_c_1},d:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_d(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_d_1},e:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_e(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_e_1},f:{_f:function(_,e,t){t=e<_CANVAS.height/2?_MAP_ENEMIES._DEF_DIR._U:_MAP_ENEMIES._DEF_DIR._D,_ENEMIES.push(new ENEMY_f(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_f_1},g:{_f:function(_,e,t){t=e<_CANVAS.height/2?_MAP_ENEMIES._DEF_DIR._U:_MAP_ENEMIES._DEF_DIR._D,_ENEMIES.push(new ENEMY_g(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_g_1},m:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_m(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_m_1},n:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_n(_,e))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_o_1},o:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_o(_,e))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_o_1},p:{_f:function(_,e,t){let s=new ENEMY_p(_,e);_ENEMIES.push(s),_ENEMIES_BOUNDS.push(s)},_st:"",_s:"000,000,000",_o:_CANVAS_IMGS.enemy_p_1}}},_MAP_THEME={_THEME1:{_p:{A:{_o:_CANVAS_IMGS.enemy_p_1,_s:"011,111,110",_mx:function(_){return _},_my:function(_){return _}}},_enemies:_MAP_ENEMIES._ENEMIES},_THEME2:{_p:{A:{_o:_CANVAS_IMGS.map_f_A,_s:"111111111,111111111,000000000",_mx:function(_){return _},_my:function(_){return _}},B:{_o:_CANVAS_IMGS.map_f_B,_s:"111111111,111111111,000000000",_mx:function(_){return _},_my:function(_){return _}},C:{_o:_CANVAS_IMGS.map_f_C,_s:"000000000,111111111,111111111",_mx:function(_){return _},_my:function(_){return _}},D:{_o:_CANVAS_IMGS.map_f_D,_s:"000000000,111111111,111111111",_mx:function(_){return _},_my:function(_){return _}},E:{_o:_CANVAS_IMGS.map_f_E,_s:"1",_mx:function(_){return _},_my:function(_){return _}},F:{_o:_CANVAS_IMGS.map_f_F,_s:"000110000,000110000,001111000,011111100,011111110,111111111",_mx:function(_){return _},_my:function(_){return _}},G:{_o:_CANVAS_IMGS.map_f_G,_s:"111111110,011111110,011111100,001111000,000110000,000110000",_mx:function(_){return _},_my:function(_){return _}},H:{_o:_CANVAS_IMGS.map_f_H,_s:"00000000000000000000,00000111111111111110,00000111111110000000,00000000011110000000,00000000001100000000,00000000001100000000,00000000001100000000,11111111111111111100,01111111111111111100,00000000011000000000,00000000011000000000,00000000111000000000,00000001111110000000",_mx:function(_){return _},_my:function(_){return _}},I:{_o:_CANVAS_IMGS.map_f_I,_s:"000000010000000,000000010000000,000000111000000,000001111100000,000011111110000,000111111111000,001111111111100,001111111111100,011111111111110,111111111111111",_mx:function(_){return _},_my:function(_){return _}},J:{_o:_CANVAS_IMGS.map_f_J,_s:"111111111111111,011111111111110,001111111111100,001111111111100,000111111111000,000011111110000,000001111100000,000000111000000,000000010000000,000000010000000",_mx:function(_){return _},_my:function(_){return _}},K:{_o:_CANVAS_IMGS.map_f_K,_s:"010",_mx:function(_){return _},_my:function(_){return _}},L:{_o:_CANVAS_IMGS.map_f_L,_s:"010",_mx:function(_){return _},_my:function(_){return _}},M:{_o:_CANVAS_IMGS.map_f_M,_s:"0111,1111",_mx:function(_){return _},_my:function(_){return _}},N:{_o:_CANVAS_IMGS.map_f_N,_s:"1111,0111",_mx:function(_){return _},_my:function(_){return _}},O:{_o:_CANVAS_IMGS.map_f_O,_s:"1111,1110",_mx:function(_){return _},_my:function(_){return _}},P:{_o:_CANVAS_IMGS.map_f_P,_s:"1110,1111",_mx:function(_){return _},_my:function(_){return _}}},_enemies:_MAP_ENEMIES._ENEMIES},_THEME3:{_p:{A:{_o:_CANVAS_IMGS.map_c_A,_s:"1",_mx:function(_){return _},_my:function(_){return _}}},_enemies:_MAP_ENEMIES._ENEMIES},_THEME4:{_p:{A:{_o:_CANVAS_IMGS.map_c_A,_s:"1",_mx:function(_){return _},_my:function(_){return _}}},_enemies:_MAP_ENEMIES._ENEMIES},_THEME5:{_p:{A:{_o:_CANVAS_IMGS.map_c_A,_s:"1",_mx:function(_){return _},_my:function(_){return _}},B:{_o:_CANVAS_IMGS.map_m_A,_s:"0000000000,1111111111,1111111111,0000000000",_mx:function(_){return _},_my:function(_){return _}},C:{_o:_CANVAS_IMGS.map_m_B,_s:"0000000000,1111111111,1111111111,0000000000",_mx:function(_){return _},_my:function(_){return _}}},_enemies:{a:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_a(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_a_1},b:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_b(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_b_1},c:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_c(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_c_1},d:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_d(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_d_1},e:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_e(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_e_1},f:{_f:function(_,e,t){t=e<_CANVAS.height/2?_MAP_ENEMIES._DEF_DIR._U:_MAP_ENEMIES._DEF_DIR._D,_ENEMIES.push(new ENEMY_f(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_f_1},g:{_f:function(_,e,t){t=e<_CANVAS.height/2?_MAP_ENEMIES._DEF_DIR._U:_MAP_ENEMIES._DEF_DIR._D,_ENEMIES.push(new ENEMY_g(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_g_1},m:{_f:function(_,e,t){_ENEMIES.push(new ENEMY_m(_,e,t))},_st:"",_s:"0",_o:_CANVAS_IMGS.enemy_m_1},l:{_f:function(_,e,t){let s=new ENEMY_q(_,e,_MAP_ENEMIES._DEF_DIR._U);_ENEMIES.push(s)},_st:"transform:scale(1,-1);",_s:"1111,0110,0011,0000",_o:_CANVAS_IMGS.enemy_m_a_1},n:{_f:function(_,e,t){let s=new ENEMY_q(_,e,_MAP_ENEMIES._DEF_DIR._D);_ENEMIES.push(s)},_st:"",_s:"0000,0011,0110,1111",_o:_CANVAS_IMGS.enemy_m_a_1},o:{_f:function(_,e,t){let s=new ENEMY_r(_,e,_MAP_ENEMIES._DEF_DIR._U);_ENEMIES.push(s)},_st:"transform:scale(1,-1);",_s:"1111,0010,0000,0000",_o:_CANVAS_IMGS.enemy_m_b_1},p:{_f:function(_,e,t){let s=new ENEMY_r(_,e,_MAP_ENEMIES._DEF_DIR._D);_ENEMIES.push(s)},_st:"",_s:"0000,0000,0010,1111",_o:_CANVAS_IMGS.enemy_m_b_2},q:{_f:function(_,e,t){let s=new ENEMY_q(_,e,_MAP_ENEMIES._DEF_DIR._LD);_ENEMIES.push(s)},_st:"transform:scale(-1,1);",_s:"0000,1100,0110,1111",_o:_CANVAS_IMGS.enemy_m_a_1},r:{_f:function(_,e,t){let s=new ENEMY_q(_,e,_MAP_ENEMIES._DEF_DIR._LU);_ENEMIES.push(s)},_st:"transform:scale(-1,-1);",_s:"1111,0110,1100,0000",_o:_CANVAS_IMGS.enemy_m_a_1}}}};class GameObject_MAP{constructor(_){this.pt=_||0,this.initx=0,this.x=this.initx,this.collision=new RegExp("[1A-Z]"),this.collision_enemies=new RegExp("[a-z]","g"),this.collision_map=new RegExp("[A-Z]"),this.collision_map_d=new RegExp("[BD]"),this.t=25,this.mapdef=new Array,this.mapdef_col=new Array,this.map_theme=0,this.map_pettern=0,this.map_difficult=0,this.map_background_speed=0}init(_){_AJAX("./gradius_map.json","json",function(e){_MAPDEFS=e,_()})}set_stage_map_pattern(_){this.map_pettern=_}init_stage_map(){this.x=parseInt(_MAPDEFS[this.map_pettern]._initx),this.initx=parseInt(_MAPDEFS[this.map_pettern]._initx),this.mapdef=_MAPDEFS[this.map_pettern]._map,this.map_difficult=parseInt(_MAPDEFS[this.map_pettern]._difficult)-1,_ENEMY_DIFFICULT=_ISDEBUG?_ENEMY_DIFFICULT:parseInt(_MAPDEFS[this.map_pettern]._difficult)-1,this.map_background_speed=parseInt(_MAPDEFS[this.map_pettern]._speed),_BACKGROUND_SPEED=parseInt(_MAPDEFS[this.map_pettern]._speed),_MAP_PETTERN=this.map_pettern,this.map_theme=_MAPDEFS[this.map_pettern]._theme,this.init_mapdef_col()}init_enemies_location(){let _=this;for(let e=0;e<_.mapdef.length;e++)for(let t=0;t<_.mapdef[e].length;t++){let s=_.mapdef[e][t];if(_.isCollisionBit(s))continue;if("0"===s)continue;let i=function(){let i=_MAP_ENEMIES._setDir(t,e),n=_MAP_THEME[_.map_theme]._enemies[s];return i=0===i?_MAP_ENEMIES._setDir(t,e+parseInt(n._o.obj.height/_MAP.t)):i}();_MAP_THEME[_.map_theme]._enemies[s]._f(_.x+t*_.t,e*_.t,i)}}init_mapdef_col(){let _=this;Object.assign(_.mapdef_col,_.mapdef);for(let e=0;e<_.mapdef_col.length;e++)_.mapdef_col[e]=_.mapdef_col[e].replace(/[a-zA-Z]/gi,"0");for(let e=0;e<_.mapdef.length;e++){let t=_.mapdef[e];for(let s=0;s<t.length;s++){if(null===t[s].match(/[A-Za-z]/))continue;let i=_.isEnemiesBit(t[s])?_MAP_THEME[_.map_theme]._enemies[t[s]]:_MAP_THEME[_.map_theme]._p[t[s]];void 0===i&&console.log(":"+_.map_theme+" "+t[s]+"");let n=i._s.split(",");for(let i=0;i<n.length;i++){let a=_.mapdef_col[e+i],o=_.mapdef[e+i];_.mapdef_col[e+i]=a.substr(0,s)+function(e,t,s){return _.setCollisionBit(s,t)}(o.substr(s,n[i].length),a.substr(s,n[i].length),n[i])+a.substr(s+n[i].length,t.length)}}}}set_mapdef_col(_,e,t){let s=this;if(void 0===_||void 0===e||void 0===t)return;let i=t.split(",");for(let t=0;t<i.length;t++){let n=s.mapdef_col[e+t];s.mapdef_col[e+t]=n.substr(0,_+1)+i[t]+n.substr(_+1+i[t].length)}}setCollisionBit(_,e){let t="";for(let s=0;s<_.length;s++)"0"!==_[s]?t+="1":t+=e[s];return t}getCollisionFlag(){return this.collision}getBackGroundSpeed(){return this.map_background_speed}get_stage_map_pattern(_){return this.map_pettern}getMapXToPx(_){return _*this.t+this.initx-_SCROLL_POSITION}getMapYToPx(_){return _*this.t}getMapX(_){return parseInt((_+_SCROLL_POSITION-this.initx)/this.t)}getMapY(_){return parseInt(_/this.t)}isCollisionBit(_){return null!==_.match(this.collision)}isEnemiesBit(_){return null!==_.match(this.collision_enemies)}isMapDouble(_){return null!==_.match(this.collision_map_d)}isMapBefore(_,e){return _<0}isMapLastSide(_,e){let t=this;return void 0!==t.mapdef[e]&&(void 0===t.mapdef[e][_]||_===t.mapdef[e].length-1)}isMapOver(_,e){let t=this;return void 0!==t.mapdef[e]&&(void 0===t.mapdef[e][_]||_>t.mapdef[e].length-1)}isMapCollision(_,e){let t=this;return void 0!==t.mapdef_col[e]&&(void 0!==t.mapdef_col[e][_]&&!!t.isCollisionBit(t.mapdef_col[e][_]))}isPlayersShotCollision(){for(let _=0;_<_PLAYERS_SHOTS[_SHOTTYPE].length;_++){let e=_PLAYERS_SHOTS[_SHOTTYPE][_];for(let _=0;_<e.shots.length;_++){let t=e.shots[_];t._shot_alive&&e.map_collition(t)}}for(let _=0;_<_PLAYERS_MISSILE.length;_++){let e=_PLAYERS_MISSILE[_];if(e.player.isalive())for(let _=0;_<e.shots.length;_++){let t=e.shots[_];t._shot_alive&&(t._c>0||e.map_collition(t))}}}show(){}showMapForStageselect(_){let e=this;if(null!==_&&void 0!==_){for(let t=0;t<_._map.length;t++){let s=_._map[t].length;for(let i=0;i<(s>30?30:s);i++){let s=_._map[t][i];if("0"!==s)if(null!==s.match(e.collision_enemies)){let e=_MAP_THEME[_._theme]._enemies[s]._o.obj;_CONTEXT.drawImage(e,50+10*i,130+10*t,e.width/2.5,e.height/2.5)}else{let e=_MAP_THEME[_._theme]._p[s],n=e._o.obj;_CONTEXT.drawImage(n,50+10*i,130+10*e._my(t),n.width/2.5,n.height/2.5)}}}_CONTEXT.fillStyle="rgba(0,0,0,1)",_CONTEXT.fillRect(351,130,_CANVAS.width,200)}}move(){let _=this;_.x-=_.map_background_speed;for(let e=0;e<_.mapdef.length;e++)for(let t=0;t<_.mapdef[e].length;t++){let s=_.mapdef[e][t];if(!_.isCollisionBit(s))continue;if(_.x+t*_.t<-500||_.x+t*_.t>_CANVAS.width+100)continue;let i=_MAP_THEME[_.map_theme]._p[s],n=i._o.obj;_CONTEXT.drawImage(n,_.x+i._mx(t)*_.t,i._my(e)*_.t,n.width,n.height)}}}let _ISDEBUG=!1,_PLAYERS_POWER_METER=0,_PLAYERS_POWER_METER_SHIELD=0,_DRAW_SETINTERVAL=null,_DRAW_GAMESTART_SETINTERVAL=null,_PLAYERS_SHOTS_SETINTERVAL=null,_EVENT_POWERMETER_FLAG=!1,_EVENT_SELECT_STAGE_FLAG=!1,_DRAW_IS_MATCH_BOSS=!1,_DRAW_IS_MATCH_BOSS_COUNT=0;const _ISSP=null===window.ontouchstart,_EVENT_KEYDOWN=null===window.ontouchstart?"touchstart":"keydown",_EVENT_KEYUP=null===window.ontouchstart?"touchend":"keyup",_FPS=60;let _CANVAS,_CONTEXT,_DRAW_IS_GAMECLEAR=!1,_SCROLL_POSITION=0;const _SHOTTYPE_MISSILE="_SHOTTYPE_MISSILE",_SHOTTYPE_NORMAL="_SHOTTYPE_NORMAL",_SHOTTYPE_DOUBLE="_SHOTTYPE_DOUBLE",_SHOTTYPE_LASER="_SHOTTYPE_LASER",_SHOTTYPE_RIPPLE_LASER="_SHOTTYPE_RIPPLE_LASER";let _SHOTTYPE=_SHOTTYPE_NORMAL,_SCORE="",_PLAYERS_MAIN="",_PLAYERS_MAIN_FORCE="",_PLAYERS_OPTION=new Array,_PLAYERS_OPTION_ISALIVE=0;const _PLAYERS_OPTION_MAX=4;let _PLAYERS_MOVE_FLAG=!1,_PLAYERS_MOVE_DRAW=new Array;const _PLAYERS_MAX=5,_PLAYERS_SHOTS_MAX=2,_PLAYERS_MOVE_DRAW_MAX=500;let _PLAYERS_SHOTS={_SHOTTYPE_NORMAL:new Array,_SHOTTYPE_DOUBLE:new Array,_SHOTTYPE_LASER:new Array},_PLAYERS_MISSILE=new Array,_PLAYERS_MISSILE_ISALIVE=!1,_ENEMIES=new Array,_ENEMIES_SHOTS=new Array,_ENEMIES_BOUNDS=new Array,_POWERCAPSELLS=new Array,_POWERMETER="",_STAGESELECT="",_MAP="",_BACKGROUND=new Array;const _BACKGROUND_STAR_MAX=70;let _KEYSAFTERPAUSE=new Array,_DEF_KEYSAFTERPAUSE="38,38,40,40,37,39,37,39,66,65";const _IS_SQ_COL=0,_IS_SQ_COL_NONE=1,_IS_SQ_NOTCOL=2,_AJAX=function(_,e,t,s){let i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&(200===i.status?(console.log("OK"),t(i.response,s)):console.log("NG"))},i.open("GET",_),i.responseType=e||"json",i.send(null)},_KEYEVENT_MASTER={addKeydownStart:function(){_ISSP?_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_start):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_start)},removeKeydownStart:function(){_ISSP?_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_start):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_start)},addKeydownSelectStage:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.addEventListener("touchmove",_KEYEVENT_SP.keymove_select_stage),_SP_CONTROLLER._sp_main_center.addEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_stage),_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_stage_a)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_stage)},removeKeydownSelectStage:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.removeEventListener("touchmove",_KEYEVENT_SP.keymove_select_stage),_SP_CONTROLLER._sp_main_center.removeEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_stage),_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_stage_a),_SP_CONTROLLER._set_reset()):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_stage)},addKeydownSelectPowermeter:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.addEventListener("touchmove",_KEYEVENT_SP.keymove_select_powermeter),_SP_CONTROLLER._sp_main_center.addEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_powermeter),_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_powermeter_a)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_powermeter)},removeKeydownSelectPowermeter:function(){_ISSP?(_SP_CONTROLLER._sp_main_center.removeEventListener("touchmove",_KEYEVENT_SP.keymove_select_powermeter),_SP_CONTROLLER._sp_main_center.removeEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyend_select_powermeter),_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_select_powermeter_a),_SP_CONTROLLER._set_reset()):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_select_powermeter)},addKeydownGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_hide.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_hide),_SP_CONTROLLER._sp_bt_r.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_r),_SP_CONTROLLER._sp_bt_p.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_p),_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_s),_SP_CONTROLLER._sp_bt_b.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_b),_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_a),_SP_CONTROLLER._sp_main_center.addEventListener("touchstart",_KEYEVENT_SP.keymove_game_controller),_SP_CONTROLLER._sp_main_center.addEventListener("touchmove",_KEYEVENT_SP.keymove_game_controller)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_game)},addKeyupGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_a.addEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyup_game_a),_SP_CONTROLLER._sp_main_center.addEventListener("touchend",_KEYEVENT_SP.keyend_game_controller),_SP_CONTROLLER._set_reset()):document.addEventListener(_EVENT_KEYUP,_KEYEVENT.keyup_game)},removeKeydownGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_hide.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_hide),_SP_CONTROLLER._sp_bt_r.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_r),_SP_CONTROLLER._sp_bt_p.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_p),_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_s),_SP_CONTROLLER._sp_bt_b.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_b),_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_game_a),_SP_CONTROLLER._sp_main_center.removeEventListener("touchstart",_KEYEVENT_SP.keymove_game_controller),_SP_CONTROLLER._sp_main_center.removeEventListener("touchmove",_KEYEVENT_SP.keymove_game_controller)):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_game)},removeKeyupGame:function(){_ISSP?(_SP_CONTROLLER._sp_bt_a.removeEventListener(_EVENT_KEYUP,_KEYEVENT_SP.keyup_game_a),_SP_CONTROLLER._sp_main_center.removeEventListener("touchend",_KEYEVENT_SP.keyend_game_controller),_SP_CONTROLLER._set_reset()):document.removeEventListener(_EVENT_KEYUP,_KEYEVENT.keyup_game)},addKeydownGameclear:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_r),_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_s)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameclear)},removeKeydownGameclear:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_r),_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameclear_s)):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameclear)},addKeydownGameover:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_r),_SP_CONTROLLER._sp_bt_s.addEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_s)):document.addEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameover)},removeKeydownGameover:function(){_ISSP?(_SP_CONTROLLER._sp_bt_r.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_r),_SP_CONTROLLER._sp_bt_s.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT_SP.keydown_gameover_s)):document.removeEventListener(_EVENT_KEYDOWN,_KEYEVENT.keydown_gameover)}},_KEYEVENT={keydown_start:function(_){"S"!==_.key&&"s"!==_.key||(document.querySelector("#game_start_wrapper .text").classList.add("on"),document.querySelector("#game_start_wrapper .text_loading").classList.add("on"),_DRAW_INIT(_CANVAS_IMGS,_DRAW_STAGE_SELECT))},keydown_select_powermeter:function(_){if(clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,"Enter"===_.key||"enter"===_.key)return _DRAW_SELECT_POWERMETER(),!1;"ArrowUp"!==_.key&&"Up"!==_.key||(_POWERMETER._c_pms=_POWERMETER._c_pms<=0?0:_POWERMETER._c_pms-1),"ArrowDown"!==_.key&&"Down"!==_.key||(_POWERMETER._c_pms=_POWERMETER._c_pms>=_POWERMETER.pms_selected.length-1?_POWERMETER._c_pms:_POWERMETER._c_pms+1),"ArrowLeft"!==_.key&&"Left"!==_.key||(_POWERMETER._c_pmss=_POWERMETER._c_pmss<=0?0:_POWERMETER._c_pmss-1),"ArrowRight"!==_.key&&"Right"!==_.key||(_POWERMETER._c_pmss=_POWERMETER._c_pmss>=_POWERMETER.pmss_selected.length-1?_POWERMETER._c_pmss:_POWERMETER._c_pmss+1),_POWERMETER.pms_disp(),_POWERMETER.pms_select()},keydown_select_stage:function(_){if("Enter"===_.key||"enter"===_.key)return _MAP.set_stage_map_pattern(_STAGESELECT.mapdef_status),_DRAW_POWER_METER_SELECT(),!1;"ArrowLeft"!==_.key&&"Left"!==_.key||(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status<=0?0:_STAGESELECT.mapdef_status-1),"ArrowRight"!==_.key&&"Right"!==_.key||(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status>=_MAPDEFS.length-1?_STAGESELECT.mapdef_status:_STAGESELECT.mapdef_status+1),_STAGESELECT.set_map_status(),_STAGESELECT.disp_thumb_map()},keydown_gameclear:function(_){if("R"===_.key||"r"===_.key)return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1;if("S"===_.key||"s"===_.key)return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1;if("P"===_.key||"p"===_.key)return null!==_DRAW_SETINTERVAL?_DRAW_STOP():(_KEYSAFTERPAUSE=[],_DRAW()),!1;if(" "===_.key||"Spacebar"===_.key){if(null!==_PLAYERS_SHOTS_SETINTERVAL)return;_DRAW_PLAYERS_SHOTS()}"ArrowLeft"!==_.key&&"Left"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel),"ArrowRight"!==_.key&&"Right"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=_PLAYERS_MAIN.accel),"ArrowUp"!==_.key&&"Up"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel),"ArrowDown"!==_.key&&"Down"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=_PLAYERS_MAIN.accel),"B"!==_.key&&"b"!==_.key||_POWERMETER.playerset()},keydown_gameover:function(_){return"R"===_.key||"r"===_.key?(_DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1):"S"===_.key||"s"===_.key?(_DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1):void 0},keydown_game:function(_){if(!_PLAYERS_MAIN.isalive())return!1;if("R"===_.key||"r"===_.key)return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1;if("S"===_.key||"s"===_.key)return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1;if("P"===_.key||"p"===_.key)return null!==_DRAW_SETINTERVAL?_DRAW_STOP():(_KEYSAFTERPAUSE=[],_DRAW()),!1;if(null===_DRAW_SETINTERVAL){if(_KEYSAFTERPAUSE.push(_.keyCode),_DEF_KEYSAFTERPAUSE===_KEYSAFTERPAUSE.toString()){_SHOTTYPE=_SHOTTYPE_NORMAL,_PLAYERS_MISSILE_ISALIVE=!0;for(let _=0;_<4;_++)_PLAYERS_OPTION[_].settruealive();_PLAYERS_MAIN_FORCE.init(),_KEYSAFTERPAUSE=[],_POWERMETER._set_current_reset(),_POWERMETER.meterdef_status="101100"}return!1}if(" "===_.key||"Spacebar"===_.key){if(null!==_PLAYERS_SHOTS_SETINTERVAL)return;_DRAW_PLAYERS_SHOTS()}if("ArrowLeft"!==_.key&&"Left"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel),"ArrowRight"!==_.key&&"Right"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=_PLAYERS_MAIN.accel),"ArrowUp"!==_.key&&"Up"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani(_.key)),"ArrowDown"!==_.key&&"Down"!==_.key||(_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._y=_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani(_.key)),"B"!==_.key&&"b"!==_.key||_POWERMETER.playerset(),!_ISDEBUG)return!1;"M"!==_.key&&"m"!==_.key||_DRAW_SCROLL_STOP(),"N"!==_.key&&"n"!==_.key||_DRAW_SCROLL_RESUME(),"V"!==_.key&&"v"!==_.key||_POWERMETER.move()},keyup_game:function(_){if(!_PLAYERS_MAIN.isalive())return!1;"ArrowLeft"!==_.key&&"Left"!==_.key||(_PLAYERS_MOVE_FLAG=!1),"ArrowRight"!==_.key&&"Right"!==_.key||(_PLAYERS_MOVE_FLAG=!1),"ArrowUp"!==_.key&&"Up"!==_.key||(_PLAYERS_MOVE_FLAG=!1),"ArrowDown"!==_.key&&"Down"!==_.key||(_PLAYERS_MOVE_FLAG=!1)," "!==_.key&&"Spacebar"!==_.key||_DRAW_STOP_PLAYERS_SHOTS()}},_KEYEVENT_SP={keydown_start:function(_){document.querySelector("#game_start_wrapper .text").classList.add("on"),document.querySelector("#game_start_wrapper .text_loading").classList.add("on"),_DRAW_INIT(_CANVAS_IMGS,_DRAW_STAGE_SELECT)},keydown_select_powermeter_a:function(_){return _DRAW_SELECT_POWERMETER(),!1},keymove_select_powermeter:function(_){clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null;let e=_SP_CONTROLLER._get_st(_)._rad;return _.preventDefault(),!0!==_EVENT_POWERMETER_FLAG&&(_EVENT_POWERMETER_FLAG=!0,e>-45&&e<=45?(_POWERMETER._c_pmss=_POWERMETER._c_pmss<=0?0:_POWERMETER._c_pmss-1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),!1):e>45&&e<=135?(_POWERMETER._c_pms=_POWERMETER._c_pms<=0?0:_POWERMETER._c_pms-1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),!1):e>135&&e<=180||e<-135&&e>=-180?(_POWERMETER._c_pmss=_POWERMETER._c_pmss>=_POWERMETER.pmss_selected.length-1?_POWERMETER._c_pmss:_POWERMETER._c_pmss+1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),!1):e<-45&&e>=-135?(_POWERMETER._c_pms=_POWERMETER._c_pms>=_POWERMETER.pms_selected.length-1?_POWERMETER._c_pms:_POWERMETER._c_pms+1,_POWERMETER.pms_disp(),_POWERMETER.pms_select(),!1):void 0)},keyend_select_powermeter:function(_){_SP_CONTROLLER._set_reset(),_EVENT_POWERMETER_FLAG=!1},keymove_select_stage:function(_){_.preventDefault();let e=_SP_CONTROLLER._get_st(_)._rad;_SP_CONTROLLER._get_st(_)._dis;if(!_EVENT_SELECT_STAGE_FLAG)return _EVENT_SELECT_STAGE_FLAG=!0,e>-45&&e<=45&&(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status<=0?0:_STAGESELECT.mapdef_status-1),(e>135&&e<=180||e<-135&&e>=-180)&&(_STAGESELECT.mapdef_status=_STAGESELECT.mapdef_status>=_MAPDEFS.length-1?_STAGESELECT.mapdef_status:_STAGESELECT.mapdef_status+1),_STAGESELECT.set_map_status(),_STAGESELECT.disp_thumb_map(),!1},keyend_select_stage:function(_){let e=_SP_CONTROLLER._sp_main_center;e.style.top="",e.style.left="",_EVENT_SELECT_STAGE_FLAG=!1},keydown_select_stage_a:function(_){return _MAP.set_stage_map_pattern(_STAGESELECT.mapdef_status),_DRAW_POWER_METER_SELECT(),!1},keydown_gameclear_r:function(_){return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_gameclear_s:function(_){return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_gameover_r:function(_){return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_gameover_s:function(_){return _DRAW_STOP_PLAYERS_SHOTS(),_DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1},keymove_game_controller:function(_){_.preventDefault(),_PLAYERS_MOVE_FLAG=!0,_PLAYERS_MAIN._x=0,_PLAYERS_MAIN._y=0;let e=_SP_CONTROLLER._get_st(_)._rad;return!(_SP_CONTROLLER._get_st(_)._dis<5)&&(e>-40&&e<=40&&(_PLAYERS_MAIN._x=-1*_PLAYERS_MAIN.accel),e>40&&e<=50&&(_PLAYERS_MAIN._x=-.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=-.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Up")),e>50&&e<=130&&(_PLAYERS_MAIN._y=-1*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Up")),e>130&&e<=140&&(_PLAYERS_MAIN._x=.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=-.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Up")),(e>140&&e<=180||e<-140&&e>=-180)&&(_PLAYERS_MAIN._x=_PLAYERS_MAIN.accel),e<-130&&e>=-140&&(_PLAYERS_MAIN._x=.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Down")),e<-50&&e>=-130&&(_PLAYERS_MAIN._y=_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Down")),e<-40&&e>=-50&&(_PLAYERS_MAIN._x=-.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN._y=.75*_PLAYERS_MAIN.accel,_PLAYERS_MAIN.set_vv_ani("Down")),!1)},keyend_game_controller:function(_){_SP_CONTROLLER._set_reset(),_PLAYERS_MOVE_FLAG=!1},keydown_game_hide:function(_){_SHOTTYPE=_SHOTTYPE_NORMAL,_PLAYERS_MISSILE_ISALIVE=!0;for(let _=0;_<4;_++)_PLAYERS_OPTION[_].settruealive();return _PLAYERS_MAIN_FORCE.init(),_KEYSAFTERPAUSE=[],_POWERMETER._set_current_reset(),_POWERMETER.meterdef_status="101100",!1},keydown_game_r:function(_){return _DRAW_RESET_OBJECT(),_DRAW_INIT_OBJECT(),!1},keydown_game_s:function(_){return _DRAW_RESET_OBJECT(),_DRAW_STAGE_SELECT(),!1},keydown_game_p:function(_){return null!==_DRAW_SETINTERVAL?_DRAW_STOP():(_KEYSAFTERPAUSE=[],_DRAW()),!1},keydown_game_a:function(_){if(null===_PLAYERS_SHOTS_SETINTERVAL)return _DRAW_PLAYERS_SHOTS(),!1},keydown_game_b:function(_){return _POWERMETER.playerset(),!1},keyup_game_a:function(_){return _DRAW_STOP_PLAYERS_SHOTS(),!1}},_SP_CONTROLLER={_x:0,_y:0,_sp_main_center:new Object,_sp_main:new Object,_sp_bt_hide:new Object,_sp_bt_r:new Object,_sp_bt_p:new Object,_sp_bt_s:new Object,_sp_bt_b:new Object,_sp_bt_a:new Object,_get_st:function(_){let e=this._sp_main_center,t=this._sp_main,s=t.getBoundingClientRect();for(var i=0;i<_.touches.length;i++)e===_.touches[i].target&&(this._x=_.touches[i].clientX-s.left,this._y=_.touches[i].clientY-s.top);let n=this._x-parseInt(window.getComputedStyle(e).width)/2,a=this._y-parseInt(window.getComputedStyle(e).height)/2;e.style.left=parseInt(n)+"px",e.style.top=parseInt(a)+"px";let o=parseInt(window.getComputedStyle(t).width),r=parseInt(window.getComputedStyle(t).height),E=o/2-this._x,m=r/2-this._y,l=Math.sqrt(Math.pow(E,2)+Math.pow(m,2));return{_rad:parseInt(180*Math.atan2(m,E)/Math.PI),_dis:l}},_set_reset(){let _=document.querySelector(".sp_controller_main_center");_.style.left="",_.style.top=""},_set_obj(){this._sp_main_center=document.querySelector(".sp_controller_main_center"),this._sp_main=document.querySelector(".sp_controller_main"),this._sp_bt_hide=document.querySelector(".sp_controller_bt.hide"),this._sp_bt_r=document.querySelector(".sp_controller_bt.r"),this._sp_bt_p=document.querySelector(".sp_controller_bt.p"),this._sp_bt_s=document.querySelector(".sp_controller_bt.s"),this._sp_bt_b=document.querySelector(".sp_controller_bt.b"),this._sp_bt_a=document.querySelector(".sp_controller_bt.a")}};class GameObject_PLAYER{constructor(_,e,t,s){this.img=_CANVAS_IMGS[_].obj,this.x=e||100,this.y=t||100,this._x=0,this._y=0,this._isalive=s||!1,this._scalechange=!0,this.width=0,this.height=0,this._c=0,this.accel=2,this.shotflag=!1}isalive(){return this._isalive}isshotflag(){return this.shotflag}enemy_collision(){}getPlayerCenterPosition(){return{_x:this.x+this.img.width/2,_y:this.y+this.img.height/2}}setfalsealive(){this._isalive=!1}settruealive(){this._isalive=!0}}class GameObject_PLAYER_MAIN extends GameObject_PLAYER{constructor(){super("vicviper1",100,200,!0),this._isequipped=!1,this._isequipped_count=0,this.c_vv_ani=20,this.vv_ani=[{img:_CANVAS_IMGS.vicviper3.obj,scale:1},{img:_CANVAS_IMGS.vicviper2.obj,scale:1},{img:_CANVAS_IMGS.vicviper1.obj,scale:1},{img:_CANVAS_IMGS.vicviper4.obj,scale:1},{img:_CANVAS_IMGS.vicviper5.obj,scale:1}],this.vv_e_ani=[{img:_CANVAS_IMGS.vicviper3_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper2_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper1_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper4_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper5_e.obj,scale:1}],this.c_vb_ani=0,this.vb_ani=[{img:_CANVAS_IMGS.vicviper_back1.obj,scale:1},{img:_CANVAS_IMGS.vicviper_back2.obj,scale:1},{img:_CANVAS_IMGS.vicviper_back3.obj,scale:1}],this.vb_e_ani=[{img:_CANVAS_IMGS.vicviper_back1_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper_back1_e.obj,scale:1},{img:_CANVAS_IMGS.vicviper_back1_e.obj,scale:1}],this._eq_ani_c=0,this.eq_ani=[{img:_CANVAS_IMGS.vicviper4.obj,scale:1},{img:_CANVAS_IMGS.vicviper1.obj,scale:1}],this._col_ani_c=0,this.col_ani=[{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.7},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.3},{img:_CANVAS_IMGS.vicviper_bomb.obj,scale:.1}],this.shotflag=!0}collapes(){null!==_DRAW_SETINTERVAL&&(_DRAW_STOP(),_DRAW_PLAYER_COLLAPES())}enemy_collision(_){1===_PLAYERS_POWER_METER_SHIELD&&_PLAYERS_MAIN_FORCE.isalive()||2!==_GAME.isSqCollision("25,33,40,42",this.x+","+this.y,_.shotColMap,_.x+","+_.y)&&(_.collision(void 0,this),this.setfalsealive())}enemy_shot_collision(_){1===_PLAYERS_POWER_METER_SHIELD&&_PLAYERS_MAIN_FORCE.isalive()||2!==_GAME.isSqCollision("25,20,40,40",this.x+","+this.y,_.shotColMap,_.x+","+_.y)&&(_.init(),this.setfalsealive())}set_equipped(){this._isequipped_count=20}map_collition(){if(1===_PLAYERS_POWER_METER_SHIELD&&_PLAYERS_MAIN_FORCE.isalive())return;let _=this.getPlayerCenterPosition(),e=_MAP.getMapX(_._x),t=_MAP.getMapY(_._y);_MAP.isMapCollision(e,t)&&this.setfalsealive()}set_vv_ani(_){"ArrowUp"!==_&&"Up"!==_||(this.c_vv_ani-=2),"ArrowDown"!==_&&"Down"!==_||(this.c_vv_ani+=2)}move(){let _=this;if(!_.isalive())return void _.collapes();_.map_collition(),_PLAYERS_MOVE_FLAG?(_.x+=_._x,_.y+=_._y,_.x=function(e){return e<50?(_._x=0,50):e>_CANVAS.width-100?(_._x=0,_CANVAS.width-100):e+_._x}(_.x),_.y=function(e){return e<50-_.img.height/4?(_._y=0,50-_.img.height/4):e>_CANVAS.height-75-_.img.height/4?(_._y=0,_CANVAS.height-75-_.img.height/4):e+_._y}(_.y)):(_._x=0,_._y=0),_PLAYERS_MOVE_FLAG?_.c_vv_ani>46?_.c_vv_ani=46:_.c_vv_ani<4&&(_.c_vv_ani=4):_.c_vv_ani>25?_.c_vv_ani-=1:_.c_vv_ani<25?_.c_vv_ani+=1:_.c_vv_ani=25;let e=function(){let e=parseInt(_.c_vv_ani/10);return _._isequipped_count<=0?_.vv_ani[e].img:(_._isequipped_count--,_._isequipped_count>0&&_._isequipped_count%2==0?_.vv_e_ani[e].img:_.vv_ani[e].img)}();_CONTEXT.drawImage(e,_.x,_.y,e.width,e.height);let t=function(){let e=parseInt(_.c_vb_ani/3);return _._isequipped_count>0&&_._isequipped_count%2==0?_.vb_e_ani[e].img:_.vb_ani[e].img}();_.width=t.width,_.height=t.height,_.c_vb_ani=_GAME._ac._get(_.c_vb_ani,_.vb_ani,3),_CONTEXT.drawImage(t,_.x,_.y+22,t.width,t.height),500===_PLAYERS_MOVE_DRAW.length&&_PLAYERS_MOVE_DRAW.pop(),_PLAYERS_MOVE_FLAG&&_PLAYERS_MOVE_DRAW.unshift({_x:parseInt(_.x+_.img.width/10),_y:parseInt(_.y+_.img.height/4)})}}class GameObject_PLAYER_MAIN_RED extends GameObject_PLAYER_MAIN{constructor(){super("vicviper1",100,200,!0),this.col_ani=[{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.7},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.5},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.3},{img:_CANVAS_IMGS.vicviper_bomb_red.obj,scale:.1}]}}class GameObject_PLAYER_OPTION extends GameObject_PLAYER{constructor(_,e,t,s){super(_,e,t,s),this.scalemax=1.3,this.scalemin=1,this._ani_c=0,this.ani=[{img:_CANVAS_IMGS.option.obj,scale:1},{img:_CANVAS_IMGS.option.obj,scale:.9},{img:_CANVAS_IMGS.option.obj,scale:.8},{img:_CANVAS_IMGS.option.obj,scale:.7},{img:_CANVAS_IMGS.option.obj,scale:.8},{img:_CANVAS_IMGS.option.obj,scale:.9}]}move(_){let e=this;if(void 0===_PLAYERS_MOVE_DRAW[_])return;if(e.x=_PLAYERS_MOVE_DRAW[_]._x,e.y=_PLAYERS_MOVE_DRAW[_]._y,!e._isalive)return;if(void 0===e.x||void 0===e.y)return;e.shotflag=!0;let t=e.getPlayerCenterPosition();e.img=(e._ani_c=e._ani_c>=3*e.ani.length-1?0:e._ani_c+1,e.ani[parseInt(e._ani_c/3)].img);let s=parseInt(e._ani_c/3),i=e.img.width,n=e.img.height,a=i*e.ani[s].scale,o=n*e.ani[s].scale;_CONTEXT.drawImage(e.img,t._x-a/2,t._y-o/2,a,o)}}class GameObject_FORCEFIELD{constructor(){this.img="",this.STATUS_MAX=4,this.x=0,this.y=0,this.width=0,this.height=0,this.type="forcefield",this._c=0,this._scale=0,this._eid=0,this.ani=[{img:_CANVAS_IMGS.forcefield1.obj,scale:1},{img:_CANVAS_IMGS.forcefield2.obj,scale:1}]}init(){this._scale=1,this.img=this.ani[0].img,this.width=this.img.width,this.height=this.img.height}isalive(){return 0!==this._scale}enemy_collision(_){let e=this;0!==e._scale&&2!==_GAME.isSqCollision(parseInt(e.width/8)+","+parseInt(e.height/8)+","+parseInt(6*e.width/8)+","+parseInt(6*e.height/8),e.x+","+e.y,_.shotColMap,_.x+","+_.y)&&(_.collision(),e.reduce())}enemy_shot_collision(_){let e=this;0!==e._scale&&2!==_GAME.isSqCollision(parseInt(e.width/8)+","+parseInt(e.height/8)+","+parseInt(6*e.width/8)+","+parseInt(6*e.height/8),e.x+","+e.y,_.shotColMap,_.x+","+_.y)&&(_.init(),e.reduce())}getPlayerCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height/2}}map_collition(){let _=this.getPlayerCenterPosition(),e=_MAP.getMapX(_._x),t=_MAP.getMapY(_._y);_MAP.isMapCollision(e,t)&&this.reduce()}reduce(){this._scale-=.06,this._scale<.7&&(this._scale=0,_POWERMETER._set_meter_on("000001")),this.width*=this._scale,this.height*=this._scale}move(_){let e=this;if(e.map_collition(),0===e._scale)return;e.x=_.getPlayerCenterPosition()._x-e.width/2-6,e.y=_.getPlayerCenterPosition()._y-e.height/2-2;let t=(e._c=e._c>=5*e.ani.length-1?0:e._c+1,e.ani[parseInt(e._c/5)].img);_CONTEXT.drawImage(t,e.x,e.y,e.width,e.height)}}class GameObject_FORCEFIELD_RED extends GameObject_FORCEFIELD{constructor(){super(),this.ani=[{img:_CANVAS_IMGS.forcefield_red1.obj,scale:1},{img:_CANVAS_IMGS.forcefield_red2.obj,scale:1}]}}class GameObject_SHIELD extends GameObject_FORCEFIELD{constructor(){super(),this.STATUS_MAX=15,this.type="shield",this.ani=[{img:_CANVAS_IMGS.shield1.obj,scale:1},{img:_CANVAS_IMGS.shield2.obj,scale:1}]}getPlayerCenterPosition(){return{_x:this.x+this.width/2,_y:this.y+this.height}}init(){this._scale=1,this.img=this.ani[0].img,this.width=this.img.width,this.height=this.img.height}isalive(){return 0!==this._scale}enemy_collision(_){0!==this._scale&&2!==_GAME.isSqCollision("0,0,"+this.width+","+2*this.height,parseInt(this.x)+","+parseInt(this.y),_.shotColMap,_.x+","+_.y)&&(_.collision(),this.reduce())}enemy_shot_collision(_){0!==this._scale&&2!==_GAME.isSqCollision("0,0,"+this.width+","+2*this.height,parseInt(this.x)+","+parseInt(this.y),_.shotColMap,_.x+","+_.y)&&(_.init(),this.reduce())}map_collition(_){let e=this,t=e.getPlayerCenterPosition(),s=_MAP.getMapX(t._x),i=_MAP.getMapY(t._y);_MAP.isMapCollision(s,i)?e.reduce():(i=parseInt(this.y/_MAP.t),_MAP.isMapCollision(s,i)?e.reduce():(i=parseInt((t._y-10+this.height)/_MAP.t),_MAP.isMapCollision(s,i)&&e.reduce()))}reduce(){this._scale-=.01,this._scale<.86&&(this._scale=0,_POWERMETER._set_meter_on("000001")),this.width*=this._scale,this.height*=this._scale}move(_){let e=this;if(0===e._scale)return;let t=_.getPlayerCenterPosition();e.map_collition(_);let s=(e._c=e._c>=5*e.ani.length-1?0:e._c+1,e.ani[parseInt(e._c/5)].img),i=_.x+_.img.width,n=t._y,a=t._y-e.height*e._scale;_CONTEXT.drawImage(s,i,n,e.width,e.height),_CONTEXT.drawImage(s,i,a,e.width,e.height),this.x=i,this.y=a}}class GameObject_SHIELD_RED extends GameObject_SHIELD{constructor(){super(),this.ani=[{img:_CANVAS_IMGS.shield_red1.obj,scale:.4},{img:_CANVAS_IMGS.shield_red2.obj,scale:.4}]}}class GameObject_SHOTS{constructor(_){this.shots=new Array,this.player=_,this._sq=0}enemy_collision(_){if(this.player.isalive())for(let e=0;e<this.shots.length;e++){let t=this.shots[e];if(!t._shot_alive)continue;if(_.x<this.player.x)continue;let s=_GAME.isSqCollision("-10,-10,10,10",t.x+","+t.y,_.shotColMap,_.x+","+_.y);if(2===s)return;0===s&&_.collision(_SHOTTYPE_NORMAL),t._init()}}map_collition(){}getshottype(){}move(){}}class GameObject_SHOTS_MISSILE extends GameObject_SHOTS{constructor(_){super(_),this.shots=new Array,this.col_mis=[{fs:"rgba(255,246,72,1)",scale:8},{fs:"rgba(255,131,62,1)",scale:10},{fs:"rgba(255,131,62,1)",scale:12},{fs:"rgba(255,131,62,1)",scale:14},{fs:"rgba(133,0,4,1)",scale:14},{fs:"rgba(133,0,4,1)",scale:14}];for(let _=0;_<2;_++)this.shots.push({sid:_SHOTTYPE_MISSILE,id:_,x:0,y:0,_t:0,_st:"_st1",_img:new Image,_c_mc:0,_c:0,_c_area:25,_enemyid:null,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._t=0,this._c=0,this._c_mc=0,this._c_area=25,this._st="_st1",this._img=new Image,this._enemyid=null,this._shot=!1,this._shot_alive=!1}});let e=this;this.mis_status={_st1:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+4:t._x}(_.x),_.y=function(e){return _._shot_alive?e+8:t._y}(_.y),_._img=_CANVAS_IMGS.missile1.obj},_st2:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e:t._x}(_.x),_.y=function(e){return _._shot_alive?e+8:t._y}(_.y),_._img=_CANVAS_IMGS.missile2.obj},_st3:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+8:t._x}(_.x),_.y=function(e){return _._shot_alive?e:t._y}(_.y),_._img=_CANVAS_IMGS.missile3.obj},_st4:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+3:t._x}(_.x),_.y=function(e){return _._shot_alive?e+3:t._y}(_.y),_._img=_CANVAS_IMGS.missile4.obj},_st5:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+3:t._x}(_.x),_.y=function(e){return _._shot_alive?e+3:t._y}(_.y),_._img=_CANVAS_IMGS.missile5.obj},_st6:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+2:t._x}(_.x),_.y=function(e){return _._shot_alive?e+3:t._y}(_.y),_._img=_CANVAS_IMGS.missile1.obj},_st7:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+4:t._x}(_.x),_.y=function(e){return _._shot_alive?e+3:t._y}(_.y),_._img=_CANVAS_IMGS.missile5.obj},_st8:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+4:t._x}(_.x),_.y=function(e){return _._shot_alive?e+1:t._y}(_.y),_._img=_CANVAS_IMGS.missile4.obj}}}enemy_collision(_,e){if(!this.player.isalive())return;if(!e._shot_alive)return;let t=_GAME.isSqCollision(e._img.width/4+","+e._img.height/4+","+3*e._img.width/4+","+3*e._img.height/4,e.x+","+e.y,_.shotColMap,_.x+","+_.y);2!==t&&e._enemyid!==_.id&&(e._c>0||(0===e._c&&(e._c=1),1!==t&&(_.collision(_SHOTTYPE_MISSILE),e._enemyid=_.id)))}get_missile_status(_){return _._st}set_missile_status(_,e){"_st1"!==this._st&&"_st2"!==this._st&&"_st3"!==this._st&&(_._c_mc++,_._c_mc>1?_._c_mc=0:_._st=e)}map_collition(_){let e=this,t=_MAP.getMapX(_.x+_._img.width),s=_MAP.getMapY(_.y);if(!_MAP.isMapBefore(t,s)){if(_MAP.isMapOver(t,s)){if("_st3"===e.get_missile_status(_))return void e.set_missile_status(_,"_st4");if("_st2"===e.get_missile_status(_))return}if("_st4"===e.get_missile_status(_)&&e.set_missile_status(_,"_st5"),"_st6"===e.get_missile_status(_)){if(t=_MAP.getMapX(_.x+_._img.width),_MAP.isMapCollision(t,s))return void _._init();e.set_missile_status(_,"_st7")}if("_st7"===e.get_missile_status(_)){if(t=_MAP.getMapX(_.x+_._img.width),_MAP.isMapCollision(t,s))return void _._init();_.x+=2,e.set_missile_status(_,"_st8")}if("_st8"===e.get_missile_status(_)){if(t=_MAP.getMapX(_.x+_._img.width),_MAP.isMapCollision(t,s))return void _._init();_.x+=2,_.y=s*_MAP.t+3,e.set_missile_status(_,"_st3")}if("_st5"===e.get_missile_status(_)){if(t=_MAP.getMapX(_.x+_._img.width),_MAP.isMapCollision(t,s+1))return _.y=s*_MAP.t-5,void e.set_missile_status(_,"_st6");if(!_MAP.isMapCollision(t,s+1))return e.set_missile_status(_,"_st2"),_.x+=2,void(_.y+=5);if(_MAP.isMapCollision(t+1,s))return void _._init()}if("_st3"===e.get_missile_status(_)){if(t=_MAP.getMapX(_.x+_._img.width),_MAP.isMapCollision(t,s))return void _._init();if(!_MAP.isMapCollision(t,s+1))return void e.set_missile_status(_,"_st4");if(t=_MAP.getMapX(_.x+_._img.width/2),_MAP.isMapCollision(t,s))return void _._init();if(_MAP.isMapOver(t,s))return void e.set_missile_status(_,"_st4")}return"_st2"===e.get_missile_status(_)&&(s=_MAP.getMapY(_.y+_._img.height/2),_MAP.isMapCollision(t,s)||_MAP.isMapCollision(t,s+1))?(_.y=s*_MAP.t-8,void e.set_missile_status(_,"_st6")):"_st1"===e.get_missile_status(_)&&(s=_MAP.getMapY(_.y+_._img.height/2),_MAP.isMapCollision(t,s)||_MAP.isMapCollision(t,s+1)||_MAP.isMapCollision(t+1,s+1))?(_.y=s*_MAP.t-5,void e.set_missile_status(_,"_st7")):void 0}}collapse_missile(_,e){let t=this;if(e=e||-5,_._c>=5*t.col_mis.length)return void _._init();let s=parseInt(_._c/5);_._c_area=t.col_mis[s].scale,_CONTEXT.fillStyle=t.col_mis[s].fs,_CONTEXT.beginPath(),_CONTEXT.arc(_.x,_.y+e,t.col_mis[s].scale,0,2*Math.PI,!1),_CONTEXT.fill(),void 0!==this.col_mis[s-1]&&(_CONTEXT.fillStyle=t.col_mis[s-1].fs,_CONTEXT.beginPath(),_CONTEXT.arc(_.x,_.y+e,t.col_mis[s-1].scale,0,2*Math.PI,!1),_CONTEXT.fill()),_._c++}move(){let _=this,e=_.player;if(e.isalive()&&e.isshotflag()&&void 0!==e.x)for(let e=0;e<_.shots.length;e++){let t=_.shots[e];(t._shot||t._shot_alive)&&(t._c>0?_.collapse_missile(t,10):t.y>_CANVAS.height||t.x>_CANVAS.width?t._init():(_.mis_status[t._st](t),"_st1"===_.get_missile_status(t)&&_MAP.isMapCollision(_MAP.getMapX(t.x),_MAP.getMapY(t.y))?t._init():(_CONTEXT.drawImage(t._img,t.x,t.y,t._img.width,t._img.height),t._shot_alive=!0)))}}}class GameObject_SHOTS_MISSILE_PHOTOM extends GameObject_SHOTS_MISSILE{constructor(_){super(_);let e=this;this.mis_status={_st1:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+4:t._x}(_.x),_.y=function(e){return _._shot_alive?e+8:t._y}(_.y),_._img=_CANVAS_IMGS.missile3.obj},_st2:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e:t._x}(_.x),_.y=function(e){return _._shot_alive?e+8:t._y}(_.y),_._img=_CANVAS_IMGS.missile2.obj},_st3:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+8:t._x}(_.x),_.y=function(e){return _._shot_alive?e:t._y}(_.y),_._img=_CANVAS_IMGS.missile3.obj},_st4:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+3:t._x}(_.x),_.y=function(e){return _._shot_alive?e+3:t._y}(_.y),_._img=_CANVAS_IMGS.missile4.obj},_st5:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+3:t._x}(_.x),_.y=function(e){return _._shot_alive?e+3:t._y}(_.y),_._img=_CANVAS_IMGS.missile5.obj},_st6:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+2:t._x}(_.x),_.y=function(e){return _._shot_alive?e+3:t._y}(_.y),_._img=_CANVAS_IMGS.missile1.obj},_st7:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+4:t._x}(_.x),_.y=function(e){return _._shot_alive?e+4:t._y}(_.y),_._img=_CANVAS_IMGS.missile5.obj},_st8:function(_){let t=e.player.getPlayerCenterPosition();_.x=function(e){return _._shot_alive?e+4:t._x}(_.x),_.y=function(e){return _._shot_alive?e+2:t._y}(_.y),_._img=_CANVAS_IMGS.missile4.obj}}}enemy_collision(_,e){if(!this.player.isalive())return;if(!e._shot_alive)return;let t=_GAME.isSqCollision(e._img.width/4+","+e._img.height/4+","+3*e._img.width/4+","+3*e._img.height/4,e.x+","+e.y,_.shotColMap,_.x+","+_.y);2!==t&&e._enemyid!==_.id&&(e._c>0||(1!==t?(_.collision(_SHOTTYPE_MISSILE),_.isalive()&&(0===e._c&&(e._c=1),e._enemyid=_.id)):0===e._c&&(e._c=1)))}}class GameObject_SHOTS_MISSILE_SPREADBOMB extends GameObject_SHOTS_MISSILE{constructor(_){super(_),this.col_mis=[{fs:"rgba(198,231,247,1)",scale:30},{fs:"rgba(54,115,255,1)",scale:40},{fs:"rgba(54,115,255,1)",scale:50},{fs:"rgba(54,115,255,1)",scale:60},{fs:"rgba(0,27,145,1)",scale:60},{fs:"rgba(0,27,145,1)",scale:60},{fs:"rgba(0,27,145,1)",scale:70}],this.mis_status={_st1:function(_){_._img=_CANVAS_IMGS.missile4.obj},_st2:function(_){_._img=_CANVAS_IMGS.missile5.obj},_st3:function(_){_._img=_CANVAS_IMGS.missile1.obj}}}enemy_collision(_,e){if(!this.player.isalive())return;if(!e._shot_alive)return;_.getEnemyCenterPosition();let t=function(){if(e._c>0){if(e._c%20!=0)return 2;let t=2*e._c_area;Math.sqrt(2);return _GAME.isSqCollision("0,0,"+t+","+t,parseInt(e.x-t/2)+","+parseInt(e.y-t/2),_.shotColMap,_.x+","+_.y)}return _GAME.isSqCollision(e._img.width/4+","+e._img.height/4+","+3*e._img.width/4+","+3*e._img.height/4,e.x+","+e.y,_.shotColMap,_.x+","+_.y)}();2!==t&&(0===e._c&&(e._c=1),1!==t&&(_.collision(_SHOTTYPE_MISSILE),e._enemyid=_.id))}map_collition(_){let e=_MAP.getMapX(_.x),t=_MAP.getMapY(_.y);(_MAP.isMapCollision(e,t)||_MAP.isMapCollision(e+1,t))&&this.collapse_missile(_,-25)}move(){let _=this,e=_.player;if(!e.isalive())return;if(!e.isshotflag())return;if(void 0===e.x)return;let t=e.getPlayerCenterPosition();for(let e=0;e<_.shots.length;e++){let s=_.shots[e];(s._shot||s._shot_alive)&&(s._c>0?_.collapse_missile(s):(s._t++,s.x=function(_){return s._shot_alive?_+4:t._x}(s.x),s.y=function(_){return s._shot_alive?_+s._t*s._t/200:t._y-8}(s.y),s._st=s._t>20&&s._t<30?"_st2":s._t>30?"_st3":"_st1",s.y>_CANVAS.height||s.x>_CANVAS.width?s._init():(_.mis_status[s._st](s),_CONTEXT.drawImage(s._img,s.x,s.y,s._img.width,s._img.height),s._shot_alive=!0)))}}}class GameObject_SHOTS_MISSILE_2WAY extends GameObject_SHOTS_MISSILE{constructor(_){super(_),this.mis_status={_st1:function(_){_._img=_CANVAS_IMGS.missile4.obj},_st2:function(_){_._img=_CANVAS_IMGS.missile5.obj},_st3:function(_){_._img=_CANVAS_IMGS.missile1.obj},_st4:function(_){_._img=_CANVAS_IMGS.missile6.obj},_st5:function(_){_._img=_CANVAS_IMGS.missile7.obj},_st6:function(_){_._img=_CANVAS_IMGS.missile8.obj}}}enemy_collision(_,e){if(!this.player.isalive())return;if(!e._shot_alive)return;let t=_GAME.isSqCollision(e._img.width/4+","+e._img.height/4+","+3*e._img.width/4+","+3*e._img.height/4,e.x+","+e.y,_.shotColMap,_.x+","+_.y);2!==t&&e._enemyid!==_.id&&(e._c>0||(0===e._c&&(e._c=1),1!==t&&(_.collision(_SHOTTYPE_MISSILE,e),e._enemyid=_.id)))}map_collition(_){let e=_MAP.getMapX(_.x),t=_MAP.getMapY(0===_.id?_.y:_.y+_._img.height);_MAP.isMapCollision(e,t)&&0===_._c&&(_._c=1)}move(){let _=this,e=_.player;if(!e.isalive())return;if(!e.isshotflag())return;if(void 0===e.x)return;let t=e.getPlayerCenterPosition(),s=this.shots[0]._shot|this.shots[1]._shot,i=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(s||i){s&&!i&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let e=0;e<this.shots.length;e++){let s=this.shots[e];if(s._shot_alive)if(s._c>0)_.collapse_missile(s,10);else{if(s._t+=1,s.x=function(_){return i?_+1:t._x}(s.x),s.y=function(_){return 0===e?i?_+s._t*s._t/100*-1:t._y-20:i?_+s._t*s._t/100:t._y}(s.y),0===e){if(s.x>_CANVAS.width||s.y<0){s._init();continue}s._st=s._t>20&&s._t<30?"_st5":s._t>30?"_st6":"_st4"}else{if(s.x>_CANVAS.width||s.y>_CANVAS.height){s._init();continue}s._st=s._t>20&&s._t<30?"_st2":s._t>30?"_st3":"_st1"}_.mis_status[s._st](s),_CONTEXT.drawImage(s._img,s.x,s.y,s._img.width,s._img.height),s._shot_alive=!0}}}}}class GameObject_SHOTS_NORMAL extends GameObject_SHOTS{constructor(_){super(_),this.shots=new Array,this.speed=20;for(let _=0;_<2;_++)this.shots.push({sid:_SHOTTYPE_NORMAL,x:0,y:0,_img:_CANVAS_IMGS.shot1.obj,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._shot=!1,this._shot_alive=!1}})}map_collition(_){let e=_MAP.getMapX(_.x),t=_MAP.getMapY(_.y);(_MAP.isMapCollision(e,t)||_MAP.isMapCollision(e+1,t))&&_._init()}move(){let _=this.player;if(!_.isalive())return;if(!_.isshotflag())return;let e=_.getPlayerCenterPosition();for(let _=0;_<this.shots.length;_++){let t=this.shots[_];if(!t._shot&&!t._shot_alive)continue;let s=this.speed;if(t.x=function(_){return t._shot_alive?_+s:e._x}(t.x),t.y=function(_){return t._shot_alive?_:e._y}(t.y),t.x>_CANVAS.width){t._init();continue}let i=_CANVAS_IMGS.shot1.obj;_CONTEXT.drawImage(i,t.x,t.y,i.width,i.height),t._shot_alive=!0}}}class GameObject_SHOTS_DOUBLE extends GameObject_SHOTS{constructor(_){super(_),this.shots=new Array,this.speed=30;for(let _=0;_<2;_++)this.shots.push({sid:_SHOTTYPE_DOUBLE,x:0,y:0,_img:0===_?_CANVAS_IMGS.shot1.obj:_CANVAS_IMGS.shot2.obj,_enemyid:null,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._enemyid=null,this._shot=!1,this._shot_alive=!1}})}enemy_collision(_){let e=this;if(!e.player.isalive())return;for(let t=0;t<e.shots.length;t++){let s=e.shots[t],i=_GAME.isSqCollision("-10,-10,10,10",s.x+","+s.y,_.shotColMap,_.x+","+_.y);2!==i&&(1!==i?_.isalive()&&(_.collision(_SHOTTYPE_DOUBLE),s._init()):s._init())}}map_collition(_){let e=_MAP.getMapX(_.x),t=_MAP.getMapY(_.y);(_MAP.isMapCollision(e,t)||_MAP.isMapCollision(e+1,t))&&_._init()}move(){let _=this.player;if(!_.isalive())return;if(!_.isshotflag())return;let e=_.getPlayerCenterPosition(),t=this.shots[0]._shot|this.shots[1]._shot,s=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(t||s){t&&!s&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let _=0;_<this.shots.length;_++){let t=this.shots[_];t._shot_alive&&(t.x=function(_){return s?_+30:e._x}(t.x),t.y=function(t){return 0===_?s?t:e._y:s?t-23:e._y-23}(t.y),this.shots[0].x>_CANVAS.width?this.shots[0]._init():this.shots[1].y<0||this.shots[1].x>_CANVAS.width?this.shots[1]._init():(_CONTEXT.drawImage(t._img,t.x,t.y,t._img.width,t._img.height),t._shot_alive=!0))}}}}class GameObject_SHOTS_TAILGUN extends GameObject_SHOTS_DOUBLE{constructor(_){super(_)}move(){let _=this.player;if(!_.isalive())return;if(!_.isshotflag())return;let e=_.getPlayerCenterPosition(),t=this.shots[0]._shot|this.shots[1]._shot,s=this.shots[0]._shot_alive|this.shots[1]._shot_alive;if(t||s){t&&!s&&(this.shots[0]._shot_alive=!0,this.shots[1]._shot_alive=!0);for(let _=0;_<this.shots.length;_++){let t=this.shots[_];if(!t._shot_alive)continue;if(t.x=function(t){return 0===_?s?t+30:e._x:s?t-30:e._x}(t.x),t.y=function(_){return s?_:e._y}(t.y),this.shots[0].x>_CANVAS.width){this.shots[0]._init();continue}if(this.shots[1].x<0){this.shots[1]._init();continue}let i=0===_?_CANVAS_IMGS.shot1.obj:_CANVAS_IMGS.shot3.obj;_CONTEXT.drawImage(i,t.x,t.y,i.width,i.height),t._shot_alive=!0}}}}class GameObject_SHOTS_RIPPLE_LASER extends GameObject_SHOTS{constructor(_){super(_),this.shots=new Array,this.speed=30,this.lineWidth=5,this.strokeStyle="rgba(50,80,255,1)";for(let _=0;_<2;_++)this.shots.push({sid:_SHOTTYPE_LASER,x:0,y:0,_t:0,_shot:!1,_shot_alive:!1,_width:0,_height:0,_init:function(){this.x=0,this.y=0,this._t=0,this._shot=!1,this._shot_alive=!1,this._width=0,this._height=0}})}enemy_collision(_){if(this.player.isalive())for(let e=0;e<this.shots.length;e++){let t=this.shots[e];if(!t._shot_alive)continue;let s=_GAME.isSqCollision("0,0,"+t._width+","+2*t._height,t.x+","+(t.y-t._height),_.shotColMap,_.x+","+_.y);if(2===s)return;if(!_.isalive())return;0===s&&_.collision(_SHOTTYPE_RIPPLE_LASER,t),t._init()}}map_collition(_){let e=_MAP.getMapX(_.x),t=_MAP.getMapY(_.y);(_MAP.isMapCollision(e,t)||_MAP.isMapCollision(e+1,t))&&_._init()}move(){let _=this,e=_.player;if(!e.isalive())return;if(!e.isshotflag())return;let t=e.getPlayerCenterPosition();for(let e=0;e<_.shots.length;e++){let s=_.shots[e];if(!s._shot&&!s._shot_alive)continue;let i=_.speed;s.x=function(_){return s._shot_alive?_+i:t._x}(s.x),s.y=function(_){return s._shot_alive?_:t._y}(s.y),s.x>_CANVAS.width?s._init():(s._t=s._t<20?s._t+1:s._t,s._width=.5+s._t,s._height=8+s._t*s._t/6,_CONTEXT.beginPath(),_CONTEXT.lineWidth=_.lineWidth,_CONTEXT.strokeStyle=_.strokeStyle,_CONTEXT.ellipse(s.x,s.y,s._width,s._height,0,0,2*Math.PI),_CONTEXT.stroke(),s._shot_alive=!0)}}}class GameObject_SHOTS_RIPPLE_LASER_RED extends GameObject_SHOTS_RIPPLE_LASER{constructor(_){super(_),this.strokeStyle="rgba(255,80,50,1)"}}class GameObject_SHOTS_LASER extends GameObject_SHOTS{constructor(_){super(_);let e=this;e.shots=new Array,e.speed=50,e.lineWidth=3,e.strokeStyle="rgba(50,80,255,1)",e.strokeStyle_u="rgba(120,150,255,1)",e.colimg=[_CANVAS_IMGS.shot_laser_col1.obj,_CANVAS_IMGS.shot_laser_col2.obj];for(let _=0;_<1;_++)e.shots.push({sid:_SHOTTYPE_LASER,x:0,y:0,_c_col:0,laser_time:500,_sx:0,_enemy:null,_laser_t:0,_laser_ts:0,_laser_MaxX:_CANVAS.width,_l_x:0,_l_y:0,_l_sx:0,_l_sy:0,_shot:!1,_shot_alive:!1,_init:function(){this.x=0,this.y=0,this._c=0,this._laser_t=0,this._laser_ts=0,this._sx=0,this._enemy=null,this._l_x=0,this._l_y=0,this._l_sx=0,this._l_sy=0,this._laser_MaxX=_CANVAS.width,this._shot=!1,this._shot_alive=!1}})}laser_collision(_){let e=this;_._c_col=_._c_col>1?0:_._c_col+1;let t=e.colimg[_._c_col];_._c_col>=2||_CONTEXT.drawImage(t,_._l_x,_.y-t.height/2,t.width,t.height)}enemy_collision(_){if(this.player.isalive())for(let e=0;e<this.shots.length;e++){if(_.x<this.player.x)continue;let t=this.shots[e];if(!t._shot_alive)continue;let s=_GAME.isSqCollision("0,0,"+parseInt(t._l_x-t._l_sx)+",2",t._l_sx+","+t.y,_.shotColMap,_.x+","+_.y);if(2===s)return void(null===t._enemy||t._enemy===_.id&&this.setLaserMaxX(_CANVAS.width));if(1===s)return void this.setLaserMaxX(_.x+_.img.width/4);if(_.collision(_SHOTTYPE_LASER),_.isalive())return this.setLaserMaxX(_.x+_.img.width/4),void(t._enemy=_.id);this.setLaserMaxX(_CANVAS.width)}}map_collition(_){if(!_._shot_alive)return;let e=this.player.getPlayerCenterPosition(),t=_MAP.getMapX(_.x+e._x),s=_MAP.getMapY(_.y);_MAP.isMapCollision(t,s)?this.setLaserMaxX(_MAP.getMapXToPx(t)):_MAP.isMapCollision(t-1,s)?this.setLaserMaxX(_MAP.getMapXToPx(t)):this.setLaserMaxX(_CANVAS.width)}setLaserLine(_,e,t,s,i){_._l_x=e,_._l_y=t,_._l_sx=s,_._l_sy=i}setLaserMaxX(_){let e=this;for(let t=0;t<e.shots.length;t++)e.shots[t]._laser_MaxX=_,e.shots[t]._laser_MaxX<_CANVAS.width&&e.laser_collision(e.shots[t])}move(){let _=this,e=_.player;if(!e.isalive())return;if(!e.isshotflag())return;let t=e.getPlayerCenterPosition();_CONTEXT.beginPath(),_CONTEXT.lineWidth=_.lineWidth,_CONTEXT.strokeStyle=_.strokeStyle,_CONTEXT.lineCap="round";for(let e=0;e<_.shots.length;e++){let s=_.shots[e];if(s._shot||s._shot_alive){if(s.x=function(e){return e>=s._laser_MaxX-t._x?(s._laser_t+=1e3/60,s._laser_MaxX-t._x):e+_.speed}(s.x),s._sx=function(e){return s._shot?s._laser_t<=s.laser_time-200?e:(s._laser_ts+=1e3/60,s._laser_ts>s.laser_time-200?(s._init(),0):e>=s.x?s.x:e+=_.speed):e>=s.x?(s._init(),0):e+=_.speed}(s._sx),s.y=t._y,s.x<s._sx||Math.abs(s.x-s._sx)<50)return;_CONTEXT.beginPath(),_CONTEXT.strokeStyle=_.strokeStyle_u,_CONTEXT.moveTo(t._x+s._sx,t._y+1),_CONTEXT.lineTo(t._x+s.x,t._y+1),_CONTEXT.stroke(),_CONTEXT.beginPath(),_CONTEXT.strokeStyle=_.strokeStyle,_CONTEXT.moveTo(t._x+s._sx,t._y),_CONTEXT.lineTo(t._x+s.x,t._y),_CONTEXT.stroke(),_.setLaserLine(s,t._x+s.x,t._y,t._x+s._sx,t._y),s.x>0&&(s._shot_alive=!0)}}}}class GameObject_SHOTS_LASER_CYCLONE extends GameObject_SHOTS_LASER{constructor(_){super(_);let e=this;e.lineWidth=5,e.strokeStyle="rgba(255,80,50,1)",e.strokeStyle_u="rgba(255,200,150,1)",e.colimg=[_CANVAS_IMGS.shot_laser_col3.obj,_CANVAS_IMGS.shot_laser_col4.obj]}}class GameObject_PM{constructor(_,e,t){let s=this;this.img=_CANVAS_IMGS[_].obj,this.x=_CANVAS.width/2-this.img.width/2,this.y=_CANVAS.height-30,this.meterdef_status="111111",this.meterdef_current="000000",this.meterdef={n_32:{imgobj:new Image,name:"meter_c_speedup",func:function(){_PLAYERS_MAIN.accel>=6?s._set_meter_status():_PLAYERS_MAIN.accel++}},n_16:{imgobj:new Image,name:"meter_c_missile",func:function(){_PLAYERS_MISSILE_ISALIVE=!0,s._set_meter_status()}},n_8:{imgobj:new Image,name:"meter_c_double",func:function(){_SHOTTYPE=_SHOTTYPE_DOUBLE,s._set_meter_status()}},n_4:{imgobj:new Image,name:"meter_c_laser",func:function(){_SHOTTYPE=_SHOTTYPE_LASER,s._set_meter_status()}},n_2:{imgobj:new Image,name:"meter_c_option",func:function(){_PLAYERS_OPTION[_PLAYERS_OPTION_ISALIVE].settruealive(),++_PLAYERS_OPTION_ISALIVE<4||s._set_meter_status()}},n_1:{imgobj:new Image,name:"meter_c_shield",func:function(){_PLAYERS_MAIN_FORCE.init(),s._set_meter_status()}}},this._c_pms=0,this.pms_img=_CANVAS_IMGS_INIT.gradius_powermeterselect.obj,this.pms_selected=[{_y:89,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_0.obj},{_y:162,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_1.obj},{_y:233,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_2.obj},{_y:306,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_3.obj}],this._c_pmss=0,this.pmss_selected=[{_x:470,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_shield_0.obj},{_x:570,_img:_CANVAS_IMGS_INIT.gradius_powermeterselect_shield_1.obj}]}init(){for(let _ in this.meterdef)this.meterdef[_].imgobj=_CANVAS_IMGS[this.meterdef[_].name].obj}_set_current_reset(){this.meterdef_current="000000"}_set_meter_status(){let _=this.meterdef_status,e=(~parseInt(this.meterdef_current,2)>>>0).toString(2).slice(-6);this.meterdef_status=this._get_bit((parseInt(_,2)&parseInt(e,2)).toString(2));let t=parseInt(this.meterdef_current,2);8!==t&&4!==t||(this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(8===t?"000100":"001000",2)).toString(2)))}_set_meter_on(_){this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(_,2)).toString(2))}_get_bit(_){return("000000"+_).slice(-6)}_get_meter_current(_){return 0===parseInt(_,2)||1===parseInt(_,2)?"100000":("000000"+(parseInt(_,2)>>1).toString(2)).slice(-6)}move(){this.meterdef_current=this._get_meter_current(this.meterdef_current)}playerset(){let _=parseInt(this.meterdef_current,2),e=parseInt(this.meterdef_status,2);0!==_&&0!=(_&e)&&(_PLAYERS_MAIN.set_equipped(),this.meterdef_status=this._get_bit((parseInt(this.meterdef_status,2)|parseInt(this.meterdef_current,2)).toString(2)),this.meterdef["n_"+_].func(),this._set_current_reset())}show(){_CONTEXT.drawImage(this.img,this.x,this.y,this.img.width,this.img.height);for(let _=0;_<this.meterdef_status.length;_++){if("0"!==this.meterdef_status[_])continue;let e=_CANVAS_IMGS.meter_blank.obj;_CONTEXT.drawImage(e,this.x+e.width*_,this.y,e.width,e.height)}let _=parseInt(this.meterdef_current,2);if(0===_)return;let e=0!=(_&parseInt(this.meterdef_status,2))?this.meterdef["n_"+_].imgobj:_CANVAS_IMGS.meter_c_blank.obj;_CONTEXT.drawImage(e,this.x+e.width*this.meterdef_current.indexOf("1"),this.y,e.width,e.height)}pms_disp(){let _="power meter select";_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_DRAW_DISP_TXT(_,_CANVAS.width/2-35*_.length/2,20,.3),_DRAW_DISP_TXT("shield select",_CANVAS.width/2-35*_.length/2,400,.15),_CONTEXT.drawImage(this.pms_img,_CANVAS.width/2-this.pms_img.width/2,70,this.pms_img.width,this.pms_img.height);let e=_CANVAS_IMGS_INIT.gradius_powermeterselect_shield_.obj;_CONTEXT.drawImage(e,_CANVAS.width/2-this.pms_img.width/2,430,e.width,e.height);let t=_CANVAS_IMGS_INIT.gradius_powermeterselect_shield.obj;_CONTEXT.drawImage(t,470,390,t.width,t.height)}pms_select(){let _=this.pms_selected[this._c_pms]._img;_CONTEXT.drawImage(_,_CANVAS.width/2-this.pms_img.width/2,this.pms_selected[this._c_pms]._y,_.width,_.height),_=this.pmss_selected[this._c_pmss]._img,_CONTEXT.drawImage(_,this.pmss_selected[this._c_pmss]._x,390,_.width,_.height)}}class GameObject_STAGESELECT{constructor(){this.x=0,this.y=0,this.speed=100,this.mapdef_status=0,this.mapdef=_MAPDEFS[this.mapdef_status]}get_ajaxdata(_,e){e.mapdef=_[e.mapdef_status],_ISDEBUG||e.disp_thumb_map()}init(){this.mapdef=_MAPDEFS[0],_ISDEBUG?this.mapdef=_MAPDEFS[_MAP_PETTERN]:this.disp_thumb_map()}set_map_status(){this.mapdef=_MAPDEFS[this.mapdef_status]}disp_thumb_map(){let _=this;_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_DRAW_DISP_TXT("stage select",_CANVAS.width/2-35*"stage select".length/2,20,.3);let e=500-20*(_MAPDEFS.length-1);for(let _=0;_<_MAPDEFS.length;_++)_CONTEXT.beginPath(),_CONTEXT.lineWidth=1,_CONTEXT.strokeStyle="rgba(255,255,255,1)",_CONTEXT.fillStyle="rgba(255,255,255,1)",_===this.mapdef_status?_CONTEXT.fillRect(e+20*_,85,10,10):_CONTEXT.strokeRect(e+20*_,85,10,10);let t=_.mapdef;_MAP.showMapForStageselect(t),_CONTEXT.beginPath(),_CONTEXT.lineWidth=1,_CONTEXT.strokeStyle="rgba(255,255,255,1)",_CONTEXT.fillStyle="rgba(255,255,255,1)",_CONTEXT.strokeRect(50,130,300,200),_DRAW_DISP_TXT("stage title",400,130,.2),_CONTEXT.moveTo(400,160),_CONTEXT.lineTo(950,160),_CONTEXT.stroke(),_CONTEXT.font="20px sans-serif";let s=_GAME._multilineText(_CONTEXT,this.mapdef._title,550);for(let _=0;_<(s.length>2?2:s.length);_++)_CONTEXT.fillText(s[_],400,190+26*_);_DRAW_DISP_TXT("difficult:"+this.mapdef._difficult,400,250,.2),_CONTEXT.moveTo(400,290),_CONTEXT.lineTo(950,290),_CONTEXT.stroke(),_DRAW_DISP_TXT("detail",400,320,.2),_CONTEXT.moveTo(400,360),_CONTEXT.lineTo(950,360),_CONTEXT.stroke(),s=_GAME._multilineText(_CONTEXT,this.mapdef._body,550);for(let _=0;_<(s.length>4?4:s.length);_++)_CONTEXT.fillText(s[_],400,390+30*_)}}class GameObject_SCORE{constructor(){this.score1p=0,this.score2p=0,this.def_scorehi=57300,this.scorehi=this.def_scorehi}init(){this.score1p=0,this.score2p=0}set(_){this.score1p+=_,this.scorehi>=this.score1p||(this.scorehi=this.score1p)}show(){let _="1p"+("        "+this.score1p).slice(-8);for(let e=0;e<_.length;e++){if(" "===_[e])continue;let t=_CANVAS_IMGS_INIT["font_"+_[e]].obj;_CONTEXT.drawImage(t,180+.15*t.width*e,10,.15*t.width,.15*t.height)}_="hi"+("        "+this.scorehi).slice(-8);for(let e=0;e<_.length;e++){if(" "===_[e])continue;let t=_CANVAS_IMGS_INIT["font_"+_[e]].obj;_CONTEXT.drawImage(t,400+.15*t.width*e,10,.15*t.width,.15*t.height)}_="2p"+("        "+this.score2p).slice(-8);for(let e=0;e<_.length;e++){if(" "===_[e])continue;let t=_CANVAS_IMGS_INIT["font_"+_[e]].obj;_CONTEXT.drawImage(t,620+.15*t.width*e,10,.15*t.width,.15*t.height)}}}class GameObject_POWERCAPSELL{constructor(_,e){this.x=_||0,this.y=e||0,this.getscore=300,this.gotpc=!1,this._c_pc_ani=0,this.pc_ani=[{img:_CANVAS_IMGS.pc1.obj,scale:.6},{img:_CANVAS_IMGS.pc2.obj,scale:.6},{img:_CANVAS_IMGS.pc3.obj,scale:.6},{img:_CANVAS_IMGS.pc4.obj,scale:.6},{img:_CANVAS_IMGS.pc5.obj,scale:.6}],this.img=this.pc_ani[0].img}getPCCenterPosition(){return{_x:this.x+this.img.width/2,_y:this.y+this.img.height/2}}getPowerCapcell(){this.gotpc=!0}move(){let _=this;if(_.gotpc)return;_.x-=_BACKGROUND_SPEED;let e=(_._c_pc_ani=_._c_pc_ani>=5*_.pc_ani.length-1?0:_._c_pc_ani+1,_.pc_ani[parseInt(_._c_pc_ani/5)].img);_CONTEXT.drawImage(e,_.x,_.y,e.width,e.height)}}class GameObject_BACKGROUND{constructor(){this.x=_CANVAS.width*Math.random(),this.y=_CANVAS.height*Math.random(),this.rgba="rgba("+parseInt(255*Math.random())+","+parseInt(255*Math.random())+","+parseInt(255*Math.random())+","+Math.random()+")",this.speed=5*Math.random()}init(){let _=Math.random()+.5;this.width=_,this.height=_}move(){let _=this;this.x=function(e){return 0===_BACKGROUND_SPEED?e:e<0?_CANVAS.width:e-_.speed}(this.x),_CONTEXT.beginPath(),_CONTEXT.arc(this.x,this.y,2,0,2*Math.PI,!0),_CONTEXT.fillStyle=this.rgba,_CONTEXT.fill()}}const _IS_GET_POWERCAPSELL=function(){for(let _=0;_<_POWERCAPSELLS.length;_++){let e=_POWERCAPSELLS[_];if(e.gotpc)continue;let t=_PLAYERS_MAIN.getPlayerCenterPosition(),s=e.getPCCenterPosition();Math.sqrt(Math.pow(s._x-t._x,2)+Math.pow(s._y-t._y,2))<Math.sqrt(Math.pow(_PLAYERS_MAIN.img.width,2)+Math.pow(_PLAYERS_MAIN.img.height,2))/2&&(_POWERMETER.move(),e.getPowerCapcell(),_SCORE.set(300))}},_IS_ENEMIES_COLLISION=function(){if(!_PLAYERS_MAIN.isalive())return;let _=_ENEMIES;_.sort(function(_,e){return _.x<e.x?-1:_.x>e.x?1:0});for(let e=0;e<_.length;e++){if(!_[e].isalive())continue;if(!_[e].isshow())continue;if(_[e].x>_CANVAS.width-50)continue;let t=_[e];for(let _=0;_<_PLAYERS_SHOTS[_SHOTTYPE].length;_++)_PLAYERS_SHOTS[_SHOTTYPE][_].enemy_collision(t);if(_PLAYERS_MAIN.enemy_collision(t),_PLAYERS_MAIN_FORCE.enemy_collision(t),_PLAYERS_MISSILE_ISALIVE)for(let _=0;_<_PLAYERS_MISSILE.length;_++){let e=_PLAYERS_MISSILE[_];if(e.player.isalive())for(let _=0;_<e.shots.length;_++){let s=e.shots[_];e.enemy_collision(t,s)}}}},_IS_ENEMIES_SHOT_COLLISION=function(){if(!_PLAYERS_MAIN.isalive())return;for(let _=0;_<_ENEMIES_SHOTS.length;_++){let e=_ENEMIES_SHOTS[_];e._shot_alive&&(_PLAYERS_MAIN.enemy_shot_collision(e),_PLAYERS_MAIN_FORCE.enemy_shot_collision(e))}},_DRAW=function(){_KEYEVENT_MASTER.addKeydownGame(),_KEYEVENT_MASTER.addKeyupGame();const _=function(){_DRAW_SETINTERVAL=window.requestAnimationFrame(_),_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);for(let _=0;_<70;_++)_BACKGROUND[_].move();for(let _=0;_<_ENEMIES_SHOTS.length;_++)_ENEMIES_SHOTS[_].move();for(let _=0;_<_ENEMIES.length;_++)void 0!==_ENEMIES[_]&&_ENEMIES[_].move();_IS_GET_POWERCAPSELL(),_MAP.isPlayersShotCollision(),_IS_ENEMIES_SHOT_COLLISION(),_IS_ENEMIES_COLLISION();for(let _=0;_<_POWERCAPSELLS.length;_++)_POWERCAPSELLS[_].move();for(let _=0;_<5;_++)_PLAYERS_MISSILE_ISALIVE&&_PLAYERS_MISSILE[_].move(),_PLAYERS_SHOTS[_SHOTTYPE][_].move();for(let _=0;_<4;_++)_PLAYERS_OPTION[_].move(10*(_+1));_PLAYERS_MAIN_FORCE.move(_PLAYERS_MAIN),_PLAYERS_MAIN.move(),_MAP.move(),_POWERMETER.show(),_SCORE.show(),(_SCROLL_POSITION+=_MAP.map_background_speed)-100<=_MAP.mapdef[0].length*_MAP.t+_MAP.initx||_DRAW_MATCH_BOSS()};_DRAW_SETINTERVAL=window.requestAnimationFrame(_)},_DRAW_MATCH_BOSS=function(){if(!_DRAW_IS_MATCH_BOSS){let _=new ENEMY_BOSS_BOGCORE(1300,200);return(_ENEMIES=[]).push(_),_ENEMIES_SHOTS=[],_ENEMIES_BOUNDS=[],_DRAW_SCROLL_STOP(),void(_DRAW_IS_MATCH_BOSS=!0)}let _="";for(let e=0;e<_ENEMIES.length;e++)_+=_ENEMIES[e].isalive()?"0":"1";-1===_.indexOf("0")&&(_DRAW_SCROLL_RESUME(),_DRAW_IS_MATCH_BOSS_COUNT>100?_DRAW_GAMECLEAR():_DRAW_IS_MATCH_BOSS_COUNT++)},_DRAW_PLAYER_COLLAPES=function(){_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame();const _=_PLAYERS_MAIN;if(void 0===_)return;let e=null,t=_.getPlayerCenterPosition();const s=function(){if(e=window.requestAnimationFrame(s),_._col_ani_c>=10*_.col_ani.length-1)return cancelAnimationFrame(e),void _DRAW_GAMEOVER();let i=parseInt(_._col_ani_c/10),n=_.col_ani[i].img.width,a=_.col_ani[i].img.height,o=n*_.col_ani[i].scale,r=a*_.col_ani[i].scale;_CONTEXT.drawImage(_.col_ani[i].img,t._x-o/2,t._y-r/2,o,r),_._col_ani_c++};e=window.requestAnimationFrame(s)},_DRAW_PLAYERS_SHOTS=function(){let _=new Date;const e=function(){if(_PLAYERS_SHOTS_SETINTERVAL=window.requestAnimationFrame(e),!(new Date-_<50)){_=new Date;for(s=0;s<_PLAYERS_SHOTS[_SHOTTYPE].length;s++){let _=_PLAYERS_SHOTS[_SHOTTYPE][s];if(_.player._isalive){_._sq=_._sq===_.shots.length-1?0:_._sq+1;var t=_.shots[_._sq];t._shot_alive||(t._shot=!0)}}for(var s=0;s<_PLAYERS_MISSILE.length;s++){let _=_PLAYERS_MISSILE[s];_._sq=_._sq===_.shots.length-1?0:_._sq+1;var i=_.shots[_._sq];i._shot_alive||(i._shot=!0)}}};_PLAYERS_SHOTS_SETINTERVAL=window.requestAnimationFrame(e)},_DRAW_STOP=function(){cancelAnimationFrame(_DRAW_SETINTERVAL),_DRAW_SETINTERVAL=null},_DRAW_STOP_GAMESTART=function(){cancelAnimationFrame(_DRAW_GAMESTART_SETINTERVAL),_DRAW_GAMESTART_SETINTERVAL=null},_DRAW_STOP_PLAYERS_SHOTS=function(){cancelAnimationFrame(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null;for(_=0;_<_PLAYERS_SHOTS[_SHOTTYPE].length;_++){let e=_PLAYERS_SHOTS[_SHOTTYPE][_];for(let _=0;_<e.shots.length;_++)e.shots[_]._shot=!1}for(var _=0;_<_PLAYERS_MISSILE.length;_++){let e=_PLAYERS_MISSILE[_];for(let _=0;_<e.shots.length;_++)e.shots[_]._shot=!1}},_DRAW_SELECT_POWERMETER=function(){_DRAW_STOP_PLAYERS_SHOTS(),_KEYEVENT_MASTER.removeKeydownSelectPowermeter();let _=0,e=null;const t=function(){e=window.requestAnimationFrame(t),_POWERMETER.pms_disp(),_%5==0&&_POWERMETER.pms_select(),_>40&&(_PLAYERS_POWER_METER=_POWERMETER._c_pms,_PLAYERS_POWER_METER_SHIELD=_POWERMETER._c_pmss,cancelAnimationFrame(e),_DRAW_INIT_OBJECT()),_++};e=window.requestAnimationFrame(t)},_DRAW_GAMESTART=function(){if(_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_ISDEBUG)return void _DRAW();let _=0;const e=function(){if(_DRAW_GAMESTART_SETINTERVAL=window.requestAnimationFrame(e),_>250)return _DRAW_STOP_GAMESTART(),void _DRAW();_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);for(let _=0;_<70;_++)_BACKGROUND[_].move();if(_POWERMETER.show(),_SCORE.show(),parseInt(_/50)%2!=0);else{for(let _=0;_<"start".length;_++){var t=_CANVAS_IMGS_INIT["font_"+"start"[_]].obj,s=_CANVAS.width/2-.5*t.width*"start".length/2,i=_CANVAS.height/2-t.height/2;_CONTEXT.drawImage(t,s+.5*t.width*_,i,.5*t.width,.5*t.height)}}_++};_DRAW_GAMESTART_SETINTERVAL=window.requestAnimationFrame(e)},_DRAW_GAMECLEAR=function(){var _=_CANVAS_IMGS_INIT.font_0.obj;let e="gameclear";_DRAW_DISP_TXT(e,_CANVAS.width/2-.5*_.width*e.length/2,_CANVAS.height/2-_.height/2,.5),_DRAW_DISP_TXT(e="press r to restart",_CANVAS.width/2-.15*_.width*e.length/2,_CANVAS.height/2+30,.15),_DRAW_DISP_TXT(e="press s to change another stage",_CANVAS.width/2-.15*_.width*e.length/2,_CANVAS.height/2+60,.15),_DRAW_IS_GAMECLEAR=!0},_DRAW_GAMEOVER=function(){_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_DRAW_STOP_PLAYERS_SHOTS(),_KEYEVENT_MASTER.addKeydownGameover(),_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);for(let _=0;_<70;_++)_BACKGROUND[_].move();_SCORE.show();var _=_CANVAS_IMGS_INIT.font_0.obj;let e="gameover";_DRAW_DISP_TXT(e,_CANVAS.width/2-.5*_.width*e.length/2,_CANVAS.height/2-_.height/2,.5),_DRAW_DISP_TXT(e="press r to restart",_CANVAS.width/2-.15*_.width*e.length/2,_CANVAS.height/2+30,.15),_DRAW_DISP_TXT(e="press s to change another stage",_CANVAS.width/2-.15*_.width*e.length/2,_CANVAS.height/2+60,.15)},_DRAW_DISP_TXT=function(_,e,t,s){s=s||1;for(let n=0;n<_.length;n++)if(" "!==_[n]){var i=_CANVAS_IMGS_INIT["font_"+_[n]].obj;_CONTEXT.drawImage(i,e+i.width*s*n,t,i.width*s,i.height*s)}},_DRAW_SCROLL_STOP=function(){_BACKGROUND_SPEED=0},_DRAW_SCROLL_RESUME=function(){_BACKGROUND_SPEED=_MAP.getBackGroundSpeed()},_DRAW_RESET_OBJECT=function(){_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_KEYEVENT_MASTER.removeKeydownGameover(),clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_DRAW_STOP(),_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_PLAYERS_MAIN="",_PLAYERS_MAIN_FORCE="",_PLAYERS_OPTION=[],_PLAYERS_OPTION_ISALIVE=0,_PLAYERS_SHOTS={_SHOTTYPE_NORMAL:[],_SHOTTYPE_DOUBLE:[],_SHOTTYPE_LASER:[]},_PLAYERS_MISSILE=[],_PLAYERS_MISSILE_ISALIVE=!1,_PLAYERS_MOVE_DRAW=[],_ENEMIES=[],_ENEMIES_BOUNDS=[],_ENEMIES_SHOTS=[],_POWERMETER="",_SHOTTYPE=_SHOTTYPE_NORMAL,_POWERCAPSELLS=[],_SCROLL_POSITION=0,_BACKGROUND_SPEED=1,_DRAW_IS_MATCH_BOSS=!1,_DRAW_IS_MATCH_BOSS_COUNT=0},_DRAW_INIT_OBJECT=function(){_KEYEVENT_MASTER.removeKeydownSelectPowermeter(),_PLAYERS_MAIN=0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?new GameObject_PLAYER_MAIN:new GameObject_PLAYER_MAIN_RED,_PLAYERS_SHOTS._SHOTTYPE_NORMAL.push(new GameObject_SHOTS_NORMAL(_PLAYERS_MAIN)),_PLAYERS_SHOTS._SHOTTYPE_DOUBLE.push(function(_){return 0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?new GameObject_SHOTS_DOUBLE(_):new GameObject_SHOTS_TAILGUN(_)}(_PLAYERS_MAIN)),_PLAYERS_SHOTS._SHOTTYPE_LASER.push(function(_){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER(_):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER_CYCLONE(_):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER(_):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER_RED(_):void 0}(_PLAYERS_MAIN)),_PLAYERS_MISSILE.push(function(_){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE(_):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_SPREADBOMB(_):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_PHOTOM(_):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_2WAY(_):void 0}(_PLAYERS_MAIN)),_PLAYERS_MAIN_FORCE=0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?1===_PLAYERS_POWER_METER_SHIELD?new GameObject_FORCEFIELD:new GameObject_SHIELD:1===_PLAYERS_POWER_METER_SHIELD?new GameObject_FORCEFIELD_RED:new GameObject_SHIELD_RED;for(let _=0;_<4;_++)_PLAYERS_OPTION.push(new GameObject_PLAYER_OPTION("option",110,70*(_+1),!1)),_PLAYERS_SHOTS._SHOTTYPE_NORMAL.push(new GameObject_SHOTS_NORMAL(_PLAYERS_OPTION[_])),_PLAYERS_SHOTS._SHOTTYPE_DOUBLE.push(function(_){return 0===_PLAYERS_POWER_METER||2===_PLAYERS_POWER_METER?new GameObject_SHOTS_DOUBLE(_):new GameObject_SHOTS_TAILGUN(_)}(_PLAYERS_OPTION[_])),_PLAYERS_SHOTS._SHOTTYPE_LASER.push(function(_){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER(_):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_LASER_CYCLONE(_):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER(_):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_RIPPLE_LASER_RED(_):void 0}(_PLAYERS_OPTION[_])),_PLAYERS_MISSILE.push(function(_){return 0===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE(_):1===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_SPREADBOMB(_):2===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_PHOTOM(_):3===_PLAYERS_POWER_METER?new GameObject_SHOTS_MISSILE_2WAY(_):void 0}(_PLAYERS_OPTION[_]));(_POWERMETER=new GameObject_PM("meter")).init(),_DRAW_IS_GAMECLEAR||_SCORE.init(),_DRAW_IS_GAMECLEAR=!1;for(let _=0;_<70;_++)_BACKGROUND[_]=new GameObject_BACKGROUND,_BACKGROUND[_].init();_MAP.init_stage_map(),_MAP.init_enemies_location(),_DRAW_GAMESTART()},_DRAW_POWER_METER_SELECT=function(){clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height),_KEYEVENT_MASTER.removeKeydownSelectStage(),_KEYEVENT_MASTER.addKeydownSelectPowermeter(),(_POWERMETER=new GameObject_PM("meter")).pms_disp(),_POWERMETER.pms_select()},_DRAW_STAGE_SELECT=function(){clearInterval(_PLAYERS_SHOTS_SETINTERVAL),_PLAYERS_SHOTS_SETINTERVAL=null,_CONTEXT.clearRect(0,0,_CANVAS.width,_CANVAS.height);let _=document.querySelector("#game_start_wrapper"),e=document.querySelector("#game_wrapper");_.classList.remove("on"),e.classList.add("on"),_KEYEVENT_MASTER.removeKeydownStart(),_KEYEVENT_MASTER.removeKeydownGame(),_KEYEVENT_MASTER.removeKeyupGame(),_KEYEVENT_MASTER.removeKeydownGameover(),_KEYEVENT_MASTER.addKeydownSelectStage(),_MAP.init(function(){(_STAGESELECT=new GameObject_STAGESELECT).init()})},_DRAW_INIT=function(_,e){let t=0,s=!1;for(let i in _){let n=_[i];n.obj.src=_[i].src,n.obj.onload=function(){n.obj.width*=n.rate,n.obj.height*=n.rate,++t>=Object.keys(_).length&&e()},n.obj.onabort=function(){},n.obj.onerror=function(){s||(alert(""),s=!0)}}},_GAME={_url_params:new Array,_init:function(){_SCORE=new GameObject_SCORE,(_MAP=new GameObject_MAP).init(_GAME._showGameStart)},_ac:{_get:function(_,e,t){return _>=e.length*t-1?0:_+1}},getBit:(_,e)=>("0".repeat(e)+_).slice(-1*e),getOrBit(_,e,t){let s=(parseInt(_,2)|parseInt(e,2)).toString(2);return this.getBit(s,t)},setUrlParams(){for(var _=location.search.slice(1).split(/(&|&amp;)/),e=0;e<_.length;e++){var t=_[e].replace("amp;","").split("=");""!==t[0]&&void 0!==t[0]&&("&"!==t[0]&&(this._url_params[t[0]]=t[1]))}},isEnemyCanvasXIn(_){_.getEnemyCenterPosition();return _.x<_CANVAS.width},isEnemyCanvasXOut:_=>_.getEnemyCenterPosition()._x<-100,isEnemyCanvasOut(_){let e=_.getEnemyCenterPosition();return e._x<-100||e._x>_CANVAS.width+100||e._y<-100||e._y>_CANVAS.height+100},isSqCollision:function(_,e,t,s,i){let n=parseInt(void 0===e?0:e.split(",")[0]),a=parseInt(void 0===e?0:e.split(",")[1]),o=parseInt(void 0===s?0:s.split(",")[0]),r=parseInt(void 0===s?0:s.split(",")[1]),E=_.split(","),m=parseInt(E[2])-parseInt(E[0]),l=parseInt(E[3])-parseInt(E[1]),c=m/2+n+parseInt(E[0]),S=l/2+a+parseInt(E[1]);i&&console.log(c+":"+S);for(let _=0;_<t.length;_++){let e=t[_].split(","),s=parseInt(e[2])-parseInt(e[0]),i=parseInt(e[3])-parseInt(e[1]),n=function(_){return void 0===_}(e[4]),a=(Math.sqrt(Math.pow(s,2)+Math.pow(i,2)),s/2+o+parseInt(e[0])),E=i/2+r+parseInt(e[1]),g=Math.abs(a-c),A=Math.abs(E-S);if(m/2+s/2>g&&l/2+i/2>A)return n?0:1}return 2},_showGameStart:function(){if(_ISSP&&_SP_CONTROLLER._set_obj(),_ISDEBUG)return document.querySelector("#game_wrapper").classList.add("on"),(_STAGESELECT=new GameObject_STAGESELECT).init(),_MAP.set_stage_map_pattern(_MAP_PETTERN),void _DRAW_INIT(_CANVAS_IMGS,_DRAW_POWER_METER_SELECT);_KEYEVENT_MASTER.addKeydownStart(),document.querySelector("#game_start_wrapper").classList.add("on"),_GAME._setTextToFont(document.querySelector("#game_start>.title"),"no pakuri",50),_GAME._setTextToFont(document.querySelector("#game_start>.text"),"press s to start",30),_GAME._setTextToFont(document.querySelector("#game_start>.text_loading"),"now loading",30)},_setTextToFont:function(_,e,t){if(void 0===_||null===_)return;t=t||30;let s="";for(let _=0;_<e.length;_++)" "!==e[_]?s+='<img src="./images/gradius_font_'+e[_]+'.png" width="'+t+'">':s+='<img src="./images/gradius_spacer.png" width="'+t+'">';_.innerHTML=s},_multilineText(_,e,t){let s=e.length,i=[],n="";if(s<1)return i;for(let a=0;a<s;a++){let s=e.charAt(a);"\n"!==s?_.measureText(n+s).width<=t?n+=s:(i.push(n),n=s):(i.push(n),n="")}return n.length>0&&i.push(n),i}};window.addEventListener("load",function(){_CANVAS=document.getElementById("game"),_CONTEXT=_CANVAS.getContext("2d"),_GAME.setUrlParams(),_ISDEBUG="true"===_GAME._url_params.debug,_MAP_PETTERN=_GAME._url_params.mp||0,_ENEMY_DIFFICULT=_GAME._url_params.ed||0,_ISSP&&document.querySelector("body").classList.add("sp"),_DRAW_INIT(_CANVAS_IMGS_INIT,_GAME._init)}),window.addEventListener("touchmove",function(_){_.preventDefault()},{passive:!1});